<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Arvind Venkatadri">
<meta name="dcterms.date" content="2023-01-29">
<title>The Foundation Series - Correlations in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../../../">
<script src="../../../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../../../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="../../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<meta property="og:title" content="The Foundation Series - Correlations in R">
<meta property="og:description" content="Tests, Tables, and Graphs for Correlations in R">
<meta property="og:site-name" content="The Foundation Series">
<meta name="twitter:title" content="The Foundation Series - Correlations in R">
<meta name="twitter:description" content="Tests, Tables, and Graphs for Correlations in R">
<meta name="twitter:creator" content="@arvind_v">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../../../../../index.html">
    <span class="navbar-title">The Foundation Series</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../../../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/my-quarto-website"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../../../../../blog.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Correlations in R</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../../blog.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Teaching</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Data Analytics</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../../content/courses/Data-Analytics/Descriptive-Analytics/listing.html" class="sidebar-item-text sidebar-link">Descriptive Analytics</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../../content/courses/Data-Analytics/Basics-of-Modeling/listing.html" class="sidebar-item-text sidebar-link">Basics of Modelling</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../../content/courses/Data-Analytics/Predictive-Analytics/listing.html" class="sidebar-item-text sidebar-link">Predictive Analytics</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../../content/courses/Data-Analytics/Prescriptive-Analytics/listing.html" class="sidebar-item-text sidebar-link">Prescriptive Analytics</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../../content/courses/R-for-Artists/listing.html" class="sidebar-item-text sidebar-link">R for Artists</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../../content/posts/listing.html" class="sidebar-item-text sidebar-link">Posts</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../../content/projects/listing.html" class="sidebar-item-text sidebar-link">Projects and Blogs</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">1</span>  Introduction</a>
  <ul class="collapse">
<li><a href="#case-study--1-dataset-from-mosaicdata" id="toc-case-study--1-dataset-from-mosaicdata" class="nav-link" data-scroll-target="#case-study--1-dataset-from-mosaicdata"><span class="toc-section-number">1.1</span>  Case Study -1: Dataset from <code>mosaicData</code></a></li>
  <li><a href="#correlations-and-plots" id="toc-correlations-and-plots" class="nav-link" data-scroll-target="#correlations-and-plots"><span class="toc-section-number">1.2</span>  Correlations and Plots</a></li>
  <li><a href="#case-study--2-dataset-from-nhanes" id="toc-case-study--2-dataset-from-nhanes" class="nav-link" data-scroll-target="#case-study--2-dataset-from-nhanes"><span class="toc-section-number">1.3</span>  Case Study -2: Dataset from <code>NHANES</code></a></li>
  </ul>
</li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="toc-section-number">2</span>  Conclusion</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Correlations in R</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Arvind Venkatadri </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 29, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">Invalid Date</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    Tests, Tables, and Graphs for Correlations in R
  </div>
</div>

</header><section id="introduction" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Introduction</h1>
<p>We will create Tables for Correlations, and graphs for Correlations in R. As always, we will consistently use the <a href="https://mosaic-web.org"><strong>Project Mosaic</strong></a> ecosystem of packages in R (<code>mosaic</code>, <code>mosaicData</code> and <code>ggformula</code>).</p>
<div class="cell">

</div>
<div id="note" class="illustration" style="background: beige">
<p>Note the standard method for all commands from the <code>mosaic</code> package:</p>
<p>goal( y ~ x | z, data = mydata, …)</p>
</div>
<section id="case-study--1-dataset-from-mosaicdata" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="case-study--1-dataset-from-mosaicdata">
<span class="header-section-number">1.1</span> Case Study -1: Dataset from <code>mosaicData</code>
</h2>
<p>Let us inspect what datasets are available in the package <code>mosaicData</code>. Run this command in your Console:</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Run in Console</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">data</span>(<span class="at">package =</span> <span class="st">"mosaicData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The popup tab shows a lot of datasets we could use. Let us continue to use the famous <code>Galton</code> dataset and <code>inspect</code> it:</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">data</span>(<span class="st">"Galton"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">inspect</span>(Galton)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; </span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt; categorical variables:  </span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt;     name  class levels   n missing</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; 1 family factor    197 898       0</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; 2    sex factor      2 898       0</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt;                                    distribution</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; 1 185 (1.7%), 166 (1.2%), 66 (1.2%) ...        </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt; 2 M (51.8%), F (48.2%)                         </span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; quantitative variables:  </span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt;     name   class min Q1 median   Q3  max      mean       sd   n missing</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; 1 father numeric  62 68   69.0 71.0 78.5 69.232851 2.470256 898       0</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; 2 mother numeric  58 63   64.0 65.5 70.5 64.084410 2.307025 898       0</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; 3 height numeric  56 64   66.5 69.7 79.0 66.760690 3.582918 898       0</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt; 4  nkids integer   1  4    6.0  8.0 15.0  6.135857 2.685156 898       0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>inspect</code> command already gives us a series of statistical measures of different variables of interest. As discussed previously, we can retain the output of <code>inspect</code> and use it in our reports: (there are ways of dressing up these tables too)</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a></span>
<span id="cb3-2"><a href="#cb3-2"></a>galton_describe <span class="ot">&lt;-</span> <span class="fu">inspect</span>(Galton)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>galton_describe<span class="sc">$</span>categorical</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["levels"],"name":[3],"type":["int"],"align":["right"]},{"label":["n"],"name":[4],"type":["int"],"align":["right"]},{"label":["missing"],"name":[5],"type":["int"],"align":["right"]},{"label":["distribution"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"family","2":"factor","3":"197","4":"898","5":"0","6":"185 (1.7%), 166 (1.2%), 66 (1.2%) ..."},{"1":"sex","2":"factor","3":"2","4":"898","5":"0","6":"M (51.8%), F (48.2%)"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>galton_describe<span class="sc">$</span>quantitative</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["min"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Q1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Q3"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[10],"type":["int"],"align":["right"]},{"label":["missing"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"father","2":"numeric","3":"62","4":"68","5":"69.0","6":"71.0","7":"78.5","8":"69.232851","9":"2.470256","10":"898","11":"0","_rn_":"1"},{"1":"mother","2":"numeric","3":"58","4":"63","5":"64.0","6":"65.5","7":"70.5","8":"64.084410","9":"2.307025","10":"898","11":"0","_rn_":"2"},{"1":"height","2":"numeric","3":"56","4":"64","5":"66.5","6":"69.7","7":"79.0","8":"66.760690","9":"3.582918","10":"898","11":"0","_rn_":"3"},{"1":"nkids","2":"integer","3":"1","4":"4","5":"6.0","6":"8.0","7":"15.0","8":"6.135857","9":"2.685156","10":"898","11":"0","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Try <code>help("Galton")</code> in your Console. The dataset is described as:</p>
<blockquote class="blockquote">
<p>A data frame with 898 observations on the following variables.<br>
- <code>family</code> a factor with levels for each family<br>
- <code>father</code> the father’s height (in inches)<br>
- <code>mother</code> the mother’s height (in inches)<br>
- <code>sex</code> the child’s sex: F or M<br>
- <code>height</code> the child’s height as an adult (in inches)<br>
- <code>nkids</code> the number of adult children in the family, or, at least, the number whose heights Galton recorded.</p>
</blockquote>
<p>There is a lot of Description generated by the <code><a href="https://rdrr.io/pkg/mosaicCore/man/inspect.html">mosaic::inspect()</a></code> command ! What can we say about the dataset and its variables? How big is the dataset? How many variables? What types are they, Quant or Qual? If they are Qual, what are the <em>levels</em>? Are they <em>ordered</em> levels? Discuss!</p>
</section><section id="correlations-and-plots" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="correlations-and-plots">
<span class="header-section-number">1.2</span> Correlations and Plots</h2>
<p>What Questions might we have, that we could answer with a Statistical Measure, or Correlation chart?</p>
<p>Q.1 Which are the variables that have significant pair-wise correlations? What polarity are these correlations?</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># Pulling out the list of Quant variables from NHANES</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>galton_quant <span class="ot">&lt;-</span> galton_describe<span class="sc">$</span>quantitative</span>
<span id="cb5-5"><a href="#cb5-5"></a>galton_quant<span class="sc">$</span>name</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt; [1] "father" "mother" "height" "nkids"</span></span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(</span>
<span id="cb5-9"><a href="#cb5-9"></a>  Galton,</span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"father"</span>, <span class="st">"mother"</span>, <span class="st">"height"</span>, <span class="st">"nkids"</span>),</span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="at">diag =</span> <span class="fu">list</span>(<span class="st">"densityDiag"</span>),</span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="at">title =</span> <span class="st">"Galton Data Correlations Plot"</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="correlations_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Can we plot a Correlogram for this dataset?</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">#library(corrplot)</span></span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>galton_num_var <span class="ot">&lt;-</span> Galton <span class="sc">%&gt;%</span> <span class="fu">select</span>(father, mother, height, nkids)</span>
<span id="cb6-4"><a href="#cb6-4"></a>galton_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(galton_num_var)</span>
<span id="cb6-5"><a href="#cb6-5"></a>galton_correlogram <span class="ot">&lt;-</span> galton_cor <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">corrplot</span>(<span class="at">method =</span> <span class="st">"ellipse"</span>,</span>
<span id="cb6-7"><a href="#cb6-7"></a>           <span class="at">type =</span> <span class="st">"lower"</span>,</span>
<span id="cb6-8"><a href="#cb6-8"></a>           <span class="at">main =</span> <span class="st">"Correlogram for Galton dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="correlations_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>galton_correlogram</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt; $corr</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt;             father      mother     height       nkids</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt; father  1.00000000  0.07366461  0.2753548 -0.16002294</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt; mother  0.07366461  1.00000000  0.2016549 -0.02002964</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt; height  0.27535483  0.20165489  1.0000000 -0.12691012</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt; nkids  -0.16002294 -0.02002964 -0.1269101  1.00000000</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt; </span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt; $corrPos</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt;     xName  yName x y        corr</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt; 1  father father 1 4  1.00000000</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">#&gt; 2  father mother 1 3  0.07366461</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt; 3  father height 1 2  0.27535483</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt; 4  father  nkids 1 1 -0.16002294</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt; 5  mother mother 2 3  1.00000000</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#&gt; 6  mother height 2 2  0.20165489</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">#&gt; 7  mother  nkids 2 1 -0.02002964</span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">#&gt; 8  height height 3 2  1.00000000</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">#&gt; 9  height  nkids 3 1 -0.12691012</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#&gt; 10  nkids  nkids 4 1  1.00000000</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#&gt; </span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">#&gt; $arg</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">#&gt; $arg$type</span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">#&gt; [1] "lower"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Clearly <code>height</code> is positvely correlated to <code>father</code> and <code>mother</code>; interestingly, <code>height</code> is negatively correlated ( slightly) with <code>nkids</code>.</p>
<p>Q.2: Let us confirm with a test:</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>mosaic<span class="sc">::</span><span class="fu">cor_test</span>(height <span class="sc">~</span> father, <span class="at">data =</span> Galton)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt; </span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt; </span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt; data:  height and father</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; t = 8.5737, df = 896, p-value &lt; 2.2e-16</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt;  0.2137851 0.3347455</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt;       cor </span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt; 0.2753548</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>mosaic<span class="sc">::</span><span class="fu">cor_test</span>(height <span class="sc">~</span> mother, <span class="at">data =</span> Galton)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt; </span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; </span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; data:  height and mother</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; t = 6.1628, df = 896, p-value = 1.079e-09</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt;  0.1380554 0.2635982</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt;       cor </span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; 0.2016549</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Q.3 What does this correlation look when split by <code>sex</code> of Child?</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># For the sons</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="fu">cor_test</span>(height <span class="sc">~</span> father, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"M"</span>))</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt; </span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt; </span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; data:  height and father</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; t = 9.1498, df = 463, p-value &lt; 2.2e-16</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt;  0.3114667 0.4656805</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt;       cor </span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt; 0.3913174</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="fu">cor_test</span>(height <span class="sc">~</span> mother, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"M"</span>))</span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#&gt; </span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co">#&gt; </span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="co">#&gt; data:  height and mother</span></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="co">#&gt; t = 7.628, df = 463, p-value = 1.367e-13</span></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co">#&gt;  0.2508178 0.4125305</span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="co">#&gt;       cor </span></span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="co">#&gt; 0.3341309</span></span>
<span id="cb10-27"><a href="#cb10-27"></a></span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="co"># For the daughters</span></span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="fu">cor_test</span>(height <span class="sc">~</span> father, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"F"</span>))</span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co">#&gt; </span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="co">#&gt; </span></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="co">#&gt; data:  height and father</span></span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="co">#&gt; t = 10.719, df = 431, p-value &lt; 2.2e-16</span></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="co">#&gt;  0.3809944 0.5300812</span></span>
<span id="cb10-38"><a href="#cb10-38"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb10-39"><a href="#cb10-39"></a><span class="co">#&gt;       cor </span></span>
<span id="cb10-40"><a href="#cb10-40"></a><span class="co">#&gt; 0.4587605</span></span>
<span id="cb10-41"><a href="#cb10-41"></a><span class="fu">cor_test</span>(height <span class="sc">~</span> mother, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"F"</span>))</span>
<span id="cb10-42"><a href="#cb10-42"></a><span class="co">#&gt; </span></span>
<span id="cb10-43"><a href="#cb10-43"></a><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span id="cb10-44"><a href="#cb10-44"></a><span class="co">#&gt; </span></span>
<span id="cb10-45"><a href="#cb10-45"></a><span class="co">#&gt; data:  height and mother</span></span>
<span id="cb10-46"><a href="#cb10-46"></a><span class="co">#&gt; t = 6.8588, df = 431, p-value = 2.421e-11</span></span>
<span id="cb10-47"><a href="#cb10-47"></a><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb10-48"><a href="#cb10-48"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="co">#&gt;  0.2261463 0.3962226</span></span>
<span id="cb10-50"><a href="#cb10-50"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb10-51"><a href="#cb10-51"></a><span class="co">#&gt;       cor </span></span>
<span id="cb10-52"><a href="#cb10-52"></a><span class="co">#&gt; 0.3136984</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Q.4. How can we show this correlation in a set of Scatter Plots + Regression Lines? Can we recreate Galton’s famous diagram?</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># For the sons</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">gf_point</span>(height <span class="sc">~</span> father, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"M"</span>)) <span class="sc">%&gt;%</span> <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="correlations_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">gf_point</span>(height <span class="sc">~</span> mother, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"M"</span>)) <span class="sc">%&gt;%</span> <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="correlations_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co"># For the daughters</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="fu">gf_point</span>(height <span class="sc">~</span> father, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"F"</span>)) <span class="sc">%&gt;%</span> <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="correlations_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" width="672"></p>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">gf_point</span>(height <span class="sc">~</span> mother, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"F"</span>)) <span class="sc">%&gt;%</span> <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="correlations_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>An approximation to Galton’s famous plot (see Wikipedia):</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">gf_point</span>(height <span class="sc">~</span> (father <span class="sc">+</span> mother)<span class="sc">/</span><span class="dv">2</span>, <span class="at">data =</span> Galton) <span class="sc">%&gt;%</span> <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">%&gt;%</span> <span class="fu">gf_density_2d</span>(<span class="at">n =</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">gf_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="correlations_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>How would you interpret this plot?</p>
</section><section id="case-study--2-dataset-from-nhanes" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="case-study--2-dataset-from-nhanes">
<span class="header-section-number">1.3</span> Case Study -2: Dataset from <code>NHANES</code>
</h2>
<p>We will “live code” this in class!</p>
</section></section><section id="conclusion" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Conclusion</h1>
<p>We have a decent Correlations related <em>workflow</em> in R:<br>
- load the dataset<br>
- <code>inspect</code> the dataset, identify Quant and Qual variables<br>
- Develop Pair-Wise plots + Correlations using <code><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">GGally::ggpairs()</a></code><br>
- Develop Correlogram <code><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot::corrplot</a></code><br>
- Check everything with a <code>cor_test</code><br>
- Plot scatter plots using <code>gf_point</code> if needed.<br>
- Add extra lines using <code>gf_abline()</code> to compare hypotheses that you may have.</p>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/av-quarto\.netlify\.app/);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb16" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">---</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="an">title:</span><span class="co"> "Correlations in R"</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="an">author:</span><span class="co"> "Arvind Venkatadri"</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="an">abstract:</span><span class="co"> Tests, Tables, and Graphs for Correlations in R</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="an">code-summary:</span><span class="co"> "Show the Code"</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="an">code-copy:</span><span class="co"> true</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="an">code-line-numbers:</span><span class="co"> true</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="an">df-print:</span><span class="co"> paged</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="an">cap-location:</span><span class="co"> margin</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">  freeze: auto</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">---</span></span>
<span id="cb16-17"><a href="#cb16-17"></a></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="fu"># Introduction</span></span>
<span id="cb16-19"><a href="#cb16-19"></a></span>
<span id="cb16-20"><a href="#cb16-20"></a>We will create Tables for Correlations, and graphs for Correlations in</span>
<span id="cb16-21"><a href="#cb16-21"></a>R. As always, we will consistently use the [**Project</span>
<span id="cb16-22"><a href="#cb16-22"></a>Mosaic**](https://mosaic-web.org) ecosystem of packages in R (<span class="in">`mosaic`</span>,</span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="in">`mosaicData`</span> and <span class="in">`ggformula`</span>).</span>
<span id="cb16-24"><a href="#cb16-24"></a></span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="in">```{r, echo = FALSE, message = FALSE, include=TRUE}</span></span>
<span id="cb16-26"><a href="#cb16-26"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">collapse =</span> T, <span class="at">comment =</span> <span class="st">"#&gt;"</span>, <span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-27"><a href="#cb16-27"></a><span class="fu">options</span>(<span class="at">tibble.print_min =</span> 4L, <span class="at">tibble.print_max =</span> 4L)</span>
<span id="cb16-28"><a href="#cb16-28"></a><span class="fu">library</span>(mosaic) <span class="co"># package for stats, simulations, and basic plots</span></span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="fu">library</span>(mosaicData) <span class="co"># package containing datasets</span></span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="fu">library</span>(ggformula) <span class="co"># package for professional looking plots, that use the formula interface from mosaic</span></span>
<span id="cb16-31"><a href="#cb16-31"></a><span class="fu">library</span>(NHANES) <span class="co"># survey data collected by the US National Center for Health Statistics (NCHS)</span></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="fu">library</span>(corrplot) <span class="co"># For Correlogram plots</span></span>
<span id="cb16-33"><a href="#cb16-33"></a></span>
<span id="cb16-34"><a href="#cb16-34"></a><span class="in">```</span></span>
<span id="cb16-35"><a href="#cb16-35"></a></span>
<span id="cb16-36"><a href="#cb16-36"></a>::: {#note .illustration style="background: beige"}</span>
<span id="cb16-37"><a href="#cb16-37"></a>Note the standard method for all commands from the <span class="in">`mosaic`</span> package:</span>
<span id="cb16-38"><a href="#cb16-38"></a></span>
<span id="cb16-39"><a href="#cb16-39"></a>goal( y \~ x \| z, data = mydata, ...)</span>
<span id="cb16-40"><a href="#cb16-40"></a>:::</span>
<span id="cb16-41"><a href="#cb16-41"></a></span>
<span id="cb16-42"><a href="#cb16-42"></a><span class="fu">## Case Study -1: Dataset from `mosaicData`</span></span>
<span id="cb16-43"><a href="#cb16-43"></a></span>
<span id="cb16-44"><a href="#cb16-44"></a>Let us inspect what datasets are available in the package <span class="in">`mosaicData`</span>.</span>
<span id="cb16-45"><a href="#cb16-45"></a>Run this command in your Console:</span>
<span id="cb16-46"><a href="#cb16-46"></a></span>
<span id="cb16-47"><a href="#cb16-47"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb16-48"><a href="#cb16-48"></a><span class="co"># Run in Console</span></span>
<span id="cb16-49"><a href="#cb16-49"></a><span class="fu">data</span>(<span class="at">package =</span> <span class="st">"mosaicData"</span>)</span>
<span id="cb16-50"><a href="#cb16-50"></a></span>
<span id="cb16-51"><a href="#cb16-51"></a><span class="in">```</span></span>
<span id="cb16-52"><a href="#cb16-52"></a></span>
<span id="cb16-53"><a href="#cb16-53"></a>The popup tab shows a lot of datasets we could use. Let us continue to</span>
<span id="cb16-54"><a href="#cb16-54"></a>use the famous <span class="in">`Galton`</span> dataset and <span class="in">`inspect`</span> it:</span>
<span id="cb16-55"><a href="#cb16-55"></a></span>
<span id="cb16-58"><a href="#cb16-58"></a><span class="in">```{r}</span></span>
<span id="cb16-59"><a href="#cb16-59"></a><span class="fu">data</span>(<span class="st">"Galton"</span>)</span>
<span id="cb16-60"><a href="#cb16-60"></a><span class="fu">inspect</span>(Galton)</span>
<span id="cb16-61"><a href="#cb16-61"></a></span>
<span id="cb16-62"><a href="#cb16-62"></a><span class="in">```</span></span>
<span id="cb16-63"><a href="#cb16-63"></a></span>
<span id="cb16-64"><a href="#cb16-64"></a>The <span class="in">`inspect`</span> command already gives us a series of statistical measures</span>
<span id="cb16-65"><a href="#cb16-65"></a>of different variables of interest. As discussed previously, we can</span>
<span id="cb16-66"><a href="#cb16-66"></a>retain the output of <span class="in">`inspect`</span> and use it in our reports: (there are</span>
<span id="cb16-67"><a href="#cb16-67"></a>ways of dressing up these tables too)</span>
<span id="cb16-68"><a href="#cb16-68"></a></span>
<span id="cb16-69"><a href="#cb16-69"></a><span class="in">```{r Galton-inspect}</span></span>
<span id="cb16-70"><a href="#cb16-70"></a></span>
<span id="cb16-71"><a href="#cb16-71"></a>galton_describe <span class="ot">&lt;-</span> <span class="fu">inspect</span>(Galton)</span>
<span id="cb16-72"><a href="#cb16-72"></a></span>
<span id="cb16-73"><a href="#cb16-73"></a>galton_describe<span class="sc">$</span>categorical</span>
<span id="cb16-74"><a href="#cb16-74"></a>galton_describe<span class="sc">$</span>quantitative</span>
<span id="cb16-75"><a href="#cb16-75"></a></span>
<span id="cb16-76"><a href="#cb16-76"></a><span class="in">```</span></span>
<span id="cb16-77"><a href="#cb16-77"></a></span>
<span id="cb16-78"><a href="#cb16-78"></a>Try <span class="in">`help("Galton")`</span> in your Console. The dataset is described as:</span>
<span id="cb16-79"><a href="#cb16-79"></a></span>
<span id="cb16-80"><a href="#cb16-80"></a><span class="at">&gt; A data frame with 898 observations on the following variables.\</span></span>
<span id="cb16-81"><a href="#cb16-81"></a><span class="at">&gt; - </span><span class="in">`family`</span><span class="at"> a factor with levels for each family\</span></span>
<span id="cb16-82"><a href="#cb16-82"></a><span class="at">&gt; - </span><span class="in">`father`</span><span class="at"> the father's height (in inches)\</span></span>
<span id="cb16-83"><a href="#cb16-83"></a><span class="at">&gt; - </span><span class="in">`mother`</span><span class="at"> the mother's height (in inches)\</span></span>
<span id="cb16-84"><a href="#cb16-84"></a><span class="at">&gt; - </span><span class="in">`sex`</span><span class="at"> the child's sex: F or M\</span></span>
<span id="cb16-85"><a href="#cb16-85"></a><span class="at">&gt; - </span><span class="in">`height`</span><span class="at"> the child's height as an adult (in inches)\</span></span>
<span id="cb16-86"><a href="#cb16-86"></a><span class="at">&gt; - </span><span class="in">`nkids`</span><span class="at"> the number of adult children in the family, or, at least,</span></span>
<span id="cb16-87"><a href="#cb16-87"></a><span class="at">&gt; the number whose heights Galton recorded.</span></span>
<span id="cb16-88"><a href="#cb16-88"></a></span>
<span id="cb16-89"><a href="#cb16-89"></a>There is a lot of Description generated by the <span class="in">`mosaic::inspect()`</span></span>
<span id="cb16-90"><a href="#cb16-90"></a>command ! What can we say about the dataset and its variables? How big</span>
<span id="cb16-91"><a href="#cb16-91"></a>is the dataset? How many variables? What types are they, Quant or Qual?</span>
<span id="cb16-92"><a href="#cb16-92"></a>If they are Qual, what are the *levels*? Are they *ordered* levels?</span>
<span id="cb16-93"><a href="#cb16-93"></a>Discuss!</span>
<span id="cb16-94"><a href="#cb16-94"></a></span>
<span id="cb16-95"><a href="#cb16-95"></a><span class="fu">## Correlations and Plots</span></span>
<span id="cb16-96"><a href="#cb16-96"></a></span>
<span id="cb16-97"><a href="#cb16-97"></a>What Questions might we have, that we could answer with a Statistical</span>
<span id="cb16-98"><a href="#cb16-98"></a>Measure, or Correlation chart?</span>
<span id="cb16-99"><a href="#cb16-99"></a></span>
<span id="cb16-100"><a href="#cb16-100"></a>Q.1 Which are the variables that have significant pair-wise</span>
<span id="cb16-101"><a href="#cb16-101"></a>correlations? What polarity are these correlations?</span>
<span id="cb16-102"><a href="#cb16-102"></a></span>
<span id="cb16-103"><a href="#cb16-103"></a><span class="in">```{r,message=FALSE}</span></span>
<span id="cb16-104"><a href="#cb16-104"></a></span>
<span id="cb16-105"><a href="#cb16-105"></a></span>
<span id="cb16-106"><a href="#cb16-106"></a><span class="co"># Pulling out the list of Quant variables from NHANES</span></span>
<span id="cb16-107"><a href="#cb16-107"></a>galton_quant <span class="ot">&lt;-</span> galton_describe<span class="sc">$</span>quantitative</span>
<span id="cb16-108"><a href="#cb16-108"></a>galton_quant<span class="sc">$</span>name</span>
<span id="cb16-109"><a href="#cb16-109"></a></span>
<span id="cb16-110"><a href="#cb16-110"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(</span>
<span id="cb16-111"><a href="#cb16-111"></a>  Galton,</span>
<span id="cb16-112"><a href="#cb16-112"></a>  <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"father"</span>, <span class="st">"mother"</span>, <span class="st">"height"</span>, <span class="st">"nkids"</span>),</span>
<span id="cb16-113"><a href="#cb16-113"></a>  <span class="at">diag =</span> <span class="fu">list</span>(<span class="st">"densityDiag"</span>),</span>
<span id="cb16-114"><a href="#cb16-114"></a>  <span class="at">title =</span> <span class="st">"Galton Data Correlations Plot"</span></span>
<span id="cb16-115"><a href="#cb16-115"></a>)</span>
<span id="cb16-116"><a href="#cb16-116"></a></span>
<span id="cb16-117"><a href="#cb16-117"></a><span class="in">```</span></span>
<span id="cb16-118"><a href="#cb16-118"></a></span>
<span id="cb16-119"><a href="#cb16-119"></a>Can we plot a Correlogram for this dataset?</span>
<span id="cb16-120"><a href="#cb16-120"></a></span>
<span id="cb16-123"><a href="#cb16-123"></a><span class="in">```{r}</span></span>
<span id="cb16-124"><a href="#cb16-124"></a><span class="co">#library(corrplot)</span></span>
<span id="cb16-125"><a href="#cb16-125"></a></span>
<span id="cb16-126"><a href="#cb16-126"></a>galton_num_var <span class="ot">&lt;-</span> Galton <span class="sc">%&gt;%</span> <span class="fu">select</span>(father, mother, height, nkids)</span>
<span id="cb16-127"><a href="#cb16-127"></a>galton_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(galton_num_var)</span>
<span id="cb16-128"><a href="#cb16-128"></a>galton_correlogram <span class="ot">&lt;-</span> galton_cor <span class="sc">%&gt;%</span></span>
<span id="cb16-129"><a href="#cb16-129"></a>  <span class="fu">corrplot</span>(<span class="at">method =</span> <span class="st">"ellipse"</span>,</span>
<span id="cb16-130"><a href="#cb16-130"></a>           <span class="at">type =</span> <span class="st">"lower"</span>,</span>
<span id="cb16-131"><a href="#cb16-131"></a>           <span class="at">main =</span> <span class="st">"Correlogram for Galton dataset"</span>)</span>
<span id="cb16-132"><a href="#cb16-132"></a>galton_correlogram</span>
<span id="cb16-133"><a href="#cb16-133"></a></span>
<span id="cb16-134"><a href="#cb16-134"></a><span class="in">```</span></span>
<span id="cb16-135"><a href="#cb16-135"></a></span>
<span id="cb16-136"><a href="#cb16-136"></a>Clearly <span class="in">`height`</span> is positvely correlated to <span class="in">`father`</span> and <span class="in">`mother`</span>;</span>
<span id="cb16-137"><a href="#cb16-137"></a>interestingly, <span class="in">`height`</span> is negatively correlated ( slightly) with</span>
<span id="cb16-138"><a href="#cb16-138"></a><span class="in">`nkids`</span>.</span>
<span id="cb16-139"><a href="#cb16-139"></a></span>
<span id="cb16-140"><a href="#cb16-140"></a>Q.2: Let us confirm with a test:</span>
<span id="cb16-141"><a href="#cb16-141"></a></span>
<span id="cb16-144"><a href="#cb16-144"></a><span class="in">```{r}</span></span>
<span id="cb16-145"><a href="#cb16-145"></a>mosaic<span class="sc">::</span><span class="fu">cor_test</span>(height <span class="sc">~</span> father, <span class="at">data =</span> Galton)</span>
<span id="cb16-146"><a href="#cb16-146"></a><span class="in">```</span></span>
<span id="cb16-147"><a href="#cb16-147"></a></span>
<span id="cb16-150"><a href="#cb16-150"></a><span class="in">```{r}</span></span>
<span id="cb16-151"><a href="#cb16-151"></a>mosaic<span class="sc">::</span><span class="fu">cor_test</span>(height <span class="sc">~</span> mother, <span class="at">data =</span> Galton)</span>
<span id="cb16-152"><a href="#cb16-152"></a><span class="in">```</span></span>
<span id="cb16-153"><a href="#cb16-153"></a></span>
<span id="cb16-154"><a href="#cb16-154"></a>Q.3 What does this correlation look when split by <span class="in">`sex`</span> of Child?</span>
<span id="cb16-155"><a href="#cb16-155"></a></span>
<span id="cb16-158"><a href="#cb16-158"></a><span class="in">```{r}</span></span>
<span id="cb16-159"><a href="#cb16-159"></a><span class="co"># For the sons</span></span>
<span id="cb16-160"><a href="#cb16-160"></a><span class="fu">cor_test</span>(height <span class="sc">~</span> father, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"M"</span>))</span>
<span id="cb16-161"><a href="#cb16-161"></a><span class="fu">cor_test</span>(height <span class="sc">~</span> mother, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"M"</span>))</span>
<span id="cb16-162"><a href="#cb16-162"></a></span>
<span id="cb16-163"><a href="#cb16-163"></a><span class="co"># For the daughters</span></span>
<span id="cb16-164"><a href="#cb16-164"></a><span class="fu">cor_test</span>(height <span class="sc">~</span> father, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"F"</span>))</span>
<span id="cb16-165"><a href="#cb16-165"></a><span class="fu">cor_test</span>(height <span class="sc">~</span> mother, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"F"</span>))</span>
<span id="cb16-166"><a href="#cb16-166"></a>         </span>
<span id="cb16-167"><a href="#cb16-167"></a><span class="in">```</span></span>
<span id="cb16-168"><a href="#cb16-168"></a></span>
<span id="cb16-169"><a href="#cb16-169"></a>Q.4. How can we show this correlation in a set of Scatter Plots +</span>
<span id="cb16-170"><a href="#cb16-170"></a>Regression Lines? Can we recreate Galton's famous diagram?</span>
<span id="cb16-171"><a href="#cb16-171"></a></span>
<span id="cb16-174"><a href="#cb16-174"></a><span class="in">```{r}</span></span>
<span id="cb16-175"><a href="#cb16-175"></a><span class="co"># For the sons</span></span>
<span id="cb16-176"><a href="#cb16-176"></a><span class="fu">gf_point</span>(height <span class="sc">~</span> father, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"M"</span>)) <span class="sc">%&gt;%</span> <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb16-177"><a href="#cb16-177"></a><span class="fu">gf_point</span>(height <span class="sc">~</span> mother, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"M"</span>)) <span class="sc">%&gt;%</span> <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb16-178"><a href="#cb16-178"></a></span>
<span id="cb16-179"><a href="#cb16-179"></a><span class="co"># For the daughters</span></span>
<span id="cb16-180"><a href="#cb16-180"></a><span class="fu">gf_point</span>(height <span class="sc">~</span> father, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"F"</span>)) <span class="sc">%&gt;%</span> <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb16-181"><a href="#cb16-181"></a><span class="fu">gf_point</span>(height <span class="sc">~</span> mother, <span class="at">data =</span> Galton <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"F"</span>)) <span class="sc">%&gt;%</span> <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb16-182"><a href="#cb16-182"></a><span class="in">```</span></span>
<span id="cb16-183"><a href="#cb16-183"></a></span>
<span id="cb16-184"><a href="#cb16-184"></a>An approximation to Galton's famous plot (see Wikipedia):</span>
<span id="cb16-185"><a href="#cb16-185"></a></span>
<span id="cb16-188"><a href="#cb16-188"></a><span class="in">```{r}</span></span>
<span id="cb16-189"><a href="#cb16-189"></a><span class="fu">gf_point</span>(height <span class="sc">~</span> (father <span class="sc">+</span> mother)<span class="sc">/</span><span class="dv">2</span>, <span class="at">data =</span> Galton) <span class="sc">%&gt;%</span> <span class="fu">gf_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">%&gt;%</span> <span class="fu">gf_density_2d</span>(<span class="at">n =</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">gf_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>)</span>
<span id="cb16-190"><a href="#cb16-190"></a><span class="in">```</span></span>
<span id="cb16-191"><a href="#cb16-191"></a></span>
<span id="cb16-192"><a href="#cb16-192"></a>How would you interpret this plot?</span>
<span id="cb16-193"><a href="#cb16-193"></a></span>
<span id="cb16-194"><a href="#cb16-194"></a><span class="fu">## Case Study -2: Dataset from `NHANES`</span></span>
<span id="cb16-195"><a href="#cb16-195"></a></span>
<span id="cb16-196"><a href="#cb16-196"></a>We will "live code" this in class!</span>
<span id="cb16-197"><a href="#cb16-197"></a></span>
<span id="cb16-198"><a href="#cb16-198"></a><span class="fu"># Conclusion</span></span>
<span id="cb16-199"><a href="#cb16-199"></a></span>
<span id="cb16-200"><a href="#cb16-200"></a>We have a decent Correlations related *workflow* in R:\</span>
<span id="cb16-201"><a href="#cb16-201"></a><span class="ss">- </span>load the dataset\</span>
<span id="cb16-202"><a href="#cb16-202"></a><span class="ss">- </span><span class="in">`inspect`</span> the dataset, identify Quant and Qual variables\</span>
<span id="cb16-203"><a href="#cb16-203"></a><span class="ss">- </span>Develop Pair-Wise plots + Correlations using <span class="in">`GGally::ggpairs()`</span>\</span>
<span id="cb16-204"><a href="#cb16-204"></a><span class="ss">- </span>Develop Correlogram <span class="in">`corrplot::corrplot`</span>\</span>
<span id="cb16-205"><a href="#cb16-205"></a><span class="ss">- </span>Check everything with a <span class="in">`cor_test`</span>\</span>
<span id="cb16-206"><a href="#cb16-206"></a><span class="ss">- </span>Plot scatter plots using <span class="in">`gf_point`</span> if needed.\</span>
<span id="cb16-207"><a href="#cb16-207"></a><span class="ss">- </span>Add extra lines using <span class="in">`gf_abline()`</span> to compare hypotheses that you may</span>
<span id="cb16-208"><a href="#cb16-208"></a>have.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>