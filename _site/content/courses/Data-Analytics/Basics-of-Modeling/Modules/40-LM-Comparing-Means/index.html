<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Arvind Venkatadri">
<meta name="dcterms.date" content="2022-11-26">
<meta name="keywords" content="Statistics ; Tests; p-value; Feynman Technique">
<title>The Foundation Series - Linear Models: Comparing Means</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>

<script src="../../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../../">
<script src="../../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../../../../../site_libs/quarto-contrib/iconify-1.0.0-beta.2/iconify-icon.min.js"></script><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="The Foundation Series - Linear Models: Comparing Means">
<meta property="og:description" content="This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats.">
<meta property="og:site-name" content="The Foundation Series">
<meta name="twitter:title" content="The Foundation Series - Linear Models: Comparing Means">
<meta name="twitter:description" content="This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats.">
<meta name="twitter:creator" content="@arvind_v">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../../../../index.html">
    <span class="navbar-title">The Foundation Series</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/my-quarto-website"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../../../../www.linkedin.com/in/arvindvenkatadri"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Linear Models: Comparing Means</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Teaching</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Data Analytics</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Data-Analytics/Tools/listing.html" class="sidebar-item-text sidebar-link">Tools and Software</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Data-Analytics/Descriptive-Analytics/listing.html" class="sidebar-item-text sidebar-link">Descriptive Analytics</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Data-Analytics/Basics-of-Modeling/listing.html" class="sidebar-item-text sidebar-link">Basics of Modelling</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Data-Analytics/Predictive-Analytics/listing.html" class="sidebar-item-text sidebar-link">Predictive Analytics</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Data-Analytics/Prescriptive-Analytics/listing.html" class="sidebar-item-text sidebar-link">Prescriptive Analytics</a>
  </div>
</li>
      </ul>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/R-for-Artists/listing.html" class="sidebar-item-text sidebar-link">R for Artists</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/TRIZ-for-Problem-Solving/listing.html" class="sidebar-item-text sidebar-link">TRIZ for Innovation</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Math-Models-in-Design/listing.html" class="sidebar-item-text sidebar-link">Math Models in Design</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Data-Visualization-with-No-Code/listing.html" class="sidebar-item-text sidebar-link">Data Vis with No Code</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/In-Short-the-World/listing.html" class="sidebar-item-text sidebar-link">In Short, the World</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/posts/listing.html" class="sidebar-item-text sidebar-link">Posts</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/projects/listing.html" class="sidebar-item-text sidebar-link">Blogs</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#fa-folder-open-slides-and-tutorials" id="toc-fa-folder-open-slides-and-tutorials" class="nav-link active" data-scroll-target="#fa-folder-open-slides-and-tutorials"><i class="fa-solid fa-folder-open" aria-label="folder-open"></i> Slides and Tutorials</a></li>
  <li><a href="#structure-of-this-document" id="toc-structure-of-this-document" class="nav-link" data-scroll-target="#structure-of-this-document">Structure of this document</a></li>
  <li>
<a href="#the-linear-model" id="toc-the-linear-model" class="nav-link" data-scroll-target="#the-linear-model">The Linear Model</a>
  <ul class="collapse">
<li><a href="#linear-models-as-hypothesis-tests" id="toc-linear-models-as-hypothesis-tests" class="nav-link" data-scroll-target="#linear-models-as-hypothesis-tests">Linear Models as Hypothesis Tests</a></li>
  <li><a href="#assumptions-in-linear-models" id="toc-assumptions-in-linear-models" class="nav-link" data-scroll-target="#assumptions-in-linear-models">Assumptions in Linear Models</a></li>
  </ul>
</li>
  <li>
<a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
<li><a href="#sample-values" id="toc-sample-values" class="nav-link" data-scroll-target="#sample-values">Sample Values</a></li>
  <li><a href="#signed-rank-values" id="toc-signed-rank-values" class="nav-link" data-scroll-target="#signed-rank-values">“Signed Rank” Values</a></li>
  <li><a href="#plotting-original-and-signed-rank-data" id="toc-plotting-original-and-signed-rank-data" class="nav-link" data-scroll-target="#plotting-original-and-signed-rank-data">Plotting Original and Signed Rank Data</a></li>
  <li><a href="#how-does-sign-rank-data-work" id="toc-how-does-sign-rank-data-work" class="nav-link" data-scroll-target="#how-does-sign-rank-data-work">How does Sign-Rank data work?</a></li>
  </ul>
</li>
  <li>
<a href="#tests-for-correlation" id="toc-tests-for-correlation" class="nav-link" data-scroll-target="#tests-for-correlation">Tests for Correlation</a>
  <ul class="collapse">
<li>
<a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation">Pearson Correlation</a>
  <ul class="collapse">
<li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a></li>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code">Code</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul>
</li>
  <li>
<a href="#spearman-correlation" id="toc-spearman-correlation" class="nav-link" data-scroll-target="#spearman-correlation">Spearman Correlation</a>
  <ul class="collapse">
<li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1">Model</a></li>
  <li><a href="#code-1" id="toc-code-1" class="nav-link" data-scroll-target="#code-1">Code</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  </ul>
</li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#iconify-orange-circle-a-workflow-in-orange" id="toc-iconify-orange-circle-a-workflow-in-orange" class="nav-link" data-scroll-target="#iconify-orange-circle-a-workflow-in-orange"><iconify-icon inline="" icon="fluent-emoji:orange-circle"></iconify-icon> A Workflow in Orange</a></li>
  <li><a href="#fa-person-rays-a-workflow-in-radiant" id="toc-fa-person-rays-a-workflow-in-radiant" class="nav-link" data-scroll-target="#fa-person-rays-a-workflow-in-radiant"><i class="fa-solid fa-person-rays" aria-label="person-rays"></i> A Workflow in Radiant</a></li>
  <li><a href="#fa-brands-r-project-a-workflow-in-r" id="toc-fa-brands-r-project-a-workflow-in-r" class="nav-link" data-scroll-target="#fa-brands-r-project-a-workflow-in-r"><i class="fa-brands fa-r-project" aria-label="r-project"></i> A Workflow in R</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">Linear Models: Comparing Means</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Arvind Venkatadri </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 26, 2022</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 12, 2023</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats. The method followed is that of Jonas Lindoloev, wherein every stat test is treated as a linear model <code>y = mx + c</code>.
  </div>
</div>

</header><section id="fa-folder-open-slides-and-tutorials" class="level1"><h1>
<i class="fa-solid fa-folder-open" aria-label="folder-open"></i> Slides and Tutorials</h1>
<table style="width:100%;">
<colgroup>
<col style="width: 22%">
<col style="width: 29%">
<col style="width: 24%">
<col style="width: 22%">
</colgroup>
<thead><tr class="header">
<th>
<a href="./files/distributions.qmd"><i class="fa-brands    
    fa-r-project"></i> R Tutorial</a>&nbsp;&nbsp;</th>
<th><a href="./files/distributions.ows"> <iconify-icon icon="fluent-emoji:orange-circle"></iconify-icon> Orange Tutorial</a></th>
<th>
<a href="./files/correlations.rda"> <i class="fa-solid fa-person-rays"></i> Radiant Tutorial</a>&nbsp;</th>
<th><a href="./files/data/qdd-data.zip"> <i class="fa-solid fa-database"></i> Datasets</a></th>
</tr></thead>
<tbody></tbody>
</table></section><section id="structure-of-this-document" class="level1"><h1>Structure of this document</h1>
<p>We will follow the following structure: Each kind of Test is described in a separate Chapter. The Test <em>Model</em> is laid out in formula <span class="math inline">\(y = mx + c\)</span> and in <em>Code</em>.</p>
</section><section id="the-linear-model" class="level1 page-columns page-full"><h1>The Linear Model</h1>
<p>The premise here is that <strong>many common statistical tests are special cases of the linear model</strong>. So what <em>is</em> the linear model?</p>
<p>A <strong>linear model</strong> estimates the relationship between dependent variable or “response” variable (<span class="math inline">\(y\)</span>) and an explanatory variable or “predictor” (<span class="math inline">\(x\)</span>).</p>
<p>(It is also possible that there is more than one explanatory variable: this is <strong>multiple regression.</strong>. We will get there later).</p>
<p>It is assumed that the relationship is <strong>linear</strong>:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 *x
\]</span></p>
<p><span class="math inline">\(\beta_0\)</span> is the <em>intercept</em> and <span class="math inline">\(\beta_1\)</span> is the slope of the linear fit, that <strong>predicts</strong> the value of y based the value of x.</p>
<p>Each prediction leaves a small “residual” error between the actual and predicted values. <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are calculated based on minimizing the <em>sum of square</em>s of these residuals, and hence this method is called “ordinary least squares” regression.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p><img src="images/OLS.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption margin-caption">Least Squares</figcaption><p></p>
</figure>
</div>
<p>The net <em>area</em> of all the shaded squares is minimized in the calculation of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1*x_1 + \beta_2*x_2 ...+ \beta_n*x_n
\]</span></p>
<p>where each of the <span class="math inline">\(\beta_i\)</span> are slopes defining the relationship between y and <span class="math inline">\(x_i\)</span>. Together, the RHS of that equation defines an n-dimensional <em>plane</em>.</p>
<p>As per Lindoloev, many statistical tests, going from one-sample t-tests to two-way ANOVA, are special cases of this system.</p>
<p>Also see <a href="https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables">Jeffrey Walker “A linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables”</a></p>
<section id="linear-models-as-hypothesis-tests" class="level2"><h2 class="anchored" data-anchor-id="linear-models-as-hypothesis-tests">Linear Models as Hypothesis Tests</h2>
<p>Using linear models is based on the idea of <strong>Testing of Hypotheses</strong>. The Hypothesis Testing method typically defines a NULL Hypothesis where the statements read as “<strong>there is no relationship</strong>” between the variables at hand, explanatory and responses. The Alternative Hypothesis typically states that there <em>is</em> a relationship between the variables.</p>
<p>Accordingly, in fitting a linear model, we follow the process as follows:</p>
<ol type="1">
<li>Make the following hypotheses: <span class="math display">\[
y = \beta_0 + \beta_1 *x \\
NULL\ Hypothesis\ H_0 =&gt; x\ and\ y\ are\ unrelated.\ (\beta_1 = 0)
\]</span> <span class="math display">\[
y = \beta_0 + \beta_1 *x \\
Alternate\ Hypothesis\ H_1 =&gt; x\ and\ y\ are\ linearly\ related\ (\beta_1 \ne 0)
\]</span>
</li>
<li>We “assume” that <span class="math inline">\(H_0\)</span> is true.</li>
<li>We calculate <span class="math inline">\(\beta_1\)</span>.</li>
<li>We then find probability <strong>p</strong> that [<span class="math inline">\(\beta_1 = Estimated\ Value\)</span>] <strong>when the NULL Hypothesis</strong> is <strong>assumed</strong> TRUE. This is the <strong>p-value</strong>. If that probability is <strong>p&gt;=0.05</strong>, we say we “cannot reject” <span class="math inline">\(H_0\)</span> and there is unlikely to be significant linear relationship.</li>
</ol>
<p>However, if <strong>p&lt;= 0.05</strong> can we reject the NULL hypothesis, and say that there could be a significant linear relationship,because <span class="math inline">\(\beta_1 = Estimated\ Value\)</span> by mere chance under <span class="math inline">\(H_0\)</span> is very small.</p>
</section><section id="assumptions-in-linear-models" class="level2"><h2 class="anchored" data-anchor-id="assumptions-in-linear-models">Assumptions in Linear Models</h2>
<ol type="1">
<li>
<strong>L</strong>: <span class="math inline">\(\color{blue}{linear}\)</span> relationship</li>
<li>
<strong>I</strong>: Errors are <strong>independent</strong> (across observations)</li>
<li>
<strong>N</strong>: y is <span class="math inline">\(\color{red}{normally}\)</span> distributed at each “level” of
<ol start="24" type="a">
<li>
</li></ol>
</li>
<li>
<strong>E</strong>: equal variance at all levels of x. No <em>heteroscedasticity</em>. <img src="images/ols_assumptions.png" class="img-fluid" alt="OLS Assumptions">
</li>
</ol>
<p>Let us now see which standard statistical tests can be re-formulated as Linear Models.</p>
</section></section><section id="data" class="level1"><h1>Data</h1>
<section id="sample-values" class="level2"><h2 class="anchored" data-anchor-id="sample-values">Sample Values</h2>
<p>Most examples in this exposition are based on three “imaginary” samples, <span class="math inline">\(x, y, y2\)</span>. Each is normally distributed and made up of 50 observations. The means are (<span class="math inline">\(mu = c(0,0.3,0.5)\)</span>), and the sds (<span class="math inline">\(sd = c(1,2,1.5)\)</span>) are</p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/data_genr_33dc340bffcb733181b8ecd994a9430b">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mu"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.0","2":"1.0"},{"1":"0.3","2":"2.0"},{"1":"0.5","2":"1.5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/toy_data_a2cf72f0de546dd0751b751a16dfc66f">

</div>
<p>Let us look at our toy data in three ways:</p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/unnamed-chunk-1_56c93f557d7985ecb5f903217672c9d1">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["dbl[,1]"],"align":["right"]},{"label":["y1"],"name":[2],"type":["dbl[,1]"],"align":["right"]},{"label":["y2"],"name":[3],"type":["dbl[,1]"],"align":["right"]}],"data":[{"1":"0.42678011","2":"1.98488355","3":"0.10303468"},{"1":"0.44408399","2":"1.27130904","3":"-0.28089065"},{"1":"-0.82789086","2":"-0.94427745","3":"0.62388864"},{"1":"-0.79925305","2":"0.10328425","3":"5.42679005"},{"1":"-0.32313106","2":"2.19041969","3":"0.16807478"},{"1":"-1.24462433","2":"0.19192798","3":"-0.54936141"},{"1":"-1.35506516","2":"4.81186172","3":"0.30919557"},{"1":"1.61563907","2":"1.55169550","3":"-0.99039138"},{"1":"-0.29189503","2":"3.35737558","3":"-0.17200537"},{"1":"-1.24940474","2":"1.92492196","3":"-0.15832838"},{"1":"-0.08659233","2":"-2.88047669","3":"0.85387666"},{"1":"-1.17065349","2":"1.75053169","3":"3.33911133"},{"1":"0.73756421","2":"-1.08428013","3":"-1.88393968"},{"1":"-0.48316590","2":"0.96031018","3":"2.48425274"},{"1":"0.40328291","2":"-1.54016895","3":"-0.04867594"},{"1":"0.91641886","2":"-1.24357666","3":"-0.61515773"},{"1":"0.41673257","2":"0.03193645","3":"-0.28681098"},{"1":"0.33137777","2":"-1.30918647","3":"-0.12350146"},{"1":"1.57677526","2":"-0.99658718","3":"0.29936602"},{"1":"-0.99289810","2":"1.42150401","3":"-1.06763475"},{"1":"1.22460582","2":"-0.90365732","3":"0.12124860"},{"1":"-0.57899018","2":"2.94554205","3":"-0.40094019"},{"1":"1.49026764","2":"2.57375451","3":"-1.55553594"},{"1":"-1.06533835","2":"-1.21795541","3":"-0.51902218"},{"1":"-1.39136994","2":"-2.10136309","3":"-0.24857353"},{"1":"0.66547299","2":"0.90556693","3":"1.35671958"},{"1":"-1.53224607","2":"0.53146356","3":"0.14529688"},{"1":"0.29011158","2":"0.90084614","3":"0.83560170"},{"1":"0.69239937","2":"0.12687786","3":"2.29182497"},{"1":"-1.76053733","2":"2.64999575","3":"2.73673094"},{"1":"0.72082239","2":"0.13435947","3":"0.27574827"},{"1":"-1.22395587","2":"-2.78065291","3":"3.14550409"},{"1":"-0.75311013","2":"1.96202837","3":"0.59938464"},{"1":"1.32801392","2":"-4.25541004","3":"1.04460392"},{"1":"-0.24174865","2":"0.51517469","3":"-0.68821620"},{"1":"0.55292812","2":"0.32962526","3":"1.15201767"},{"1":"-1.38976342","2":"0.18227394","3":"-1.86691141"},{"1":"0.20633230","2":"0.76029377","3":"4.27233650"},{"1":"-0.31920849","2":"3.55063527","3":"0.45077005"},{"1":"0.78482776","2":"-0.56564635","3":"-1.70953625"},{"1":"1.23964789","2":"-2.88080049","3":"0.84694745"},{"1":"0.27462181","2":"3.04164950","3":"-0.03903472"},{"1":"1.89759493","2":"-1.29407455","3":"1.11956044"},{"1":"-0.19262565","2":"-3.42396604","3":"1.05156905"},{"1":"-1.41365701","2":"-1.75335473","3":"1.49593530"},{"1":"0.35118649","2":"1.82462838","3":"1.86447305"},{"1":"1.45121334","2":"-2.37113604","3":"1.33013723"},{"1":"1.17029448","2":"2.34340037","3":"-0.14230534"},{"1":"-0.83901696","2":"1.86633352","3":"-0.39773459"},{"1":"0.31714653","2":"-0.14984045","3":"-0.99949269"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/unnamed-chunk-2_2610fe57cdac6dd8e7996d514ae311a3">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl[,1]"],"align":["right"]}],"data":[{"1":"x","2":"0.42678011"},{"1":"y1","2":"1.98488355"},{"1":"y2","2":"0.10303468"},{"1":"x","2":"0.44408399"},{"1":"y1","2":"1.27130904"},{"1":"y2","2":"-0.28089065"},{"1":"x","2":"-0.82789086"},{"1":"y1","2":"-0.94427745"},{"1":"y2","2":"0.62388864"},{"1":"x","2":"-0.79925305"},{"1":"y1","2":"0.10328425"},{"1":"y2","2":"5.42679005"},{"1":"x","2":"-0.32313106"},{"1":"y1","2":"2.19041969"},{"1":"y2","2":"0.16807478"},{"1":"x","2":"-1.24462433"},{"1":"y1","2":"0.19192798"},{"1":"y2","2":"-0.54936141"},{"1":"x","2":"-1.35506516"},{"1":"y1","2":"4.81186172"},{"1":"y2","2":"0.30919557"},{"1":"x","2":"1.61563907"},{"1":"y1","2":"1.55169550"},{"1":"y2","2":"-0.99039138"},{"1":"x","2":"-0.29189503"},{"1":"y1","2":"3.35737558"},{"1":"y2","2":"-0.17200537"},{"1":"x","2":"-1.24940474"},{"1":"y1","2":"1.92492196"},{"1":"y2","2":"-0.15832838"},{"1":"x","2":"-0.08659233"},{"1":"y1","2":"-2.88047669"},{"1":"y2","2":"0.85387666"},{"1":"x","2":"-1.17065349"},{"1":"y1","2":"1.75053169"},{"1":"y2","2":"3.33911133"},{"1":"x","2":"0.73756421"},{"1":"y1","2":"-1.08428013"},{"1":"y2","2":"-1.88393968"},{"1":"x","2":"-0.48316590"},{"1":"y1","2":"0.96031018"},{"1":"y2","2":"2.48425274"},{"1":"x","2":"0.40328291"},{"1":"y1","2":"-1.54016895"},{"1":"y2","2":"-0.04867594"},{"1":"x","2":"0.91641886"},{"1":"y1","2":"-1.24357666"},{"1":"y2","2":"-0.61515773"},{"1":"x","2":"0.41673257"},{"1":"y1","2":"0.03193645"},{"1":"y2","2":"-0.28681098"},{"1":"x","2":"0.33137777"},{"1":"y1","2":"-1.30918647"},{"1":"y2","2":"-0.12350146"},{"1":"x","2":"1.57677526"},{"1":"y1","2":"-0.99658718"},{"1":"y2","2":"0.29936602"},{"1":"x","2":"-0.99289810"},{"1":"y1","2":"1.42150401"},{"1":"y2","2":"-1.06763475"},{"1":"x","2":"1.22460582"},{"1":"y1","2":"-0.90365732"},{"1":"y2","2":"0.12124860"},{"1":"x","2":"-0.57899018"},{"1":"y1","2":"2.94554205"},{"1":"y2","2":"-0.40094019"},{"1":"x","2":"1.49026764"},{"1":"y1","2":"2.57375451"},{"1":"y2","2":"-1.55553594"},{"1":"x","2":"-1.06533835"},{"1":"y1","2":"-1.21795541"},{"1":"y2","2":"-0.51902218"},{"1":"x","2":"-1.39136994"},{"1":"y1","2":"-2.10136309"},{"1":"y2","2":"-0.24857353"},{"1":"x","2":"0.66547299"},{"1":"y1","2":"0.90556693"},{"1":"y2","2":"1.35671958"},{"1":"x","2":"-1.53224607"},{"1":"y1","2":"0.53146356"},{"1":"y2","2":"0.14529688"},{"1":"x","2":"0.29011158"},{"1":"y1","2":"0.90084614"},{"1":"y2","2":"0.83560170"},{"1":"x","2":"0.69239937"},{"1":"y1","2":"0.12687786"},{"1":"y2","2":"2.29182497"},{"1":"x","2":"-1.76053733"},{"1":"y1","2":"2.64999575"},{"1":"y2","2":"2.73673094"},{"1":"x","2":"0.72082239"},{"1":"y1","2":"0.13435947"},{"1":"y2","2":"0.27574827"},{"1":"x","2":"-1.22395587"},{"1":"y1","2":"-2.78065291"},{"1":"y2","2":"3.14550409"},{"1":"x","2":"-0.75311013"},{"1":"y1","2":"1.96202837"},{"1":"y2","2":"0.59938464"},{"1":"x","2":"1.32801392"},{"1":"y1","2":"-4.25541004"},{"1":"y2","2":"1.04460392"},{"1":"x","2":"-0.24174865"},{"1":"y1","2":"0.51517469"},{"1":"y2","2":"-0.68821620"},{"1":"x","2":"0.55292812"},{"1":"y1","2":"0.32962526"},{"1":"y2","2":"1.15201767"},{"1":"x","2":"-1.38976342"},{"1":"y1","2":"0.18227394"},{"1":"y2","2":"-1.86691141"},{"1":"x","2":"0.20633230"},{"1":"y1","2":"0.76029377"},{"1":"y2","2":"4.27233650"},{"1":"x","2":"-0.31920849"},{"1":"y1","2":"3.55063527"},{"1":"y2","2":"0.45077005"},{"1":"x","2":"0.78482776"},{"1":"y1","2":"-0.56564635"},{"1":"y2","2":"-1.70953625"},{"1":"x","2":"1.23964789"},{"1":"y1","2":"-2.88080049"},{"1":"y2","2":"0.84694745"},{"1":"x","2":"0.27462181"},{"1":"y1","2":"3.04164950"},{"1":"y2","2":"-0.03903472"},{"1":"x","2":"1.89759493"},{"1":"y1","2":"-1.29407455"},{"1":"y2","2":"1.11956044"},{"1":"x","2":"-0.19262565"},{"1":"y1","2":"-3.42396604"},{"1":"y2","2":"1.05156905"},{"1":"x","2":"-1.41365701"},{"1":"y1","2":"-1.75335473"},{"1":"y2","2":"1.49593530"},{"1":"x","2":"0.35118649"},{"1":"y1","2":"1.82462838"},{"1":"y2","2":"1.86447305"},{"1":"x","2":"1.45121334"},{"1":"y1","2":"-2.37113604"},{"1":"y2","2":"1.33013723"},{"1":"x","2":"1.17029448"},{"1":"y1","2":"2.34340037"},{"1":"y2","2":"-0.14230534"},{"1":"x","2":"-0.83901696"},{"1":"y1","2":"1.86633352"},{"1":"y2","2":"-0.39773459"},{"1":"x","2":"0.31714653"},{"1":"y1","2":"-0.14984045"},{"1":"y2","2":"-0.99949269"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/unnamed-chunk-3_b0e84a8243a529c9346a8bf2486ad040">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl[,1]"],"align":["right"]}],"data":[{"1":"y1","2":"1.98488355"},{"1":"y2","2":"0.10303468"},{"1":"y1","2":"1.27130904"},{"1":"y2","2":"-0.28089065"},{"1":"y1","2":"-0.94427745"},{"1":"y2","2":"0.62388864"},{"1":"y1","2":"0.10328425"},{"1":"y2","2":"5.42679005"},{"1":"y1","2":"2.19041969"},{"1":"y2","2":"0.16807478"},{"1":"y1","2":"0.19192798"},{"1":"y2","2":"-0.54936141"},{"1":"y1","2":"4.81186172"},{"1":"y2","2":"0.30919557"},{"1":"y1","2":"1.55169550"},{"1":"y2","2":"-0.99039138"},{"1":"y1","2":"3.35737558"},{"1":"y2","2":"-0.17200537"},{"1":"y1","2":"1.92492196"},{"1":"y2","2":"-0.15832838"},{"1":"y1","2":"-2.88047669"},{"1":"y2","2":"0.85387666"},{"1":"y1","2":"1.75053169"},{"1":"y2","2":"3.33911133"},{"1":"y1","2":"-1.08428013"},{"1":"y2","2":"-1.88393968"},{"1":"y1","2":"0.96031018"},{"1":"y2","2":"2.48425274"},{"1":"y1","2":"-1.54016895"},{"1":"y2","2":"-0.04867594"},{"1":"y1","2":"-1.24357666"},{"1":"y2","2":"-0.61515773"},{"1":"y1","2":"0.03193645"},{"1":"y2","2":"-0.28681098"},{"1":"y1","2":"-1.30918647"},{"1":"y2","2":"-0.12350146"},{"1":"y1","2":"-0.99658718"},{"1":"y2","2":"0.29936602"},{"1":"y1","2":"1.42150401"},{"1":"y2","2":"-1.06763475"},{"1":"y1","2":"-0.90365732"},{"1":"y2","2":"0.12124860"},{"1":"y1","2":"2.94554205"},{"1":"y2","2":"-0.40094019"},{"1":"y1","2":"2.57375451"},{"1":"y2","2":"-1.55553594"},{"1":"y1","2":"-1.21795541"},{"1":"y2","2":"-0.51902218"},{"1":"y1","2":"-2.10136309"},{"1":"y2","2":"-0.24857353"},{"1":"y1","2":"0.90556693"},{"1":"y2","2":"1.35671958"},{"1":"y1","2":"0.53146356"},{"1":"y2","2":"0.14529688"},{"1":"y1","2":"0.90084614"},{"1":"y2","2":"0.83560170"},{"1":"y1","2":"0.12687786"},{"1":"y2","2":"2.29182497"},{"1":"y1","2":"2.64999575"},{"1":"y2","2":"2.73673094"},{"1":"y1","2":"0.13435947"},{"1":"y2","2":"0.27574827"},{"1":"y1","2":"-2.78065291"},{"1":"y2","2":"3.14550409"},{"1":"y1","2":"1.96202837"},{"1":"y2","2":"0.59938464"},{"1":"y1","2":"-4.25541004"},{"1":"y2","2":"1.04460392"},{"1":"y1","2":"0.51517469"},{"1":"y2","2":"-0.68821620"},{"1":"y1","2":"0.32962526"},{"1":"y2","2":"1.15201767"},{"1":"y1","2":"0.18227394"},{"1":"y2","2":"-1.86691141"},{"1":"y1","2":"0.76029377"},{"1":"y2","2":"4.27233650"},{"1":"y1","2":"3.55063527"},{"1":"y2","2":"0.45077005"},{"1":"y1","2":"-0.56564635"},{"1":"y2","2":"-1.70953625"},{"1":"y1","2":"-2.88080049"},{"1":"y2","2":"0.84694745"},{"1":"y1","2":"3.04164950"},{"1":"y2","2":"-0.03903472"},{"1":"y1","2":"-1.29407455"},{"1":"y2","2":"1.11956044"},{"1":"y1","2":"-3.42396604"},{"1":"y2","2":"1.05156905"},{"1":"y1","2":"-1.75335473"},{"1":"y2","2":"1.49593530"},{"1":"y1","2":"1.82462838"},{"1":"y2","2":"1.86447305"},{"1":"y1","2":"-2.37113604"},{"1":"y2","2":"1.33013723"},{"1":"y1","2":"2.34340037"},{"1":"y2","2":"-0.14230534"},{"1":"y1","2":"1.86633352"},{"1":"y2","2":"-0.39773459"},{"1":"y1","2":"-0.14984045"},{"1":"y2","2":"-0.99949269"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="signed-rank-values" class="level2"><h2 class="anchored" data-anchor-id="signed-rank-values">“Signed Rank” Values</h2>
<p>Most statistical tests use the <strong>actual values</strong> of the data variables. However, in some <em>non-parametric</em> statistical tests, the data are used in <strong>rank-transformed</strong> sense/order. In some cases the <strong>signed-rank</strong> of the data values is used instead of the data itself.</p>
<p>Signed Rank is calculated as follows:<br>
1. Take the absolute value of each observation in a sample<br>
2. Place the <u><em>ranks</em></u> in order of (absolute magnitude). The smallest number has <em>rank = 1</em> and so on.<br>
3. Give each of the ranks the sign of the original observation ( + or - )</p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/signed_rank_function_b1abdd1f20dedc34fba649343160cbcf">

</div>
</section><section id="plotting-original-and-signed-rank-data" class="level2"><h2 class="anchored" data-anchor-id="plotting-original-and-signed-rank-data">Plotting Original and Signed Rank Data</h2>
<p>A quick plot:</p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/data_plots_b46df11287b79b1f40cef3b318601dc7">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/data_plots-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section><section id="how-does-sign-rank-data-work" class="level2"><h2 class="anchored" data-anchor-id="how-does-sign-rank-data-work">How does Sign-Rank data work?</h2>
<p>TBD: need to add some explanation here.</p>
</section></section><section id="tests-for-correlation" class="level1 tabset"><h1 class="tabset">Tests for Correlation</h1>
<p>Correlation <strong>r</strong> is a measure of <em>strength</em> and <em>direction</em> of <em>linear association</em> between two variables. <strong>r</strong> is between [-1,+1], with 0 implying no association/correlation.</p>
<p>From this definition, the <em>linear model</em> lends itself in a straightforward way as a model to interpret <em>correlation</em>. Intuitively, the slope of the linear model could be related to the correlation between y and x.</p>
<p>Now we look at the numbers.</p>
<section id="pearson-correlation" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="pearson-correlation">Pearson Correlation</h2>
<section id="model" class="level3"><h3 class="anchored" data-anchor-id="model">Model</h3>
<p>The model for Pearson Correlation tests is exactly the Linear Model:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 * x
\\
H_0: \beta_1 = 0
\]</span></p>
<p>See the Code section for further insights into the relationship between the Correlation Score and the Slope of the Linear Model.</p>
</section><section id="code" class="level3"><h3 class="anchored" data-anchor-id="code">Code</h3>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/Pearson_Correlation_879d9e6153bae14ae7ebaf8cddcbda61">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  estimate p.value
     &lt;dbl&gt;   &lt;dbl&gt;
1   -0.232   0.105</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  estimate p.value
     &lt;dbl&gt;   &lt;dbl&gt;
1    0.3     0.286
2   -0.464   0.105</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   estimate p.value
      &lt;dbl&gt;   &lt;dbl&gt;
1 -9.06e-17   1    
2 -2.32e- 1   0.105</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
   estimate p.value
      &lt;dbl&gt;   &lt;dbl&gt;
1 -2.32e- 1   0.105
2  3   e- 1   0.286
3 -4.64e- 1   0.105
4 -9.06e-17   1    
5 -2.32e- 1   0.105</code></pre>
</div>
</div>
<p>Notes: 1. The <em>p-value</em> for Pearson Correlation and that for the <em>slope</em> in the linear model is the same ( 0.1053 ). Which means we cannot reject the NULL hypothesis of “no relationship”.</p>
<ol start="2" type="1">
<li>Here is the relationship between the slope and correlation:</li>
</ol>
<p><span class="math display">\[
Slope\ \beta_1 = \frac{sd_y}{sd_x} * r
\]</span></p>
<p>When both x and y have the same standard deviation, the slope and correlation are the same. Here, since x has twice the <code>sd</code> of y, the ratio of <strong>slope</strong> = -0.4635533 to <strong>r</strong> = -0.2317767 is 0.5. Hence a linear model using <code><a href="https://rdrr.io/r/base/scale.html">scale()</a></code> for both variables will show slope = <strong>r</strong>.</p>
<p>Slope_Scaled: -0.2317767 = Correlation: -0.2317767</p>
</section><section id="example" class="level3"><h3 class="anchored" data-anchor-id="example">Example</h3>
<p>We choose to look at the <code>gpa_study_hours</code> dataset. It has two numeric columns <code>gpa</code> and <code>study_hours</code>:</p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/gpa_study_hours_232dc374d6cf06bd9644a941a45a51e2">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 193
Columns: 2
$ gpa         &lt;dbl&gt; 4.000, 3.800, 3.930, 3.400, 3.200, 3.520, 3.680, 3.400, 3.…
$ study_hours &lt;dbl&gt; 10, 25, 45, 10, 4, 10, 24, 40, 10, 10, 30, 7, 15, 60, 10, …</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/Pearson_example_1_9b8f5736f9e8aa0cb67676c337735966">
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Pearson_example_1-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<p>Hmm…not normally distributed, and the relationship is also not linear, and there is some evidence of heterscedasticity, so Pearson correlation would not be the best idea here.</p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/Pearson_example_2_1c4e5ac4b3b419842c334dc63874d7a9">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gpa ~ study_hours, data = gpa_study_hours)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.95130 -0.19456  0.03879  0.21708  0.73872 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 3.527997   0.037424  94.272   &lt;2e-16 ***
study_hours 0.003328   0.001794   1.855   0.0652 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2837 on 191 degrees of freedom
Multiple R-squared:  0.01769,   Adjusted R-squared:  0.01255 
F-statistic:  3.44 on 1 and 191 DF,  p-value: 0.06517</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  gpa and study_hours
t = 1.8548, df = 191, p-value = 0.06517
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.008383868  0.269196552
sample estimates:
      cor 
0.1330138 </code></pre>
</div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["effectsize"],"name":[3],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf.level"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["df.error"],"name":[9],"type":["int"],"align":["right"]},{"label":["p.value"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[11],"type":["chr"],"align":["left"]},{"label":["n.obs"],"name":[12],"type":["int"],"align":["right"]},{"label":["conf.method"],"name":[13],"type":["chr"],"align":["left"]},{"label":["expression"],"name":[14],"type":["list"],"align":["right"]}],"data":[{"1":"study_hours","2":"gpa","3":"Pearson correlation","4":"0.1330138","5":"0.95","6":"-0.008383868","7":"0.2691966","8":"1.854768","9":"191","10":"0.06517072","11":"Pearson correlation","12":"193","13":"normal","14":"<language>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The correlation estimate is <span class="math inline">\(0.133\)</span>; the <code>p-value</code> is 0.065 and the confidence interval includes 0. Hence we fail to reject the NULL hypothesis that <code>study_hours</code> and <code>gpa</code> have no relationship.</p>
<p>We can use a later package <code>ggstaplot</code> to plot this:</p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/Pearson_example_3_c9e1ee5864fa22aff0a86005ba1df625">
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'ggside':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Pearson_example_3-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="spearman-correlation" class="level2"><h2 class="anchored" data-anchor-id="spearman-correlation">Spearman Correlation</h2>
<section id="model-1" class="level3"><h3 class="anchored" data-anchor-id="model-1">Model</h3>
<p>In some cases the <strong>LINE</strong> assumptions may not hold. Nonlinear relationships, non-normally distributed data ( with large outliers ) and working with <em>ordinal</em> rather than continuous data: these situations necessitate the use of Spearman’s <em>ranked</em> correlation scores. (<strong>Ranked</strong>, not <strong>sign-ranked</strong>.)</p>
<p><span class="math display">\[
rank(y) = \beta_0 + \beta_1 * rank(x) \\
H_0: \beta_1 = 0
\]</span></p>
<p>Spearman correlation = Pearson correlation using the rank of the data observations. Let’s check how this holds for a our x and y data:</p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/Spearman_Plot_792d465df36d614ed2e821536441e48c">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Spearman_Plot-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<p>Slopes are almost identical, ~ 0.25.</p>
</section><section id="code-1" class="level3"><h3 class="anchored" data-anchor-id="code-1">Code</h3>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/Spearman_Correlation_60f487c3f2208cf7c62aad8a10112a70">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  estimate  p.value
     &lt;dbl&gt;    &lt;dbl&gt;
1   -0.227 1.13e- 1
2   -0.227 1.14e- 1
3   31.3   9.11e-10
4   -0.227 1.14e- 1</code></pre>
</div>
</div>
<p>Notes:</p>
<ol type="1">
<li><p>When ranks are used, the slope of the linear model (<span class="math inline">\(\beta_1\)</span>) has the same value as the correlation coefficient ( <span class="math inline">\(\rho\)</span> ).</p></li>
<li><p>Note that the slope from the linear model now has an intuitive interpretation: <strong>the number of ranks y changes for each change in rank of x</strong>. ( Ranks are “independent” of <code>sd</code> )</p></li>
</ol></section><section id="example-1" class="level3"><h3 class="anchored" data-anchor-id="example-1">Example</h3>
<p>We examine the <code>cars93</code> data, where the numeric variables of interest are <code>weight</code> and <code>price</code>.</p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/Spearman_example_1_dd7fdfe1daf96a273e1f902d0eaa6dbf">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Spearman_example_1-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<p>Let us try a Spearman Correlation score for these variables, since the data are not linearly related and the variance of <code>price</code> also is not constant over <code>weight</code></p>
<div class="cell" data-layout-align="center" data-hash="index_cache/html/Spearman_example_2_e7b7ce46e1dfef14364e2440d9aca7cf">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor.test.default(x, y, ...): Cannot compute exact p-value with ties</code></pre>
</div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["estimate"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[4],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"0.8828317","2":"3073.91","3":"1.066315e-18","4":"Spearman's rank correlation rho","5":"two.sided"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rank(price) ~ rank(weight), data = cars93)

Residuals:
     Min       1Q   Median       3Q      Max 
-20.0676  -3.0135   0.7815   3.6926  20.4099 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.22074    2.05894   1.564    0.124    
rank(weight)  0.88288    0.06514  13.554   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.46 on 52 degrees of freedom
Multiple R-squared:  0.7794,    Adjusted R-squared:  0.7751 
F-statistic: 183.7 on 1 and 52 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Spearman_example_2-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<p>We see that using ranks of the <code>price</code> variable, we obtain a Spearman’s <span class="math inline">\(\rho = 0.882\)</span> with a <code>p-value</code> that is very small. Hence we are able to reject the NULL hypothesis and state that there is a relationship between these two variables. The <strong>linear</strong> relationship is evaluated as a correlation of <code>0.882</code>.</p>
</section></section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Hopefully, interpreting Statistical Tests in terms of the Linear Model has benefits of improved intuitive understanding.</p>
</section><section id="iconify-orange-circle-a-workflow-in-orange" class="level2"><h2 class="anchored" data-anchor-id="iconify-orange-circle-a-workflow-in-orange">
<iconify-icon inline="" icon="fluent-emoji:orange-circle"></iconify-icon> A Workflow in Orange</h2>
<p><a href="./files/distributions.ows"> <iconify-icon icon="fluent-emoji:orange-circle"></iconify-icon> Orange Tutorial</a></p>
<p>Download the Orange Workflow file by clicking the icon above, save the file, and open it in Orange.</p>
</section><section id="fa-person-rays-a-workflow-in-radiant" class="level2"><h2 class="anchored" data-anchor-id="fa-person-rays-a-workflow-in-radiant">
<i class="fa-solid fa-person-rays" aria-label="person-rays"></i> A Workflow in Radiant</h2>
<p><a href="./files/correlations.rda"> <i class="fa-solid fa-person-rays"></i> Radiant Tutorial</a>&nbsp;&nbsp;</p>
<p>Download the Radiant Workflow statefile by clicking the icon above, an upload/open it in Radiant. You need to start radiant from the <code>Add-In</code>menu in RStudio.</p>
</section><section id="fa-brands-r-project-a-workflow-in-r" class="level2"><h2 class="anchored" data-anchor-id="fa-brands-r-project-a-workflow-in-r">
<i class="fa-brands fa-r-project" aria-label="r-project"></i> A Workflow in R</h2>
<p><a href="./files/distributions.qmd"><i class="fa-brands
fa-r-project"></i> R Tutorial</a>&nbsp;&nbsp;</p>
<p>Download the Quarto tutorial file by clicking the icon above and open it in RStudio or <a href="https://rstudio.cloud" class="uri">https://rstudio.cloud</a> .</p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/av-quarto\.netlify\.app/);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Website made with 💜 and <a href="https://quarto.org/">Quarto</a>, by Arvind Venkatadri. License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>.</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:arvind.venkatadri@gmail.com">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../../../../blog.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


<script src="../../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>