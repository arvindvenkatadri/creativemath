<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Arvind Venkatadri">
<meta name="dcterms.date" content="2022-11-25">
<title>The Foundation Series - Samples, Populations, Statistics and Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../../">
<script src="../../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="The Foundation Series - Samples, Populations, Statistics and Inference">
<meta property="og:description" content="How much ~~Land~~ Data does a Man need?">
<meta property="og:site-name" content="The Foundation Series">
<meta name="twitter:title" content="The Foundation Series - Samples, Populations, Statistics and Inference">
<meta name="twitter:description" content="How much ~~Land~~ Data does a Man need?">
<meta name="twitter:creator" content="@arvind_v">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../../../../index.html">
    <span class="navbar-title">The Foundation Series</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/my-quarto-website"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../../../../blog.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Samples, Populations, Statistics and Inference</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Samples, Populations, Statistics and Inference</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Arvind Venkatadri </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 25, 2022</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">January 31, 2023</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="abstract-title">Abstract</div>
      How much <del>Land</del> Data does a Man need?
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../blog.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Teaching</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Data Analytics</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Data-Analytics/Descriptive-Analytics/listing.html" class="sidebar-item-text sidebar-link">Descriptive Analytics</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Data-Analytics/Basics-of-Modeling/listing.html" class="sidebar-item-text sidebar-link">Basics of Modelling</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Data-Analytics/Predictive-Analytics/listing.html" class="sidebar-item-text sidebar-link">Predictive Analytics</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Data-Analytics/Prescriptive-Analytics/listing.html" class="sidebar-item-text sidebar-link">Prescriptive Analytics</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/R-for-Artists/listing.html" class="sidebar-item-text sidebar-link">R for Artists</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/posts/listing.html" class="sidebar-item-text sidebar-link">Posts</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/projects/listing.html" class="sidebar-item-text sidebar-link">Projects</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content"><section id="fa-folder-open-slides-and-tutorials" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="fa-folder-open-slides-and-tutorials">
<span class="header-section-number">1</span> <i class="fa-solid fa-folder-open" aria-label="folder-open"></i> Slides and Tutorials</h2>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 27%">
<col style="width: 23%">
<col style="width: 23%">
</colgroup>
<tbody><tr class="odd">
<td><a href="../../../../../../content/courses/Data-Analytics/Basics-of-Modeling/Modules/20-Sampling-and-Probability/files/sampling.html"> <i class="fa-solid fa-file-powerpoint fa-2x"></i></a></td>
<td><a href="./files/sampling.ows"> <iconify-icon icon="icon-park-solid:orange"></iconify-icon></a></td>
<td><a href="./files/sampling.rda"> <i class="fa-solid fa-person-rays"></i></a></td>
<td><a href="./data/data.zip"> <i class="fa-solid fa-database"></i></a></td>
</tr></tbody>
</table>
<div class="cell" data-layout-align="center">

</div>
</section><section id="what-is-a-population" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="what-is-a-population">
<span class="header-section-number">2</span> What is a Population?</h2>
<p>A <em>population</em> is a collection of individuals or observations we are interested in. This is also commonly denoted as a study population. We mathematically denote the population’s size using upper-case <code>N</code>.</p>
<p>A <em>population parameter</em> is some numerical summary about the population that is unknown but you wish you knew. For example, when this quantity is a mean like the average height of all Bangaloreans, the population parameter of interest is the population mean.</p>
<p>A <em>census</em> is an exhaustive enumeration or counting of all N individuals in the population. We do this in order to compute the population parameter’s value exactly. Of note is that as the number N of individuals in our population increases, conducting a census gets more expensive (in terms of time, energy, and money).</p>
</section><section id="what-is-a-sample" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="what-is-a-sample">
<span class="header-section-number">3</span> What is a Sample?</h2>
<p>Sampling is the act of collecting a sample from the population, which we generally do when we can’t perform a census. We mathematically denote the sample size using lower case <code>n</code>, as opposed to upper case N which denotes the population’s size. Typically the sample size n is much smaller than the population size N. Thus sampling is a much cheaper alternative than performing a census.</p>
<p>A <strong>sample statistic</strong>, also known as a <em>point estimate</em>, is a summary statistic like a mean or standard deviation that is computed from a sample.</p>
</section><section id="why-do-we-sample" class="level2" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="why-do-we-sample">
<span class="header-section-number">4</span> Why do we sample?</h2>
<p>Because we cannot conduct a census ( not always ) — and sometimes we won’t even know how big the population is — we take samples. And we <em>still</em> want to do useful work for/with the population, after <em>estimating its parameters, an act of generalizing</em> from sample to population. So the question is, <strong>can we estimate useful parameters of the population, using just samples? Can point estimates serve as useful guides to population parameters?</strong></p>
<p>This act of generalizing from sample to population is at the heart of <strong>statistical inference</strong>.</p>
<p>NOTE: there is an <em>alliterative mnemonic</em> here: <strong>S</strong>amples have <strong>S</strong>tatistics; <strong>P</strong>opulations have <strong>P</strong>arameters.</p>
</section><section id="sampling" class="level2 page-columns page-full" data-number="5"><h2 data-number="5" class="anchored" data-anchor-id="sampling">
<span class="header-section-number">5</span> Sampling</h2>
<p>We will first execute some samples from a known dataset. We load up the NHANES dataset and inspect it.</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">data</span>(<span class="st">"NHANES"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>mosaic<span class="sc">::</span><span class="fu">inspect</span>(NHANES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
categorical variables:  
               name  class levels     n missing
1          SurveyYr factor      2 10000       0
2            Gender factor      2 10000       0
3         AgeDecade factor      8  9667     333
4             Race1 factor      5 10000       0
5             Race3 factor      6  5000    5000
6         Education factor      5  7221    2779
7     MaritalStatus factor      6  7231    2769
8          HHIncome factor     12  9189     811
9           HomeOwn factor      3  9937      63
10             Work factor      3  7771    2229
11 BMICatUnder20yrs factor      4  1274    8726
12          BMI_WHO factor      4  9603     397
13         Diabetes factor      2  9858     142
14        HealthGen factor      5  7539    2461
15   LittleInterest factor      3  6667    3333
16        Depressed factor      3  6673    3327
17     SleepTrouble factor      2  7772    2228
18       PhysActive factor      2  8326    1674
19         TVHrsDay factor      7  4859    5141
20       CompHrsDay factor      7  4863    5137
21  Alcohol12PlusYr factor      2  6580    3420
22         SmokeNow factor      2  3211    6789
23         Smoke100 factor      2  7235    2765
24        Smoke100n factor      2  7235    2765
25        Marijuana factor      2  4941    5059
26     RegularMarij factor      2  4941    5059
27        HardDrugs factor      2  5765    4235
28          SexEver factor      2  5767    4233
29          SameSex factor      2  5768    4232
30   SexOrientation factor      3  4842    5158
31      PregnantNow factor      3  1696    8304
                                    distribution
1  2009_10 (50%), 2011_12 (50%)                 
2  female (50.2%), male (49.8%)                 
3   40-49 (14.5%),  0-9 (14.4%) ...             
4  White (63.7%), Black (12%) ...               
5  White (62.7%), Black (11.8%) ...             
6  Some College (31.4%) ...                     
7  Married (54.6%), NeverMarried (19.1%) ...    
8  more 99999 (24.2%) ...                       
9  Own (64.7%), Rent (33.1%) ...                
10 Working (59.4%), NotWorking (36.6%) ...      
11 NormWeight (63.2%), Obese (17.3%) ...        
12 18.5_to_24.9 (30.3%) ...                     
13 No (92.3%), Yes (7.7%)                       
14 Good (39.2%), Vgood (33.3%) ...              
15 None (76.5%), Several (16.9%) ...            
16 None (78.6%), Several (15.1%) ...            
17 No (74.6%), Yes (25.4%)                      
18 Yes (55.8%), No (44.2%)                      
19 2_hr (26.2%), 1_hr (18.2%) ...               
20 0_to_1_hr (29%), 0_hrs (22.1%) ...           
21 Yes (79.2%), No (20.8%)                      
22 No (54.3%), Yes (45.7%)                      
23 No (55.6%), Yes (44.4%)                      
24 Non-Smoker (55.6%), Smoker (44.4%)           
25 Yes (58.5%), No (41.5%)                      
26 No (72.4%), Yes (27.6%)                      
27 No (81.5%), Yes (18.5%)                      
28 Yes (96.1%), No (3.9%)                       
29 No (92.8%), Yes (7.2%)                       
30 Heterosexual (95.8%), Bisexual (2.5%) ...    
31 No (92.7%), Yes (4.2%) ...                   

quantitative variables:  
              name   class      min        Q1    median        Q3        max
1               ID integer 51624.00 56904.500 62159.500 67039.000  71915.000
2              Age integer     0.00    17.000    36.000    54.000     80.000
3        AgeMonths integer     0.00   199.000   418.000   624.000    959.000
4      HHIncomeMid integer  2500.00 30000.000 50000.000 87500.000 100000.000
5          Poverty numeric     0.00     1.240     2.700     4.710      5.000
6        HomeRooms integer     1.00     5.000     6.000     8.000     13.000
7           Weight numeric     2.80    56.100    72.700    88.900    230.700
8           Length numeric    47.10    75.700    87.000    96.100    112.200
9         HeadCirc numeric    34.20    39.575    41.450    42.925     45.400
10          Height numeric    83.60   156.800   166.000   174.500    200.400
11             BMI numeric    12.88    21.580    25.980    30.890     81.250
12           Pulse integer    40.00    64.000    72.000    82.000    136.000
13        BPSysAve integer    76.00   106.000   116.000   127.000    226.000
14        BPDiaAve integer     0.00    61.000    69.000    76.000    116.000
15          BPSys1 integer    72.00   106.000   116.000   128.000    232.000
16          BPDia1 integer     0.00    62.000    70.000    76.000    118.000
17          BPSys2 integer    76.00   106.000   116.000   128.000    226.000
18          BPDia2 integer     0.00    60.000    68.000    76.000    118.000
19          BPSys3 integer    76.00   106.000   116.000   126.000    226.000
20          BPDia3 integer     0.00    60.000    68.000    76.000    116.000
21    Testosterone numeric     0.25    17.700    43.820   362.410   1795.600
22      DirectChol numeric     0.39     1.090     1.290     1.580      4.030
23         TotChol numeric     1.53     4.110     4.780     5.530     13.650
24       UrineVol1 integer     0.00    50.000    94.000   164.000    510.000
25      UrineFlow1 numeric     0.00     0.403     0.699     1.221     17.167
26       UrineVol2 integer     0.00    52.000    95.000   171.750    409.000
27      UrineFlow2 numeric     0.00     0.475     0.760     1.513     13.692
28     DiabetesAge integer     1.00    40.000    50.000    58.000     80.000
29 DaysPhysHlthBad integer     0.00     0.000     0.000     3.000     30.000
30 DaysMentHlthBad integer     0.00     0.000     0.000     4.000     30.000
31    nPregnancies integer     1.00     2.000     3.000     4.000     32.000
32         nBabies integer     0.00     2.000     2.000     3.000     12.000
33      Age1stBaby integer    14.00    19.000    22.000    26.000     39.000
34   SleepHrsNight integer     2.00     6.000     7.000     8.000     12.000
35  PhysActiveDays integer     1.00     2.000     3.000     5.000      7.000
36   TVHrsDayChild integer     0.00     1.000     2.000     3.000      6.000
37 CompHrsDayChild integer     0.00     0.000     1.000     6.000      6.000
38      AlcoholDay integer     1.00     1.000     2.000     3.000     82.000
39     AlcoholYear integer     0.00     3.000    24.000   104.000    364.000
40        SmokeAge integer     6.00    15.000    17.000    19.000     72.000
41   AgeFirstMarij integer     1.00    15.000    16.000    19.000     48.000
42     AgeRegMarij integer     5.00    15.000    17.000    19.000     52.000
43          SexAge integer     9.00    15.000    17.000    19.000     50.000
44 SexNumPartnLife integer     0.00     2.000     5.000    12.000   2000.000
45  SexNumPartYear integer     0.00     1.000     1.000     1.000     69.000
           mean           sd     n missing
1  6.194464e+04 5.871167e+03 10000       0
2  3.674210e+01 2.239757e+01 10000       0
3  4.201239e+02 2.590431e+02  4962    5038
4  5.720617e+04 3.302028e+04  9189     811
5  2.801844e+00 1.677909e+00  9274     726
6  6.248918e+00 2.277538e+00  9931      69
7  7.098180e+01 2.912536e+01  9922      78
8  8.501602e+01 1.370503e+01   543    9457
9  4.118068e+01 2.311483e+00    88    9912
10 1.618778e+02 2.018657e+01  9647     353
11 2.666014e+01 7.376579e+00  9634     366
12 7.355973e+01 1.215542e+01  8563    1437
13 1.181550e+02 1.724817e+01  8551    1449
14 6.748006e+01 1.435480e+01  8551    1449
15 1.190902e+02 1.749636e+01  8237    1763
16 6.827826e+01 1.378078e+01  8237    1763
17 1.184758e+02 1.749133e+01  8353    1647
18 6.766455e+01 1.441978e+01  8353    1647
19 1.179292e+02 1.717719e+01  8365    1635
20 6.729874e+01 1.495839e+01  8365    1635
21 1.978980e+02 2.265045e+02  4126    5874
22 1.364865e+00 3.992581e-01  8474    1526
23 4.879220e+00 1.075583e+00  8474    1526
24 1.185161e+02 9.033648e+01  9013     987
25 9.792946e-01 9.495143e-01  8397    1603
26 1.196759e+02 9.016005e+01  1478    8522
27 1.149372e+00 1.072948e+00  1476    8524
28 4.842289e+01 1.568050e+01   629    9371
29 3.334838e+00 7.400700e+00  7532    2468
30 4.126493e+00 7.832971e+00  7534    2466
31 3.026882e+00 1.795341e+00  2604    7396
32 2.456954e+00 1.315227e+00  2416    7584
33 2.264968e+01 4.772509e+00  1884    8116
34 6.927531e+00 1.346729e+00  7755    2245
35 3.743513e+00 1.836358e+00  4663    5337
36 1.938744e+00 1.434431e+00   653    9347
37 2.197550e+00 2.516667e+00   653    9347
38 2.914123e+00 3.182672e+00  4914    5086
39 7.510165e+01 1.030337e+02  5922    4078
40 1.782662e+01 5.326660e+00  3080    6920
41 1.702283e+01 3.895010e+00  2891    7109
42 1.769107e+01 4.806103e+00  1366    8634
43 1.742870e+01 3.716551e+00  5540    4460
44 1.508507e+01 5.784643e+01  5725    4275
45 1.342330e+00 2.782688e+00  4928    5072</code></pre>
</div>
</div>
<p>Let us create a NHANES dataset without duplicated IDs and only adults:</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>NHANES <span class="ot">&lt;-</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  NHANES <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">distinct</span>(ID, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) </span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#create a dataset of only adults</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>NHANES_adult <span class="ot">&lt;-</span> </span>
<span id="cb3-7"><a href="#cb3-7"></a>  NHANES <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>  <span class="fu">filter</span>( </span>
<span id="cb3-9"><a href="#cb3-9"></a>    Age <span class="sc">&gt;=</span> <span class="dv">18</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>  <span class="fu">drop_na</span>(Height)</span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="fu">glimpse</span>(NHANES_adult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,790
Columns: 76
$ ID               &lt;int&gt; 51624, 51630, 51647, 51654, 51656, 51657, 51666, 5166…
$ SurveyYr         &lt;fct&gt; 2009_10, 2009_10, 2009_10, 2009_10, 2009_10, 2009_10,…
$ Gender           &lt;fct&gt; male, female, female, male, male, male, female, male,…
$ Age              &lt;int&gt; 34, 49, 45, 66, 58, 54, 58, 50, 33, 60, 56, 57, 54, 3…
$ AgeDecade        &lt;fct&gt;  30-39,  40-49,  40-49,  60-69,  50-59,  50-59,  50-5…
$ AgeMonths        &lt;int&gt; 409, 596, 541, 795, 707, 654, 700, 603, 404, 721, 677…
$ Race1            &lt;fct&gt; White, White, White, White, White, White, Mexican, Wh…
$ Race3            &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Education        &lt;fct&gt; High School, Some College, College Grad, Some College…
$ MaritalStatus    &lt;fct&gt; Married, LivePartner, Married, Married, Divorced, Mar…
$ HHIncome         &lt;fct&gt; 25000-34999, 35000-44999, 75000-99999, 25000-34999, m…
$ HHIncomeMid      &lt;int&gt; 30000, 40000, 87500, 30000, 100000, 70000, 87500, 175…
$ Poverty          &lt;dbl&gt; 1.36, 1.91, 5.00, 2.20, 5.00, 2.20, 2.03, 1.24, 1.27,…
$ HomeRooms        &lt;int&gt; 6, 5, 6, 5, 10, 6, 10, 4, 11, 5, 10, 9, 3, 6, 6, 10, …
$ HomeOwn          &lt;fct&gt; Own, Rent, Own, Own, Rent, Rent, Rent, Rent, Own, Own…
$ Work             &lt;fct&gt; NotWorking, NotWorking, Working, NotWorking, Working,…
$ Weight           &lt;dbl&gt; 87.4, 86.7, 75.7, 68.0, 78.4, 74.7, 57.5, 84.1, 93.8,…
$ Length           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ HeadCirc         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Height           &lt;dbl&gt; 164.7, 168.4, 166.7, 169.5, 181.9, 169.4, 148.1, 177.…
$ BMI              &lt;dbl&gt; 32.22, 30.57, 27.24, 23.67, 23.69, 26.03, 26.22, 26.6…
$ BMICatUnder20yrs &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ BMI_WHO          &lt;fct&gt; 30.0_plus, 30.0_plus, 25.0_to_29.9, 18.5_to_24.9, 18.…
$ Pulse            &lt;int&gt; 70, 86, 62, 60, 62, 76, 94, 74, 96, 84, 64, 70, 64, 6…
$ BPSysAve         &lt;int&gt; 113, 112, 118, 111, 104, 134, 127, 142, 128, 152, 95,…
$ BPDiaAve         &lt;int&gt; 85, 75, 64, 63, 74, 85, 83, 68, 74, 100, 69, 89, 41, …
$ BPSys1           &lt;int&gt; 114, 118, 106, 124, 108, 136, NA, 138, 126, 154, 94, …
$ BPDia1           &lt;int&gt; 88, 82, 62, 64, 76, 86, NA, 66, 80, 98, 74, 82, 48, 8…
$ BPSys2           &lt;int&gt; 114, 108, 118, 108, 104, 132, 134, 142, 128, 150, 94,…
$ BPDia2           &lt;int&gt; 88, 74, 68, 62, 72, 88, 82, 74, 74, 98, 70, 88, 42, 8…
$ BPSys3           &lt;int&gt; 112, 116, 118, 114, 104, 136, 120, 142, NA, 154, 96, …
$ BPDia3           &lt;int&gt; 82, 76, 60, 64, 76, 82, 84, 62, NA, 102, 68, 90, 40, …
$ Testosterone     &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ DirectChol       &lt;dbl&gt; 1.29, 1.16, 2.12, 0.67, 0.96, 1.16, 1.14, 1.06, 0.91,…
$ TotChol          &lt;dbl&gt; 3.49, 6.70, 5.82, 4.99, 4.24, 6.41, 4.78, 5.22, 5.59,…
$ UrineVol1        &lt;int&gt; 352, 77, 106, 113, 163, 215, 29, 64, 155, 238, 26, 13…
$ UrineFlow1       &lt;dbl&gt; NA, 0.094, 1.116, 0.489, NA, 0.903, 0.299, 0.190, 0.5…
$ UrineVol2        &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 86, NA, NA, N…
$ UrineFlow2       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.43, NA, NA,…
$ Diabetes         &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, N…
$ DiabetesAge      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ HealthGen        &lt;fct&gt; Good, Good, Vgood, Vgood, Vgood, Fair, NA, Good, Fair…
$ DaysPhysHlthBad  &lt;int&gt; 0, 0, 0, 10, 0, 4, NA, 0, 3, 7, 3, 0, 0, 3, 0, 2, 0, …
$ DaysMentHlthBad  &lt;int&gt; 15, 10, 3, 0, 0, 0, NA, 0, 7, 0, 0, 0, 0, 4, 0, 30, 0…
$ LittleInterest   &lt;fct&gt; Most, Several, None, None, None, None, NA, None, Seve…
$ Depressed        &lt;fct&gt; Several, Several, None, None, None, None, NA, None, N…
$ nPregnancies     &lt;int&gt; NA, 2, 1, NA, NA, NA, NA, NA, NA, NA, 4, 2, NA, NA, N…
$ nBabies          &lt;int&gt; NA, 2, NA, NA, NA, NA, NA, NA, NA, NA, 3, 2, NA, NA, …
$ Age1stBaby       &lt;int&gt; NA, 27, NA, NA, NA, NA, NA, NA, NA, NA, 26, 32, NA, N…
$ SleepHrsNight    &lt;int&gt; 4, 8, 8, 7, 5, 4, 5, 7, 6, 6, 7, 8, 6, 5, 6, 4, 5, 7,…
$ SleepTrouble     &lt;fct&gt; Yes, Yes, No, No, No, Yes, No, No, No, Yes, No, No, Y…
$ PhysActive       &lt;fct&gt; No, No, Yes, Yes, Yes, Yes, Yes, Yes, No, No, Yes, Ye…
$ PhysActiveDays   &lt;int&gt; NA, NA, 5, 7, 5, 1, 2, 7, NA, NA, 7, 3, 3, NA, 2, NA,…
$ TVHrsDay         &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ CompHrsDay       &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ TVHrsDayChild    &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ CompHrsDayChild  &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Alcohol12PlusYr  &lt;fct&gt; Yes, Yes, Yes, Yes, Yes, Yes, NA, No, Yes, Yes, Yes, …
$ AlcoholDay       &lt;int&gt; NA, 2, 3, 1, 2, 6, NA, NA, 3, 6, 1, 1, 2, NA, 12, NA,…
$ AlcoholYear      &lt;int&gt; 0, 20, 52, 100, 104, 364, NA, 0, 104, 36, 12, 312, 15…
$ SmokeNow         &lt;fct&gt; No, Yes, NA, No, NA, NA, Yes, NA, No, No, NA, No, NA,…
$ Smoke100         &lt;fct&gt; Yes, Yes, No, Yes, No, No, Yes, No, Yes, Yes, No, Yes…
$ Smoke100n        &lt;fct&gt; Smoker, Smoker, Non-Smoker, Smoker, Non-Smoker, Non-S…
$ SmokeAge         &lt;int&gt; 18, 38, NA, 13, NA, NA, 17, NA, NA, 16, NA, 18, NA, N…
$ Marijuana        &lt;fct&gt; Yes, Yes, Yes, NA, Yes, Yes, NA, No, No, NA, No, Yes,…
$ AgeFirstMarij    &lt;int&gt; 17, 18, 13, NA, 19, 15, NA, NA, NA, NA, NA, 18, NA, N…
$ RegularMarij     &lt;fct&gt; No, No, No, NA, Yes, Yes, NA, No, No, NA, No, No, No,…
$ AgeRegMarij      &lt;int&gt; NA, NA, NA, NA, 20, 15, NA, NA, NA, NA, NA, NA, NA, N…
$ HardDrugs        &lt;fct&gt; Yes, Yes, No, No, Yes, Yes, NA, No, No, No, No, No, N…
$ SexEver          &lt;fct&gt; Yes, Yes, Yes, Yes, Yes, Yes, NA, Yes, Yes, Yes, Yes,…
$ SexAge           &lt;int&gt; 16, 12, 13, 17, 22, 12, NA, NA, 27, 20, 20, 18, 14, 2…
$ SexNumPartnLife  &lt;int&gt; 8, 10, 20, 15, 7, 100, NA, 9, 1, 1, 2, 5, 20, 1, 20, …
$ SexNumPartYear   &lt;int&gt; 1, 1, 0, NA, 1, 1, NA, 1, 1, NA, 1, 1, 2, 1, 3, 1, NA…
$ SameSex          &lt;fct&gt; No, Yes, Yes, No, No, No, NA, No, No, No, No, No, No,…
$ SexOrientation   &lt;fct&gt; Heterosexual, Heterosexual, Bisexual, NA, Heterosexua…
$ PregnantNow      &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
<p>For now, we will <strong>treat</strong> this dataset as our <strong>Population</strong>. So each variable in the dataset is a population for that particular quantity/category, with appropriate <em>population parameters</em> such as means, sd-s, and proportions. Let us calculate the <strong>population parameters</strong> for the <code>Height</code> data:</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>pop_mean_height <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">~</span> Height, <span class="at">data =</span> NHANES_adult)</span>
<span id="cb5-2"><a href="#cb5-2"></a>pop_sd_height <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="sc">~</span> Height, <span class="at">data =</span> NHANES_adult)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a>pop_mean_height</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 168.3497</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>pop_sd_height</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 10.15705</code></pre>
</div>
</div>
<p>Now, we will sample <strong>ONCE</strong> from the NHANES <code>Height</code> variable. Let us take a sample of <code>sample size</code> 50. We will compare <strong>sample statistics</strong> with <strong>population parameters</strong> on the basis of this ONE sample of 50:</p>
<div class="cell page-columns page-full" data-fig.id="true">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>sample_height <span class="ot">&lt;-</span> <span class="fu">sample</span>(NHANES_adult, <span class="at">size =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Height)</span>
<span id="cb9-2"><a href="#cb9-2"></a>sample_height</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">

<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Height"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"172.0"},{"1":"158.8"},{"1":"171.0"},{"1":"159.1"},{"1":"156.5"},{"1":"170.2"},{"1":"148.5"},{"1":"158.7"},{"1":"167.7"},{"1":"158.6"},{"1":"154.3"},{"1":"173.9"},{"1":"154.2"},{"1":"164.3"},{"1":"174.9"},{"1":"149.4"},{"1":"164.2"},{"1":"168.1"},{"1":"171.9"},{"1":"180.1"},{"1":"156.5"},{"1":"157.6"},{"1":"162.7"},{"1":"176.0"},{"1":"167.5"},{"1":"157.9"},{"1":"150.2"},{"1":"164.0"},{"1":"162.6"},{"1":"171.2"},{"1":"180.6"},{"1":"167.1"},{"1":"188.5"},{"1":"185.1"},{"1":"137.3"},{"1":"161.5"},{"1":"185.3"},{"1":"188.3"},{"1":"153.7"},{"1":"160.8"},{"1":"157.3"},{"1":"174.2"},{"1":"178.8"},{"1":"169.1"},{"1":"151.8"},{"1":"171.5"},{"1":"160.8"},{"1":"160.0"},{"1":"176.9"},{"1":"182.1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Single-Sample Mean and Population Mean</p>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>sample_mean_height <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">~</span> Height, <span class="at">data =</span> sample_height)</span>
<span id="cb10-2"><a href="#cb10-2"></a>sample_mean_height</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 165.866</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Plotting the histogram of this sample</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>sample_height <span class="sc">%&gt;%</span> <span class="fu">gf_histogram</span>(<span class="sc">~</span> Height) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> sample_mean_height, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> pop_mean_height, <span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">gf_text</span>(<span class="dv">1</span> <span class="sc">~</span> (pop_mean_height <span class="sc">+</span> <span class="dv">5</span>), <span class="at">label =</span> <span class="st">"Population Mean Height"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="fu">gf_text</span>(<span class="dv">2</span> <span class="sc">~</span> (sample_mean_height<span class="dv">-5</span>), <span class="at">label =</span> <span class="st">"Sample Mean Height"</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption margin-caption">Single-Sample Mean and Population Mean</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>OK, so the <code>sample_mean_height</code> is not too far from the <code>pop_mean_height</code>. Is this always true? Let us check: we will create 500 samples each of size 50. And calculate their mean as the <em>sample statistic</em>, giving us a dataframe containing 5000 <code>sample means</code>. We will then compare if these 500 means are close to the <code>pop_mean_height</code>:</p>
<div class="cell page-columns page-full" data-fig.id="true">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>sample_height_500 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">500</span>) <span class="sc">*</span> {</span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">sample</span>(NHANES_adult, <span class="at">size =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="fu">select</span>(Height) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="fu">summarise</span>(</span>
<span id="cb13-5"><a href="#cb13-5"></a>      <span class="at">sample_mean_500 =</span> <span class="fu">mean</span>(Height),</span>
<span id="cb13-6"><a href="#cb13-6"></a>      <span class="at">sample_min_500 =</span> <span class="fu">min</span>(Height),</span>
<span id="cb13-7"><a href="#cb13-7"></a>      <span class="at">sample_max_500 =</span> <span class="fu">max</span>(Height))</span>
<span id="cb13-8"><a href="#cb13-8"></a>}</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="fu">head</span>(sample_height_500)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">

<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sample_mean_500"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sample_min_500"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sample_max_500"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".row"],"name":[4],"type":["int"],"align":["right"]},{"label":[".index"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"166.988","2":"144.4","3":"188.8","4":"1","5":"1"},{"1":"166.738","2":"143.6","3":"190.8","4":"1","5":"2"},{"1":"166.864","2":"146.6","3":"192.3","4":"1","5":"3"},{"1":"170.150","2":"146.6","3":"191.6","4":"1","5":"4"},{"1":"169.000","2":"149.3","3":"190.7","4":"1","5":"5"},{"1":"165.948","2":"143.4","3":"188.3","4":"1","5":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Multiple Sample-Means and Population Mean</p>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">dim</span>(sample_height_500)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 500   5</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>sample_height_500 <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">gf_point</span>(.index <span class="sc">~</span> sample_mean_500, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">gf_segment</span>(</span>
<span id="cb16-4"><a href="#cb16-4"></a>    .index <span class="sc">+</span> .index <span class="sc">~</span> sample_min_500 <span class="sc">+</span> sample_max_500,</span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb16-6"><a href="#cb16-6"></a>    <span class="at">size =</span> <span class="fl">0.3</span>,</span>
<span id="cb16-7"><a href="#cb16-7"></a>    <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb16-8"><a href="#cb16-8"></a>    <span class="at">ylab =</span> <span class="st">"Sample Index (1-500)"</span>,</span>
<span id="cb16-9"><a href="#cb16-9"></a>    <span class="at">xlab =</span> <span class="st">"Sample Means"</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> <span class="sc">~</span> pop_mean_height, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>  <span class="fu">gf_label</span>(<span class="sc">-</span><span class="dv">15</span> <span class="sc">~</span> pop_mean_height, <span class="at">label =</span> <span class="st">"Population Mean"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption margin-caption">Multiple Sample-Means and Population Mean</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The <code>sample_mean</code>s (red dots), are themselves random because the samples are random, of course. It appears that they are generally in the vicinity of the <code>pop_mean</code> (blue line).</p>
<section id="distribution-of-sample-means" class="level3 page-columns page-full" data-number="5.1"><h3 data-number="5.1" class="anchored" data-anchor-id="distribution-of-sample-means">
<span class="header-section-number">5.1</span> Distribution of Sample-Means</h3>
<p>Since the <strong>sample-means</strong> are themselves random variables, let’s plot the <strong>distribution</strong> of these 5000 sample-means themselves, called a <strong>a distribution of sample-means</strong>.</p>
<div class="Note">
<p>NOTE: this <strong>a distribution of sample-means</strong> will <em>itself</em> have a mean and standard deviation. Do not get confused ;-D</p>
</div>
<p>We will also plot the position of the population mean <code>pop_mean_height</code> parameter, the means of the <code>Height</code> variable.</p>
<div class="cell page-columns page-full" data-fig.id="true">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>sample_height_500 <span class="sc">%&gt;%</span> <span class="fu">gf_dhistogram</span>(<span class="sc">~</span> sample_mean_500) <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> pop_mean_height, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3"></a>   <span class="fu">gf_label</span>(<span class="fl">0.01</span> <span class="sc">~</span> pop_mean_height, <span class="at">label =</span> <span class="st">"Population Mean"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p><img src="index_files/figure-html/Sampling-Mean-Distribution-1.png" class="figure-img" style="height:50.0%" width="768"></p>
<p></p><figcaption class="figure-caption margin-caption">Sampling Mean Distribution</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>How does this <strong>distribution of sample-means</strong> compare with that of the overall distribution of the population?</p>
<div class="cell page-columns page-full" data-fig.id="true">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>sample_height_500 <span class="sc">%&gt;%</span> <span class="fu">gf_dhistogram</span>(<span class="sc">~</span> sample_mean_500) <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> pop_mean_height, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3"></a>   <span class="fu">gf_label</span>(<span class="fl">0.01</span> <span class="sc">~</span> pop_mean_height, <span class="at">label =</span> <span class="st">"Population Mean"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="do">## Add the population histogram</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>  <span class="fu">gf_histogram</span>(<span class="sc">~</span> Height, <span class="at">data =</span> NHANES_adult, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="fu">gf_label</span>(<span class="fl">0.025</span> <span class="sc">~</span> (pop_mean_height <span class="sc">+</span> <span class="dv">20</span>), <span class="at">label =</span> <span class="st">"Population Distribution"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption margin-caption">Sampling Means and Population Distributions</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="central-limit-theorem" class="level3" data-number="5.2"><h3 data-number="5.2" class="anchored" data-anchor-id="central-limit-theorem">
<span class="header-section-number">5.2</span> Central limit theorem</h3>
<p>We see in the Figure above that</p>
<ul>
<li><p>the <em>distribution of sample-means</em> is centered around mean = <code>pop_mean</code>.</p></li>
<li><p>That the standard deviation of the <em>distribution of sample means</em> is less than that of the original population. But exactly what is it?</p></li>
<li><p>And what is the kind of distribution?</p></li>
</ul>
<p>One more experiment.</p>
<p>Now let’s repeatedly sample <code>Height</code> and compute the sample mean, and look at the resulting histograms and Q-Q plots. ( Q-Q plots check whether a certain distribution is close to being normal or not.)</p>
<p>We will use sample sizes of <code>c(16, 32, 64, 128)</code> and generate 1000 samples each time, take the means and plot these 1000 means:</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a></span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a>samples_height_16 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1000</span>,) <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">resample</span>(NHANES_adult<span class="sc">$</span>Height, <span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb19-5"><a href="#cb19-5"></a>samples_height_32 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1000</span>) <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">resample</span>(NHANES_adult<span class="sc">$</span>Height, <span class="at">size =</span> <span class="dv">32</span>))</span>
<span id="cb19-6"><a href="#cb19-6"></a>samples_height_64 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1000</span>) <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">resample</span>(NHANES_adult<span class="sc">$</span>Height, <span class="at">size =</span> <span class="dv">64</span>))</span>
<span id="cb19-7"><a href="#cb19-7"></a>samples_height_128 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1000</span>) <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">resample</span>(NHANES_adult<span class="sc">$</span>Height, <span class="at">size =</span> <span class="dv">128</span>))</span>
<span id="cb19-8"><a href="#cb19-8"></a></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co"># Quick Check</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="fu">head</span>(samples_height_16)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"168.0500","_rn_":"1"},{"1":"166.1000","_rn_":"2"},{"1":"165.5375","_rn_":"3"},{"1":"167.5625","_rn_":"4"},{"1":"165.2375","_rn_":"5"},{"1":"169.0250","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="do">### do(1000,) * mean(resample(NHANES_adult$Height, size = 16)) produces a data frame with a variable named mean.</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="do">###</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now let’s create separate Q-Q plots for the different sample sizes.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let us plot their individual histograms to compare them:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And if we overlay the histograms:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This shows that the results become more normally distributed (i.e. following the straight line) as the samples get larger. Hence we learn that:</p>
<ul>
<li>the sample-means are normally distributed around the <em>population mean</em>. This is because when we sample from the population, many values will be close to the <em>population mean</em>, and values far away from the mean will be increasingly scarce.</li>
</ul>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">mean</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_16)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 168.306</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">mean</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_32)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 168.4349</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">mean</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 168.3184</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">mean</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_128)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 168.366</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>pop_mean_height</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 168.3497</code></pre>
</div>
</div>
<ul>
<li><p>the sample-means become “more normally distributed” with sample length, as shown by the (small but definite) improvements in the Q-Q plots with sample-size.</p></li>
<li><p>the sample-mean distributions narrow with sample length.</p></li>
</ul>
<p>This is regardless of the distribution of the <em>population</em> itself. ( The <code>Height</code> variable seems to be normally distributed at population level. We will try other non-normal population variables as an exercise). This is the ** Central Limit Theorem (CLT) **.</p>
<p>As we saw above, the standard deviations of the sample-mean distributions reduce with sample size. In fact their SDs are defined by:</p>
<p><code>sd = pop_sd/sqrt(sample_size)</code> where sample-size here is one of <code>c(16,32,64,128)</code></p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">sd</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_16)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 2.578355</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">sd</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_32)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.834979</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">sd</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.280014</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">sd</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_128)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9096318</code></pre>
</div>
</div>
<p>The standard deviation of the <strong>sample-mean distribution</strong> is called the <strong>Standard Error</strong>. This statistic derived from the sample, will help us infer our population parameters with a precise estimate of the <em>uncertainty</em> involved.</p>
<p><span class="math display">\[
Standard\ Error\ \pmb {se} = \frac{population\ sd}{\sqrt[]{sample\ size}}\\\
\pmb {se} = \frac{\sigma}{\sqrt[]{n}}
\]</span></p>
<p>In our sampling experiments, the Standard Errors evaluate to:</p>
<div class="cell">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>pop_sd_height <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="sc">~</span> Height, <span class="at">data =</span> NHANES_adult)</span>
<span id="cb39-2"><a href="#cb39-2"></a></span>
<span id="cb39-3"><a href="#cb39-3"></a>pop_sd_height<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 2.539262</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>pop_sd_height<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">32</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.795529</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>pop_sd_height<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">64</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.269631</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>pop_sd_height<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">128</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8977646</code></pre>
</div>
</div>
<p>As seen, these are identical to the Standard Deviations of the individual sample-mean distributions.</p>
</section></section><section id="confidence-intervals" class="level2" data-number="6"><h2 data-number="6" class="anchored" data-anchor-id="confidence-intervals">
<span class="header-section-number">6</span> Confidence intervals</h2>
<p>When we work with samples, we want to be able to speak with a certain degree of confidence about the <strong>population mean</strong>, based on the evaluation of <strong>one</strong> sample mean,not a whole large number of them. Give that sample-means are normally distributed around the <strong>population means</strong>, we can say that <span class="math inline">\(68\%\)</span> of <em>all possible sample-mean</em> lie within $ \pm 1 SE$ of the <em>population mean</em>; and further that <span class="math inline">\(95%\)</span> of of <em>all possible sample-mean</em> lie within $ \pm 1.5* SE$ of the <em>population mean</em>.</p>
<p>These two intervals <strong>[sample-mean +/- SE]</strong> and <strong>[sample-mean +/- 1.5SE]</strong> are called the <strong>confidence intervals</strong> for the population mean, at levels 68% and 95% respectively.</p>
<p>Thus if we want to estimate a <em>population mean</em>: - we take one sample from the population<br>
- we calculate the sample-mean - we calculate the sample-sd - We calculate the Standard Error as <span class="math inline">\(\frac{sample-sd}{\sqrt[]{n}}\)</span> - We calculate 95% confidence intervals for the <em>population mean</em> based on the formula above.</p>
</section><section id="references" class="level2" data-number="7"><h2 data-number="7" class="anchored" data-anchor-id="references">
<span class="header-section-number">7</span> References</h2>
<ol type="1">
<li><p>Diez, David M &amp; Barr, Christopher D &amp; Çetinkaya-Rundel, Mine, <em>OpenIntro Statistics</em>. <a href="https://www.openintro.org/book/os/" class="uri">https://www.openintro.org/book/os/</a></p></li>
<li><p>Stats Test Wizard. <a href="https://www.socscistatistics.com/tests/what_stats_test_wizard.aspx" class="uri">https://www.socscistatistics.com/tests/what_stats_test_wizard.aspx</a></p></li>
<li><p>Diez, David M &amp; Barr, Christopher D &amp; Çetinkaya-Rundel, Mine: <em>OpenIntro Statistics</em>. Available online <a href="https://www.openintro.org/book/os/" class="uri">https://www.openintro.org/book/os/</a></p></li>
<li><p>Måns Thulin, <em>Modern Statistics with R: From wrangling and exploring data to inference and predictive modelling</em> <a href="http://www.modernstatisticswithr.com/" class="uri">http://www.modernstatisticswithr.com/</a></p></li>
<li><p>Jonas Kristoffer Lindeløv, Common statistical tests are linear models (or: how to teach stats) <a href="https://lindeloev.github.io/tests-as-linear/" class="uri">https://lindeloev.github.io/tests-as-linear/</a></p></li>
<li><p>CheatSheet <a href="https://lindeloev.github.io/tests-as-linear/linear_tests_cheat_sheet.pdf" class="uri">https://lindeloev.github.io/tests-as-linear/linear_tests_cheat_sheet.pdf</a></p></li>
<li><p>Common statistical tests are linear models: a work through by Steve Doogue <a href="https://steverxd.github.io/Stat_tests/" class="uri">https://steverxd.github.io/Stat_tests/</a></p></li>
<li><p>Jeffrey Walker “Elements of Statistical Modeling for Experimental Biology”. <a href="https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/" class="uri">https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/</a></p></li>
</ol>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/av-quarto\.netlify\.app/);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><script src="https://utteranc.es/client.js" repo="arvindvenkatadri/Issues" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb47" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb47-1"><a href="#cb47-1"></a><span class="co">---</span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="an">title:</span><span class="co"> "Samples, Populations, Statistics and Inference"</span></span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="an">author:</span><span class="co"> "Arvind Venkatadri"</span></span>
<span id="cb47-4"><a href="#cb47-4"></a><span class="an">date:</span><span class="co"> 25/Nov/2022</span></span>
<span id="cb47-5"><a href="#cb47-5"></a><span class="an">date-modified:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb47-6"><a href="#cb47-6"></a><span class="an">order:</span><span class="co"> 20</span></span>
<span id="cb47-7"><a href="#cb47-7"></a><span class="an">abstract:</span><span class="co"> "How much ~~Land~~ Data does a Man need?"</span></span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb47-9"><a href="#cb47-9"></a><span class="co">#fig-format: retina</span></span>
<span id="cb47-10"><a href="#cb47-10"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb47-11"><a href="#cb47-11"></a><span class="an">code-summary:</span><span class="co"> Show the Code</span></span>
<span id="cb47-12"><a href="#cb47-12"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb47-13"><a href="#cb47-13"></a><span class="an">code-line-numbers:</span><span class="co"> true</span></span>
<span id="cb47-14"><a href="#cb47-14"></a><span class="an">code-overflow:</span><span class="co"> wrap</span></span>
<span id="cb47-15"><a href="#cb47-15"></a><span class="an">code-copy:</span><span class="co"> true</span></span>
<span id="cb47-16"><a href="#cb47-16"></a><span class="an">fig-align:</span><span class="co"> center</span></span>
<span id="cb47-17"><a href="#cb47-17"></a><span class="an">reference-location:</span><span class="co"> margin</span></span>
<span id="cb47-18"><a href="#cb47-18"></a><span class="an">cap-location:</span><span class="co"> margin</span></span>
<span id="cb47-19"><a href="#cb47-19"></a><span class="an">highlight-style:</span><span class="co"> dracula</span></span>
<span id="cb47-20"><a href="#cb47-20"></a><span class="an">df-print:</span><span class="co"> paged</span></span>
<span id="cb47-21"><a href="#cb47-21"></a><span class="an">section-divs:</span><span class="co"> true</span></span>
<span id="cb47-22"><a href="#cb47-22"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb47-23"><a href="#cb47-23"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb47-24"><a href="#cb47-24"></a><span class="co">  freeze: auto</span></span>
<span id="cb47-25"><a href="#cb47-25"></a><span class="an">tags:</span></span>
<span id="cb47-26"><a href="#cb47-26"></a><span class="co">- Sampling</span></span>
<span id="cb47-27"><a href="#cb47-27"></a><span class="co">- Central Limit Theorem</span></span>
<span id="cb47-28"><a href="#cb47-28"></a><span class="co">- Standard Error</span></span>
<span id="cb47-29"><a href="#cb47-29"></a><span class="co">---</span></span>
<span id="cb47-30"><a href="#cb47-30"></a></span>
<span id="cb47-31"><a href="#cb47-31"></a><span class="fu">## {{&lt; fa folder-open &gt;}} Slides and Tutorials</span></span>
<span id="cb47-32"><a href="#cb47-32"></a></span>
<span id="cb47-33"><a href="#cb47-33"></a>|                                                                                       |                                                                                                 |                                                                             |                                                                     |</span>
<span id="cb47-34"><a href="#cb47-34"></a>|------------------|--------------------|-----------------|-----------------|</span>
<span id="cb47-35"><a href="#cb47-35"></a>| <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"./files/sampling.qmd"</span><span class="kw">&gt;</span> <span class="kw">&lt;i</span> <span class="er">class</span><span class="ot">=</span><span class="st">"fa-solid fa-file-powerpoint fa-2x"</span><span class="kw">&gt;&lt;/i&gt;&lt;/a&gt;</span> | <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"./files/sampling.ows"</span><span class="kw">&gt;</span> <span class="kw">&lt;iconify-icon</span> <span class="er">icon</span><span class="ot">=</span><span class="st">"icon-park-solid:orange"</span><span class="kw">&gt;&lt;/iconify-icon&gt;&lt;/a&gt;</span> | <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"./files/sampling.rda"</span><span class="kw">&gt;</span> <span class="kw">&lt;i</span> <span class="er">class</span><span class="ot">=</span><span class="st">"fa-solid fa-person-rays"</span><span class="kw">&gt;&lt;/i&gt;&lt;/a&gt;</span> | <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"./data/data.zip"</span><span class="kw">&gt;</span> <span class="kw">&lt;i</span> <span class="er">class</span><span class="ot">=</span><span class="st">"fa-solid fa-database"</span><span class="kw">&gt;&lt;/i&gt;&lt;/a&gt;</span> |</span>
<span id="cb47-36"><a href="#cb47-36"></a></span>
<span id="cb47-37"><a href="#cb47-37"></a><span class="in">```{r setup, include = FALSE}</span></span>
<span id="cb47-38"><a href="#cb47-38"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb47-39"><a href="#cb47-39"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">tidy.opts=</span><span class="fu">list</span>(<span class="at">width.cutoff=</span><span class="dv">80</span>),<span class="at">warning =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-40"><a href="#cb47-40"></a></span>
<span id="cb47-41"><a href="#cb47-41"></a></span>
<span id="cb47-42"><a href="#cb47-42"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb47-43"><a href="#cb47-43"></a><span class="fu">library</span>(mosaic) <span class="co"># Our workhorse for stats, sampling</span></span>
<span id="cb47-44"><a href="#cb47-44"></a><span class="fu">library</span>(ggformula) <span class="co"># Formula interface for graphs</span></span>
<span id="cb47-45"><a href="#cb47-45"></a></span>
<span id="cb47-46"><a href="#cb47-46"></a><span class="co"># load the NHANES data library</span></span>
<span id="cb47-47"><a href="#cb47-47"></a><span class="fu">library</span>(NHANES)</span>
<span id="cb47-48"><a href="#cb47-48"></a></span>
<span id="cb47-49"><a href="#cb47-49"></a><span class="fu">library</span>(infer) <span class="co"># tidy workflow for statistical inference</span></span>
<span id="cb47-50"><a href="#cb47-50"></a><span class="fu">library</span>(gt) <span class="co"># Create tidy tables to report data</span></span>
<span id="cb47-51"><a href="#cb47-51"></a><span class="fu">library</span>(cowplot) <span class="co"># ggplot themes and stacking of plots</span></span>
<span id="cb47-52"><a href="#cb47-52"></a></span>
<span id="cb47-53"><a href="#cb47-53"></a></span>
<span id="cb47-54"><a href="#cb47-54"></a><span class="in">```</span></span>
<span id="cb47-55"><a href="#cb47-55"></a></span>
<span id="cb47-56"><a href="#cb47-56"></a><span class="in">```{r,echo=FALSE, eval = FALSE, fig.align='center',fig.alt="Photo by Anirudh on unsplash"}</span></span>
<span id="cb47-57"><a href="#cb47-57"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"featured.jpg"</span>)</span>
<span id="cb47-58"><a href="#cb47-58"></a></span>
<span id="cb47-59"><a href="#cb47-59"></a><span class="in">```</span></span>
<span id="cb47-60"><a href="#cb47-60"></a></span>
<span id="cb47-61"><a href="#cb47-61"></a><span class="fu">## What is a Population?</span></span>
<span id="cb47-62"><a href="#cb47-62"></a></span>
<span id="cb47-63"><a href="#cb47-63"></a>A *population* is a collection of individuals or observations we are</span>
<span id="cb47-64"><a href="#cb47-64"></a>interested in. This is also commonly denoted as a study population. We</span>
<span id="cb47-65"><a href="#cb47-65"></a>mathematically denote the population's size using upper-case <span class="in">`N`</span>.</span>
<span id="cb47-66"><a href="#cb47-66"></a></span>
<span id="cb47-67"><a href="#cb47-67"></a>A *population parameter* is some numerical summary about the population</span>
<span id="cb47-68"><a href="#cb47-68"></a>that is unknown but you wish you knew. For example, when this quantity</span>
<span id="cb47-69"><a href="#cb47-69"></a>is a mean like the average height of all Bangaloreans, the population</span>
<span id="cb47-70"><a href="#cb47-70"></a>parameter of interest is the population mean.</span>
<span id="cb47-71"><a href="#cb47-71"></a></span>
<span id="cb47-72"><a href="#cb47-72"></a>A *census* is an exhaustive enumeration or counting of all N individuals</span>
<span id="cb47-73"><a href="#cb47-73"></a>in the population. We do this in order to compute the population</span>
<span id="cb47-74"><a href="#cb47-74"></a>parameter's value exactly. Of note is that as the number N of</span>
<span id="cb47-75"><a href="#cb47-75"></a>individuals in our population increases, conducting a census gets more</span>
<span id="cb47-76"><a href="#cb47-76"></a>expensive (in terms of time, energy, and money).</span>
<span id="cb47-77"><a href="#cb47-77"></a></span>
<span id="cb47-78"><a href="#cb47-78"></a><span class="fu">## What is a Sample?</span></span>
<span id="cb47-79"><a href="#cb47-79"></a></span>
<span id="cb47-80"><a href="#cb47-80"></a>Sampling is the act of collecting a sample from the population, which we</span>
<span id="cb47-81"><a href="#cb47-81"></a>generally do when we can't perform a census. We mathematically denote</span>
<span id="cb47-82"><a href="#cb47-82"></a>the sample size using lower case <span class="in">`n`</span>, as opposed to upper case N which</span>
<span id="cb47-83"><a href="#cb47-83"></a>denotes the population's size. Typically the sample size n is much</span>
<span id="cb47-84"><a href="#cb47-84"></a>smaller than the population size N. Thus sampling is a much cheaper</span>
<span id="cb47-85"><a href="#cb47-85"></a>alternative than performing a census.</span>
<span id="cb47-86"><a href="#cb47-86"></a></span>
<span id="cb47-87"><a href="#cb47-87"></a>A **sample statistic**, also known as a *point estimate*, is a summary</span>
<span id="cb47-88"><a href="#cb47-88"></a>statistic like a mean or standard deviation that is computed from a</span>
<span id="cb47-89"><a href="#cb47-89"></a>sample.</span>
<span id="cb47-90"><a href="#cb47-90"></a></span>
<span id="cb47-91"><a href="#cb47-91"></a><span class="fu">## Why do we sample?</span></span>
<span id="cb47-92"><a href="#cb47-92"></a></span>
<span id="cb47-93"><a href="#cb47-93"></a>Because we cannot conduct a census ( not always ) --- and sometimes we</span>
<span id="cb47-94"><a href="#cb47-94"></a>won't even know how big the population is --- we take samples. And we</span>
<span id="cb47-95"><a href="#cb47-95"></a>*still* want to do useful work for/with the population, after</span>
<span id="cb47-96"><a href="#cb47-96"></a>*estimating its parameters, an act of generalizing* from sample to</span>
<span id="cb47-97"><a href="#cb47-97"></a>population. So the question is, **can we estimate useful parameters of</span>
<span id="cb47-98"><a href="#cb47-98"></a>the population, using just samples? Can point estimates serve as useful</span>
<span id="cb47-99"><a href="#cb47-99"></a>guides to population parameters?**</span>
<span id="cb47-100"><a href="#cb47-100"></a></span>
<span id="cb47-101"><a href="#cb47-101"></a>This act of generalizing from sample to population is at the heart of</span>
<span id="cb47-102"><a href="#cb47-102"></a>**statistical inference**.</span>
<span id="cb47-103"><a href="#cb47-103"></a></span>
<span id="cb47-104"><a href="#cb47-104"></a>NOTE: there is an *alliterative mnemonic* here: **S**amples have</span>
<span id="cb47-105"><a href="#cb47-105"></a>**S**tatistics; **P**opulations have **P**arameters.</span>
<span id="cb47-106"><a href="#cb47-106"></a></span>
<span id="cb47-107"><a href="#cb47-107"></a><span class="fu">## Sampling</span></span>
<span id="cb47-108"><a href="#cb47-108"></a></span>
<span id="cb47-109"><a href="#cb47-109"></a>We will first execute some samples from a known dataset. We load up the</span>
<span id="cb47-110"><a href="#cb47-110"></a>NHANES dataset and inspect it.</span>
<span id="cb47-111"><a href="#cb47-111"></a></span>
<span id="cb47-114"><a href="#cb47-114"></a><span class="in">```{r}</span></span>
<span id="cb47-115"><a href="#cb47-115"></a><span class="fu">data</span>(<span class="st">"NHANES"</span>)</span>
<span id="cb47-116"><a href="#cb47-116"></a>mosaic<span class="sc">::</span><span class="fu">inspect</span>(NHANES)</span>
<span id="cb47-117"><a href="#cb47-117"></a></span>
<span id="cb47-118"><a href="#cb47-118"></a><span class="in">```</span></span>
<span id="cb47-119"><a href="#cb47-119"></a></span>
<span id="cb47-120"><a href="#cb47-120"></a>Let us create a NHANES dataset without duplicated IDs and only adults:</span>
<span id="cb47-121"><a href="#cb47-121"></a></span>
<span id="cb47-124"><a href="#cb47-124"></a><span class="in">```{r}</span></span>
<span id="cb47-125"><a href="#cb47-125"></a>NHANES <span class="ot">&lt;-</span></span>
<span id="cb47-126"><a href="#cb47-126"></a>  NHANES <span class="sc">%&gt;%</span></span>
<span id="cb47-127"><a href="#cb47-127"></a>  <span class="fu">distinct</span>(ID, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) </span>
<span id="cb47-128"><a href="#cb47-128"></a></span>
<span id="cb47-129"><a href="#cb47-129"></a><span class="co">#create a dataset of only adults</span></span>
<span id="cb47-130"><a href="#cb47-130"></a>NHANES_adult <span class="ot">&lt;-</span> </span>
<span id="cb47-131"><a href="#cb47-131"></a>  NHANES <span class="sc">%&gt;%</span></span>
<span id="cb47-132"><a href="#cb47-132"></a>  <span class="fu">filter</span>( </span>
<span id="cb47-133"><a href="#cb47-133"></a>    Age <span class="sc">&gt;=</span> <span class="dv">18</span></span>
<span id="cb47-134"><a href="#cb47-134"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-135"><a href="#cb47-135"></a>  <span class="fu">drop_na</span>(Height)</span>
<span id="cb47-136"><a href="#cb47-136"></a></span>
<span id="cb47-137"><a href="#cb47-137"></a><span class="fu">glimpse</span>(NHANES_adult)</span>
<span id="cb47-138"><a href="#cb47-138"></a></span>
<span id="cb47-139"><a href="#cb47-139"></a><span class="in">```</span></span>
<span id="cb47-140"><a href="#cb47-140"></a></span>
<span id="cb47-141"><a href="#cb47-141"></a>For now, we will **treat** this dataset as our **Population**. So each</span>
<span id="cb47-142"><a href="#cb47-142"></a>variable in the dataset is a population for that particular</span>
<span id="cb47-143"><a href="#cb47-143"></a>quantity/category, with appropriate *population parameters* such as</span>
<span id="cb47-144"><a href="#cb47-144"></a>means, sd-s, and proportions. Let us calculate the **population</span>
<span id="cb47-145"><a href="#cb47-145"></a>parameters** for the <span class="in">`Height`</span> data:</span>
<span id="cb47-146"><a href="#cb47-146"></a></span>
<span id="cb47-149"><a href="#cb47-149"></a><span class="in">```{r}</span></span>
<span id="cb47-150"><a href="#cb47-150"></a>pop_mean_height <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">~</span> Height, <span class="at">data =</span> NHANES_adult)</span>
<span id="cb47-151"><a href="#cb47-151"></a>pop_sd_height <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="sc">~</span> Height, <span class="at">data =</span> NHANES_adult)</span>
<span id="cb47-152"><a href="#cb47-152"></a></span>
<span id="cb47-153"><a href="#cb47-153"></a>pop_mean_height</span>
<span id="cb47-154"><a href="#cb47-154"></a>pop_sd_height</span>
<span id="cb47-155"><a href="#cb47-155"></a></span>
<span id="cb47-156"><a href="#cb47-156"></a><span class="in">```</span></span>
<span id="cb47-157"><a href="#cb47-157"></a></span>
<span id="cb47-158"><a href="#cb47-158"></a>Now, we will sample **ONCE** from the NHANES <span class="in">`Height`</span> variable. Let us</span>
<span id="cb47-159"><a href="#cb47-159"></a>take a sample of <span class="in">`sample size`</span> 50. We will compare **sample statistics**</span>
<span id="cb47-160"><a href="#cb47-160"></a>with **population parameters** on the basis of this ONE sample of 50:</span>
<span id="cb47-161"><a href="#cb47-161"></a></span>
<span id="cb47-162"><a href="#cb47-162"></a><span class="in">```{r, fig.cap="Single-Sample Mean and Population Mean", fig.id=TRUE}</span></span>
<span id="cb47-163"><a href="#cb47-163"></a></span>
<span id="cb47-164"><a href="#cb47-164"></a>sample_height <span class="ot">&lt;-</span> <span class="fu">sample</span>(NHANES_adult, <span class="at">size =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Height)</span>
<span id="cb47-165"><a href="#cb47-165"></a>sample_height</span>
<span id="cb47-166"><a href="#cb47-166"></a></span>
<span id="cb47-167"><a href="#cb47-167"></a>sample_mean_height <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">~</span> Height, <span class="at">data =</span> sample_height)</span>
<span id="cb47-168"><a href="#cb47-168"></a>sample_mean_height</span>
<span id="cb47-169"><a href="#cb47-169"></a></span>
<span id="cb47-170"><a href="#cb47-170"></a><span class="co"># Plotting the histogram of this sample</span></span>
<span id="cb47-171"><a href="#cb47-171"></a>sample_height <span class="sc">%&gt;%</span> <span class="fu">gf_histogram</span>(<span class="sc">~</span> Height) <span class="sc">%&gt;%</span> </span>
<span id="cb47-172"><a href="#cb47-172"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> sample_mean_height, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-173"><a href="#cb47-173"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> pop_mean_height, <span class="at">colour =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-174"><a href="#cb47-174"></a>  <span class="fu">gf_text</span>(<span class="dv">1</span> <span class="sc">~</span> (pop_mean_height <span class="sc">+</span> <span class="dv">5</span>), <span class="at">label =</span> <span class="st">"Population Mean Height"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-175"><a href="#cb47-175"></a>  <span class="fu">gf_text</span>(<span class="dv">2</span> <span class="sc">~</span> (sample_mean_height<span class="dv">-5</span>), <span class="at">label =</span> <span class="st">"Sample Mean Height"</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb47-176"><a href="#cb47-176"></a></span>
<span id="cb47-177"><a href="#cb47-177"></a><span class="in">```</span></span>
<span id="cb47-178"><a href="#cb47-178"></a></span>
<span id="cb47-179"><a href="#cb47-179"></a>OK, so the <span class="in">`sample_mean_height`</span> is not too far from the</span>
<span id="cb47-180"><a href="#cb47-180"></a><span class="in">`pop_mean_height`</span>. Is this always true? Let us check: we will create 500</span>
<span id="cb47-181"><a href="#cb47-181"></a>samples each of size 50. And calculate their mean as the *sample</span>
<span id="cb47-182"><a href="#cb47-182"></a>statistic*, giving us a dataframe containing 5000 <span class="in">`sample means`</span>. We</span>
<span id="cb47-183"><a href="#cb47-183"></a>will then compare if these 500 means are close to the <span class="in">`pop_mean_height`</span>:</span>
<span id="cb47-184"><a href="#cb47-184"></a></span>
<span id="cb47-185"><a href="#cb47-185"></a><span class="in">```{r,fig.cap="Multiple Sample-Means and Population Mean", fig.id=TRUE}</span></span>
<span id="cb47-186"><a href="#cb47-186"></a></span>
<span id="cb47-187"><a href="#cb47-187"></a>sample_height_500 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">500</span>) <span class="sc">*</span> {</span>
<span id="cb47-188"><a href="#cb47-188"></a>  <span class="fu">sample</span>(NHANES_adult, <span class="at">size =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-189"><a href="#cb47-189"></a>    <span class="fu">select</span>(Height) <span class="sc">%&gt;%</span></span>
<span id="cb47-190"><a href="#cb47-190"></a>    <span class="fu">summarise</span>(</span>
<span id="cb47-191"><a href="#cb47-191"></a>      <span class="at">sample_mean_500 =</span> <span class="fu">mean</span>(Height),</span>
<span id="cb47-192"><a href="#cb47-192"></a>      <span class="at">sample_min_500 =</span> <span class="fu">min</span>(Height),</span>
<span id="cb47-193"><a href="#cb47-193"></a>      <span class="at">sample_max_500 =</span> <span class="fu">max</span>(Height))</span>
<span id="cb47-194"><a href="#cb47-194"></a>}</span>
<span id="cb47-195"><a href="#cb47-195"></a></span>
<span id="cb47-196"><a href="#cb47-196"></a><span class="fu">head</span>(sample_height_500)</span>
<span id="cb47-197"><a href="#cb47-197"></a><span class="fu">dim</span>(sample_height_500)</span>
<span id="cb47-198"><a href="#cb47-198"></a></span>
<span id="cb47-199"><a href="#cb47-199"></a>sample_height_500 <span class="sc">%&gt;%</span></span>
<span id="cb47-200"><a href="#cb47-200"></a>  <span class="fu">gf_point</span>(.index <span class="sc">~</span> sample_mean_500, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-201"><a href="#cb47-201"></a>  <span class="fu">gf_segment</span>(</span>
<span id="cb47-202"><a href="#cb47-202"></a>    .index <span class="sc">+</span> .index <span class="sc">~</span> sample_min_500 <span class="sc">+</span> sample_max_500,</span>
<span id="cb47-203"><a href="#cb47-203"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb47-204"><a href="#cb47-204"></a>    <span class="at">size =</span> <span class="fl">0.3</span>,</span>
<span id="cb47-205"><a href="#cb47-205"></a>    <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb47-206"><a href="#cb47-206"></a>    <span class="at">ylab =</span> <span class="st">"Sample Index (1-500)"</span>,</span>
<span id="cb47-207"><a href="#cb47-207"></a>    <span class="at">xlab =</span> <span class="st">"Sample Means"</span></span>
<span id="cb47-208"><a href="#cb47-208"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-209"><a href="#cb47-209"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> <span class="sc">~</span> pop_mean_height, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-210"><a href="#cb47-210"></a>  <span class="fu">gf_label</span>(<span class="sc">-</span><span class="dv">15</span> <span class="sc">~</span> pop_mean_height, <span class="at">label =</span> <span class="st">"Population Mean"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb47-211"><a href="#cb47-211"></a></span>
<span id="cb47-212"><a href="#cb47-212"></a><span class="in">```</span></span>
<span id="cb47-213"><a href="#cb47-213"></a></span>
<span id="cb47-214"><a href="#cb47-214"></a>The <span class="in">`sample_mean`</span>s (red dots), are themselves random because the samples</span>
<span id="cb47-215"><a href="#cb47-215"></a>are random, of course. It appears that they are generally in the</span>
<span id="cb47-216"><a href="#cb47-216"></a>vicinity of the <span class="in">`pop_mean`</span> (blue line).</span>
<span id="cb47-217"><a href="#cb47-217"></a></span>
<span id="cb47-218"><a href="#cb47-218"></a><span class="fu">### Distribution of Sample-Means</span></span>
<span id="cb47-219"><a href="#cb47-219"></a></span>
<span id="cb47-220"><a href="#cb47-220"></a>Since the **sample-means** are themselves random variables, let's plot</span>
<span id="cb47-221"><a href="#cb47-221"></a>the **distribution** of these 5000 sample-means themselves, called a **a</span>
<span id="cb47-222"><a href="#cb47-222"></a>distribution of sample-means**.</span>
<span id="cb47-223"><a href="#cb47-223"></a></span>
<span id="cb47-224"><a href="#cb47-224"></a>::: Note</span>
<span id="cb47-225"><a href="#cb47-225"></a>NOTE: this **a distribution of sample-means** will *itself* have a mean</span>
<span id="cb47-226"><a href="#cb47-226"></a>and standard deviation. Do not get confused ;-D</span>
<span id="cb47-227"><a href="#cb47-227"></a>:::</span>
<span id="cb47-228"><a href="#cb47-228"></a></span>
<span id="cb47-229"><a href="#cb47-229"></a>We will also plot the position of the population mean <span class="in">`pop_mean_height`</span></span>
<span id="cb47-230"><a href="#cb47-230"></a>parameter, the means of the <span class="in">`Height`</span> variable.</span>
<span id="cb47-231"><a href="#cb47-231"></a></span>
<span id="cb47-232"><a href="#cb47-232"></a><span class="in">```{r,Sampling-Mean-Distribution, fig.width=8,fig.height=4,out.height='50%', fig.cap="Sampling Mean Distribution", fig.id=TRUE}</span></span>
<span id="cb47-233"><a href="#cb47-233"></a></span>
<span id="cb47-234"><a href="#cb47-234"></a>sample_height_500 <span class="sc">%&gt;%</span> <span class="fu">gf_dhistogram</span>(<span class="sc">~</span> sample_mean_500) <span class="sc">%&gt;%</span> </span>
<span id="cb47-235"><a href="#cb47-235"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> pop_mean_height, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-236"><a href="#cb47-236"></a>   <span class="fu">gf_label</span>(<span class="fl">0.01</span> <span class="sc">~</span> pop_mean_height, <span class="at">label =</span> <span class="st">"Population Mean"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb47-237"><a href="#cb47-237"></a></span>
<span id="cb47-238"><a href="#cb47-238"></a><span class="in">```</span></span>
<span id="cb47-239"><a href="#cb47-239"></a></span>
<span id="cb47-240"><a href="#cb47-240"></a>How does this **distribution of sample-means** compare with that of the</span>
<span id="cb47-241"><a href="#cb47-241"></a>overall distribution of the population?</span>
<span id="cb47-242"><a href="#cb47-242"></a></span>
<span id="cb47-243"><a href="#cb47-243"></a><span class="in">```{r, fig.cap="Sampling Means and Population Distributions", fig.id=TRUE}</span></span>
<span id="cb47-244"><a href="#cb47-244"></a></span>
<span id="cb47-245"><a href="#cb47-245"></a>sample_height_500 <span class="sc">%&gt;%</span> <span class="fu">gf_dhistogram</span>(<span class="sc">~</span> sample_mean_500) <span class="sc">%&gt;%</span> </span>
<span id="cb47-246"><a href="#cb47-246"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> pop_mean_height, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-247"><a href="#cb47-247"></a>   <span class="fu">gf_label</span>(<span class="fl">0.01</span> <span class="sc">~</span> pop_mean_height, <span class="at">label =</span> <span class="st">"Population Mean"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-248"><a href="#cb47-248"></a></span>
<span id="cb47-249"><a href="#cb47-249"></a>  <span class="do">## Add the population histogram</span></span>
<span id="cb47-250"><a href="#cb47-250"></a>  <span class="fu">gf_histogram</span>(<span class="sc">~</span> Height, <span class="at">data =</span> NHANES_adult, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-251"><a href="#cb47-251"></a>  <span class="fu">gf_label</span>(<span class="fl">0.025</span> <span class="sc">~</span> (pop_mean_height <span class="sc">+</span> <span class="dv">20</span>), <span class="at">label =</span> <span class="st">"Population Distribution"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb47-252"><a href="#cb47-252"></a></span>
<span id="cb47-253"><a href="#cb47-253"></a></span>
<span id="cb47-254"><a href="#cb47-254"></a><span class="in">```</span></span>
<span id="cb47-255"><a href="#cb47-255"></a></span>
<span id="cb47-256"><a href="#cb47-256"></a><span class="fu">### Central limit theorem</span></span>
<span id="cb47-257"><a href="#cb47-257"></a></span>
<span id="cb47-258"><a href="#cb47-258"></a>We see in the Figure above that</span>
<span id="cb47-259"><a href="#cb47-259"></a></span>
<span id="cb47-260"><a href="#cb47-260"></a><span class="ss">-   </span>the *distribution of sample-means* is centered around mean =</span>
<span id="cb47-261"><a href="#cb47-261"></a>    <span class="in">`pop_mean`</span>.</span>
<span id="cb47-262"><a href="#cb47-262"></a></span>
<span id="cb47-263"><a href="#cb47-263"></a><span class="ss">-   </span>That the standard deviation of the *distribution of sample means* is</span>
<span id="cb47-264"><a href="#cb47-264"></a>    less than that of the original population. But exactly what is it?</span>
<span id="cb47-265"><a href="#cb47-265"></a></span>
<span id="cb47-266"><a href="#cb47-266"></a><span class="ss">-   </span>And what is the kind of distribution?</span>
<span id="cb47-267"><a href="#cb47-267"></a></span>
<span id="cb47-268"><a href="#cb47-268"></a>One more experiment.</span>
<span id="cb47-269"><a href="#cb47-269"></a></span>
<span id="cb47-270"><a href="#cb47-270"></a>Now let's repeatedly sample <span class="in">`Height`</span> and compute the sample mean, and</span>
<span id="cb47-271"><a href="#cb47-271"></a>look at the resulting histograms and Q-Q plots. ( Q-Q plots check</span>
<span id="cb47-272"><a href="#cb47-272"></a>whether a certain distribution is close to being normal or not.)</span>
<span id="cb47-273"><a href="#cb47-273"></a></span>
<span id="cb47-274"><a href="#cb47-274"></a>We will use sample sizes of <span class="in">`c(16, 32, 64, 128)`</span> and generate 1000</span>
<span id="cb47-275"><a href="#cb47-275"></a>samples each time, take the means and plot these 1000 means:</span>
<span id="cb47-276"><a href="#cb47-276"></a></span>
<span id="cb47-279"><a href="#cb47-279"></a><span class="in">```{r}</span></span>
<span id="cb47-280"><a href="#cb47-280"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb47-281"><a href="#cb47-281"></a></span>
<span id="cb47-282"><a href="#cb47-282"></a></span>
<span id="cb47-283"><a href="#cb47-283"></a>samples_height_16 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1000</span>,) <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">resample</span>(NHANES_adult<span class="sc">$</span>Height, <span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb47-284"><a href="#cb47-284"></a>samples_height_32 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1000</span>) <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">resample</span>(NHANES_adult<span class="sc">$</span>Height, <span class="at">size =</span> <span class="dv">32</span>))</span>
<span id="cb47-285"><a href="#cb47-285"></a>samples_height_64 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1000</span>) <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">resample</span>(NHANES_adult<span class="sc">$</span>Height, <span class="at">size =</span> <span class="dv">64</span>))</span>
<span id="cb47-286"><a href="#cb47-286"></a>samples_height_128 <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1000</span>) <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">resample</span>(NHANES_adult<span class="sc">$</span>Height, <span class="at">size =</span> <span class="dv">128</span>))</span>
<span id="cb47-287"><a href="#cb47-287"></a></span>
<span id="cb47-288"><a href="#cb47-288"></a><span class="co"># Quick Check</span></span>
<span id="cb47-289"><a href="#cb47-289"></a><span class="fu">head</span>(samples_height_16)</span>
<span id="cb47-290"><a href="#cb47-290"></a></span>
<span id="cb47-291"><a href="#cb47-291"></a><span class="do">### do(1000,) * mean(resample(NHANES_adult$Height, size = 16)) produces a data frame with a variable named mean.</span></span>
<span id="cb47-292"><a href="#cb47-292"></a><span class="do">###</span></span>
<span id="cb47-293"><a href="#cb47-293"></a></span>
<span id="cb47-294"><a href="#cb47-294"></a><span class="in">```</span></span>
<span id="cb47-295"><a href="#cb47-295"></a></span>
<span id="cb47-296"><a href="#cb47-296"></a>Now let's create separate Q-Q plots for the different sample sizes.</span>
<span id="cb47-297"><a href="#cb47-297"></a></span>
<span id="cb47-298"><a href="#cb47-298"></a><span class="in">```{r,echo=FALSE, warning=FALSE}</span></span>
<span id="cb47-299"><a href="#cb47-299"></a></span>
<span id="cb47-300"><a href="#cb47-300"></a></span>
<span id="cb47-301"><a href="#cb47-301"></a><span class="co"># Now let's create separate Q-Q plots for the different sample sizes.</span></span>
<span id="cb47-302"><a href="#cb47-302"></a><span class="co">#</span></span>
<span id="cb47-303"><a href="#cb47-303"></a>p1 <span class="ot">&lt;-</span> <span class="fu">gf_qq</span>( <span class="sc">~</span> mean,<span class="at">data =</span> samples_height_16,<span class="at">title =</span> <span class="st">"N = 16"</span>, <span class="at">color =</span> <span class="st">"cornsilk"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-304"><a href="#cb47-304"></a>  <span class="fu">gf_qqline</span>()</span>
<span id="cb47-305"><a href="#cb47-305"></a></span>
<span id="cb47-306"><a href="#cb47-306"></a>p2 <span class="ot">&lt;-</span><span class="fu">gf_qq</span>( <span class="sc">~</span> mean,<span class="at">data =</span> samples_height_32,<span class="at">title =</span> <span class="st">"N = 32"</span>, <span class="at">color =</span> <span class="st">"sienna"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-307"><a href="#cb47-307"></a>  <span class="fu">gf_qqline</span>()</span>
<span id="cb47-308"><a href="#cb47-308"></a></span>
<span id="cb47-309"><a href="#cb47-309"></a>p3 <span class="ot">&lt;-</span><span class="fu">gf_qq</span>( <span class="sc">~</span> mean,<span class="at">data =</span> samples_height_32,<span class="at">title =</span> <span class="st">"N = 64"</span>, <span class="at">color =</span> <span class="st">"tomato2"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-310"><a href="#cb47-310"></a>  <span class="fu">gf_qqline</span>()</span>
<span id="cb47-311"><a href="#cb47-311"></a></span>
<span id="cb47-312"><a href="#cb47-312"></a>p4 <span class="ot">&lt;-</span><span class="fu">gf_qq</span>( <span class="sc">~</span> mean,<span class="at">data =</span> samples_height_128,<span class="at">title =</span> <span class="st">"N = 128"</span>, <span class="at">color =</span> <span class="st">"violetred"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-313"><a href="#cb47-313"></a>  <span class="fu">gf_qqline</span>()</span>
<span id="cb47-314"><a href="#cb47-314"></a></span>
<span id="cb47-315"><a href="#cb47-315"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1, p2, p3, p4)</span>
<span id="cb47-316"><a href="#cb47-316"></a></span>
<span id="cb47-317"><a href="#cb47-317"></a><span class="in">```</span></span>
<span id="cb47-318"><a href="#cb47-318"></a></span>
<span id="cb47-319"><a href="#cb47-319"></a>Let us plot their individual histograms to compare them:</span>
<span id="cb47-320"><a href="#cb47-320"></a></span>
<span id="cb47-321"><a href="#cb47-321"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb47-322"><a href="#cb47-322"></a></span>
<span id="cb47-323"><a href="#cb47-323"></a><span class="co"># Let us overlay their individual histograms to compare them:</span></span>
<span id="cb47-324"><a href="#cb47-324"></a>p5 <span class="ot">&lt;-</span> <span class="fu">gf_dhistogram</span>(<span class="sc">~</span> mean,</span>
<span id="cb47-325"><a href="#cb47-325"></a>              <span class="at">data =</span> samples_height_16,</span>
<span id="cb47-326"><a href="#cb47-326"></a>              <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb47-327"><a href="#cb47-327"></a>              <span class="at">fill =</span> <span class="st">"cornsilk"</span>,<span class="at">title =</span> <span class="st">"N = 16"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-328"><a href="#cb47-328"></a>  <span class="fu">gf_fitdistr</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-329"><a href="#cb47-329"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> pop_mean_height,</span>
<span id="cb47-330"><a href="#cb47-330"></a>           <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-331"><a href="#cb47-331"></a>  <span class="fu">gf_label</span>(<span class="sc">-</span><span class="fl">0.01</span> <span class="sc">~</span> pop_mean_height, <span class="at">label =</span> <span class="st">"Population Mean"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb47-332"><a href="#cb47-332"></a></span>
<span id="cb47-333"><a href="#cb47-333"></a>p6 <span class="ot">&lt;-</span> <span class="fu">gf_dhistogram</span>(<span class="sc">~</span> mean,</span>
<span id="cb47-334"><a href="#cb47-334"></a>              <span class="at">data =</span> samples_height_32 ,</span>
<span id="cb47-335"><a href="#cb47-335"></a>              <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb47-336"><a href="#cb47-336"></a>              <span class="at">fill =</span> <span class="st">"sienna"</span>,<span class="at">title =</span> <span class="st">"N = 32"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-337"><a href="#cb47-337"></a>  <span class="fu">gf_fitdistr</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-338"><a href="#cb47-338"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> pop_mean_height,</span>
<span id="cb47-339"><a href="#cb47-339"></a>           <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-340"><a href="#cb47-340"></a>  <span class="fu">gf_label</span>(<span class="sc">-</span>.<span class="dv">01</span> <span class="sc">~</span> pop_mean_height, <span class="at">label =</span> <span class="st">"Population Mean"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb47-341"><a href="#cb47-341"></a></span>
<span id="cb47-342"><a href="#cb47-342"></a>p7 <span class="ot">&lt;-</span> <span class="fu">gf_dhistogram</span>(</span>
<span id="cb47-343"><a href="#cb47-343"></a>  <span class="sc">~</span> mean,</span>
<span id="cb47-344"><a href="#cb47-344"></a>  <span class="at">data =</span> samples_height_64 ,</span>
<span id="cb47-345"><a href="#cb47-345"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-346"><a href="#cb47-346"></a>  <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb47-347"><a href="#cb47-347"></a>  <span class="at">fill =</span> <span class="st">"tomato2"</span>,<span class="at">title =</span> <span class="st">"N = 64"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-348"><a href="#cb47-348"></a>  <span class="fu">gf_fitdistr</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-349"><a href="#cb47-349"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> pop_mean_height,</span>
<span id="cb47-350"><a href="#cb47-350"></a>           <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-351"><a href="#cb47-351"></a>  <span class="fu">gf_label</span>(<span class="sc">-</span>.<span class="dv">01</span> <span class="sc">~</span> pop_mean_height, <span class="at">label =</span> <span class="st">"Population Mean"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb47-352"><a href="#cb47-352"></a></span>
<span id="cb47-353"><a href="#cb47-353"></a>p8 <span class="ot">&lt;-</span> <span class="fu">gf_dhistogram</span>(</span>
<span id="cb47-354"><a href="#cb47-354"></a>  <span class="sc">~</span> mean,</span>
<span id="cb47-355"><a href="#cb47-355"></a>  <span class="at">data =</span> samples_height_128 ,</span>
<span id="cb47-356"><a href="#cb47-356"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-357"><a href="#cb47-357"></a>  <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb47-358"><a href="#cb47-358"></a>  <span class="at">fill =</span> <span class="st">"violetred"</span>,<span class="at">title =</span> <span class="st">"N = 128"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-359"><a href="#cb47-359"></a>  <span class="fu">gf_fitdistr</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-360"><a href="#cb47-360"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> pop_mean_height,</span>
<span id="cb47-361"><a href="#cb47-361"></a>         <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-362"><a href="#cb47-362"></a>  <span class="fu">gf_label</span>(<span class="sc">-</span>.<span class="dv">01</span> <span class="sc">~</span> pop_mean_height, <span class="at">label =</span> <span class="st">"Population Mean"</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb47-363"><a href="#cb47-363"></a></span>
<span id="cb47-364"><a href="#cb47-364"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p5,p6,p7,p8)</span>
<span id="cb47-365"><a href="#cb47-365"></a></span>
<span id="cb47-366"><a href="#cb47-366"></a></span>
<span id="cb47-367"><a href="#cb47-367"></a><span class="in">```</span></span>
<span id="cb47-368"><a href="#cb47-368"></a></span>
<span id="cb47-369"><a href="#cb47-369"></a>And if we overlay the histograms:</span>
<span id="cb47-370"><a href="#cb47-370"></a></span>
<span id="cb47-371"><a href="#cb47-371"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb47-372"><a href="#cb47-372"></a><span class="fu">gf_dhistogram</span>(<span class="sc">~</span> mean,</span>
<span id="cb47-373"><a href="#cb47-373"></a>              <span class="at">data =</span> samples_height_16,</span>
<span id="cb47-374"><a href="#cb47-374"></a>              <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb47-375"><a href="#cb47-375"></a>              <span class="at">fill =</span> <span class="st">"cornsilk"</span>,<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-376"><a href="#cb47-376"></a></span>
<span id="cb47-377"><a href="#cb47-377"></a><span class="fu">gf_dhistogram</span>(<span class="sc">~</span> mean,</span>
<span id="cb47-378"><a href="#cb47-378"></a>              <span class="at">data =</span> samples_height_32,</span>
<span id="cb47-379"><a href="#cb47-379"></a>              <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb47-380"><a href="#cb47-380"></a>              <span class="at">fill =</span> <span class="st">"sienna"</span>,<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-381"><a href="#cb47-381"></a></span>
<span id="cb47-382"><a href="#cb47-382"></a><span class="fu">gf_dhistogram</span>(<span class="sc">~</span> mean,</span>
<span id="cb47-383"><a href="#cb47-383"></a>              <span class="at">data =</span> samples_height_64,</span>
<span id="cb47-384"><a href="#cb47-384"></a>              <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb47-385"><a href="#cb47-385"></a>              <span class="at">fill =</span> <span class="st">"tomato2"</span>,<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-386"><a href="#cb47-386"></a></span>
<span id="cb47-387"><a href="#cb47-387"></a><span class="fu">gf_dhistogram</span>(<span class="sc">~</span> mean,</span>
<span id="cb47-388"><a href="#cb47-388"></a>              <span class="at">data =</span> samples_height_128,</span>
<span id="cb47-389"><a href="#cb47-389"></a>              <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb47-390"><a href="#cb47-390"></a>              <span class="at">fill =</span> <span class="st">"violetred"</span>,<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-391"><a href="#cb47-391"></a></span>
<span id="cb47-392"><a href="#cb47-392"></a><span class="fu">gf_fitdistr</span>(</span>
<span id="cb47-393"><a href="#cb47-393"></a>  <span class="sc">~</span> mean,</span>
<span id="cb47-394"><a href="#cb47-394"></a>  <span class="at">data =</span> samples_height_16,</span>
<span id="cb47-395"><a href="#cb47-395"></a>  <span class="at">color =</span> <span class="st">"cornsilk"</span>,<span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb47-396"><a href="#cb47-396"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb47-397"><a href="#cb47-397"></a>  </span>
<span id="cb47-398"><a href="#cb47-398"></a>  <span class="fu">gf_fitdistr</span>(</span>
<span id="cb47-399"><a href="#cb47-399"></a>    <span class="sc">~</span> mean,</span>
<span id="cb47-400"><a href="#cb47-400"></a>    <span class="at">data =</span> samples_height_32 ,</span>
<span id="cb47-401"><a href="#cb47-401"></a>    <span class="at">color =</span> <span class="st">"sienna"</span>,<span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb47-402"><a href="#cb47-402"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-403"><a href="#cb47-403"></a>  </span>
<span id="cb47-404"><a href="#cb47-404"></a>  <span class="fu">gf_fitdistr</span>(</span>
<span id="cb47-405"><a href="#cb47-405"></a>    <span class="sc">~</span> mean,</span>
<span id="cb47-406"><a href="#cb47-406"></a>    <span class="at">data =</span> samples_height_64 ,</span>
<span id="cb47-407"><a href="#cb47-407"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-408"><a href="#cb47-408"></a>    <span class="at">color =</span> <span class="st">"tomato2"</span>,<span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb47-409"><a href="#cb47-409"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-410"><a href="#cb47-410"></a>  </span>
<span id="cb47-411"><a href="#cb47-411"></a>  <span class="fu">gf_fitdistr</span>(</span>
<span id="cb47-412"><a href="#cb47-412"></a>    <span class="sc">~</span> mean,</span>
<span id="cb47-413"><a href="#cb47-413"></a>    <span class="at">data =</span> samples_height_128 ,</span>
<span id="cb47-414"><a href="#cb47-414"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-415"><a href="#cb47-415"></a>    <span class="at">color =</span> <span class="st">"violetred"</span>, <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb47-416"><a href="#cb47-416"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-417"><a href="#cb47-417"></a>  </span>
<span id="cb47-418"><a href="#cb47-418"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> pop_mean_height,</span>
<span id="cb47-419"><a href="#cb47-419"></a>           <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-420"><a href="#cb47-420"></a>  <span class="fu">gf_label</span>(<span class="sc">-</span>.<span class="dv">02</span> <span class="sc">~</span> pop_mean_height, <span class="at">label =</span> <span class="st">"Population Mean"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">%&gt;%</span> <span class="fu">gf_theme</span>(ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>())</span>
<span id="cb47-421"><a href="#cb47-421"></a></span>
<span id="cb47-422"><a href="#cb47-422"></a><span class="in">```</span></span>
<span id="cb47-423"><a href="#cb47-423"></a></span>
<span id="cb47-424"><a href="#cb47-424"></a>This shows that the results become more normally distributed (i.e.</span>
<span id="cb47-425"><a href="#cb47-425"></a>following the straight line) as the samples get larger. Hence we learn</span>
<span id="cb47-426"><a href="#cb47-426"></a>that:</span>
<span id="cb47-427"><a href="#cb47-427"></a></span>
<span id="cb47-428"><a href="#cb47-428"></a><span class="ss">-   </span>the sample-means are normally distributed around the *population</span>
<span id="cb47-429"><a href="#cb47-429"></a>    mean*. This is because when we sample from the population, many</span>
<span id="cb47-430"><a href="#cb47-430"></a>    values will be close to the *population mean*, and values far away</span>
<span id="cb47-431"><a href="#cb47-431"></a>    from the mean will be increasingly scarce.</span>
<span id="cb47-432"><a href="#cb47-432"></a></span>
<span id="cb47-435"><a href="#cb47-435"></a><span class="in">```{r}</span></span>
<span id="cb47-436"><a href="#cb47-436"></a><span class="fu">mean</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_16)</span>
<span id="cb47-437"><a href="#cb47-437"></a><span class="fu">mean</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_32)</span>
<span id="cb47-438"><a href="#cb47-438"></a><span class="fu">mean</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_64)</span>
<span id="cb47-439"><a href="#cb47-439"></a><span class="fu">mean</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_128)</span>
<span id="cb47-440"><a href="#cb47-440"></a>pop_mean_height</span>
<span id="cb47-441"><a href="#cb47-441"></a></span>
<span id="cb47-442"><a href="#cb47-442"></a><span class="in">```</span></span>
<span id="cb47-443"><a href="#cb47-443"></a></span>
<span id="cb47-444"><a href="#cb47-444"></a><span class="ss">-   </span>the sample-means become "more normally distributed" with sample</span>
<span id="cb47-445"><a href="#cb47-445"></a>    length, as shown by the (small but definite) improvements in the Q-Q</span>
<span id="cb47-446"><a href="#cb47-446"></a>    plots with sample-size.</span>
<span id="cb47-447"><a href="#cb47-447"></a></span>
<span id="cb47-448"><a href="#cb47-448"></a><span class="ss">-   </span>the sample-mean distributions narrow with sample length.</span>
<span id="cb47-449"><a href="#cb47-449"></a></span>
<span id="cb47-450"><a href="#cb47-450"></a>This is regardless of the distribution of the *population* itself. ( The</span>
<span id="cb47-451"><a href="#cb47-451"></a><span class="in">`Height`</span> variable seems to be normally distributed at population level.</span>
<span id="cb47-452"><a href="#cb47-452"></a>We will try other non-normal population variables as an exercise). This</span>
<span id="cb47-453"><a href="#cb47-453"></a>is the <span class="sc">\*\*</span> Central Limit Theorem (CLT) <span class="sc">\*\*</span>.</span>
<span id="cb47-454"><a href="#cb47-454"></a></span>
<span id="cb47-455"><a href="#cb47-455"></a>As we saw above, the standard deviations of the sample-mean</span>
<span id="cb47-456"><a href="#cb47-456"></a>distributions reduce with sample size. In fact their SDs are defined by:</span>
<span id="cb47-457"><a href="#cb47-457"></a></span>
<span id="cb47-458"><a href="#cb47-458"></a><span class="in">`sd = pop_sd/sqrt(sample_size)`</span> where sample-size here is one of</span>
<span id="cb47-459"><a href="#cb47-459"></a><span class="in">`c(16,32,64,128)`</span></span>
<span id="cb47-460"><a href="#cb47-460"></a></span>
<span id="cb47-463"><a href="#cb47-463"></a><span class="in">```{r}</span></span>
<span id="cb47-464"><a href="#cb47-464"></a><span class="fu">sd</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_16)</span>
<span id="cb47-465"><a href="#cb47-465"></a><span class="fu">sd</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_32)</span>
<span id="cb47-466"><a href="#cb47-466"></a><span class="fu">sd</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_64)</span>
<span id="cb47-467"><a href="#cb47-467"></a><span class="fu">sd</span>(<span class="sc">~</span> mean, <span class="at">data  =</span> samples_height_128)</span>
<span id="cb47-468"><a href="#cb47-468"></a></span>
<span id="cb47-469"><a href="#cb47-469"></a><span class="in">```</span></span>
<span id="cb47-470"><a href="#cb47-470"></a></span>
<span id="cb47-471"><a href="#cb47-471"></a>The standard deviation of the **sample-mean distribution** is called the</span>
<span id="cb47-472"><a href="#cb47-472"></a>**Standard Error**. This statistic derived from the sample, will help us</span>
<span id="cb47-473"><a href="#cb47-473"></a>infer our population parameters with a precise estimate of the</span>
<span id="cb47-474"><a href="#cb47-474"></a>*uncertainty* involved.</span>
<span id="cb47-475"><a href="#cb47-475"></a></span>
<span id="cb47-476"><a href="#cb47-476"></a>$$</span>
<span id="cb47-477"><a href="#cb47-477"></a>Standard\ Error\ \pmb {se} = \frac{population\ sd}{\sqrt[]{sample\ size}}<span class="sc">\\</span>\</span>
<span id="cb47-478"><a href="#cb47-478"></a>\pmb {se} = \frac{\sigma}{\sqrt[]{n}}</span>
<span id="cb47-479"><a href="#cb47-479"></a>$$</span>
<span id="cb47-480"><a href="#cb47-480"></a></span>
<span id="cb47-481"><a href="#cb47-481"></a>In our sampling experiments, the Standard Errors evaluate to:</span>
<span id="cb47-482"><a href="#cb47-482"></a></span>
<span id="cb47-485"><a href="#cb47-485"></a><span class="in">```{r}</span></span>
<span id="cb47-486"><a href="#cb47-486"></a>pop_sd_height <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="sc">~</span> Height, <span class="at">data =</span> NHANES_adult)</span>
<span id="cb47-487"><a href="#cb47-487"></a></span>
<span id="cb47-488"><a href="#cb47-488"></a>pop_sd_height<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">16</span>)</span>
<span id="cb47-489"><a href="#cb47-489"></a>pop_sd_height<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">32</span>)</span>
<span id="cb47-490"><a href="#cb47-490"></a>pop_sd_height<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">64</span>)</span>
<span id="cb47-491"><a href="#cb47-491"></a>pop_sd_height<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">128</span>)</span>
<span id="cb47-492"><a href="#cb47-492"></a></span>
<span id="cb47-493"><a href="#cb47-493"></a><span class="in">```</span></span>
<span id="cb47-494"><a href="#cb47-494"></a></span>
<span id="cb47-495"><a href="#cb47-495"></a>As seen, these are identical to the Standard Deviations of the</span>
<span id="cb47-496"><a href="#cb47-496"></a>individual sample-mean distributions.</span>
<span id="cb47-497"><a href="#cb47-497"></a></span>
<span id="cb47-498"><a href="#cb47-498"></a><span class="fu">## Confidence intervals</span></span>
<span id="cb47-499"><a href="#cb47-499"></a></span>
<span id="cb47-500"><a href="#cb47-500"></a>When we work with samples, we want to be able to speak with a certain</span>
<span id="cb47-501"><a href="#cb47-501"></a>degree of confidence about the **population mean**, based on the</span>
<span id="cb47-502"><a href="#cb47-502"></a>evaluation of **one** sample mean,not a whole large number of them. Give</span>
<span id="cb47-503"><a href="#cb47-503"></a>that sample-means are normally distributed around the **population</span>
<span id="cb47-504"><a href="#cb47-504"></a>means**, we can say that $68\%$ of *all possible sample-mean* lie within</span>
<span id="cb47-505"><a href="#cb47-505"></a>\$ <span class="sc">\\</span>pm 1 SE\$ of the *population mean*; and further that $95%$ of of</span>
<span id="cb47-506"><a href="#cb47-506"></a>*all possible sample-mean* lie within \$ <span class="sc">\\</span>pm 1.5<span class="sc">\*</span> SE\$ of the</span>
<span id="cb47-507"><a href="#cb47-507"></a>*population mean*.</span>
<span id="cb47-508"><a href="#cb47-508"></a></span>
<span id="cb47-509"><a href="#cb47-509"></a>These two intervals **\[sample-mean +/- SE\]** and **<span class="sc">\[</span>sample-mean +/-</span>
<span id="cb47-510"><a href="#cb47-510"></a>1.5SE<span class="sc">\]</span>** are called the **confidence intervals** for the population</span>
<span id="cb47-511"><a href="#cb47-511"></a>mean, at levels 68% and 95% respectively.</span>
<span id="cb47-512"><a href="#cb47-512"></a></span>
<span id="cb47-513"><a href="#cb47-513"></a>Thus if we want to estimate a *population mean*: - we take one sample</span>
<span id="cb47-514"><a href="#cb47-514"></a>from the population\</span>
<span id="cb47-515"><a href="#cb47-515"></a><span class="ss">- </span>we calculate the sample-mean - we calculate the sample-sd - We</span>
<span id="cb47-516"><a href="#cb47-516"></a>calculate the Standard Error as $\frac{sample-sd}{\sqrt[]{n}}$ - We</span>
<span id="cb47-517"><a href="#cb47-517"></a>calculate 95% confidence intervals for the *population mean* based on</span>
<span id="cb47-518"><a href="#cb47-518"></a>the formula above.</span>
<span id="cb47-519"><a href="#cb47-519"></a></span>
<span id="cb47-520"><a href="#cb47-520"></a><span class="fu">## References</span></span>
<span id="cb47-521"><a href="#cb47-521"></a></span>
<span id="cb47-522"><a href="#cb47-522"></a><span class="ss">1.  </span>Diez, David M &amp; Barr, Christopher D &amp; Çetinkaya-Rundel, Mine,</span>
<span id="cb47-523"><a href="#cb47-523"></a>    *OpenIntro Statistics*. <span class="ot">&lt;https://www.openintro.org/book/os/&gt;</span></span>
<span id="cb47-524"><a href="#cb47-524"></a></span>
<span id="cb47-525"><a href="#cb47-525"></a><span class="ss">2.  </span>Stats Test Wizard.</span>
<span id="cb47-526"><a href="#cb47-526"></a>    <span class="ot">&lt;https://www.socscistatistics.com/tests/what_stats_test_wizard.aspx&gt;</span></span>
<span id="cb47-527"><a href="#cb47-527"></a></span>
<span id="cb47-528"><a href="#cb47-528"></a><span class="ss">3.  </span>Diez, David M &amp; Barr, Christopher D &amp; Çetinkaya-Rundel, Mine:</span>
<span id="cb47-529"><a href="#cb47-529"></a>    *OpenIntro Statistics*. Available online</span>
<span id="cb47-530"><a href="#cb47-530"></a>    <span class="ot">&lt;https://www.openintro.org/book/os/&gt;</span></span>
<span id="cb47-531"><a href="#cb47-531"></a></span>
<span id="cb47-532"><a href="#cb47-532"></a><span class="ss">4.  </span>Måns Thulin, *Modern Statistics with R: From wrangling and exploring</span>
<span id="cb47-533"><a href="#cb47-533"></a>    data to inference and predictive modelling*</span>
<span id="cb47-534"><a href="#cb47-534"></a>    <span class="ot">&lt;http://www.modernstatisticswithr.com/&gt;</span></span>
<span id="cb47-535"><a href="#cb47-535"></a></span>
<span id="cb47-536"><a href="#cb47-536"></a><span class="ss">5.  </span>Jonas Kristoffer Lindeløv, Common statistical tests are linear</span>
<span id="cb47-537"><a href="#cb47-537"></a>    models (or: how to teach stats)</span>
<span id="cb47-538"><a href="#cb47-538"></a>    <span class="ot">&lt;https://lindeloev.github.io/tests-as-linear/&gt;</span></span>
<span id="cb47-539"><a href="#cb47-539"></a></span>
<span id="cb47-540"><a href="#cb47-540"></a><span class="ss">6.  </span>CheatSheet</span>
<span id="cb47-541"><a href="#cb47-541"></a>    <span class="ot">&lt;https://lindeloev.github.io/tests-as-linear/linear_tests_cheat_sheet.pdf&gt;</span></span>
<span id="cb47-542"><a href="#cb47-542"></a></span>
<span id="cb47-543"><a href="#cb47-543"></a><span class="ss">7.  </span>Common statistical tests are linear models: a work through by Steve</span>
<span id="cb47-544"><a href="#cb47-544"></a>    Doogue <span class="ot">&lt;https://steverxd.github.io/Stat_tests/&gt;</span></span>
<span id="cb47-545"><a href="#cb47-545"></a></span>
<span id="cb47-546"><a href="#cb47-546"></a><span class="ss">8.  </span>Jeffrey Walker "Elements of Statistical Modeling for Experimental</span>
<span id="cb47-547"><a href="#cb47-547"></a>    Biology".</span>
<span id="cb47-548"><a href="#cb47-548"></a>    <span class="ot">&lt;https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/&gt;</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>