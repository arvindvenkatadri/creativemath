<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.354">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Arvind Venkatadri">
<meta name="dcterms.date" content="2022-11-10">
<title>The Foundation Series - üÉè Permutation Test for Two Proportions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../../">
<script src="../../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="../../../../../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../../../../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="The Foundation Series - üÉè Permutation Test for Two Proportions">
<meta property="og:description" content="Testing Two Proportions">
<meta property="og:image" content="https://av-quarto.netlify.app/content/courses/Analytics/Inference/Modules/90-TwoProp/preview.jpg">
<meta property="og:site-name" content="The Foundation Series">
<meta property="og:image:alt" content="From The Internet Archive">
</head>
<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../../../../index.html">
    <span class="navbar-title">The Foundation Series</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/my-quarto-website" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../../../../www.linkedin.com/in/arvindvenkatadri" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">üÉè Permutation Test for Two Proportions</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Teaching</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../../content/courses/Analytics/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analytics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Tools/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tools and Software</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Descriptive/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descriptive Analytics</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Inference/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Modelling/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inferential Modelling</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Predictive/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predictive Analytics</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Prescriptive/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prescriptive Analytics</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Workflow/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflow</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/R4Artists/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R for Artists and Managers</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/TRIZ4ProbSolving/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TRIZ for Innovation</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/MathModelsDesign/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Math Models in Design</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/NoCode/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Vis with No Code</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/ISTW/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">In Short, the World</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/posts/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Posts</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/projects/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blogs</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#setting-up-the-packages" id="toc-setting-up-the-packages" class="nav-link active" data-scroll-target="#setting-up-the-packages">Setting up the Packages</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#testing-for-two-or-more-proportions" id="toc-testing-for-two-or-more-proportions" class="nav-link" data-scroll-target="#testing-for-two-or-more-proportions">Testing for Two or More Proportions</a></li>
  <li><a href="#contingency-table-plots" id="toc-contingency-table-plots" class="nav-link" data-scroll-target="#contingency-table-plots">Contingency Table Plots</a></li>
  <li>
<a href="#observed-statistic-the-x2-metric" id="toc-observed-statistic-the-x2-metric" class="nav-link" data-scroll-target="#observed-statistic-the-x2-metric">Observed Statistic: the <span class="math inline">\(X^2\)</span> metric</a>
  <ul class="collapse">
<li><a href="#hypotheses-definition" id="toc-hypotheses-definition" class="nav-link" data-scroll-target="#hypotheses-definition">Hypotheses Definition</a></li>
  <li><a href="#permutation-test-for-education" id="toc-permutation-test-for-education" class="nav-link" data-scroll-target="#permutation-test-for-education">Permutation Test for <code>Education</code></a></li>
  </ul>
</li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">üÉè Permutation Test for Two Proportions</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Permutation</div>
    <div class="quarto-category">Monte Carlo Simulation</div>
    <div class="quarto-category">Random Number Generation</div>
    <div class="quarto-category">Distributions</div>
    <div class="quarto-category">Generating Parallel Worlds</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Arvind Venkatadri </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 10, 2022</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    Testing Two Proportions
  </div>
</div>

</header><section id="setting-up-the-packages" class="level2"><h2 class="anchored" data-anchor-id="setting-up-the-packages">Setting up the Packages</h2>
<div class="cell" data-hash="two-props_cache/html/setup_fe1392eaea460a1bbd12910202ad4842">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(ggmosaic) <span class="co"># plotting mosaic plots for Categorical Data</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="do">### Dataset from Chihara and Hesterberg's book (Second Edition)</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(resampledata)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(vcd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>We saw from the diagram created by Allen Downey that <em>there is only one test</em>! We will now use this philosophy to develop a technique that allows us to mechanize several <em>Statistical Models</em> in that way, with nearly identical code.</p>
<p>We will use two packages in R, <code>mosaic</code> and the relatively new <code>infer</code> package, to develop our intuition for what are called <strong>permutation</strong> based statistical tests.</p>
</section><section id="testing-for-two-or-more-proportions" class="level2"><h2 class="anchored" data-anchor-id="testing-for-two-or-more-proportions">Testing for Two or More Proportions</h2>
<p>Let us try a dataset with Qualitative / Categorical data. This is the <code>General Social Survey GSS dataset</code>, and we have people with different levels of <code>Education</code> stating their opinion on the <code>Death Penalty</code>. We want to know if these two Categorical variables have a correlation, i.e. can the opinions in favour of the <code>Death Penalty</code> be explained by the <code>Education</code> level?</p>
<p>Since data is Categorical ( both variables ), we need to take <code>counts</code> in a table, and then implement a <code>chi-square test</code>. In the test, we will permute the <code>Education</code> variable to see if we can see how significant its <em>effect size</em> is.</p>
<div class="cell" data-hash="two-props_cache/html/unnamed-chunk-2_ef2ac587f738d5a479088aefe2da27e6">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">data</span>(GSS2002)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">inspect</span>(GSS2002)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
categorical variables:  
            name  class levels    n missing
1         Region factor      7 2765       0
2         Gender factor      2 2765       0
3           Race factor      3 2765       0
4      Education factor      5 2760       5
5        Marital factor      5 2765       0
6       Religion factor     13 2746      19
7          Happy factor      3 1369    1396
8         Income factor     24 1875     890
9       PolParty factor      8 2729      36
10      Politics factor      7 1331    1434
11     Marijuana factor      2  851    1914
12  DeathPenalty factor      2 1308    1457
13        OwnGun factor      3  924    1841
14        GunLaw factor      2  916    1849
15 SpendMilitary factor      3 1324    1441
16     SpendEduc factor      3 1343    1422
17      SpendEnv factor      3 1322    1443
18      SpendSci factor      3 1266    1499
19        Pres00 factor      5 1749    1016
20      Postlife factor      2 1211    1554
                                    distribution
1  North Central (24.7%) ...                    
2  Female (55.6%), Male (44.4%)                 
3  White (79.1%), Black (14.8%) ...             
4  HS (53.8%), Bachelors (16.1%) ...            
5  Married (45.9%), Never Married (25.6%) ...   
6  Protestant (53.2%), Catholic (24.5%) ...     
7  Pretty happy (57.3%) ...                     
8  40000-49999 (9.1%) ...                       
9  Ind (19.3%), Not Str Dem (18.9%) ...         
10 Moderate (39.2%), Conservative (15.8%) ...   
11 Not legal (64%), Legal (36%)                 
12 Favor (68.7%), Oppose (31.3%)                
13 No (65.5%), Yes (33.5%) ...                  
14 Favor (80.5%), Oppose (19.5%)                
15 About right (46.5%) ...                      
16 Too little (73.9%) ...                       
17 Too little (60%) ...                         
18 About right (49.7%) ...                      
19 Bush (50.6%), Gore (44.7%) ...               
20 Yes (80.5%), No (19.5%)                      

quantitative variables:  
  name   class min  Q1 median   Q3  max mean       sd    n missing
1   ID integer   1 692   1383 2074 2765 1383 798.3311 2765       0</code></pre>
</div>
</div>
<p>Note how <em>all</em> variables are Categorical !! <code>Education</code> has five <code>levels</code>, and of course <code>DeathPenalty</code> has three:</p>
<div class="cell" data-hash="two-props_cache/html/unnamed-chunk-3_367fc7c377e0d3156fd87352663d62aa">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>GSS2002 <span class="sc">%&gt;%</span> <span class="fu">count</span>(Education)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Education"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Left HS","2":"400"},{"1":"HS","2":"1485"},{"1":"Jr Col","2":"202"},{"1":"Bachelors","2":"443"},{"1":"Graduate","2":"230"},{"1":"NA","2":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>GSS2002 <span class="sc">%&gt;%</span> <span class="fu">count</span>(DeathPenalty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["DeathPenalty"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Favor","2":"899"},{"1":"Oppose","2":"409"},{"1":"NA","2":"1457"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Let us drop NA entries in <code>Education</code> and <code>Death Penalty</code> and set up a <strong>Contingency Table</strong>.</p>
<div class="cell" data-hash="two-props_cache/html/unnamed-chunk-4_8d673f6c2638cd1cc4eb28db734a6c28">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>gss2002 <span class="ot">&lt;-</span> GSS2002 <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Education, DeathPenalty) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>(., <span class="fu">c</span>(Education, DeathPenalty))</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>gss_table <span class="ot">&lt;-</span> <span class="fu">tally</span>(DeathPenalty <span class="sc">~</span> Education, <span class="at">data =</span> gss2002)</span>
<span id="cb6-8"><a href="#cb6-8"></a>gss_table <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9"></a>  <span class="fu">addmargins</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Education
DeathPenalty Left HS   HS Jr Col Bachelors Graduate  Sum
      Favor      117  511     71       135       64  898
      Oppose      72  200     16        71       50  409
      Sum        189  711     87       206      114 1307</code></pre>
</div>
</div>
</section><section id="contingency-table-plots" class="level2"><h2 class="anchored" data-anchor-id="contingency-table-plots">Contingency Table Plots</h2>
<p>The Contingency Table can be plotted, as we have seen, using a <code>mosaic</code> plot using several packages:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Using <code>ggformula</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Using <code>vcd</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Using <code>ggmosaic</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Need a little more work, to convert the Contigency Table into a tibble:</p>
<div class="cell" data-hash="two-props_cache/html/unnamed-chunk-5_f82b3436ada9d3c3b45f188c6662c94a">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># https://stackoverflow.com/questions/19233365/how-to-create-a-marimekko-mosaic-plot-in-ggplot2</span></span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>gss_summary <span class="ot">&lt;-</span> gss2002 <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="at">Education =</span> <span class="fu">factor</span>(</span>
<span id="cb8-6"><a href="#cb8-6"></a>      Education,</span>
<span id="cb8-7"><a href="#cb8-7"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Bachelors"</span>, <span class="st">"Graduate"</span>, <span class="st">"Jr Col"</span>, <span class="st">"HS"</span>, <span class="st">"Left HS"</span>),</span>
<span id="cb8-8"><a href="#cb8-8"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Bachelors"</span>, <span class="st">"Graduate"</span>, <span class="st">"Jr Col"</span>, <span class="st">"HS"</span>, <span class="st">"Left HS"</span>)</span>
<span id="cb8-9"><a href="#cb8-9"></a>    ),</span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="at">DeathPenalty =</span> <span class="fu">as.factor</span>(DeathPenalty)</span>
<span id="cb8-11"><a href="#cb8-11"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="fu">group_by</span>(Education, DeathPenalty) <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="co"># This is good for a chisq test</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>  </span>
<span id="cb8-15"><a href="#cb8-15"></a>  <span class="co"># Add two more columns to facilitate mosaic/Marrimekko Plot</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>  <span class="co"># </span></span>
<span id="cb8-17"><a href="#cb8-17"></a>  <span class="fu">mutate</span>(<span class="at">edu_count =</span> <span class="fu">sum</span>(count), </span>
<span id="cb8-18"><a href="#cb8-18"></a>         <span class="at">edu_prop =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb8-20"><a href="#cb8-20"></a></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="fu">gf_col</span>(edu_prop <span class="sc">~</span> Education, <span class="at">data =</span> gss_summary,</span>
<span id="cb8-22"><a href="#cb8-22"></a>       <span class="at">width =</span> <span class="sc">~</span> edu_count, </span>
<span id="cb8-23"><a href="#cb8-23"></a>       <span class="at">fill =</span> <span class="sc">~</span> DeathPenalty,</span>
<span id="cb8-24"><a href="#cb8-24"></a>       <span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb8-25"><a href="#cb8-25"></a>       <span class="at">position =</span> <span class="st">"fill"</span>, </span>
<span id="cb8-26"><a href="#cb8-26"></a>       <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-27"><a href="#cb8-27"></a>  </span>
<span id="cb8-28"><a href="#cb8-28"></a>  <span class="fu">gf_text</span>(edu_prop <span class="sc">~</span> Education, </span>
<span id="cb8-29"><a href="#cb8-29"></a>          <span class="at">label =</span> <span class="sc">~</span> scales<span class="sc">::</span><span class="fu">percent</span>(edu_prop),</span>
<span id="cb8-30"><a href="#cb8-30"></a>          <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-31"><a href="#cb8-31"></a>  </span>
<span id="cb8-32"><a href="#cb8-32"></a>  <span class="fu">gf_facet_grid</span>(<span class="sc">~</span> Education, </span>
<span id="cb8-33"><a href="#cb8-33"></a>                <span class="at">scales =</span> <span class="st">"free_x"</span>, </span>
<span id="cb8-34"><a href="#cb8-34"></a>                <span class="at">space =</span> <span class="st">"free_x"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-35"><a href="#cb8-35"></a>  </span>
<span id="cb8-36"><a href="#cb8-36"></a>  <span class="fu">gf_theme</span>(<span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"orangered"</span>, <span class="st">"palegreen3"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb8-37"><a href="#cb8-37"></a>  <span class="fu">gf_theme</span>(<span class="fu">theme_void</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="two-props_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-hash="two-props_cache/html/unnamed-chunk-6_cdf3e00e0cb0f1f4440390e55d117879">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>vcd<span class="sc">::</span><span class="fu">mosaic</span>(gss_table, <span class="at">gp =</span> shading_hsv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="two-props_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-hash="two-props_cache/html/mosaic-plot_fe1592163cdb99e1f234821195afa653">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">#library(ggmosaic)</span></span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gss2002) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(DeathPenalty, Education), </span>
<span id="cb10-5"><a href="#cb10-5"></a>                  <span class="at">fill =</span> DeathPenalty))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="two-props_files/figure-html/mosaic-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section><section id="observed-statistic-the-x2-metric" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="observed-statistic-the-x2-metric">Observed Statistic: the <span class="math inline">\(X^2\)</span> metric</h2>
<p>When there are multiple proportions involved, the <span class="math inline">\(X^2\)</span> test is what is used.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset page-columns page-full">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Intuitive Explanation</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Code</a></li>
</ul>
<div class="tab-content page-columns page-full">
<div id="tabset-2-1" class="tab-pane active page-columns page-full" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Let us look at the Contingency Table that we have:</p>
<div class="cell page-columns page-full" data-hash="two-props_cache/html/unnamed-chunk-7_09560991d960d96c0da25ec2b492e186">
<div class="cell-output-display page-columns page-full">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">

<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Left HS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">HS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Jr Col</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Bachelors</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Graduate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Favor</td>
<td style="text-align: right;">117</td>
<td style="text-align: right;">511</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">898</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oppose</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">409</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sum</td>
<td style="text-align: right;">189</td>
<td style="text-align: right;">711</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">206</td>
<td style="text-align: right;">114</td>
<td style="text-align: right;">1307</td>
</tr>
</tbody>
</table>
<div class="quarto-table-caption margin-caption">Contigency Table</div></div>
</div>
<p>In the chi-square test, we check whether the two ( or more ) categorical variables are independent. To do this we perform a simple check on the Contingency Table. We first <em>re-compute</em> the totals in each row and column, based on what we could <strong>expect</strong> if there was independence (NULL Hypothesis). If the two variables were independent, then there should be <strong>no difference</strong> between real and expected scores.</p>
<p>How do we know what scores to expect?</p>
<p>Consider the entry in location (1,1): 117. The number of <strong>expected</strong> entries there is probability of an entry landing in that square times the total number of entries:</p>
<div class="column-body-outset">
<span class="math display">\[\begin{align}

\text{Expected Value at location[1,1]}
&amp;= p_{row_1} * p_{col_1} * \text{Total Scores}\\\
&amp;= \frac{\text{Row-1-Total}}{\text{Total Scores}} * \frac{\text{Col-1-Total}}{\text{Total Scores}} * \text{Total Scores}\\\
&amp;= \frac{898}{1307} * \frac{189}{1307} * 1307\\\
&amp;= 130


\end{align}\]</span>
</div>
<p>Proceeding in this way for all the 15 entries in the Contingency Table, we get the ‚ÄúExpected‚Äù Contingency Table. Here are both tables for comparison:</p>
<div class="cell" data-hash="two-props_cache/html/unnamed-chunk-8_61d12ad7b15d992a3c667e32a26973a4">

</div>
<div class="cell page-columns page-full" data-hash="two-props_cache/html/unnamed-chunk-9_2359e47e4947dbacd357b058381bc338">
<div class="cell-output-display page-columns page-full">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">

<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Left HS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">HS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Jr Col</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Bachelors</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Graduate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Favor</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">489</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">142</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">898</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oppose</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">222</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">409</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sum</td>
<td style="text-align: right;">189</td>
<td style="text-align: right;">711</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">206</td>
<td style="text-align: right;">114</td>
<td style="text-align: right;">1307</td>
</tr>
</tbody>
</table>
<div class="quarto-table-caption margin-caption">Expected Contigency Table</div></div>
</div>
<div class="cell page-columns page-full" data-hash="two-props_cache/html/unnamed-chunk-10_f9bf4a76321ea9274fbaa52254052b27">
<div class="cell-output-display page-columns page-full">
<table class="lightable-classic table table-sm table-striped small" data-quarto-postprocess="true">

<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Left HS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">HS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Jr Col</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Bachelors</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Graduate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Favor</td>
<td style="text-align: right;">117</td>
<td style="text-align: right;">511</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">898</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oppose</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">409</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sum</td>
<td style="text-align: right;">189</td>
<td style="text-align: right;">711</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">206</td>
<td style="text-align: right;">114</td>
<td style="text-align: right;">1307</td>
</tr>
</tbody>
</table>
<div class="quarto-table-caption margin-caption">Actual Contigency Table</div></div>
</div>
<p>The <span class="math inline">\(X^2\)</span> statistic is sum of squared differences between <code>Observed</code> and <code>Expected</code> scores, scaled by the <code>Expected Scores</code>. For location [1,1] this would be: <span class="math inline">\((117-130)^2/189\)</span>. Do try to compute all of these and the <span class="math inline">\(X^2\)</span> statistic by hand !!</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Let us now perform the base <code>chisq test</code>: We need a <code>table</code> and then the <code>chisq</code> test:</p>
<div class="cell" data-hash="two-props_cache/html/unnamed-chunk-11_d64491afe3c83d49e7b783f5c053bf79">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># gss_table &lt;- tally(DeathPenalty ~ Education, data = gss2002)</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co"># gss_table</span></span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co"># Get the observed chi-square statistic</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>observedChi2 <span class="ot">&lt;-</span> mosaic<span class="sc">::</span><span class="fu">chisq</span>(<span class="fu">tally</span>(DeathPenalty <span class="sc">~</span> Education, <span class="at">data =</span> gss2002))</span>
<span id="cb11-6"><a href="#cb11-6"></a>observedChi2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X.squared 
 23.45093 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Actual chi-square test</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>stats<span class="sc">::</span><span class="fu">chisq.test</span>(<span class="fu">tally</span>(DeathPenalty <span class="sc">~</span> Education, <span class="at">data =</span> gss2002))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  tally(DeathPenalty ~ Education, data = gss2002)
X-squared = 23.451, df = 4, p-value = 0.0001029</code></pre>
</div>
</div>
<p>We see that our observed <span class="math inline">\(X^2 = 23.45\)</span>.</p>
</div>
</div>
</div>
<section id="hypotheses-definition" class="level3"><h3 class="anchored" data-anchor-id="hypotheses-definition">Hypotheses Definition</h3>
<p>What would our Hypotheses be?</p>
<p><span class="math inline">\(H_0: \text{Education does not affect votes for Death Penalty}\)</span> <span class="math inline">\(H_a: \text{Education affects votes for Death Penalty}\)</span></p>
</section><section id="permutation-test-for-education" class="level3"><h3 class="anchored" data-anchor-id="permutation-test-for-education">Permutation Test for <code>Education</code>
</h3>
<p>We should now repeat the test with permutations on <code>Education</code>:</p>
<div class="cell" data-hash="two-props_cache/html/unnamed-chunk-12_d4df0a9aeefafc18de251d02277a88a5">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>null_chisq <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">chisq.test</span>(<span class="fu">tally</span>(DeathPenalty <span class="sc">~</span> <span class="fu">shuffle</span>(Education), </span>
<span id="cb15-3"><a href="#cb15-3"></a>                   <span class="at">data =</span> gss2002))</span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="fu">head</span>(null_chisq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[2],"type":["int"],"align":["right"]},{"label":["p.value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[4],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[5],"type":["lgl"],"align":["right"]},{"label":["data"],"name":[6],"type":["chr"],"align":["left"]},{"label":[".row"],"name":[7],"type":["int"],"align":["right"]},{"label":[".index"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"5.5127150","2":"4","3":"0.2386141","4":"Pearson's Chi-squared test","5":"NA","6":"tally(DeathPenalty ~ shuffle(Education), data = gss2002)","7":"1","8":"1","_rn_":"X-squared...1"},{"1":"7.4482619","2":"4","3":"0.1140125","4":"Pearson's Chi-squared test","5":"NA","6":"tally(DeathPenalty ~ shuffle(Education), data = gss2002)","7":"1","8":"2","_rn_":"X-squared...2"},{"1":"0.6791743","2":"4","3":"0.9538721","4":"Pearson's Chi-squared test","5":"NA","6":"tally(DeathPenalty ~ shuffle(Education), data = gss2002)","7":"1","8":"3","_rn_":"X-squared...3"},{"1":"2.6690819","2":"4","3":"0.6146356","4":"Pearson's Chi-squared test","5":"NA","6":"tally(DeathPenalty ~ shuffle(Education), data = gss2002)","7":"1","8":"4","_rn_":"X-squared...4"},{"1":"2.6784995","2":"4","3":"0.6129821","4":"Pearson's Chi-squared test","5":"NA","6":"tally(DeathPenalty ~ shuffle(Education), data = gss2002)","7":"1","8":"5","_rn_":"X-squared...5"},{"1":"5.6618727","2":"4","3":"0.2258629","4":"Pearson's Chi-squared test","5":"NA","6":"tally(DeathPenalty ~ shuffle(Education), data = gss2002)","7":"1","8":"6","_rn_":"X-squared...6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">gf_histogram</span>( <span class="sc">~</span> X.squared, <span class="at">data =</span> null_chisq) <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  </span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> observedChi2, </span>
<span id="cb16-4"><a href="#cb16-4"></a>           <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="fu">gf_theme</span>(<span class="at">theme =</span> <span class="fu">theme_classic</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="two-props_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">prop1</span>(<span class="sc">~</span> X.squared <span class="sc">&gt;=</span> observedChi2, <span class="at">data =</span> null_chisq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> prop_TRUE 
0.00029997 </code></pre>
</div>
</div>
<p>The <code>p-value</code> is well below our threshold of <span class="math inline">\(0.05\)</span>, so we would conclude that <code>Education</code> has a significant effect on <code>DeathPenalty</code> opinion!</p>
</section></section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Why would a permutation test be a good idea here?</p>
<p>In our basic <span class="math inline">\(X^2\)</span> test, we calculate the test statistic of <span class="math inline">\(X^2\)</span> and look up a <em>theoretical</em> null distribution for that statistic, and see how unlikely our observed value is.</p>
<p>With a permutation test, there are <em>no assumptions</em> of the null distribution: this is computed based on real data. We note in passing that, in this case, since the number of <code>cases</code> in each cell of the Contingency Table are fairly high ( &gt;= 5) the resulting NULL distribution is of the <span class="math inline">\(X^2\)</span> variety.</p>
</section><section id="references" class="level2"><h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li><a href="https://openintro-ims.netlify.app/inference-one-prop.html">OpenIntro Modern Statistics: Chapter 17</a></li>
</ol>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Handle positioning of the toggle
      window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/av-quarto\.netlify\.app");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Website made with üíú and <a href="https://quarto.org/">Quarto</a>, by Arvind Venkatadri. License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:arvind.venkatadri@gmail.com">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


<script src="../../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>