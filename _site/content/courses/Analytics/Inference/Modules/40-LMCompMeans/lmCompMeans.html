<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Arvind Venkatadri">
<meta name="dcterms.date" content="2022-11-25">
<meta name="keywords" content="Statistics ; Tests; p-value; Feynman Technique">
<title>The Foundation Series - Linear Models: Comparing Means</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../../">
<script src="../../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../../../../../site_libs/quarto-contrib/jquery-3.6.3/jquery-3.6.3.min.js"></script>
<script src="../../../../../../site_libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.js" defer="true"></script>
<link href="../../../../../../site_libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.css" rel="stylesheet">
<script src="../../../../../../site_libs/quarto-contrib/iconify-1.0.0-beta.2/iconify-icon.min.js"></script><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="The Foundation Series - Linear Models: Comparing Means">
<meta property="og:description" content="This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats. The method followed is that of Jonas Lindoloev, wherein every stat test is treated as a linear model y = mx + c.">
<meta property="og:image" content="https://av-quarto.netlify.app/content/courses/Analytics/Inference/Modules/40-LMCompMeans/lmCompMeans_files/figure-html/data_plots-1.png">
<meta property="og:site-name" content="The Foundation Series">
<meta property="og:image:height" content="3000">
<meta property="og:image:width" content="4200">
</head>
<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../../../../index.html">
    <span class="navbar-title">The Foundation Series</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/my-quarto-website" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../../../../www.linkedin.com/in/arvindvenkatadri" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Linear Models: Comparing Means</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Teaching</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../../content/courses/Analytics/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analytics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Tools/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tools and Software</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Descriptive/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descriptive Analytics</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Inference/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Modelling/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inferential Modelling</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Predictive/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predictive Analytics</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Prescriptive/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prescriptive Analytics</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Workflow/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflow</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/R4Artists/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R for Artists and Managers</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/TRIZ4ProbSolving/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TRIZ for Innovation</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/MathModelsDesign/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Math Models in Design</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/NoCode/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Vis with No Code</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/ISTW/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">In Short, the World</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/posts/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Posts</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/projects/listing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blogs</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#iconify-noto-v1-package-setting-up-r-packages" id="toc-iconify-noto-v1-package-setting-up-r-packages" class="nav-link active" data-scroll-target="#iconify-noto-v1-package-setting-up-r-packages"><iconify-icon inline="" icon="noto-v1:package"></iconify-icon> Setting up R Packages</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li>
<a href="#structure-of-this-document" id="toc-structure-of-this-document" class="nav-link" data-scroll-target="#structure-of-this-document">Structure of this document</a>
  <ul class="collapse">
<li>
<a href="#test" id="toc-test" class="nav-link" data-scroll-target="#test">Test</a>
  <ul class="collapse">
<li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a></li>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code">Code</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
<li><a href="#sample-values" id="toc-sample-values" class="nav-link" data-scroll-target="#sample-values">Sample Values</a></li>
  <li><a href="#signed-rank-values" id="toc-signed-rank-values" class="nav-link" data-scroll-target="#signed-rank-values">“Signed Rank” Values</a></li>
  <li><a href="#plotting-original-and-signed-rank-data" id="toc-plotting-original-and-signed-rank-data" class="nav-link" data-scroll-target="#plotting-original-and-signed-rank-data">Plotting Original and Signed Rank Data</a></li>
  <li><a href="#how-does-sign-rank-data-work" id="toc-how-does-sign-rank-data-work" class="nav-link" data-scroll-target="#how-does-sign-rank-data-work">How does Sign-Rank data work?</a></li>
  </ul>
</li>
  <li>
<a href="#the-linear-regression-model" id="toc-the-linear-regression-model" class="nav-link" data-scroll-target="#the-linear-regression-model">The Linear ( Regression ) Model</a>
  <ul class="collapse">
<li><a href="#linear-models-as-hypothesis-tests" id="toc-linear-models-as-hypothesis-tests" class="nav-link" data-scroll-target="#linear-models-as-hypothesis-tests">Linear Models as Hypothesis Tests</a></li>
  <li><a href="#linear-models-in-r" id="toc-linear-models-in-r" class="nav-link" data-scroll-target="#linear-models-in-r">Linear Models in R</a></li>
  <li><a href="#assumptions-in-linear-models" id="toc-assumptions-in-linear-models" class="nav-link" data-scroll-target="#assumptions-in-linear-models">Assumptions in Linear Models</a></li>
  </ul>
</li>
  <li>
<a href="#tests-for-correlation" id="toc-tests-for-correlation" class="nav-link" data-scroll-target="#tests-for-correlation">Tests for Correlation</a>
  <ul class="collapse">
<li>
<a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation">Pearson Correlation</a>
  <ul class="collapse">
<li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1">Model</a></li>
  <li><a href="#code-1" id="toc-code-1" class="nav-link" data-scroll-target="#code-1">Code</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  </ul>
</li>
  <li>
<a href="#spearman-correlation" id="toc-spearman-correlation" class="nav-link" data-scroll-target="#spearman-correlation">Spearman Correlation</a>
  <ul class="collapse">
<li><a href="#model-2" id="toc-model-2" class="nav-link" data-scroll-target="#model-2">Model</a></li>
  <li><a href="#code-2" id="toc-code-2" class="nav-link" data-scroll-target="#code-2">Code</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#tests-on-one-mean" id="toc-tests-on-one-mean" class="nav-link" data-scroll-target="#tests-on-one-mean">Tests on One Mean</a>
  <ul class="collapse">
<li>
<a href="#the-students-t-test-with-one-sample" id="toc-the-students-t-test-with-one-sample" class="nav-link" data-scroll-target="#the-students-t-test-with-one-sample">The Student’s t-test with one sample</a>
  <ul class="collapse">
<li><a href="#model-3" id="toc-model-3" class="nav-link" data-scroll-target="#model-3">Model</a></li>
  <li><a href="#code-3" id="toc-code-3" class="nav-link" data-scroll-target="#code-3">Code</a></li>
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3">Example</a></li>
  </ul>
</li>
  <li>
<a href="#wilcoxons-signed-rank-test" id="toc-wilcoxons-signed-rank-test" class="nav-link" data-scroll-target="#wilcoxons-signed-rank-test">Wilcoxon’s Signed-Rank Test</a>
  <ul class="collapse">
<li><a href="#model-4" id="toc-model-4" class="nav-link" data-scroll-target="#model-4">Model</a></li>
  <li><a href="#code-4" id="toc-code-4" class="nav-link" data-scroll-target="#code-4">Code</a></li>
  <li><a href="#example-4" id="toc-example-4" class="nav-link" data-scroll-target="#example-4">Example</a></li>
  <li><a href="#plots-for-both-t-test-and-wilcoxon-test" id="toc-plots-for-both-t-test-and-wilcoxon-test" class="nav-link" data-scroll-target="#plots-for-both-t-test-and-wilcoxon-test">Plots for both t-test and Wilcoxon test</a></li>
  </ul>
</li>
  <li>
<a href="#paired-sample-t-test" id="toc-paired-sample-t-test" class="nav-link" data-scroll-target="#paired-sample-t-test">Paired Sample t-test</a>
  <ul class="collapse">
<li><a href="#model-5" id="toc-model-5" class="nav-link" data-scroll-target="#model-5">Model</a></li>
  <li><a href="#code-5" id="toc-code-5" class="nav-link" data-scroll-target="#code-5">Code</a></li>
  <li><a href="#example-5" id="toc-example-5" class="nav-link" data-scroll-target="#example-5">Example</a></li>
  </ul>
</li>
  <li>
<a href="#wilcoxon-paired-test" id="toc-wilcoxon-paired-test" class="nav-link" data-scroll-target="#wilcoxon-paired-test">Wilcoxon Paired Test</a>
  <ul class="collapse">
<li><a href="#model-6" id="toc-model-6" class="nav-link" data-scroll-target="#model-6">Model</a></li>
  <li><a href="#code-6" id="toc-code-6" class="nav-link" data-scroll-target="#code-6">Code</a></li>
  <li><a href="#example-6" id="toc-example-6" class="nav-link" data-scroll-target="#example-6">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#tests-with-two-means" id="toc-tests-with-two-means" class="nav-link" data-scroll-target="#tests-with-two-means">Tests with Two Means</a>
  <ul class="collapse">
<li><a href="#dummy-group-variable-concept" id="toc-dummy-group-variable-concept" class="nav-link" data-scroll-target="#dummy-group-variable-concept">Dummy Group Variable Concept</a></li>
  <li><a href="#model-7" id="toc-model-7" class="nav-link" data-scroll-target="#model-7">Model</a></li>
  </ul>
</li>
  <li>
<a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a>
  <ul class="collapse">
<li>
<a href="#independent-t-test" id="toc-independent-t-test" class="nav-link" data-scroll-target="#independent-t-test">Independent t-test</a>
  <ul class="collapse">
<li><a href="#model-8" id="toc-model-8" class="nav-link" data-scroll-target="#model-8">Model</a></li>
  <li><a href="#code-7" id="toc-code-7" class="nav-link" data-scroll-target="#code-7">Code</a></li>
  <li><a href="#example-7" id="toc-example-7" class="nav-link" data-scroll-target="#example-7">Example</a></li>
  </ul>
</li>
  <li>
<a href="#welchs-t-test" id="toc-welchs-t-test" class="nav-link" data-scroll-target="#welchs-t-test">Welch’s t-test</a>
  <ul class="collapse">
<li><a href="#model-9" id="toc-model-9" class="nav-link" data-scroll-target="#model-9">Model</a></li>
  <li><a href="#code-8" id="toc-code-8" class="nav-link" data-scroll-target="#code-8">Code</a></li>
  <li><a href="#example-8" id="toc-example-8" class="nav-link" data-scroll-target="#example-8">Example</a></li>
  </ul>
</li>
  <li>
<a href="#mann-whitney-u-test" id="toc-mann-whitney-u-test" class="nav-link" data-scroll-target="#mann-whitney-u-test">Mann-Whitney U Test</a>
  <ul class="collapse">
<li><a href="#model-10" id="toc-model-10" class="nav-link" data-scroll-target="#model-10">Model</a></li>
  <li><a href="#code-9" id="toc-code-9" class="nav-link" data-scroll-target="#code-9">Code</a></li>
  <li><a href="#example-9" id="toc-example-9" class="nav-link" data-scroll-target="#example-9">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#tests-with-three-or-more-means" id="toc-tests-with-three-or-more-means" class="nav-link" data-scroll-target="#tests-with-three-or-more-means">Tests with Three or More Means</a>
  <ul class="collapse">
<li><a href="#model-11" id="toc-model-11" class="nav-link" data-scroll-target="#model-11">Model</a></li>
  <li>
<a href="#one-way-anova" id="toc-one-way-anova" class="nav-link" data-scroll-target="#one-way-anova">One-way ANOVA</a>
  <ul class="collapse">
<li><a href="#model-12" id="toc-model-12" class="nav-link" data-scroll-target="#model-12">Model</a></li>
  <li><a href="#code-10" id="toc-code-10" class="nav-link" data-scroll-target="#code-10">Code</a></li>
  <li><a href="#example-10" id="toc-example-10" class="nav-link" data-scroll-target="#example-10">Example</a></li>
  </ul>
</li>
  <li>
<a href="#two-way-anova" id="toc-two-way-anova" class="nav-link" data-scroll-target="#two-way-anova">Two-way ANOVA</a>
  <ul class="collapse">
<li><a href="#model-13" id="toc-model-13" class="nav-link" data-scroll-target="#model-13">Model</a></li>
  <li><a href="#code-11" id="toc-code-11" class="nav-link" data-scroll-target="#code-11">Code</a></li>
  <li><a href="#example-11" id="toc-example-11" class="nav-link" data-scroll-target="#example-11">Example</a></li>
  </ul>
</li>
  <li>
<a href="#ancova" id="toc-ancova" class="nav-link" data-scroll-target="#ancova">ANCOVA</a>
  <ul class="collapse">
<li><a href="#model-14" id="toc-model-14" class="nav-link" data-scroll-target="#model-14">Model</a></li>
  <li><a href="#code-12" id="toc-code-12" class="nav-link" data-scroll-target="#code-12">Code</a></li>
  <li><a href="#example-12" id="toc-example-12" class="nav-link" data-scroll-target="#example-12">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#proportions" id="toc-proportions" class="nav-link" data-scroll-target="#proportions">Proportions</a>
  <ul class="collapse">
<li><a href="#model-15" id="toc-model-15" class="nav-link" data-scroll-target="#model-15">Model</a></li>
  <li>
<a href="#discrete-variables" id="toc-discrete-variables" class="nav-link" data-scroll-target="#discrete-variables">Discrete Variables</a>
  <ul class="collapse">
<li><a href="#model-16" id="toc-model-16" class="nav-link" data-scroll-target="#model-16">Model</a></li>
  <li><a href="#code-13" id="toc-code-13" class="nav-link" data-scroll-target="#code-13">Code</a></li>
  <li><a href="#example-13" id="toc-example-13" class="nav-link" data-scroll-target="#example-13">Example</a></li>
  </ul>
</li>
  <li>
<a href="#continuous-variables" id="toc-continuous-variables" class="nav-link" data-scroll-target="#continuous-variables">Continuous Variables</a>
  <ul class="collapse">
<li><a href="#model-17" id="toc-model-17" class="nav-link" data-scroll-target="#model-17">Model</a></li>
  <li><a href="#code-14" id="toc-code-14" class="nav-link" data-scroll-target="#code-14">Code</a></li>
  <li><a href="#example-14" id="toc-example-14" class="nav-link" data-scroll-target="#example-14">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Linear Models: Comparing Means</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Arvind Venkatadri </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 25, 2022</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 26, 2023</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats. The method followed is that of Jonas Lindoloev, wherein every stat test is treated as a linear model y = mx + c.
  </div>
</div>

</header><section id="iconify-noto-v1-package-setting-up-r-packages" class="level2"><h2 class="anchored" data-anchor-id="iconify-noto-v1-package-setting-up-r-packages">
<iconify-icon inline="" icon="noto-v1:package"></iconify-icon> Setting up R Packages</h2>
</section><section id="references" class="level1"><h1>References</h1>
<ol type="1">
<li>
<em>Common statistical tests are linear models (or: how to teach stats)</em> by <a href="https://lindeloev.github.io/tests-as-linear/">Jonas Kristoffer Lindeløv</a>
</li>
<li><a href="https://lindeloev.github.io/tests-as-linear/linear_tests_cheat_sheet.pdf">CheatSheet</a></li>
<li>
<em>Common statistical tests are linear models: a work through</em> by <a href="https://steverxd.github.io/Stat_tests/">Steve Doogue</a>
</li>
<li><a href="https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/">Jeffrey Walker “Elements of Statistical Modeling for Experimental Biology”</a></li>
<li>Text: Diez, David M &amp; Barr, Christopher D &amp; Çetinkaya-Rundel, Mine: <a href="https://www.openintro.org/book/os/">OpenIntro Statistics</a>
</li>
<li>Modern Statistics with R: From wrangling and exploring data to inference and predictive modelling by <a href="http://www.modernstatisticswithr.com/">Måns Thulin</a>
</li>
</ol></section><section id="structure-of-this-document" class="level1"><h1>Structure of this document</h1>
<p>We will follow the following structure: Each kind of Test is described in a separate Chapter. The Test <em>Model</em> is laid out in formula <span class="math inline">\(y = mx + c\)</span> and in <em>Code</em>.</p>
<p>The Structure looks like this:</p>
<section id="test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="test">Test</h2>
<section id="model" class="level3"><h3 class="anchored" data-anchor-id="model">Model</h3>
<p>Explanation, formula etc.</p>
</section><section id="code" class="level3"><h3 class="anchored" data-anchor-id="code">Code</h3>
<p>With Toy Data; Graphs</p>
</section><section id="example" class="level3"><h3 class="anchored" data-anchor-id="example">Example</h3>
<p>With another “real world” data set; Graphs</p>
</section></section></section><section id="data" class="level1"><h1>Data</h1>
<section id="sample-values" class="level2"><h2 class="anchored" data-anchor-id="sample-values">Sample Values</h2>
<p>Most examples in this exposition are based on three “imaginary” samples, <span class="math inline">\(x, y, y2\)</span>. Each is normally distributed and made up of 50 observations.</p>
<p>We start by creating a function that will allow us to produce samples of a given size (N) with a specified mean (mu) and standard deviation (sd): Note: this gives a <em>matrix</em> of numbers, as opposed to a vector using <code>rnorm</code> by itself. The data are created both in vector form and tibble form for flexibility of use in diverse packages and formulae in what follows.</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/data_genr_ad9c5c1696a970e351fceae46b006abb">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>rnorm_fixed  <span class="ot">&lt;-</span> <span class="cf">function</span>(N, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) {</span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="fu">scale</span>(<span class="fu">rnorm</span>(N))<span class="sc">*</span> sd <span class="sc">+</span> mu</span>
<span id="cb1-3"><a href="#cb1-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We create three variables: x ( explanatory) and y, y2 ( dependent ).</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/toy_data_8d195afc7f789858142852a9e96b2673">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">set.seed</span>(<span class="dv">40</span>) <span class="co"># for replication</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># Data as vectors ( for t.tests etc)</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co">#explanatory</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.3</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="co"># dependent #1</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>y2 <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="fl">1.5</span>) <span class="co"># dependent #2</span></span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># Make a tibble with all variables</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>mydata_wide <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">y2 =</span> y2)</span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co"># Long form data</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>mydata_long <span class="ot">&lt;-</span> </span>
<span id="cb2-13"><a href="#cb2-13"></a>  mydata_wide <span class="sc">%&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>  <span class="fu">pivot_longer</span>(., <span class="at">cols =</span> <span class="fu">c</span>(x,y,y2), </span>
<span id="cb2-15"><a href="#cb2-15"></a>               <span class="at">names_to =</span> <span class="st">"group"</span>, </span>
<span id="cb2-16"><a href="#cb2-16"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co"># Long form data with only dependent variables</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>mydata_long_y <span class="ot">&lt;-</span> </span>
<span id="cb2-20"><a href="#cb2-20"></a>  mydata_wide <span class="sc">%&gt;%</span> </span>
<span id="cb2-21"><a href="#cb2-21"></a>  <span class="fu">select</span>(<span class="sc">-</span>x) <span class="sc">%&gt;%</span> </span>
<span id="cb2-22"><a href="#cb2-22"></a>  <span class="fu">pivot_longer</span>(., <span class="at">cols =</span> <span class="fu">c</span>(y,y2), </span>
<span id="cb2-23"><a href="#cb2-23"></a>               <span class="at">names_to =</span> <span class="st">"group"</span>, </span>
<span id="cb2-24"><a href="#cb2-24"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb2-25"><a href="#cb2-25"></a>mydata_wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["dbl[,1]"],"align":["right"]},{"label":["y"],"name":[2],"type":["dbl[,1]"],"align":["right"]},{"label":["y2"],"name":[3],"type":["dbl[,1]"],"align":["right"]}],"data":[{"1":"0.42678011","2":"1.98488355","3":"0.10303468"},{"1":"0.44408399","2":"1.27130904","3":"-0.28089065"},{"1":"-0.82789086","2":"-0.94427745","3":"0.62388864"},{"1":"-0.79925305","2":"0.10328425","3":"5.42679005"},{"1":"-0.32313106","2":"2.19041969","3":"0.16807478"},{"1":"-1.24462433","2":"0.19192798","3":"-0.54936141"},{"1":"-1.35506516","2":"4.81186172","3":"0.30919557"},{"1":"1.61563907","2":"1.55169550","3":"-0.99039138"},{"1":"-0.29189503","2":"3.35737558","3":"-0.17200537"},{"1":"-1.24940474","2":"1.92492196","3":"-0.15832838"},{"1":"-0.08659233","2":"-2.88047669","3":"0.85387666"},{"1":"-1.17065349","2":"1.75053169","3":"3.33911133"},{"1":"0.73756421","2":"-1.08428013","3":"-1.88393968"},{"1":"-0.48316590","2":"0.96031018","3":"2.48425274"},{"1":"0.40328291","2":"-1.54016895","3":"-0.04867594"},{"1":"0.91641886","2":"-1.24357666","3":"-0.61515773"},{"1":"0.41673257","2":"0.03193645","3":"-0.28681098"},{"1":"0.33137777","2":"-1.30918647","3":"-0.12350146"},{"1":"1.57677526","2":"-0.99658718","3":"0.29936602"},{"1":"-0.99289810","2":"1.42150401","3":"-1.06763475"},{"1":"1.22460582","2":"-0.90365732","3":"0.12124860"},{"1":"-0.57899018","2":"2.94554205","3":"-0.40094019"},{"1":"1.49026764","2":"2.57375451","3":"-1.55553594"},{"1":"-1.06533835","2":"-1.21795541","3":"-0.51902218"},{"1":"-1.39136994","2":"-2.10136309","3":"-0.24857353"},{"1":"0.66547299","2":"0.90556693","3":"1.35671958"},{"1":"-1.53224607","2":"0.53146356","3":"0.14529688"},{"1":"0.29011158","2":"0.90084614","3":"0.83560170"},{"1":"0.69239937","2":"0.12687786","3":"2.29182497"},{"1":"-1.76053733","2":"2.64999575","3":"2.73673094"},{"1":"0.72082239","2":"0.13435947","3":"0.27574827"},{"1":"-1.22395587","2":"-2.78065291","3":"3.14550409"},{"1":"-0.75311013","2":"1.96202837","3":"0.59938464"},{"1":"1.32801392","2":"-4.25541004","3":"1.04460392"},{"1":"-0.24174865","2":"0.51517469","3":"-0.68821620"},{"1":"0.55292812","2":"0.32962526","3":"1.15201767"},{"1":"-1.38976342","2":"0.18227394","3":"-1.86691141"},{"1":"0.20633230","2":"0.76029377","3":"4.27233650"},{"1":"-0.31920849","2":"3.55063527","3":"0.45077005"},{"1":"0.78482776","2":"-0.56564635","3":"-1.70953625"},{"1":"1.23964789","2":"-2.88080049","3":"0.84694745"},{"1":"0.27462181","2":"3.04164950","3":"-0.03903472"},{"1":"1.89759493","2":"-1.29407455","3":"1.11956044"},{"1":"-0.19262565","2":"-3.42396604","3":"1.05156905"},{"1":"-1.41365701","2":"-1.75335473","3":"1.49593530"},{"1":"0.35118649","2":"1.82462838","3":"1.86447305"},{"1":"1.45121334","2":"-2.37113604","3":"1.33013723"},{"1":"1.17029448","2":"2.34340037","3":"-0.14230534"},{"1":"-0.83901696","2":"1.86633352","3":"-0.39773459"},{"1":"0.31714653","2":"-0.14984045","3":"-0.99949269"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>mydata_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl[,1]"],"align":["right"]}],"data":[{"1":"x","2":"0.42678011"},{"1":"y","2":"1.98488355"},{"1":"y2","2":"0.10303468"},{"1":"x","2":"0.44408399"},{"1":"y","2":"1.27130904"},{"1":"y2","2":"-0.28089065"},{"1":"x","2":"-0.82789086"},{"1":"y","2":"-0.94427745"},{"1":"y2","2":"0.62388864"},{"1":"x","2":"-0.79925305"},{"1":"y","2":"0.10328425"},{"1":"y2","2":"5.42679005"},{"1":"x","2":"-0.32313106"},{"1":"y","2":"2.19041969"},{"1":"y2","2":"0.16807478"},{"1":"x","2":"-1.24462433"},{"1":"y","2":"0.19192798"},{"1":"y2","2":"-0.54936141"},{"1":"x","2":"-1.35506516"},{"1":"y","2":"4.81186172"},{"1":"y2","2":"0.30919557"},{"1":"x","2":"1.61563907"},{"1":"y","2":"1.55169550"},{"1":"y2","2":"-0.99039138"},{"1":"x","2":"-0.29189503"},{"1":"y","2":"3.35737558"},{"1":"y2","2":"-0.17200537"},{"1":"x","2":"-1.24940474"},{"1":"y","2":"1.92492196"},{"1":"y2","2":"-0.15832838"},{"1":"x","2":"-0.08659233"},{"1":"y","2":"-2.88047669"},{"1":"y2","2":"0.85387666"},{"1":"x","2":"-1.17065349"},{"1":"y","2":"1.75053169"},{"1":"y2","2":"3.33911133"},{"1":"x","2":"0.73756421"},{"1":"y","2":"-1.08428013"},{"1":"y2","2":"-1.88393968"},{"1":"x","2":"-0.48316590"},{"1":"y","2":"0.96031018"},{"1":"y2","2":"2.48425274"},{"1":"x","2":"0.40328291"},{"1":"y","2":"-1.54016895"},{"1":"y2","2":"-0.04867594"},{"1":"x","2":"0.91641886"},{"1":"y","2":"-1.24357666"},{"1":"y2","2":"-0.61515773"},{"1":"x","2":"0.41673257"},{"1":"y","2":"0.03193645"},{"1":"y2","2":"-0.28681098"},{"1":"x","2":"0.33137777"},{"1":"y","2":"-1.30918647"},{"1":"y2","2":"-0.12350146"},{"1":"x","2":"1.57677526"},{"1":"y","2":"-0.99658718"},{"1":"y2","2":"0.29936602"},{"1":"x","2":"-0.99289810"},{"1":"y","2":"1.42150401"},{"1":"y2","2":"-1.06763475"},{"1":"x","2":"1.22460582"},{"1":"y","2":"-0.90365732"},{"1":"y2","2":"0.12124860"},{"1":"x","2":"-0.57899018"},{"1":"y","2":"2.94554205"},{"1":"y2","2":"-0.40094019"},{"1":"x","2":"1.49026764"},{"1":"y","2":"2.57375451"},{"1":"y2","2":"-1.55553594"},{"1":"x","2":"-1.06533835"},{"1":"y","2":"-1.21795541"},{"1":"y2","2":"-0.51902218"},{"1":"x","2":"-1.39136994"},{"1":"y","2":"-2.10136309"},{"1":"y2","2":"-0.24857353"},{"1":"x","2":"0.66547299"},{"1":"y","2":"0.90556693"},{"1":"y2","2":"1.35671958"},{"1":"x","2":"-1.53224607"},{"1":"y","2":"0.53146356"},{"1":"y2","2":"0.14529688"},{"1":"x","2":"0.29011158"},{"1":"y","2":"0.90084614"},{"1":"y2","2":"0.83560170"},{"1":"x","2":"0.69239937"},{"1":"y","2":"0.12687786"},{"1":"y2","2":"2.29182497"},{"1":"x","2":"-1.76053733"},{"1":"y","2":"2.64999575"},{"1":"y2","2":"2.73673094"},{"1":"x","2":"0.72082239"},{"1":"y","2":"0.13435947"},{"1":"y2","2":"0.27574827"},{"1":"x","2":"-1.22395587"},{"1":"y","2":"-2.78065291"},{"1":"y2","2":"3.14550409"},{"1":"x","2":"-0.75311013"},{"1":"y","2":"1.96202837"},{"1":"y2","2":"0.59938464"},{"1":"x","2":"1.32801392"},{"1":"y","2":"-4.25541004"},{"1":"y2","2":"1.04460392"},{"1":"x","2":"-0.24174865"},{"1":"y","2":"0.51517469"},{"1":"y2","2":"-0.68821620"},{"1":"x","2":"0.55292812"},{"1":"y","2":"0.32962526"},{"1":"y2","2":"1.15201767"},{"1":"x","2":"-1.38976342"},{"1":"y","2":"0.18227394"},{"1":"y2","2":"-1.86691141"},{"1":"x","2":"0.20633230"},{"1":"y","2":"0.76029377"},{"1":"y2","2":"4.27233650"},{"1":"x","2":"-0.31920849"},{"1":"y","2":"3.55063527"},{"1":"y2","2":"0.45077005"},{"1":"x","2":"0.78482776"},{"1":"y","2":"-0.56564635"},{"1":"y2","2":"-1.70953625"},{"1":"x","2":"1.23964789"},{"1":"y","2":"-2.88080049"},{"1":"y2","2":"0.84694745"},{"1":"x","2":"0.27462181"},{"1":"y","2":"3.04164950"},{"1":"y2","2":"-0.03903472"},{"1":"x","2":"1.89759493"},{"1":"y","2":"-1.29407455"},{"1":"y2","2":"1.11956044"},{"1":"x","2":"-0.19262565"},{"1":"y","2":"-3.42396604"},{"1":"y2","2":"1.05156905"},{"1":"x","2":"-1.41365701"},{"1":"y","2":"-1.75335473"},{"1":"y2","2":"1.49593530"},{"1":"x","2":"0.35118649"},{"1":"y","2":"1.82462838"},{"1":"y2","2":"1.86447305"},{"1":"x","2":"1.45121334"},{"1":"y","2":"-2.37113604"},{"1":"y2","2":"1.33013723"},{"1":"x","2":"1.17029448"},{"1":"y","2":"2.34340037"},{"1":"y2","2":"-0.14230534"},{"1":"x","2":"-0.83901696"},{"1":"y","2":"1.86633352"},{"1":"y2","2":"-0.39773459"},{"1":"x","2":"0.31714653"},{"1":"y","2":"-0.14984045"},{"1":"y2","2":"-0.99949269"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>mydata_long_y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl[,1]"],"align":["right"]}],"data":[{"1":"y","2":"1.98488355"},{"1":"y2","2":"0.10303468"},{"1":"y","2":"1.27130904"},{"1":"y2","2":"-0.28089065"},{"1":"y","2":"-0.94427745"},{"1":"y2","2":"0.62388864"},{"1":"y","2":"0.10328425"},{"1":"y2","2":"5.42679005"},{"1":"y","2":"2.19041969"},{"1":"y2","2":"0.16807478"},{"1":"y","2":"0.19192798"},{"1":"y2","2":"-0.54936141"},{"1":"y","2":"4.81186172"},{"1":"y2","2":"0.30919557"},{"1":"y","2":"1.55169550"},{"1":"y2","2":"-0.99039138"},{"1":"y","2":"3.35737558"},{"1":"y2","2":"-0.17200537"},{"1":"y","2":"1.92492196"},{"1":"y2","2":"-0.15832838"},{"1":"y","2":"-2.88047669"},{"1":"y2","2":"0.85387666"},{"1":"y","2":"1.75053169"},{"1":"y2","2":"3.33911133"},{"1":"y","2":"-1.08428013"},{"1":"y2","2":"-1.88393968"},{"1":"y","2":"0.96031018"},{"1":"y2","2":"2.48425274"},{"1":"y","2":"-1.54016895"},{"1":"y2","2":"-0.04867594"},{"1":"y","2":"-1.24357666"},{"1":"y2","2":"-0.61515773"},{"1":"y","2":"0.03193645"},{"1":"y2","2":"-0.28681098"},{"1":"y","2":"-1.30918647"},{"1":"y2","2":"-0.12350146"},{"1":"y","2":"-0.99658718"},{"1":"y2","2":"0.29936602"},{"1":"y","2":"1.42150401"},{"1":"y2","2":"-1.06763475"},{"1":"y","2":"-0.90365732"},{"1":"y2","2":"0.12124860"},{"1":"y","2":"2.94554205"},{"1":"y2","2":"-0.40094019"},{"1":"y","2":"2.57375451"},{"1":"y2","2":"-1.55553594"},{"1":"y","2":"-1.21795541"},{"1":"y2","2":"-0.51902218"},{"1":"y","2":"-2.10136309"},{"1":"y2","2":"-0.24857353"},{"1":"y","2":"0.90556693"},{"1":"y2","2":"1.35671958"},{"1":"y","2":"0.53146356"},{"1":"y2","2":"0.14529688"},{"1":"y","2":"0.90084614"},{"1":"y2","2":"0.83560170"},{"1":"y","2":"0.12687786"},{"1":"y2","2":"2.29182497"},{"1":"y","2":"2.64999575"},{"1":"y2","2":"2.73673094"},{"1":"y","2":"0.13435947"},{"1":"y2","2":"0.27574827"},{"1":"y","2":"-2.78065291"},{"1":"y2","2":"3.14550409"},{"1":"y","2":"1.96202837"},{"1":"y2","2":"0.59938464"},{"1":"y","2":"-4.25541004"},{"1":"y2","2":"1.04460392"},{"1":"y","2":"0.51517469"},{"1":"y2","2":"-0.68821620"},{"1":"y","2":"0.32962526"},{"1":"y2","2":"1.15201767"},{"1":"y","2":"0.18227394"},{"1":"y2","2":"-1.86691141"},{"1":"y","2":"0.76029377"},{"1":"y2","2":"4.27233650"},{"1":"y","2":"3.55063527"},{"1":"y2","2":"0.45077005"},{"1":"y","2":"-0.56564635"},{"1":"y2","2":"-1.70953625"},{"1":"y","2":"-2.88080049"},{"1":"y2","2":"0.84694745"},{"1":"y","2":"3.04164950"},{"1":"y2","2":"-0.03903472"},{"1":"y","2":"-1.29407455"},{"1":"y2","2":"1.11956044"},{"1":"y","2":"-3.42396604"},{"1":"y2","2":"1.05156905"},{"1":"y","2":"-1.75335473"},{"1":"y2","2":"1.49593530"},{"1":"y","2":"1.82462838"},{"1":"y2","2":"1.86447305"},{"1":"y","2":"-2.37113604"},{"1":"y2","2":"1.33013723"},{"1":"y","2":"2.34340037"},{"1":"y2","2":"-0.14230534"},{"1":"y","2":"1.86633352"},{"1":"y2","2":"-0.39773459"},{"1":"y","2":"-0.14984045"},{"1":"y2","2":"-0.99949269"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="signed-rank-values" class="level2"><h2 class="anchored" data-anchor-id="signed-rank-values">“Signed Rank” Values</h2>
<p>Most statistical tests use the <strong>actual values</strong> of the data variables. However, in some <em>non-parametric</em> statistical tests, the data are used in <strong>rank-transformed</strong> sense/order. In some cases the <strong>signed-rank</strong> of the data values is used instead of the data itself.</p>
<p>Signed Rank is calculated as follows:<br>
1. Take the absolute value of each observation in a sample<br>
2. Place the <u><em>ranks</em></u> in order of (absolute magnitude). The smallest number has <em>rank = 1</em> and so on.<br>
3. Give each of the ranks the sign of the original observation ( + or - )</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/signed_rank_function_3213fe5c48229c7f495904792a992777">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>signed_rank <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">sign</span>(x) <span class="sc">*</span> <span class="fu">rank</span>(<span class="fu">abs</span>(x))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="plotting-original-and-signed-rank-data" class="level2"><h2 class="anchored" data-anchor-id="plotting-original-and-signed-rank-data">Plotting Original and Signed Rank Data</h2>
<p>A quick plot:</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/data_plots_89d89a51d9140ee8e66894101e9ad923">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_long,<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.02</span>, <span class="at">height =</span> <span class="dv">0</span>,<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb6-4"><a href="#cb6-4"></a>                                       <span class="at">x =</span> .<span class="dv">75</span>, </span>
<span id="cb6-5"><a href="#cb6-5"></a>                                       <span class="at">xend =</span> <span class="fl">1.25</span> )) <span class="sc">+</span> </span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="st">"0"</span>)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.3</span>, <span class="at">yend =</span> <span class="fl">0.3</span>, </span>
<span id="cb6-8"><a href="#cb6-8"></a>                                       <span class="at">x =</span> <span class="fl">1.75</span> , </span>
<span id="cb6-9"><a href="#cb6-9"></a>                                       <span class="at">xend =</span> <span class="fl">2.25</span> )) <span class="sc">+</span> </span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">0.6</span>, <span class="at">label =</span> <span class="st">"0.3"</span>)) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">yend =</span> <span class="fl">0.5</span>, </span>
<span id="cb6-12"><a href="#cb6-12"></a>                                       <span class="at">x =</span> <span class="fl">2.75</span>, </span>
<span id="cb6-13"><a href="#cb6-13"></a>                                       <span class="at">xend =</span> <span class="fl">3.25</span> )) <span class="sc">+</span> </span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.8</span>, <span class="at">label =</span> <span class="st">"0.5"</span>)) <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Original Data"</span>) <span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="fu">ylab</span>(<span class="st">"Response Variable"</span>)</span>
<span id="cb6-17"><a href="#cb6-17"></a></span>
<span id="cb6-18"><a href="#cb6-18"></a>p2 <span class="ot">&lt;-</span> mydata_long <span class="sc">%&gt;%</span> </span>
<span id="cb6-19"><a href="#cb6-19"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> </span>
<span id="cb6-20"><a href="#cb6-20"></a>  <span class="fu">mutate</span>( <span class="at">s_value =</span> <span class="fu">signed_rank</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-21"><a href="#cb6-21"></a>  <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> s_value)) <span class="sc">+</span> </span>
<span id="cb6-22"><a href="#cb6-22"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.02</span>, <span class="at">height =</span> <span class="dv">0</span>,<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb6-23"><a href="#cb6-23"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, </span>
<span id="cb6-24"><a href="#cb6-24"></a>               <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb6-25"><a href="#cb6-25"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Signed Rank of Data"</span>) <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26"></a>  <span class="fu">ylab</span>(<span class="st">"Signed Rank of Response Variable"</span>)</span>
<span id="cb6-27"><a href="#cb6-27"></a></span>
<span id="cb6-28"><a href="#cb6-28"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="lmCompMeans_files/figure-html/data_plots-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section><section id="how-does-sign-rank-data-work" class="level2"><h2 class="anchored" data-anchor-id="how-does-sign-rank-data-work">How does Sign-Rank data work?</h2>
<p>TBD: need to add some explanation here.</p>
</section></section><section id="the-linear-regression-model" class="level1 tabset page-columns page-full"><h1 class="tabset">The Linear ( Regression ) Model</h1>
<p>The premise here is that many common statistical tests are special cases of the linear model.</p>
<p>A linear model estimates the relationship between one <em>continuous</em> or <em>ordinal</em> variable (dependent variable or “response” ) and one or more other variables ( explanatory variable or “predictors” ). It is assumed that the relationship is linear:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 *x
\]</span> <span class="math inline">\(\beta_0\)</span> is the <em>intercept</em> and <span class="math inline">\(\beta_1\)</span> is the slope of the linear fit, that <strong>predicts</strong> the value of y based the value of x. Each prediction leaves a small “residual” error between the actual and predicted values. <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are calculated based on minimizing the <em>sum of square</em>s of these residuals, and hence this method is called “ordinary least squares” regression.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p><img src="OLS.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption margin-caption">Least Squares</figcaption></figure>
</div>
<p>The net <em>area</em> of all the shaded squares is minimized in the calculation of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. It is also possible that there is more than one explanatory variable: this is <strong>multiple regression.</strong></p>
<p><span class="math display">\[
y = \beta_0 + \beta_1*x_1 + \beta_2*x_2 ...+ \beta_n*x_n
\]</span></p>
<p>where each of the <span class="math inline">\(\beta_i\)</span> are slopes defining the relationship between y and <span class="math inline">\(x_i\)</span>. Together, the RHS of that equation defines an n-dimensional <em>plane</em>.</p>
<p>As per Lindoloev, many statistical tests, going from one-sample t-tests to two-way ANOVA, are special cases of this system.</p>
<p>Also see <a href="https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables">Jeffrey Walker “A linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables”</a></p>
<section id="linear-models-as-hypothesis-tests" class="level2"><h2 class="anchored" data-anchor-id="linear-models-as-hypothesis-tests">Linear Models as Hypothesis Tests</h2>
<p>Using linear models is based on the idea of <strong>Testing of Hypotheses</strong>. The Hypothesis Testing method typically defines a NULL Hypothesis where the statements read as “<strong>there is no relationship</strong>” between the variables at hand, explanatory and responses. The Alternative Hypothesis typically states that there <em>is</em> a relationship between the variables.</p>
<p>Accordingly, in fitting a linear model, we follow the process as follows: With <span class="math inline">\(y = \beta_0 + \beta_1 *x\)</span><br></p>
<ol type="1">
<li>Make the following hypotheses: <span class="math display">\[
NULL\ Hypothesis\ H_0 =&gt; x\ and\ y\ are\ unrelated.\ (\beta_1 = 0)
\]</span> <span class="math display">\[
Alternate\ Hypothesis\ H_1 =&gt; x\ and\ y\ are\ linearly\ related\ (\beta_1 \ne 0)
\]</span>
</li>
<li>We “assume” that <span class="math inline">\(H_0\)</span> is true.</li>
<li>We calculate <span class="math inline">\(\beta_1\)</span>.</li>
<li>We then find probability <strong>p</strong> that [<span class="math inline">\(\beta_1 = Estimated\ Value\)</span>] <strong>when the NULL Hypothesis</strong> is <strong>assumed</strong> TRUE. This is the <strong>p-value</strong>. If that probability is <strong>p&gt;=0.05</strong>, we say we “cannot reject” <span class="math inline">\(H_0\)</span> and there is unlikely to be significant linear relationship.</li>
</ol>
<p>However, if <strong>p&lt;= 0.05</strong> can we reject the NULL hypothesis, and say that there could be a significant linear relationship,because <span class="math inline">\(\beta_1 = Estimated\ Value\)</span> by mere chance under <span class="math inline">\(H_0\)</span> is very small.</p>
</section><section id="linear-models-in-r" class="level2"><h2 class="anchored" data-anchor-id="linear-models-in-r">Linear Models in R</h2>
<p><code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> is the function to create linear models in R. In R we are lazy and write :</p>
<p><span class="math display">\[
y \sim 1 + x\\
\]</span> <span class="math display">\[
which\ reads\ like\\
\]</span> <span class="math display">\[
y = 1*number + x* another\ number
\]</span></p>
<p>Note: there are very many ways in which linear models can be coded in R. See <a href="https://cran.r-project.org/doc/contrib/Ricci-refcard-regression.pdf">Vito Ricci on CRAN.</a></p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/linear_model_157da52a94490544c1656160915e3a8c">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># using lm()</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span>   </span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ 1 + x, data = mydata_wide)

Residuals:
     Min       1Q   Median       3Q      Max 
-3.93980 -1.09967  0.12548  1.27904  3.88372 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  0.30000    0.27799  1.0792   0.2859
x           -0.46355    0.28081 -1.6507   0.1053

Residual standard error: 1.9657 on 48 degrees of freedom
Multiple R-squared:  0.05372,   Adjusted R-squared:  0.034006 
F-statistic:  2.725 on 1 and 48 DF,  p-value: 0.10532</code></pre>
</div>
</div>
<p>Since the <em>p-value</em> is &gt;=0.05, we <em>fail to reject the NULL Hypothesis that there is no relationship between x and y</em>.</p>
</section><section id="assumptions-in-linear-models" class="level2"><h2 class="anchored" data-anchor-id="assumptions-in-linear-models">Assumptions in Linear Models</h2>
<ol type="1">
<li>
<strong>L</strong>: <span class="math inline">\(\color{blue}{linear}\)</span> relationship</li>
<li>
<strong>I</strong>: Errors are <strong>independent</strong> (across observations)</li>
<li>
<strong>N</strong>: y is <span class="math inline">\(\color{red}{normally}\)</span> distributed at each “level” of
<ol start="24" type="a">
<li>
</li></ol>
</li>
<li>
<strong>E</strong>: equal variance at all levels of x. No <em>heteroscedasticity</em>. <img src="ols_assumptions.png" class="img-fluid" alt="OLS Assumptions">
</li>
</ol>
<p>Let us now see which standard statistical tests can be re-formulated as Linear Models.</p>
</section></section><section id="tests-for-correlation" class="level1 tabset"><h1 class="tabset">Tests for Correlation</h1>
<p>Correlation <strong>r</strong> is a measure of <em>strength</em> and <em>direction</em> of <em>linear association</em> between two variables. <strong>r</strong> is between [-1,+1], with 0 implying no association/correlation.</p>
<p>From this definition, the <em>linear model</em> lends itself in a straightforward way as a model to interpret <em>correlation</em>. Intuitively, the slope of the linear model could be related to the correlation between y and x.</p>
<p>Now we look at the numbers.</p>
<section id="pearson-correlation" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="pearson-correlation">Pearson Correlation</h2>
<section id="model-1" class="level3"><h3 class="anchored" data-anchor-id="model-1">Model</h3>
<p>The model for Pearson Correlation tests is exactly the Linear Model:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 * x
\\
H_0: \beta_1 = 0
\]</span></p>
<p>See the Code section for further insights into the relationship between the Correlation Score and the Slope of the Linear Model.</p>
</section><section id="code-1" class="level3"><h3 class="anchored" data-anchor-id="code-1">Code</h3>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Pearson_Correlation_598608da0e761ee8e907fb34b84d1358">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Pearson (built-in test)</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>cor <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(y,x,<span class="at">method =</span> <span class="st">"pearson"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co"># Linear Model</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>lin <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href="#cb9-7"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb9-8"><a href="#cb9-8"></a></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co"># Scaled linear model</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>lin_scl <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">scale</span>(y) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">scale</span>(x), <span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb9-12"><a href="#cb9-12"></a></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="fu">print</span>(cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  estimate p.value
     &lt;dbl&gt;   &lt;dbl&gt;
1   -0.232   0.105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">print</span>(lin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  estimate p.value
     &lt;dbl&gt;   &lt;dbl&gt;
1    0.3     0.286
2   -0.464   0.105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">print</span>(lin_scl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   estimate p.value
      &lt;dbl&gt;   &lt;dbl&gt;
1 -9.06e-17   1    
2 -2.32e- 1   0.105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># All together</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">rbind</span>(cor, lin, lin_scl) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
   estimate p.value
      &lt;dbl&gt;   &lt;dbl&gt;
1 -2.32e- 1   0.105
2  3   e- 1   0.286
3 -4.64e- 1   0.105
4 -9.06e-17   1    
5 -2.32e- 1   0.105</code></pre>
</div>
</div>
<p>Notes: 1. The <em>p-value</em> for Pearson Correlation and that for the <em>slope</em> in the linear model is the same ( 0.1053 ). Which means we cannot reject the NULL hypothesis of “no relationship”.</p>
<ol start="2" type="1">
<li>Here is the relationship between the slope and correlation:</li>
</ol>
<p><span class="math display">\[
Slope\ \beta_1 = \frac{sd_y}{sd_x} * r
\]</span></p>
<p>When both x and y have the same standard deviation, the slope and correlation are the same. Here, since x has twice the <code>sd</code> of y, the ratio of <strong>slope</strong> = -0.4635533 to <strong>r</strong> = -0.2317767 is 0.5. Hence a linear model using <code><a href="https://rdrr.io/r/base/scale.html">scale()</a></code> for both variables will show slope = <strong>r</strong>.</p>
<p>Slope_Scaled: -0.2317767 = Correlation: -0.2317767</p>
</section><section id="example-1" class="level3"><h3 class="anchored" data-anchor-id="example-1">Example</h3>
<p>We choose to look at the <code>gpa_study_hours</code> dataset. It has two numeric columns <code>gpa</code> and <code>study_hours</code>:</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/gpa_study_hours_5dce1206dcb493ed2276ffa713294c00">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">glimpse</span>(gpa_study_hours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 193
Columns: 2
$ gpa         &lt;dbl&gt; 4.000, 3.800, 3.930, 3.400, 3.200, 3.520, 3.680, 3.400, 3.…
$ study_hours &lt;dbl&gt; 10, 25, 45, 10, 4, 10, 24, 40, 10, 10, 30, 7, 15, 60, 10, …</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Pearson_example_1_a10d76c334be2191e4b4607fa4bbe516">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Checks for Normal/Symmetric distributions</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gpa_study_hours) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(gpa))</span>
<span id="cb19-3"><a href="#cb19-3"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gpa_study_hours) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(study_hours))</span>
<span id="cb19-4"><a href="#cb19-4"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gpa_study_hours) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(gpa, study_hours))</span>
<span id="cb19-5"><a href="#cb19-5"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="lmCompMeans_files/figure-html/Pearson_example_1-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>Hmm…not normally distributed, and the relationship is also not linear, and there is some evidence of heterscedasticity, so Pearson correlation would not be the best idea here.</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Pearson_example_2_1792af1cb9eae5d9a476395ab03df9dc">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Pearson Correlation as Linear Model</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fu">lm</span>(gpa <span class="sc">~</span> study_hours, <span class="at">data =</span> gpa_study_hours) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gpa ~ study_hours, data = gpa_study_hours)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.95130 -0.19456  0.03879  0.21708  0.73872 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 3.527997   0.037424  94.272   &lt;2e-16 ***
study_hours 0.003328   0.001794   1.855   0.0652 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2837 on 191 degrees of freedom
Multiple R-squared:  0.01769,   Adjusted R-squared:  0.01255 
F-statistic:  3.44 on 1 and 191 DF,  p-value: 0.06517</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Other ways using other packages</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>mosaic<span class="sc">::</span><span class="fu">cor_test</span>(gpa <span class="sc">~</span> study_hours, <span class="at">data =</span> gpa_study_hours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  gpa and study_hours
t = 1.8548, df = 191, p-value = 0.06517
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.008383868  0.269196552
sample estimates:
      cor 
0.1330138 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>statsExpressions<span class="sc">::</span><span class="fu">corr_test</span>(<span class="at">data =</span> gpa_study_hours, </span>
<span id="cb24-2"><a href="#cb24-2"></a>                            <span class="at">x =</span> study_hours, </span>
<span id="cb24-3"><a href="#cb24-3"></a>                            <span class="at">y =</span> gpa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["parameter1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["parameter2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["effectsize"],"name":[3],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf.level"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["df.error"],"name":[9],"type":["int"],"align":["right"]},{"label":["p.value"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[11],"type":["chr"],"align":["left"]},{"label":["n.obs"],"name":[12],"type":["int"],"align":["right"]},{"label":["conf.method"],"name":[13],"type":["chr"],"align":["left"]},{"label":["expression"],"name":[14],"type":["list"],"align":["right"]}],"data":[{"1":"study_hours","2":"gpa","3":"Pearson correlation","4":"0.1330138","5":"0.95","6":"-0.008383868","7":"0.2691966","8":"1.854768","9":"191","10":"0.06517072","11":"Pearson correlation","12":"193","13":"normal","14":"<language>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The correlation estimate is <span class="math inline">\(0.133\)</span>; the <code>p-value</code> is 0.065 and the confidence interval includes 0. Hence we fail to reject the NULL hypothesis that <code>study_hours</code> and <code>gpa</code> have no relationship.</p>
<p>We can use a later package <code>ggstaplot</code> to plot this:</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Pearson_example_3_e7933fe762166e02a1b50407f9ba43bc">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggscatterstats</span>(<span class="at">data =</span> gpa_study_hours, </span>
<span id="cb25-2"><a href="#cb25-2"></a>                            <span class="at">x =</span> study_hours, </span>
<span id="cb25-3"><a href="#cb25-3"></a>                            <span class="at">y =</span> gpa,</span>
<span id="cb25-4"><a href="#cb25-4"></a>                            <span class="at">type =</span> <span class="st">"robust"</span>,</span>
<span id="cb25-5"><a href="#cb25-5"></a>                            <span class="at">marginal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-6"><a href="#cb25-6"></a>                            <span class="at">title =</span> <span class="st">"GPA vs Study Hours"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="lmCompMeans_files/figure-html/Pearson_example_3-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="spearman-correlation" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="spearman-correlation">Spearman Correlation</h2>
<section id="model-2" class="level3"><h3 class="anchored" data-anchor-id="model-2">Model</h3>
<p>In some cases the <strong>LINE</strong> assumptions may not hold. Nonlinear relationships, non-normally distributed data ( with large outliers ) and working with <em>ordinal</em> rather than continuous data: these situations necessitate the use of Spearman’s <em>ranked</em> correlation scores. (<strong>Ranked</strong>, not <strong>sign-ranked</strong>.)</p>
<p><span class="math display">\[
rank(y) = \beta_0 + \beta_1 * rank(x) \\
H_0: \beta_1 = 0
\]</span></p>
<p>Spearman correlation = Pearson correlation using the rank of the data observations. Let’s check how this holds for a our x and y data:</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Spearman_Plot_b8021a7789544fc3f67f86e319d7f5db">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Plot the data</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">ggtitle</span>(<span class="st">" Pearson Correlation</span><span class="sc">\n</span><span class="st"> and Linear Models"</span>)</span>
<span id="cb26-6"><a href="#cb26-6"></a></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co"># Plot ranked data</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>p2 <span class="ot">&lt;-</span> mydata_wide <span class="sc">%&gt;%</span> </span>
<span id="cb26-9"><a href="#cb26-9"></a>  <span class="fu">mutate</span>(<span class="at">x_rank =</span> <span class="fu">rank</span>(x),</span>
<span id="cb26-10"><a href="#cb26-10"></a>         <span class="at">y_rank =</span> <span class="fu">rank</span>(y)) <span class="sc">%&gt;%</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(x_rank, y_rank)) <span class="sc">+</span> </span>
<span id="cb26-12"><a href="#cb26-12"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">15</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb26-14"><a href="#cb26-14"></a>  <span class="fu">ggtitle</span>(<span class="st">" Spearman Ranked Correlation</span><span class="sc">\n</span><span class="st"> and Linear Models"</span>)</span>
<span id="cb26-15"><a href="#cb26-15"></a></span>
<span id="cb26-16"><a href="#cb26-16"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="lmCompMeans_files/figure-html/Spearman_Plot-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>Slopes are almost identical, ~ 0.25.</p>
</section><section id="code-2" class="level3"><h3 class="anchored" data-anchor-id="code-2">Code</h3>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Spearman_Correlation_d9e501f782bbde1eac47e9520c5d4288">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Spearman</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>cor1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(y,x, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb27-4"><a href="#cb27-4"></a></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="co"># Pearson using ranks</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>cor2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(<span class="fu">rank</span>(y), <span class="fu">rank</span>(x), <span class="at">method =</span> <span class="st">"pearson"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-7"><a href="#cb27-7"></a>broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb27-8"><a href="#cb27-8"></a></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="co"># Linear Models using rank</span></span>
<span id="cb27-10"><a href="#cb27-10"></a>cor3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">rank</span>(y) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">rank</span>(x),<span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb27-11"><a href="#cb27-11"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb27-12"><a href="#cb27-12"></a></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="fu">rbind</span>(cor1, cor2, cor3) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  estimate  p.value
     &lt;dbl&gt;    &lt;dbl&gt;
1   -0.227 1.13e- 1
2   -0.227 1.14e- 1
3   31.3   9.11e-10
4   -0.227 1.14e- 1</code></pre>
</div>
</div>
<p>Notes:</p>
<ol type="1">
<li><p>When ranks are used, the slope of the linear model (<span class="math inline">\(\beta_1\)</span>) has the same value as the correlation coefficient ( <span class="math inline">\(\rho\)</span> ).</p></li>
<li><p>Note that the slope from the linear model now has an intuitive interpretation: <strong>the number of ranks y changes for each change in rank of x</strong>. ( Ranks are “independent” of <code>sd</code> )</p></li>
</ol></section><section id="example-2" class="level3"><h3 class="anchored" data-anchor-id="example-2">Example</h3>
<p>We examine the <code>cars93</code> data, where the numeric variables of interest are <code>weight</code> and <code>price</code>.</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Spearman_example_1_b0e7e431a29302ea0b39a1c02dc3692e">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>cars93 <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(weight, price)) <span class="sc">+</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Car Weight and Car Price have a nonlinear relationship"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="lmCompMeans_files/figure-html/Spearman_example_1-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>Let us try a Spearman Correlation score for these variables, since the data are not linearly related and the variance of <code>price</code> also is not constant over <code>weight</code></p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Spearman_example_2_05ddf170f34ceae7263e0e02d0d31337">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">cor.test</span>(cars93<span class="sc">$</span>price, cars93<span class="sc">$</span>weight, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["estimate"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[4],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"0.8828317","2":"3073.91","3":"1.066315e-18","4":"Spearman's rank correlation rho","5":"two.sided"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Using linear Model</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="fu">lm</span>(<span class="fu">rank</span>(price) <span class="sc">~</span> <span class="fu">rank</span>(weight), <span class="at">data =</span> cars93) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rank(price) ~ rank(weight), data = cars93)

Residuals:
     Min       1Q   Median       3Q      Max 
-20.0676  -3.0135   0.7815   3.6926  20.4099 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.22074    2.05894   1.564    0.124    
rank(weight)  0.88288    0.06514  13.554   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.46 on 52 degrees of freedom
Multiple R-squared:  0.7794,    Adjusted R-squared:  0.7751 
F-statistic: 183.7 on 1 and 52 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># Stats Plot</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggscatterstats</span>(<span class="at">data =</span> cars93, <span class="at">x =</span> weight, </span>
<span id="cb33-3"><a href="#cb33-3"></a>                            <span class="at">y =</span> price,</span>
<span id="cb33-4"><a href="#cb33-4"></a>                            <span class="at">type =</span> <span class="st">"nonparametric"</span>,</span>
<span id="cb33-5"><a href="#cb33-5"></a>                            <span class="at">title =</span> <span class="st">"Cars93: Weight vs Price"</span>,</span>
<span id="cb33-6"><a href="#cb33-6"></a>                            <span class="at">subtitle =</span> <span class="st">"Spearman Correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="lmCompMeans_files/figure-html/Spearman_example_2-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>We see that using ranks of the <code>price</code> variable, we obtain a Spearman’s <span class="math inline">\(\rho = 0.882\)</span> with a <code>p-value</code> that is very small. Hence we are able to reject the NULL hypothesis and state that there is a relationship between these two variables. The <strong>linear</strong> relationship is evaluated as a correlation of <code>0.882</code>.</p>
</section></section></section><section id="tests-on-one-mean" class="level1 tabset"><h1 class="tabset">Tests on One Mean</h1>
<p>A series of tests deal with one mean value of a sample. The idea is to evaluate whether that mean is representative of the mean of the underlying population.</p>
<p>This uses the <em>Student’s t-test</em> for parametric data and the <em>Wilcoxon signed-rank test</em> for non-parametric data.</p>
<p>Tests can involve a <em>single sample</em> or <em>paired samples</em>.</p>
<section id="the-students-t-test-with-one-sample" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="the-students-t-test-with-one-sample">The Student’s t-test with one sample</h2>
<section id="model-3" class="level3"><h3 class="anchored" data-anchor-id="model-3">Model</h3>
<p>A single number predicts y:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1*x \\
\\and\ further \ actually\\
y = \beta_0
\]</span></p>
<p>and the second term vanishes, since “there is no x”: all the x-values are made equal to zero in the linear model !! The NULL Hypothesis therefore is:</p>
<p><span class="math display">\[
\ H_0: \beta_0 = 0
\]</span></p>
<p>This NULL Hypothesis makes sense, because in the accompanying linear model all values of the <u>explanatory</u> variable x are zero, and therefore the NULL Hypothesis for the model should be that y also should be zero mean. Note that if we <strong>want</strong> the NULL hypothesis to be that the mean is other than zero, we can use the <code>lm(...., mu = some_number, ..)</code> parameter in the command.</p>
</section><section id="code-3" class="level3"><h3 class="anchored" data-anchor-id="code-3">Code</h3>
<p>If we compare the <code>t.test</code> with the appropriate <code>lm</code> model:</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/t_test_one_mean_c786899f776772fb980ab3757ae62809">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># t-test</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>t1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="fu">print</span>(t1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  y
t = 1.0607, df = 49, p-value = 0.294
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.2683937  0.8683937
sample estimates:
mean of x 
      0.3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># linear model</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mydata_wide)</span>
<span id="cb36-3"><a href="#cb36-3"></a>lm1 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ 1, data = mydata_wide)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5554 -1.4845 -0.0392  1.5559  4.5119 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.3000     0.2828   1.061    0.294

Residual standard error: 2 on 49 degrees of freedom</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>lm1 <span class="sc">%&gt;%</span> <span class="fu">confint</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %    97.5 %
(Intercept) -0.2683937 0.8683937</code></pre>
</div>
</div>
<p>The confidence intervals for both the <code>t.test</code> and the <code>lm</code> model are identical.</p>
<p>t-test confidence intervals: -0.2683937, 0.8683937<br>
linear model confidence intervals: -0.2683937, 0.8683937</p>
<p>So even though y has a mean of 0.3, the confidence intervals straddle zero, and hence we cannot reject the NULL hypothesis that the true population, of which y is a sample, could have mean=0.</p>
</section><section id="example-3" class="level3"><h3 class="anchored" data-anchor-id="example-3">Example</h3>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/unnamed-chunk-1_54496d4eec450294f079f89af6a14ca2">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>exam_grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["semester"],"name":[1],"type":["chr"],"align":["left"]},{"label":["sex"],"name":[2],"type":["chr"],"align":["left"]},{"label":["exam1"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["exam2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["exam3"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["course_grade"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"2000-1","2":"Man","3":"84.5000","4":"69.5","5":"86.5000","6":"76.2564"},{"1":"2000-1","2":"Man","3":"80.0000","4":"74.0","5":"67.0000","6":"75.3882"},{"1":"2000-1","2":"Man","3":"56.0000","4":"70.0","5":"71.5000","6":"67.0564"},{"1":"2000-1","2":"Man","3":"64.0000","4":"61.0","5":"67.5000","6":"63.4538"},{"1":"2000-1","2":"Man","3":"90.5000","4":"72.5","5":"75.0000","6":"72.3949"},{"1":"2000-1","2":"Man","3":"74.0000","4":"78.5","5":"84.5000","6":"71.4128"},{"1":"2000-1","2":"Man","3":"60.5000","4":"44.0","5":"58.0000","6":"56.0949"},{"1":"2000-1","2":"Man","3":"89.0000","4":"82.0","5":"88.0000","6":"78.0103"},{"1":"2000-1","2":"Woman","3":"87.5000","4":"86.5","5":"95.0000","6":"82.9026"},{"1":"2000-1","2":"Man","3":"91.0000","4":"98.0","5":"88.0000","6":"89.0846"},{"1":"2000-1","2":"Man","3":"79.5000","4":"88.0","5":"56.0000","6":"72.9769"},{"1":"2000-1","2":"Man","3":"96.0000","4":"91.5","5":"78.0000","6":"82.5282"},{"1":"2000-1","2":"Man","3":"55.0000","4":"79.5","5":"72.0000","6":"69.9872"},{"1":"2000-1","2":"Man","3":"80.0000","4":"83.5","5":"70.0000","6":"67.7256"},{"1":"2000-1","2":"Woman","3":"64.5000","4":"83.5","5":"77.0000","6":"80.3051"},{"1":"2000-1","2":"Man","3":"73.0000","4":"90.0","5":"96.0000","6":"74.8744"},{"1":"2000-1","2":"Man","3":"83.0000","4":"79.0","5":"65.0000","6":"71.1615"},{"1":"2000-1","2":"Man","3":"72.0000","4":"91.0","5":"90.0000","6":"76.5615"},{"1":"2000-1","2":"Woman","3":"57.9000","4":"53.0","5":"47.0000","6":"56.9903"},{"1":"2000-1","2":"Man","3":"89.0000","4":"83.5","5":"78.5000","6":"80.8026"},{"1":"2000-1","2":"Woman","3":"69.0000","4":"57.0","5":"88.0000","6":"69.4308"},{"1":"2000-1","2":"Woman","3":"91.0000","4":"91.0","5":"95.5000","6":"92.0051"},{"1":"2000-1","2":"Man","3":"68.0000","4":"84.5","5":"64.0000","6":"67.9051"},{"1":"2000-1","2":"Man","3":"83.0000","4":"89.5","5":"93.0000","6":"79.7872"},{"1":"2000-1","2":"Man","3":"72.0000","4":"77.5","5":"67.0000","6":"67.1256"},{"1":"2000-1","2":"Woman","3":"56.0000","4":"45.0","5":"61.0000","6":"58.6308"},{"1":"2000-1","2":"Man","3":"55.0000","4":"71.0","5":"72.0000","6":"67.8308"},{"1":"2000-1","2":"Woman","3":"68.5000","4":"64.0","5":"93.0000","6":"77.6903"},{"1":"2000-1","2":"Man","3":"68.5000","4":"79.5","5":"50.5000","6":"69.9308"},{"1":"2000-1","2":"Man","3":"70.0000","4":"71.0","5":"76.0000","6":"69.6769"},{"1":"2000-1","2":"Man","3":"75.0000","4":"81.0","5":"81.5000","6":"68.0923"},{"1":"2000-1","2":"Man","3":"68.5000","4":"66.0","5":"58.0000","6":"60.3128"},{"1":"2000-1","2":"Man","3":"54.0000","4":"84.0","5":"88.0000","6":"72.3821"},{"1":"2000-1","2":"Man","3":"79.6000","4":"67.0","5":"72.0000","6":"67.4787"},{"1":"2000-1","2":"Man","3":"85.0000","4":"61.0","5":"44.5000","6":"66.2364"},{"1":"2000-1","2":"Man","3":"82.0000","4":"86.5","5":"92.5000","6":"83.3231"},{"1":"2000-1","2":"Woman","3":"65.0000","4":"83.5","5":"87.0000","6":"77.6436"},{"1":"2000-1","2":"Woman","3":"76.0000","4":"50.0","5":"91.5000","6":"70.9462"},{"1":"2000-1","2":"Man","3":"94.5000","4":"67.0","5":"96.0000","6":"86.0133"},{"1":"2000-1","2":"Man","3":"72.0000","4":"67.0","5":"90.0000","6":"72.0269"},{"1":"2000-1","2":"Man","3":"65.5000","4":"82.5","5":"79.0000","6":"77.0282"},{"1":"2000-1","2":"Man","3":"61.5000","4":"80.5","5":"81.5000","6":"68.2821"},{"1":"2000-1","2":"Man","3":"65.0000","4":"50.0","5":"43.5000","6":"43.2733"},{"1":"2000-1","2":"Man","3":"63.0000","4":"82.0","5":"88.0000","6":"70.1031"},{"1":"2000-1","2":"Man","3":"75.0000","4":"66.5","5":"76.0000","6":"65.0846"},{"1":"2000-1","2":"Man","3":"69.5000","4":"70.5","5":"76.0000","6":"68.6538"},{"1":"2000-1","2":"Woman","3":"60.0000","4":"95.0","5":"91.0000","6":"83.0508"},{"1":"2000-1","2":"Man","3":"84.0000","4":"88.0","5":"67.0000","6":"75.0856"},{"1":"2000-1","2":"Man","3":"90.0000","4":"99.5","5":"87.5000","6":"74.4718"},{"1":"2000-1","2":"Woman","3":"62.5000","4":"85.5","5":"85.5000","6":"74.4821"},{"1":"2000-1","2":"Man","3":"88.5000","4":"86.5","5":"70.0000","6":"77.9526"},{"1":"2000-2","2":"Man","3":"74.5000","4":"83.0","5":"62.4000","6":"78.7554"},{"1":"2000-2","2":"Man","3":"73.5000","4":"69.5","5":"74.5000","6":"69.0228"},{"1":"2000-2","2":"Man","3":"75.0000","4":"60.5","5":"80.9000","6":"68.6502"},{"1":"2000-2","2":"Man","3":"76.5000","4":"76.0","5":"61.0000","6":"73.6702"},{"1":"2000-2","2":"Woman","3":"90.5000","4":"68.0","5":"59.0000","6":"69.7842"},{"1":"2000-2","2":"Man","3":"88.0000","4":"77.5","5":"90.5000","6":"84.1474"},{"1":"2000-2","2":"Man","3":"87.2727","4":"58.0","5":"28.0000","6":"49.1931"},{"1":"2000-2","2":"Man","3":"81.9000","4":"86.0","5":"62.0000","6":"73.9116"},{"1":"2000-2","2":"Man","3":"65.5000","4":"90.0","5":"61.8000","6":"68.5425"},{"1":"2000-2","2":"Woman","3":"84.5000","4":"80.5","5":"72.5000","6":"81.2088"},{"1":"2000-2","2":"Man","3":"88.9000","4":"67.0","5":"76.0000","6":"80.5554"},{"1":"2000-2","2":"Man","3":"70.0000","4":"56.0","5":"81.5000","6":"68.7839"},{"1":"2000-2","2":"Man","3":"73.0000","4":"48.0","5":"55.0000","6":"65.3088"},{"1":"2000-2","2":"Man","3":"86.0000","4":"77.0","5":"82.0000","6":"79.6035"},{"1":"2000-2","2":"Man","3":"68.0000","4":"60.0","5":"59.0000","6":"58.4316"},{"1":"2000-2","2":"Woman","3":"82.0000","4":"74.0","5":"81.5000","6":"76.6842"},{"1":"2000-2","2":"Man","3":"86.4000","4":"72.0","5":"69.5000","6":"67.5625"},{"1":"2000-2","2":"Man","3":"74.0000","4":"83.0","5":"79.9000","6":"74.5730"},{"1":"2000-2","2":"Man","3":"92.3000","4":"76.0","5":"97.0000","6":"87.0288"},{"1":"2000-2","2":"Man","3":"57.0000","4":"70.0","5":"56.0000","6":"65.3947"},{"1":"2000-2","2":"Man","3":"62.5000","4":"41.0","5":"77.8000","6":"59.8863"},{"1":"2000-2","2":"Man","3":"75.5000","4":"62.5","5":"79.7000","6":"73.5435"},{"1":"2000-2","2":"Man","3":"67.0000","4":"58.0","5":"45.8000","6":"58.3828"},{"1":"2000-2","2":"Man","3":"73.0000","4":"78.0","5":"77.3000","6":"79.2354"},{"1":"2000-2","2":"Man","3":"93.0000","4":"75.0","5":"96.0000","6":"71.3228"},{"1":"2000-2","2":"Man","3":"81.5000","4":"73.0","5":"69.5000","6":"65.5295"},{"1":"2000-2","2":"Man","3":"82.5000","4":"83.5","5":"82.5000","6":"81.4474"},{"1":"2000-2","2":"Woman","3":"46.5000","4":"77.0","5":"47.0000","6":"62.8842"},{"1":"2000-2","2":"Man","3":"62.0000","4":"71.0","5":"64.0000","6":"69.4702"},{"1":"2000-2","2":"Woman","3":"68.5000","4":"55.5","5":"52.0000","6":"61.8263"},{"1":"2000-2","2":"Man","3":"80.0000","4":"84.0","5":"48.5000","6":"70.0947"},{"1":"2000-2","2":"Man","3":"77.0000","4":"77.0","5":"44.0000","6":"68.0404"},{"1":"2000-2","2":"Woman","3":"55.0000","4":"94.0","5":"96.0000","6":"83.5193"},{"1":"2000-2","2":"Man","3":"69.0000","4":"74.5","5":"41.5000","6":"59.0386"},{"1":"2000-2","2":"Woman","3":"74.0000","4":"56.0","5":"69.9000","6":"65.0204"},{"1":"2001-1","2":"Man","3":"93.0000","4":"76.0","5":"95.5000","6":"85.5000"},{"1":"2001-1","2":"Man","3":"81.0000","4":"78.0","5":"79.5000","6":"75.7333"},{"1":"2001-1","2":"Man","3":"98.0000","4":"87.0","5":"85.5000","6":"86.5833"},{"1":"2001-1","2":"Man","3":"92.5000","4":"81.0","5":"74.5000","6":"77.2833"},{"1":"2001-1","2":"Man","3":"83.5000","4":"60.5","5":"78.0000","6":"73.6333"},{"1":"2001-1","2":"Man","3":"98.0000","4":"92.0","5":"90.5000","6":"91.8585"},{"1":"2001-1","2":"Man","3":"80.5000","4":"53.5","5":"67.5000","6":"62.9555"},{"1":"2001-1","2":"Man","3":"80.9000","4":"68.0","5":"67.0000","6":"72.7600"},{"1":"2001-1","2":"Man","3":"84.5000","4":"46.0","5":"65.5000","6":"60.6167"},{"1":"2001-1","2":"Man","3":"93.8000","4":"59.5","5":"73.3000","6":"70.0067"},{"1":"2001-1","2":"Man","3":"98.0000","4":"96.5","5":"98.5000","6":"97.5667"},{"1":"2001-1","2":"Man","3":"92.0000","4":"78.5","5":"72.0000","6":"73.2833"},{"1":"2001-1","2":"Man","3":"91.0000","4":"72.0","5":"81.0000","6":"75.1167"},{"1":"2001-1","2":"Man","3":"80.0000","4":"72.0","5":"59.5000","6":"69.7000"},{"1":"2001-1","2":"Man","3":"94.0000","4":"84.0","5":"98.5000","6":"88.8667"},{"1":"2001-1","2":"Man","3":"90.0000","4":"73.0","5":"63.5000","6":"72.9000"},{"1":"2001-1","2":"Man","3":"94.0000","4":"82.0","5":"86.4000","6":"80.3267"},{"1":"2001-1","2":"Man","3":"86.5000","4":"76.0","5":"85.5000","6":"76.2000"},{"1":"2001-1","2":"Man","3":"87.0000","4":"76.0","5":"72.5000","6":"70.7442"},{"1":"2001-1","2":"Man","3":"80.3000","4":"88.5","5":"83.5000","6":"85.9700"},{"1":"2001-1","2":"Man","3":"89.5000","4":"66.5","5":"78.9000","6":"72.5267"},{"1":"2001-1","2":"Man","3":"70.5000","4":"70.5","5":"58.0000","6":"57.0000"},{"1":"2001-1","2":"Man","3":"89.4000","4":"84.5","5":"82.5000","6":"83.8685"},{"1":"2001-1","2":"Woman","3":"79.5000","4":"56.0","5":"81.0000","6":"68.2500"},{"1":"2001-1","2":"Man","3":"93.9000","4":"88.0","5":"71.0000","6":"80.0600"},{"1":"2001-1","2":"Man","3":"73.5000","4":"78.5","5":"72.0000","6":"77.0333"},{"1":"2001-1","2":"Man","3":"94.8000","4":"84.5","5":"77.5000","6":"84.1700"},{"1":"2001-1","2":"Woman","3":"66.0000","4":"62.0","5":"80.5000","6":"70.9333"},{"1":"2001-1","2":"Man","3":"96.3000","4":"82.0","5":"76.0000","6":"79.9867"},{"1":"2001-1","2":"Man","3":"93.3000","4":"93.0","5":"92.5000","6":"89.8033"},{"1":"2001-1","2":"Man","3":"87.3000","4":"81.0","5":"78.5000","6":"85.7367"},{"1":"2001-1","2":"Man","3":"79.0000","4":"81.0","5":"91.0000","6":"78.1222"},{"1":"2001-1","2":"Man","3":"84.0000","4":"81.0","5":"91.0000","6":"75.0333"},{"1":"2001-1","2":"Woman","3":"81.0000","4":"81.5","5":"70.0000","6":"74.2167"},{"1":"2001-1","2":"Woman","3":"84.5000","4":"71.5","5":"76.0000","6":"73.9833"},{"1":"2001-1","2":"Woman","3":"90.6250","4":"61.5","5":"59.5000","6":"66.6958"},{"1":"2001-1","2":"Woman","3":"91.5000","4":"58.0","5":"79.5000","6":"74.9888"},{"1":"2001-1","2":"Man","3":"84.0000","4":"72.5","5":"76.0000","6":"75.7000"},{"1":"2001-2","2":"Man","3":"73.2000","4":"44.0","5":"50.9000","6":"47.9000"},{"1":"2001-2","2":"Man","3":"70.5000","4":"42.8","5":"36.4000","6":"48.0500"},{"1":"2001-2","2":"Woman","3":"92.9000","4":"88.5","5":"79.0000","6":"86.6500"},{"1":"2001-2","2":"Man","3":"68.8000","4":"52.1","5":"65.4000","6":"55.9500"},{"1":"2001-2","2":"Man","3":"91.3000","4":"71.0","5":"79.5000","6":"77.8250"},{"1":"2001-2","2":"Man","3":"78.3000","4":"46.5","5":"63.9000","6":"56.7250"},{"1":"2001-2","2":"Man","3":"71.3000","4":"43.0","5":"67.4000","6":"58.3750"},{"1":"2001-2","2":"Man","3":"74.9000","4":"65.4","5":"51.5000","6":"56.0750"},{"1":"2001-2","2":"Man","3":"90.5000","4":"71.5","5":"69.5000","6":"78.5000"},{"1":"2001-2","2":"Man","3":"80.3000","4":"63.0","5":"64.0000","6":"64.7000"},{"1":"2001-2","2":"Woman","3":"79.0000","4":"74.5","5":"72.5000","6":"68.3250"},{"1":"2001-2","2":"Man","3":"82.5000","4":"62.5","5":"77.5000","6":"73.5000"},{"1":"2001-2","2":"Man","3":"79.7000","4":"84.4","5":"77.3000","6":"75.5500"},{"1":"2001-2","2":"Man","3":"79.5000","4":"77.9","5":"62.0000","6":"68.3500"},{"1":"2001-2","2":"Man","3":"79.5000","4":"68.7","5":"87.0000","6":"81.7500"},{"1":"2001-2","2":"Man","3":"93.0000","4":"70.9","5":"67.5000","6":"70.4250"},{"1":"2001-2","2":"Man","3":"88.5000","4":"79.5","5":"82.0000","6":"80.5000"},{"1":"2001-2","2":"Woman","3":"86.0000","4":"73.0","5":"47.0000","6":"66.0000"},{"1":"2001-2","2":"Man","3":"93.8000","4":"68.5","5":"66.4000","6":"74.8750"},{"1":"2001-2","2":"Woman","3":"93.9000","4":"84.0","5":"83.5000","6":"88.2250"},{"1":"2001-2","2":"Man","3":"83.3000","4":"83.0","5":"78.0000","6":"82.5750"},{"1":"2001-2","2":"Man","3":"75.1000","4":"70.0","5":"61.0000","6":"64.0250"},{"1":"2001-2","2":"Man","3":"92.9000","4":"83.0","5":"84.5000","6":"84.1500"},{"1":"2001-2","2":"Man","3":"76.5000","4":"41.5","5":"48.0000","6":"53.0750"},{"1":"2001-2","2":"Woman","3":"84.1000","4":"88.8","5":"75.5000","6":"81.5500"},{"1":"2001-2","2":"Man","3":"87.9000","4":"58.2","5":"67.0000","6":"63.5250"},{"1":"2001-2","2":"Woman","3":"79.5000","4":"66.0","5":"67.5000","6":"69.1250"},{"1":"2001-2","2":"Man","3":"82.0000","4":"53.5","5":"52.0000","6":"54.5000"},{"1":"2001-2","2":"Woman","3":"91.4000","4":"77.0","5":"76.0000","6":"76.1000"},{"1":"2001-2","2":"Man","3":"84.9000","4":"69.5","5":"37.3000","6":"60.3000"},{"1":"2001-2","2":"Man","3":"58.0000","4":"61.0","5":"47.4000","6":"57.6000"},{"1":"2001-2","2":"Man","3":"81.5000","4":"57.5","5":"65.8000","6":"60.3250"},{"1":"2001-2","2":"Man","3":"95.0000","4":"68.0","5":"82.5000","6":"76.7500"},{"1":"2001-2","2":"Man","3":"95.5000","4":"80.5","5":"84.3000","6":"75.7750"},{"1":"2001-2","2":"Man","3":"77.5000","4":"80.9","5":"75.0000","6":"76.4250"},{"1":"2001-2","2":"Man","3":"82.0000","4":"46.0","5":"54.0000","6":"53.0000"},{"1":"2001-2","2":"Man","3":"93.8000","4":"82.5","5":"80.5000","6":"84.6500"},{"1":"2002-1","2":"Man","3":"89.0000","4":"83.5","5":"92.0000","6":"77.1197"},{"1":"2002-1","2":"Man","3":"82.0000","4":"78.5","5":"82.0000","6":"61.7972"},{"1":"2002-1","2":"Man","3":"73.5000","4":"80.0","5":"82.0000","6":"73.5563"},{"1":"2002-1","2":"Man","3":"73.5000","4":"82.8","5":"79.5000","6":"69.9459"},{"1":"2002-1","2":"Woman","3":"79.0000","4":"86.5","5":"97.0000","6":"80.5324"},{"1":"2002-1","2":"Man","3":"71.5000","4":"71.0","5":"58.0000","6":"62.4331"},{"1":"2002-1","2":"Man","3":"92.5000","4":"92.0","5":"93.5000","6":"82.2000"},{"1":"2002-1","2":"Woman","3":"85.5000","4":"90.5","5":"85.0000","6":"86.7901"},{"1":"2002-1","2":"Man","3":"93.0000","4":"47.0","5":"70.0000","6":"59.8218"},{"1":"2002-1","2":"Man","3":"75.5000","4":"66.0","5":"94.0000","6":"69.0648"},{"1":"2002-1","2":"Man","3":"88.5000","4":"74.0","5":"87.0000","6":"78.2085"},{"1":"2002-1","2":"Man","3":"87.0000","4":"96.0","5":"98.5000","6":"84.0577"},{"1":"2002-1","2":"Woman","3":"89.5000","4":"77.5","5":"88.9000","6":"69.2110"},{"1":"2002-1","2":"Man","3":"97.5000","4":"94.5","5":"76.0000","6":"78.9310"},{"1":"2002-1","2":"Woman","3":"59.0000","4":"73.0","5":"85.5000","6":"58.2606"},{"1":"2002-1","2":"Man","3":"81.0000","4":"87.0","5":"86.5000","6":"72.1352"},{"1":"2002-1","2":"Man","3":"73.5000","4":"57.5","5":"83.0000","6":"61.7713"},{"1":"2002-1","2":"Man","3":"90.5000","4":"53.0","5":"78.5000","6":"60.7915"},{"1":"2002-1","2":"Man","3":"70.0000","4":"62.5","5":"85.0000","6":"64.5225"},{"1":"2002-1","2":"Man","3":"98.5000","4":"98.0","5":"90.0000","6":"80.3761"},{"1":"2002-1","2":"Man","3":"85.5000","4":"67.0","5":"86.0000","6":"67.6535"},{"1":"2002-1","2":"Man","3":"78.0000","4":"58.0","5":"92.5000","6":"65.1831"},{"1":"2002-1","2":"Man","3":"86.5000","4":"85.0","5":"85.0000","6":"73.5972"},{"1":"2002-1","2":"Woman","3":"99.3000","4":"96.0","5":"89.0000","6":"91.4868"},{"1":"2002-1","2":"Man","3":"90.5000","4":"78.5","5":"79.5000","6":"73.0634"},{"1":"2002-1","2":"Man","3":"86.5000","4":"67.5","5":"85.5000","6":"70.0746"},{"1":"2002-1","2":"Man","3":"80.0000","4":"94.0","5":"90.5000","6":"88.4310"},{"1":"2002-1","2":"Man","3":"72.0000","4":"95.0","5":"78.0000","6":"77.3507"},{"1":"2002-1","2":"Man","3":"72.5000","4":"69.5","5":"92.0000","6":"73.5648"},{"1":"2002-1","2":"Man","3":"77.5000","4":"74.0","5":"82.0000","6":"73.1493"},{"1":"2002-1","2":"Man","3":"74.0000","4":"49.5","5":"82.0000","6":"64.6690"},{"1":"2002-1","2":"Man","3":"79.0000","4":"80.5","5":"80.5000","6":"71.9845"},{"1":"2002-1","2":"Man","3":"80.0000","4":"82.0","5":"77.0000","6":"67.7986"},{"1":"2002-1","2":"Man","3":"97.4000","4":"66.9","5":"83.0000","6":"74.9276"},{"1":"2002-1","2":"Man","3":"61.5000","4":"64.5","5":"86.0000","6":"63.7651"},{"1":"2002-1","2":"Man","3":"86.0000","4":"67.0","5":"96.8000","6":"73.7346"},{"1":"2003-1","2":"Woman","3":"75.7143","4":"62.6","5":"45.5556","6":"59.5549"},{"1":"2003-1","2":"Woman","3":"80.7143","4":"38.0","5":"78.3333","6":"65.2202"},{"1":"2003-1","2":"Woman","3":"88.2143","4":"75.1","5":"70.0000","6":"72.3670"},{"1":"2003-1","2":"Man","3":"81.7857","4":"76.0","5":"68.3333","6":"74.1120"},{"1":"2003-1","2":"Man","3":"96.0714","4":"68.1","5":"74.4444","6":"70.4423"},{"1":"2003-1","2":"Man","3":"NA","4":"58.0","5":"78.3333","6":"46.7231"},{"1":"2003-1","2":"Man","3":"73.5714","4":"62.1","5":"97.7778","6":"69.1030"},{"1":"2003-1","2":"Man","3":"71.0714","4":"41.5","5":"55.5556","6":"53.9348"},{"1":"2003-1","2":"Man","3":"66.4286","4":"59.1","5":"85.5556","6":"68.5149"},{"1":"2003-1","2":"Man","3":"85.7143","4":"77.1","5":"83.3333","6":"79.8810"},{"1":"2003-1","2":"Woman","3":"88.9286","4":"72.0","5":"93.3333","6":"82.3626"},{"1":"2003-1","2":"Man","3":"65.7143","4":"60.5","5":"30.0000","6":"48.5152"},{"1":"2003-1","2":"Man","3":"92.5000","4":"63.5","5":"92.7778","6":"80.3655"},{"1":"2003-1","2":"Woman","3":"86.0714","4":"77.5","5":"96.6667","6":"80.3527"},{"1":"2003-1","2":"Man","3":"75.0000","4":"71.9","5":"88.3333","6":"70.3606"},{"1":"2003-1","2":"Man","3":"95.7143","4":"90.1","5":"98.8889","6":"93.3003"},{"1":"2003-1","2":"Man","3":"88.9286","4":"52.5","5":"62.5000","6":"61.1081"},{"1":"2003-1","2":"Man","3":"94.6429","4":"90.0","5":"90.0000","6":"87.6431"},{"1":"2003-1","2":"Man","3":"92.5000","4":"80.0","5":"96.1111","6":"87.9477"},{"1":"2003-1","2":"Woman","3":"91.0714","4":"39.5","5":"78.8889","6":"67.9143"},{"1":"2003-1","2":"Man","3":"92.8571","4":"73.5","5":"92.1111","6":"86.2788"},{"1":"2003-1","2":"Woman","3":"86.0714","4":"45.5","5":"55.5556","6":"59.8701"},{"1":"2003-1","2":"Man","3":"87.1429","4":"81.6","5":"73.8889","6":"76.4304"},{"1":"2003-1","2":"Man","3":"74.2857","4":"52.6","5":"47.2222","6":"56.3211"},{"1":"2003-1","2":"Man","3":"95.7143","4":"78.0","5":"84.4444","6":"83.2086"},{"1":"2003-1","2":"Man","3":"83.2143","4":"64.6","5":"58.8889","6":"68.0731"},{"1":"2003-1","2":"Man","3":"85.0000","4":"78.1","5":"82.2222","6":"70.5416"},{"1":"2003-1","2":"Man","3":"85.7143","4":"68.1","5":"72.0000","6":"66.1202"},{"1":"2003-1","2":"Woman","3":"94.6429","4":"94.5","5":"96.1111","6":"90.7190"},{"1":"2003-1","2":"Man","3":"90.7143","4":"77.5","5":"78.2222","6":"77.5340"},{"1":"2003-1","2":"Man","3":"86.4286","4":"70.1","5":"88.3333","6":"74.5553"},{"1":"2003-1","2":"Man","3":"98.2143","4":"89.1","5":"71.1111","6":"85.5208"},{"1":"2003-1","2":"Woman","3":"95.0000","4":"86.0","5":"78.3333","6":"83.6959"},{"1":"2003-1","2":"Man","3":"97.1429","4":"53.5","5":"67.2222","6":"72.1189"},{"1":"2003-1","2":"Man","3":"85.0000","4":"63.0","5":"75.0000","6":"67.1996"},{"1":"2003-1","2":"Man","3":"72.8571","4":"48.5","5":"90.5556","6":"66.4035"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section><section id="wilcoxons-signed-rank-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="wilcoxons-signed-rank-test">Wilcoxon’s Signed-Rank Test</h2>
<p>Since we are dealing with the <strong>mean</strong>, the <em>sign</em> of the rank becomes important to use, in the case of a non-parametric single mean test.</p>
<section id="model-4" class="level3"><h3 class="anchored" data-anchor-id="model-4">Model</h3>
<p><span class="math display">\[
signed\_rank(y) = \beta_0 \\
H_0: \beta_0 = 0
\]</span></p>
</section><section id="code-4" class="level3"><h3 class="anchored" data-anchor-id="code-4">Code</h3>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Wilcoxon_Signed_Rank_test_One_Mean_0d8edc8004dba95b8872e009f92e49aa">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># Standard Wilcoxon Signed_Rank Test</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>w1 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y)</span>
<span id="cb41-3"><a href="#cb41-3"></a>w1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  y
V = 754, p-value = 0.2628
alternative hypothesis: true location is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># Wilcoxon test with lm</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>w2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y) <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data =</span> mydata_wide)</span>
<span id="cb43-3"><a href="#cb43-3"></a>w2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = signed_rank(y) ~ 1, data = mydata_wide)

Coefficients:
(Intercept)  
       4.66  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># t-test with signed_rank data</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>w3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="fu">signed_rank</span>(y))</span>
<span id="cb45-3"><a href="#cb45-3"></a>w3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  signed_rank(y)
t = 1.1277, df = 49, p-value = 0.265
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -3.644491 12.964491
sample estimates:
mean of x 
     4.66 </code></pre>
</div>
</div>
<p>We can plot the y data both original and ranked to see where the mean lies in each case. The approximation to the true $_0&nbsp;( is good when the number of observations N is &gt;=50. Lindoloev has a <a href="https://lindeloev.github.io/tests-as-linear/simulations/simulate_wilcoxon.html">simulation on this.</a>. We can also plot the model using <em>lm</em> for both the original data and the sign-ranked data.</p>
</section><section id="example-4" class="level3"><h3 class="anchored" data-anchor-id="example-4">Example</h3>
</section><section id="plots-for-both-t-test-and-wilcoxon-test" class="level3"><h3 class="anchored" data-anchor-id="plots-for-both-t-test-and-wilcoxon-test">Plots for both t-test and Wilcoxon test</h3>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Mean_Related_Plots_fd54b4053228047f3fe11f864b3ad2a3">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> t1<span class="sc">$</span>estimate, </span>
<span id="cb47-4"><a href="#cb47-4"></a>                   <span class="at">yend =</span> t1<span class="sc">$</span>estimate, </span>
<span id="cb47-5"><a href="#cb47-5"></a>                   <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb47-6"><a href="#cb47-6"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Student's</span><span class="sc">\n</span><span class="st"> t-Test"</span>)</span>
<span id="cb47-7"><a href="#cb47-7"></a></span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="co"># t-test using linear model</span></span>
<span id="cb47-9"><a href="#cb47-9"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb47-12"><a href="#cb47-12"></a>                   <span class="at">yend =</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb47-13"><a href="#cb47-13"></a>                   <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb47-14"><a href="#cb47-14"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Student's</span><span class="sc">\n</span><span class="st"> t-Test </span><span class="sc">\n</span><span class="st"> using lm"</span>)</span>
<span id="cb47-15"><a href="#cb47-15"></a></span>
<span id="cb47-16"><a href="#cb47-16"></a><span class="co"># Wilcoxon test, using signed-ranks of data</span></span>
<span id="cb47-17"><a href="#cb47-17"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fu">signed_rank</span>(y))) <span class="sc">+</span></span>
<span id="cb47-18"><a href="#cb47-18"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb47-19"><a href="#cb47-19"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">signed_rank</span>(y)), <span class="at">yend =</span> <span class="fu">mean</span>(<span class="fu">signed_rank</span>(y)), <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb47-20"><a href="#cb47-20"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wilcoxon </span><span class="sc">\n</span><span class="st">Signed-Rank</span><span class="sc">\n</span><span class="st"> Test"</span>)</span>
<span id="cb47-21"><a href="#cb47-21"></a></span>
<span id="cb47-22"><a href="#cb47-22"></a><span class="co"># Wilcoxon test, using signed-ranks of data, and lm</span></span>
<span id="cb47-23"><a href="#cb47-23"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fu">signed_rank</span>(y))) <span class="sc">+</span></span>
<span id="cb47-24"><a href="#cb47-24"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb47-25"><a href="#cb47-25"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y) <span class="sc">~</span><span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb47-26"><a href="#cb47-26"></a>                   <span class="at">yend =</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y) <span class="sc">~</span><span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb47-27"><a href="#cb47-27"></a>                   <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb47-28"><a href="#cb47-28"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wilcoxon </span><span class="sc">\n</span><span class="st"> Signed-Rank </span><span class="sc">\n</span><span class="st"> Test with lm"</span>)</span>
<span id="cb47-29"><a href="#cb47-29"></a></span>
<span id="cb47-30"><a href="#cb47-30"></a></span>
<span id="cb47-31"><a href="#cb47-31"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(p1,p2,p3,p4, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="lmCompMeans_files/figure-html/Mean_Related_Plots-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="paired-sample-t-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="paired-sample-t-test">Paired Sample t-test</h2>
<p>We use this when we have two samples and the observations from one sample can be “paired” with observations in the other sample. Controlled studies for interventions/measures, such as before/after kind of data, comparisons between two interventions on the same set of subjects, and two measurements made on the same subjects using different methods etc.</p>
<section id="model-5" class="level3"><h3 class="anchored" data-anchor-id="model-5">Model</h3>
<p><span class="math display">\[
y_2 - y_1 = \beta_0 \\
H_0 : \beta_0 = 0
\]</span></p>
<p>The NULL Hypothesis is that there is no difference, <strong>either way</strong>, between the two samples. Again, in the linear model, we assume as before that “the explanatory x variable has been equated to zero.</p>
<p>We therefore set <code>two.sided</code> and <code>mu = 0</code> in the <code>t.test</code>.</p>
</section><section id="code-5" class="level3"><h3 class="anchored" data-anchor-id="code-5">Code</h3>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Paired_t_test_85b4beaff7028f4fadb88857234317f1">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># Using paired t-test</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>t2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y2, y, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">mu =</span> <span class="dv">0</span>, </span>
<span id="cb48-3"><a href="#cb48-3"></a>             <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb48-4"><a href="#cb48-4"></a>t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  y2 and y
t = 0.54264, df = 49, p-value = 0.5898
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -0.54067  0.94067
sample estimates:
mean difference 
            0.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># linear model</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y2<span class="sc">-</span>y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mydata_wide)</span>
<span id="cb50-3"><a href="#cb50-3"></a>lm2 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y2 - y ~ 1, data = mydata_wide)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.7027 -2.1872 -0.1367  1.3835  5.7262 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.2000     0.3686   0.543     0.59

Residual standard error: 2.606 on 49 degrees of freedom</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>lm2 <span class="sc">%&gt;%</span> <span class="fu">confint</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               2.5 %  97.5 %
(Intercept) -0.54067 0.94067</code></pre>
</div>
</div>
<p>Both tests report the difference to be 0.2. However the p-value in both tests is about 0.6, so the result is not statistically significant.</p>
</section><section id="example-5" class="level3"><h3 class="anchored" data-anchor-id="example-5">Example</h3>
</section></section><section id="wilcoxon-paired-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="wilcoxon-paired-test">Wilcoxon Paired Test</h2>
<p>When the original data is not normally distributed or has outliers etc,. we use a nonparametric Wilcoxon paired test. The difference between the paired and unpaired Wilcoxon test is that the test is run on the signed-ranks of the <strong>pairwise differences</strong> y2- y.</p>
<section id="model-6" class="level3"><h3 class="anchored" data-anchor-id="model-6">Model</h3>
<p>$$ signed_rank(y2 - y1) = _0 \</p>
<p>H_0: _0 = 0</p>
<p>$$</p>
</section><section id="code-6" class="level3"><h3 class="anchored" data-anchor-id="code-6">Code</h3>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Paired_Wilcoxon_Test_e51dc17baacca7c2519ef639ce926c08">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># Paired Wilcoxon Test</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>w4 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y, y2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-3"><a href="#cb54-3"></a>w4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  y and y2
V = 608, p-value = 0.7795
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># Linear Model</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y2<span class="sc">-</span>y) <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data =</span> mydata_wide)</span>
<span id="cb56-3"><a href="#cb56-3"></a>lm4 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = signed_rank(y2 - y) ~ 1, data = mydata_wide)

Residuals:
   Min     1Q Median     3Q    Max 
-48.18 -27.93   0.82  22.57  48.82 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    1.180      4.182   0.282    0.779

Residual standard error: 29.57 on 49 degrees of freedom</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># t-test with Signed Rank</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>t4 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="fu">signed_rank</span>(y2<span class="sc">-</span>y), <span class="at">mu =</span> <span class="dv">0</span> , <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb58-3"><a href="#cb58-3"></a>t4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  signed_rank(y2 - y)
t = 0.28214, df = 49, p-value = 0.779
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -7.224733  9.584733
sample estimates:
mean of x 
     1.18 </code></pre>
</div>
</div>
<p>Here too, the p-values reported by the three tests are p = 0.779 so the difference reported is not significant.</p>
</section><section id="example-6" class="level3"><h3 class="anchored" data-anchor-id="example-6">Example</h3>
</section></section></section><section id="tests-with-two-means" class="level1 tabset"><h1 class="tabset">Tests with Two Means</h1>
<p>When we have two independent samples and these are <em>not paired</em> as earlier. The intent is to test if there is a significant difference to their means. An example is identical measurements on two sets of subjects.</p>
<p>There is considerable discussion on what test to use when:&nbsp; 1.If variances are equal between samples, observations are normally distributed within groups, no outliers, then <code>independent t-test</code><br>
2. If unequal variance, <code>t-test</code> with <code>Welch correction</code> ( Welch’s t-test)<br>
3.If samples are not normal, then nonparametric test ( Wilcoxon with two samples = <code>Mann-Whitney test</code>). Symmetry of the distribution is assumed here.</p>
<section id="dummy-group-variable-concept" class="level2"><h2 class="anchored" data-anchor-id="dummy-group-variable-concept">Dummy Group Variable Concept</h2>
<p>An important construct here is the <strong>dummy variable</strong>. When there is more than one group in the data, a dummy <em>categorical variable</em> is set up, whose entries specify the group ID. The group IDs are <strong>still numerical</strong> ( as with factors, remember ). The dummy variable is plotted on the x-axis. The consecutive IDs in the dummy variable x are separated by <em>1</em>. Hence the <em>between-groups difference</em> in the stat measures computed on y are numerically equivalent to the <strong>slope</strong> in the linear model. Thus the <em>dummy variable</em> allows us to **mathematically* use the linear model, as presented in the equations above.</p>
<p>Dummy variables become even more useful when the explanatory variable ( “x-planatory” ) is already categorical, as with ANOVA and friends.</p>
<p>We can visualize this as follows:</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Independent_Data_Plots_48a93673d8e5abab3d6b866e9e664d9a">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>mydata_wide_new <span class="ot">&lt;-</span> </span>
<span id="cb60-2"><a href="#cb60-2"></a>  <span class="fu">tibble</span>(<span class="at">y1 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>),</span>
<span id="cb60-3"><a href="#cb60-3"></a>         <span class="at">y2 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="fl">1.2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="#cb60-4"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(y1, y2),</span>
<span id="cb60-5"><a href="#cb60-5"></a>               <span class="at">names_to =</span> <span class="st">"variable"</span>,  </span>
<span id="cb60-6"><a href="#cb60-6"></a>               <span class="at">values_to =</span> <span class="st">"values"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-7"><a href="#cb60-7"></a>  <span class="fu">cbind</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">50</span>))</span>
<span id="cb60-8"><a href="#cb60-8"></a></span>
<span id="cb60-9"><a href="#cb60-9"></a>mydata_wide_new <span class="sc">%&gt;%</span> </span>
<span id="cb60-10"><a href="#cb60-10"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> values)) <span class="sc">+</span> </span>
<span id="cb60-11"><a href="#cb60-11"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb60-12"><a href="#cb60-12"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">geom =</span><span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb60-13"><a href="#cb60-13"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom=</span> <span class="st">"line"</span>, <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14"></a>  <span class="fu">xlab</span>(<span class="st">"Dummy Variable to show groups"</span>) <span class="sc">+</span></span>
<span id="cb60-15"><a href="#cb60-15"></a>  <span class="fu">ylab</span>(<span class="st">"y1 and y2, on the same scale"</span>) <span class="sc">+</span></span>
<span id="cb60-16"><a href="#cb60-16"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"Dummy Variable x_i  [0,1]"</span>,</span>
<span id="cb60-17"><a href="#cb60-17"></a>                <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb60-18"><a href="#cb60-18"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">label =</span> <span class="st">"Difference in means </span><span class="sc">\n</span><span class="st"> equals slope in linear model"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="lmCompMeans_files/figure-html/Independent_Data_Plots-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># Need to use `glue` here to add more annotations</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="co"># Math annotation on graphs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="model-7" class="level2"><h2 class="anchored" data-anchor-id="model-7">Model</h2>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 * x_i \\
where\\
x_i= \left\{\begin{matrix}
1\ when\ x\ \in\ Group 1\\
0\ when\ x\ \in\ Group2
\end{matrix}\right.
\]</span></p>
</section></section><section id="section" class="level1 unnumbered"><h1 class="unnumbered"></h1>
<p>Let us now look at the tests.</p>
<section id="independent-t-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="independent-t-test">Independent t-test</h2>
<section id="model-8" class="level3"><h3 class="anchored" data-anchor-id="model-8">Model</h3>
<p>The assumptions here are:<br>
- both data sets are normally distributed.Small samples may be assumed to be <code>t-distributed</code><br>
- variances are the same<br>
- no outliers<br>
- observations across data sets are independent(obviously)</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 * x_i \\
where \\
x_i= \left\{\begin{matrix}
1\ when\ x\ \in\ Group 1\\
0\ when\ x\ \in\ Group2
\end{matrix}\right.
\\
H_0 : \beta_1 = 0
\]</span></p>
<p>The t.test computes a statistic as follows:</p>
<p><span class="math display">\[
t \ \ = \mod(\bar{x_1}\ - \bar{x_2}) / std.error(\bar{x_1}\ - \bar{x_2}) \\
= \mod(\bar{x_1} - \bar{x_2})\ / \sqrt{s_x^2 /n_x + s_y^2/n_y}  \\
and\\
df = n_1 + n_2 - 2\ \ \ \ ( degrees\ of\ freedom)
\]</span></p>
<p>The t-test uses an approximation to the sampling distribution of the difference in sample means based on the Central Limit Theorem, which ensures that for sufficiently large samples, the sampling distribution will be very close to Normal. The mean of the sampling distribution will be the difference in (underlying) population means, and the variance of the sampling distribution will be the standard error of the difference in sample means.</p>
<p>For the <code>t-statistic</code>, note that the numerator of the formula is the difference between means. The denominator is a measurement of experimental error in the two groups combined. The wider the difference between means, the more confident you are in the data. The more experimental error you have, the less confident you are in the data. Thus the higher the value of t, the greater the confidence that there is a difference.</p>
<p>The <code>t-statistic</code> has a t-distribution. It is compared to a <em>critical value</em> of t, for a given probability value ( 0.05 usually). If the calculated t exceeds the critical value, we can assert that the NULL Hypothesis can be rejected and there could be a significant difference in means. <img src="t-distribution.png" class="img-fluid" alt="t-distribution curves"></p>
</section><section id="code-7" class="level3"><h3 class="anchored" data-anchor-id="code-7">Code</h3>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/unnamed-chunk-2_3094c6cea8c178fb3395ba5163a08455">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># Independent t-test</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>t5 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y2, y, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a>t5 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["estimate"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["estimate1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["estimate2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["parameter"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[9],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"0.2","2":"0.5","3":"0.3","4":"0.5656854","5":"0.5729006","6":"98","7":"-0.5016152","8":"0.9016152","9":"Two Sample t-test","10":"two.sided"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># Welch test when variances are not equal</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>t6 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y2,y, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb63-3"><a href="#cb63-3"></a>t6 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["estimate"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["estimate1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["estimate2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["parameter"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[9],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[10],"type":["chr"],"align":["left"]}],"data":[{"1":"0.2","2":"0.5","3":"0.3","4":"0.5656854","5":"0.5730018","6":"90.87537","7":"-0.5023034","8":"0.9023034","9":"Welch Two Sample t-test","10":"two.sided"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># Linear Model with Dummy variable</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="co"># lm(value ~ 1 + group, data = mydata_long_y) # also works</span></span>
<span id="cb64-3"><a href="#cb64-3"></a>lm6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(group <span class="sc">==</span> <span class="st">"y2"</span>), <span class="at">data =</span> mydata_long_y)</span>
<span id="cb64-4"><a href="#cb64-4"></a>lm6 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"0.3","3":"0.2500000","4":"1.2000000","5":"0.2330323"},{"1":"I(group == \"y2\")TRUE","2":"0.2","3":"0.3535534","4":"0.5656854","5":"0.5729006"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We get the same estimates for means of y and y2 ( 0.3 and 0.5 respectively).</p>
</section><section id="example-7" class="level3"><h3 class="anchored" data-anchor-id="example-7">Example</h3>
</section></section><section id="welchs-t-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="welchs-t-test">Welch’s t-test</h2>
<section id="model-9" class="level3"><h3 class="anchored" data-anchor-id="model-9">Model</h3>
<p>Welch’s test we have already explored as a variant of the t.test for two means, with variances unequal.</p>
<p>Welch’s test is also stated as a <em>Generalized</em> Linear Model using, not <code>lm</code> but the <code>gls</code> command from the <code>nlme</code> package. This is explained on <a href="https://stats.stackexchange.com/questions/142685/equivalent-to-welchs-t-test-in-gls-framework">StackExchange</a> but we need not digress now.</p>
<p>When the variances are unequal, there is a difference in the t-statistic that is computed <em>only</em> when the group **sizes* are different ( Denominator of t-statistic ).</p>
<p>From StackExchange:<br><span class="math display">\[
t_w =\ \frac {\bar{x_1}-\bar{x_2}}{\sqrt{{s_1^2/n_1}{s_2^2/n_2}}}
\\\\
=\ \frac{\bar{x_1}-\bar{x_2}} {{\sqrt{\frac{s_1^2 + s_2^2}{n}}}}
\\\\
=\ \frac{\bar{x_1}-\bar{x_2}} {{\sqrt{\frac{s_1^2 + s_2^2} {2} * (\frac{2}{n})}}}
\\\\
=\ t_s
\]</span></p>
<p>So under these conditions the t-statistic for the Welch t-test is the same as that for the standard t-test.</p>
</section><section id="code-8" class="level3"><h3 class="anchored" data-anchor-id="code-8">Code</h3>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Welch_independent_sample_t_test_04dc579101999b723e28be96abbf6e6b">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>t7 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y, y2, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="example-8" class="level3"><h3 class="anchored" data-anchor-id="example-8">Example</h3>
</section></section><section id="mann-whitney-u-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="mann-whitney-u-test">Mann-Whitney U Test</h2>
<p>(Wilcoxon Independent Sample test)</p>
<p>As before, when sample groups are not normally distributed, and when variances are different, and they are outliers, a nonparametric rank-sum test is preferred. This is the same as the Wilcoxon Test for independent variables, and is called the Mann-Whitney Test.</p>
<section id="model-10" class="level3"><h3 class="anchored" data-anchor-id="model-10">Model</h3>
<p>As before:</p>
<p><span class="math display">\[
rank(y_i) = \beta_0 + \beta_1 * rank(x_i) \\
where \\
x_i= \left\{\begin{matrix}
1\ when\ x\ \in\ Group 1\\
0\ when\ x\ \in\ Group2
\end{matrix}\right.
\\
H_0 : \beta_1 = 0
\]</span></p>
</section><section id="code-9" class="level3"><h3 class="anchored" data-anchor-id="code-9">Code</h3>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Mann_Whitney_U_Test_caf204dc085662778099ae5ccf84e77e">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># As Wilcoxon Test</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>w5 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y2,y, <span class="at">paired =</span> <span class="cn">FALSE</span>)</span>
<span id="cb66-3"><a href="#cb66-3"></a>w5 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["statistic"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[3],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"1264","2":"0.9258507","3":"Wilcoxon rank sum test with continuity correction","4":"two.sided"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># As Linear model</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>lm5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">rank</span>(value) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(group <span class="sc">==</span> <span class="st">"y2"</span>), </span>
<span id="cb67-3"><a href="#cb67-3"></a>          <span class="at">data =</span> mydata_long_y)</span>
<span id="cb67-4"><a href="#cb67-4"></a>lm5 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"50.22","3":"4.123530","4":"12.17888471","5":"2.504281e-21"},{"1":"I(group == \"y2\")TRUE","2":"0.56","3":"5.831552","4":"0.09602932","5":"9.236934e-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># As Mann-Whitney</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Not clear how to explain this. Need to dig more into Mann-Whitney.</p>
</section><section id="example-9" class="level3"><h3 class="anchored" data-anchor-id="example-9">Example</h3>
</section></section></section><section id="tests-with-three-or-more-means" class="level1 tabset"><h1 class="tabset">Tests with Three or More Means</h1>
<section id="model-11" class="level2"><h2 class="anchored" data-anchor-id="model-11">Model</h2>
<p>ANOVAs are linear models with (only) categorical predictors so they simply extend everything we did above, relying heavily on dummy coding.</p>
</section><section id="one-way-anova" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="one-way-anova">One-way ANOVA</h2>
<section id="model-12" class="level3"><h3 class="anchored" data-anchor-id="model-12">Model</h3>
<p>One mean for each group predicts y.</p>
<p><span class="math display">\[
y=\beta_0 + \beta_1*x_1 + \beta_2*x_2...+\beta_n*x_n\\
H0:y=β0
\]</span></p>
<p>where <span class="math inline">\(x_i\)</span> are indicators (x=0 or x=1) where at most one <span class="math inline">\(x_i=1\)</span> while all others are <span class="math inline">\(x_i=0\)</span>.</p>
<p>Notice how this is just “more of the same” of what we already did in other models above. When there are only two groups, this model is <span class="math inline">\(y=β0+β1∗x\)</span>, i.e.&nbsp;the <em>independent t-test</em>. If there is only one group, it is <span class="math inline">\(y=β0\)</span>, i.e.&nbsp;the <em>one-sample t-test</em>. This makes <em>one-way ANOVA</em> a <strong>multiple regression</strong> model.</p>
<p>This is easy to see in the visualization below - just cover up a few groups and see that it matches the other visualizations above. Let’s visualize this using toy data:</p>
<div class="cell" data-layout-align="center" data-hash="lmCompMeans_cache/html/Visualizing_One_way_ANOVA_c5a1a2a7af7dc6755629f8ae70886b67">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>N <span class="ot">=</span> <span class="dv">15</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>D_anova1 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb69-3"><a href="#cb69-3"></a>  <span class="at">y =</span> <span class="fu">c</span>(</span>
<span id="cb69-4"><a href="#cb69-4"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="fl">0.5</span>, <span class="fl">0.3</span>),</span>
<span id="cb69-5"><a href="#cb69-5"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="dv">0</span>, <span class="fl">0.3</span>),</span>
<span id="cb69-6"><a href="#cb69-6"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="dv">1</span>, <span class="fl">0.3</span>),</span>
<span id="cb69-7"><a href="#cb69-7"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="fl">0.8</span>, <span class="fl">0.3</span>)</span>
<span id="cb69-8"><a href="#cb69-8"></a>  ),</span>
<span id="cb69-9"><a href="#cb69-9"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">15</span>)</span>
<span id="cb69-10"><a href="#cb69-10"></a>)</span>
<span id="cb69-11"><a href="#cb69-11"></a>ymeans <span class="ot">=</span> <span class="fu">aggregate</span>(y<span class="sc">~</span>x, D_anova1, mean)<span class="sc">$</span>y</span>
<span id="cb69-12"><a href="#cb69-12"></a>P_anova1 <span class="ot">=</span> <span class="fu">ggplot</span>(D_anova1, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> </span>
<span id="cb69-13"><a href="#cb69-13"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span>mean, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> ..y.., <span class="at">ymin =</span> ..y.., <span class="at">color=</span><span class="st">'intercepts'</span>), <span class="at">lwd=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb69-14"><a href="#cb69-14"></a>  </span>
<span id="cb69-15"><a href="#cb69-15"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">xend =</span> <span class="dv">100</span>, </span>
<span id="cb69-16"><a href="#cb69-16"></a>               <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">yend =</span> <span class="fl">0.5</span>, </span>
<span id="cb69-17"><a href="#cb69-17"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'beta_0'</span>)) <span class="sc">+</span></span>
<span id="cb69-18"><a href="#cb69-18"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">xend =</span> <span class="dv">1</span>, </span>
<span id="cb69-19"><a href="#cb69-19"></a>               <span class="at">y =</span> ymeans[<span class="dv">1</span>], <span class="at">yend =</span> ymeans[<span class="dv">2</span>], </span>
<span id="cb69-20"><a href="#cb69-20"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'betas'</span>)) <span class="sc">+</span></span>
<span id="cb69-21"><a href="#cb69-21"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="dv">2</span>, </span>
<span id="cb69-22"><a href="#cb69-22"></a>               <span class="at">y =</span> ymeans[<span class="dv">1</span>], <span class="at">yend =</span> ymeans[<span class="dv">3</span>], </span>
<span id="cb69-23"><a href="#cb69-23"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'betas'</span>)) <span class="sc">+</span></span>
<span id="cb69-24"><a href="#cb69-24"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">xend =</span> <span class="dv">3</span>, </span>
<span id="cb69-25"><a href="#cb69-25"></a>               <span class="at">y =</span> ymeans[<span class="dv">1</span>], <span class="at">yend =</span> ymeans[<span class="dv">4</span>], </span>
<span id="cb69-26"><a href="#cb69-26"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'betas'</span>)) <span class="sc">+</span></span>
<span id="cb69-27"><a href="#cb69-27"></a>  </span>
<span id="cb69-28"><a href="#cb69-28"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, </span>
<span id="cb69-29"><a href="#cb69-29"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkblue"</span>),</span>
<span id="cb69-30"><a href="#cb69-30"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">bquote</span>(beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">" (group 1 mean)"</span>),</span>
<span id="cb69-31"><a href="#cb69-31"></a>                              <span class="fu">bquote</span>(beta[<span class="dv">1</span>]<span class="sc">*</span><span class="st">", "</span><span class="sc">*</span>beta[<span class="dv">2</span>]<span class="sc">*</span><span class="st">", </span></span>
<span id="cb69-32"><a href="#cb69-32"></a><span class="st">                                     etc. (slopes/differences to "</span><span class="sc">*</span>beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb69-33"><a href="#cb69-33"></a>      <span class="fu">bquote</span>(beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">"+"</span><span class="sc">*</span>beta[<span class="dv">1</span>]<span class="sc">*</span><span class="st">", "</span><span class="sc">*</span>beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">"+"</span><span class="sc">*</span>beta[<span class="dv">2</span>]<span class="sc">*</span><span class="st">", etc. (group 2, 3, ... means)"</span>)</span>
<span id="cb69-34"><a href="#cb69-34"></a>    )</span>
<span id="cb69-35"><a href="#cb69-35"></a>  )</span>
<span id="cb69-36"><a href="#cb69-36"></a>P_anova1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="lmCompMeans_files/figure-html/Visualizing_One_way_ANOVA-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section><section id="code-10" class="level3"><h3 class="anchored" data-anchor-id="code-10">Code</h3>
</section><section id="example-10" class="level3"><h3 class="anchored" data-anchor-id="example-10">Example</h3>
</section></section><section id="two-way-anova" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="two-way-anova">Two-way ANOVA</h2>
<section id="model-13" class="level3"><h3 class="anchored" data-anchor-id="model-13">Model</h3>
</section><section id="code-11" class="level3"><h3 class="anchored" data-anchor-id="code-11">Code</h3>
</section><section id="example-11" class="level3"><h3 class="anchored" data-anchor-id="example-11">Example</h3>
</section></section><section id="ancova" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="ancova">ANCOVA</h2>
<section id="model-14" class="level3"><h3 class="anchored" data-anchor-id="model-14">Model</h3>
</section><section id="code-12" class="level3"><h3 class="anchored" data-anchor-id="code-12">Code</h3>
</section><section id="example-12" class="level3"><h3 class="anchored" data-anchor-id="example-12">Example</h3>
</section></section></section><section id="proportions" class="level1 tabset"><h1 class="tabset">Proportions</h1>
<section id="model-15" class="level2"><h2 class="anchored" data-anchor-id="model-15">Model</h2>
</section><section id="discrete-variables" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="discrete-variables">Discrete Variables</h2>
<section id="model-16" class="level3"><h3 class="anchored" data-anchor-id="model-16">Model</h3>
</section><section id="code-13" class="level3"><h3 class="anchored" data-anchor-id="code-13">Code</h3>
</section><section id="example-13" class="level3"><h3 class="anchored" data-anchor-id="example-13">Example</h3>
</section></section><section id="continuous-variables" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="continuous-variables">Continuous Variables</h2>
<section id="model-17" class="level3"><h3 class="anchored" data-anchor-id="model-17">Model</h3>
</section><section id="code-14" class="level3"><h3 class="anchored" data-anchor-id="code-14">Code</h3>
</section><section id="example-14" class="level3"><h3 class="anchored" data-anchor-id="example-14">Example</h3>


</section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Handle positioning of the toggle
      window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/av-quarto\.netlify\.app");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Website made with 💜 and <a href="https://quarto.org/">Quarto</a>, by Arvind Venkatadri. License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:arvind.venkatadri@gmail.com">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


<script src="../../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>