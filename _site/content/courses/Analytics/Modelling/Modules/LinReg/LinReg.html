<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Arvind Venkatadri">
<meta name="dcterms.date" content="2021-11-01">
<title>The Foundation Series - Modelling Linear Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../../">
<script src="../../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../../../../../site_libs/quarto-contrib/nutshell-1.0.0/nutshell.min.js"></script>
<link href="../../../../../../site_libs/quarto-contrib/downloadthis-1.9.1/downloadthis.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="The Foundation Series - Modelling Linear Regression">
<meta property="og:description" content="Following the ANOVA tutorial at Our Coding Club.">
<meta property="og:image" content="https://av-quarto.netlify.app/content\courses\Analytics\Modelling\Modules\LinReg\preview.png">
<meta property="og:site-name" content="The Foundation Series">
<meta property="og:image:alt" content="By Rudityas on Glazestock.com">
</head>
<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../../../../index.html">
    <span class="navbar-title">The Foundation Series</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/my-quarto-website"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../../../../www.linkedin.com/in/arvindvenkatadri"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Modelling Linear Regression</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Teaching</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../../content/courses/Analytics/listing.html" class="sidebar-item-text sidebar-link">Data Analytics</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Tools/listing.html" class="sidebar-item-text sidebar-link">Tools and Software</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Descriptive/listing.html" class="sidebar-item-text sidebar-link">Descriptive Analytics</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Inference/listing.html" class="sidebar-item-text sidebar-link">Statistical Inference</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Modelling/listing.html" class="sidebar-item-text sidebar-link">Inferential Modelling</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Predictive/listing.html" class="sidebar-item-text sidebar-link">Predictive Analytics</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Prescriptive/listing.html" class="sidebar-item-text sidebar-link">Prescriptive Analytics</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/Analytics/Workflow/listing.html" class="sidebar-item-text sidebar-link">Workflow</a>
  </div>
</li>
      </ul>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/R4Artists/listing.html" class="sidebar-item-text sidebar-link">R for Artists</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/TRIZ4ProbSolving/listing.html" class="sidebar-item-text sidebar-link">TRIZ for Innovation</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/MathModelsDesign/listing.html" class="sidebar-item-text sidebar-link">Math Models in Design</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/NoCode/listing.html" class="sidebar-item-text sidebar-link">Data Vis with No Code</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/courses/ISTW/listing.html" class="sidebar-item-text sidebar-link">In Short, the World</a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/posts/listing.html" class="sidebar-item-text sidebar-link">Posts</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../../content/projects/listing.html" class="sidebar-item-text sidebar-link">Blogs</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
<li><a href="#read-the-data" id="toc-read-the-data" class="nav-link" data-scroll-target="#read-the-data">Read the Data</a></li>
  </ul>
</li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">EDA</a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova">ANOVA</a></li>
  <li>
<a href="#checking-anova-assumptions" id="toc-checking-anova-assumptions" class="nav-link" data-scroll-target="#checking-anova-assumptions">Checking ANOVA Assumptions</a>
  <ul class="collapse">
<li><a href="#check-for-similar-variance" id="toc-check-for-similar-variance" class="nav-link" data-scroll-target="#check-for-similar-variance">Check for Similar Variance</a></li>
  <li><a href="#independent-observations" id="toc-independent-observations" class="nav-link" data-scroll-target="#independent-observations">Independent Observations</a></li>
  </ul>
</li>
  <li><a href="#effect-size" id="toc-effect-size" class="nav-link" data-scroll-target="#effect-size">Effect Size</a></li>
  <li><a href="#anova-using-permutation-tests" id="toc-anova-using-permutation-tests" class="nav-link" data-scroll-target="#anova-using-permutation-tests">ANOVA using Permutation Tests</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">Modelling Linear Regression</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Linear Regression</div>
    <div class="quarto-category">Slope</div>
    <div class="quarto-category">Intercept</div>
    <div class="quarto-category">Permutation</div>
    <div class="quarto-category">Explanatory Variable</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Arvind Venkatadri </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 1, 2021</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">April 13, 2023</p>
    </div>
  </div>
    
  </div>
  

</header><div class="cell" data-hash="LinReg_cache/html/setup_f9a2cbe01028e2f6b12f7354d9874b54">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,<span class="at">warning =</span> <span class="cn">FALSE</span>,<span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(ggformula)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(infer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-2_601b154211124dd0009f1c9997738d73">
<style type="text/css">

/*https://stackoverflow.com/questions/73546631/how-to-format-tabset-font-in-quarto
*/

/*
.panel-tabset .nav-item {
   font-size: 20px;
   font-style: italic
    }
*/
</style>
</div>
<section id="introduction" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Following the ANOVA tutorial at <a href="https://ourcodingclub.github.io/tutorials/anova/">Our Coding Club</a>.</p>
<p>Suppose we have three sales strategies on our website, to sell a certain product, say men’s shirts. We have website interaction over several months. How do we know which strategy makes people buy the fastest ?</p>
<p>If there is a University course that is offered in parallel in three different classrooms, is there a difference between the average marks obtained by students in each of the classrooms?</p>
<p>In each case we have a set of observations in each category: Interaction Time vs Sales Strategy in the first example, and Student Marks vs Classroom in the second. We can take <em>mean</em> scores in each category and decide to compare them. How do we make the comparisons? One way would be to compare them pair-wise. But with this rapidly becomes intractable and also dangerous: with increasing number of <code>groups</code>, the number of mean-comparisons becomes very large <span class="math inline">\(N\choose 2\)</span> and with each comparison the possibility of some difference showing up, <em>just by chance</em>, increases! And we end up making the wrong inference and perhaps the wrong decision.</p>
<div class="page-columns page-full"><p>The trick is of course to make comparisons <strong>all at once</strong> and ANOVA is the technique that allows us to do just that. In this tutorial, we will compare the Hatching Time of frog spawn<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, at three different lab temperatures.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;https://www.openintro.org/go/?id=anova-supplement&amp;referrer=/book/ahss/index.php</p></li></div></div>
<p>In this tutorial, our research question is:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Research Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>How does frogspawn hatching time vary with temperature?</p>
</div>
</div>
<section id="read-the-data" class="level3"><h3 class="anchored" data-anchor-id="read-the-data">Read the Data</h3>
<p>Download the data by clicking the button below:</p>
<p><a href="#dnldts3594" onclick="fetch('data:text/csv;base64,RnJvZ3NwYXduIHNhbXBsZSBpZCxUZW1wZXJhdHVyZTEzLFRlbXBlcmF0dXJlMTgsVGVtcGVyYXR1cmUyNQ0KMSwyNCwsDQoyLCwyMSwNCjMsLCwxOA0KNCwyNiwsDQo1LCwyMiwNCjYsLCwxNA0KNywyNywsDQo4LCwyMiwNCjksLCwxNQ0KMTAsMjcsLA0KMTEsLDIxLA0KMTIsLCwxNQ0KMTMsMjYsLA0KMTQsLDIwLA0KMTUsLCwxNg0KMTYsMjcsLA0KMTcsLDIwLA0KMTgsLCwxNg0KMTksMjcsLA0KMjAsLDE5LA0KMjEsLCwxNw0KMjIsMjUsLA0KMjMsLDIxLA0KMjQsLCwxNw0KMjUsMjYsLA0KMjYsLDIzLA0KMjcsLCwxNw0KMjgsMjgsLA0KMjksLDIxLA0KMzAsLCwxNw0KMzEsMjQsLA0KMzIsLDIxLA0KMzMsLCwxOA0KMzQsMjYsLA0KMzUsLDIyLA0KMzYsLCwxNA0KMzcsMjcsLA0KMzgsLDIyLA0KMzksLCwxNQ0KNDAsMjcsLA0KNDEsLDIxLA0KNDIsLCwxNQ0KNDMsMjYsLA0KNDQsLDIwLA0KNDUsLCwxNg0KNDYsMjcsLA0KNDcsLDIwLA0KNDgsLCwxNg0KNDksMjcsLA0KNTAsLDE5LA0KNTEsLCwxNw0KNTIsMjUsLA0KNTMsLDIxLA0KNTQsLCwxNw0KNTUsMjYsLA0KNTYsLDIzLA0KNTcsLCwxNw0KNTgsMjgsLA0KNTksLDIxLA0KNjAsLCwxNw0K').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'frogs.csv'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
        });"><button class="btn btn-info downloadthis  " id="dnldts3594"><i class="bi bi-database-fill-down"></i> Download the frogs data </button></a></p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-3_b0b318c440038d4c27cd6eea33e21ed3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>frogs_orig <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/frogs.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 60 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (4): Frogspawn sample id, Temperature13, Temperature18, Temperature25

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>frogs_orig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Frogspawn sample id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Temperature13"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Temperature18"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Temperature25"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"24","3":"NA","4":"NA"},{"1":"2","2":"NA","3":"21","4":"NA"},{"1":"3","2":"NA","3":"NA","4":"18"},{"1":"4","2":"26","3":"NA","4":"NA"},{"1":"5","2":"NA","3":"22","4":"NA"},{"1":"6","2":"NA","3":"NA","4":"14"},{"1":"7","2":"27","3":"NA","4":"NA"},{"1":"8","2":"NA","3":"22","4":"NA"},{"1":"9","2":"NA","3":"NA","4":"15"},{"1":"10","2":"27","3":"NA","4":"NA"},{"1":"11","2":"NA","3":"21","4":"NA"},{"1":"12","2":"NA","3":"NA","4":"15"},{"1":"13","2":"26","3":"NA","4":"NA"},{"1":"14","2":"NA","3":"20","4":"NA"},{"1":"15","2":"NA","3":"NA","4":"16"},{"1":"16","2":"27","3":"NA","4":"NA"},{"1":"17","2":"NA","3":"20","4":"NA"},{"1":"18","2":"NA","3":"NA","4":"16"},{"1":"19","2":"27","3":"NA","4":"NA"},{"1":"20","2":"NA","3":"19","4":"NA"},{"1":"21","2":"NA","3":"NA","4":"17"},{"1":"22","2":"25","3":"NA","4":"NA"},{"1":"23","2":"NA","3":"21","4":"NA"},{"1":"24","2":"NA","3":"NA","4":"17"},{"1":"25","2":"26","3":"NA","4":"NA"},{"1":"26","2":"NA","3":"23","4":"NA"},{"1":"27","2":"NA","3":"NA","4":"17"},{"1":"28","2":"28","3":"NA","4":"NA"},{"1":"29","2":"NA","3":"21","4":"NA"},{"1":"30","2":"NA","3":"NA","4":"17"},{"1":"31","2":"24","3":"NA","4":"NA"},{"1":"32","2":"NA","3":"21","4":"NA"},{"1":"33","2":"NA","3":"NA","4":"18"},{"1":"34","2":"26","3":"NA","4":"NA"},{"1":"35","2":"NA","3":"22","4":"NA"},{"1":"36","2":"NA","3":"NA","4":"14"},{"1":"37","2":"27","3":"NA","4":"NA"},{"1":"38","2":"NA","3":"22","4":"NA"},{"1":"39","2":"NA","3":"NA","4":"15"},{"1":"40","2":"27","3":"NA","4":"NA"},{"1":"41","2":"NA","3":"21","4":"NA"},{"1":"42","2":"NA","3":"NA","4":"15"},{"1":"43","2":"26","3":"NA","4":"NA"},{"1":"44","2":"NA","3":"20","4":"NA"},{"1":"45","2":"NA","3":"NA","4":"16"},{"1":"46","2":"27","3":"NA","4":"NA"},{"1":"47","2":"NA","3":"20","4":"NA"},{"1":"48","2":"NA","3":"NA","4":"16"},{"1":"49","2":"27","3":"NA","4":"NA"},{"1":"50","2":"NA","3":"19","4":"NA"},{"1":"51","2":"NA","3":"NA","4":"17"},{"1":"52","2":"25","3":"NA","4":"NA"},{"1":"53","2":"NA","3":"21","4":"NA"},{"1":"54","2":"NA","3":"NA","4":"17"},{"1":"55","2":"26","3":"NA","4":"NA"},{"1":"56","2":"NA","3":"23","4":"NA"},{"1":"57","2":"NA","3":"NA","4":"17"},{"1":"58","2":"28","3":"NA","4":"NA"},{"1":"59","2":"NA","3":"21","4":"NA"},{"1":"60","2":"NA","3":"NA","4":"17"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Our response variable is the hatching <code>Time</code>. Our explanatory variable is a <em>factor</em>, Temperature, with 3 levels: 13°C, 18°C and 25°C. Different samples of spawn were subject to each of these temperatures respectively. The data is badly organized, with a separate column for each Temperature, with NA entries since not all samples of spawn could be subject to all temperatures. Hence, we should <code>pivot_longer()</code> this data, so all Time readings are in one column, and also convert the Temperature into a <code>factor</code>:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-4_c7429bdd41923f1af07fb4ae08ed2ef1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>frogs_long <span class="ot">&lt;-</span> frogs_orig <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">pivot_longer</span>(., <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"Temperature"</span>),</span>
<span id="cb5-3"><a href="#cb5-3"></a>               <span class="at">cols_vary =</span> <span class="st">"fastest"</span>, <span class="co"># new in pivot_longer</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>               <span class="at">names_to =</span> <span class="st">"Temp"</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>               <span class="at">values_to =</span> <span class="st">"Time"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>  </span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="co"># knock off the unnecessary "Temperature" word everywhere</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">separate_wider_regex</span>(<span class="at">cols =</span> Temp,</span>
<span id="cb5-10"><a href="#cb5-10"></a>                       <span class="at">patterns =</span> <span class="fu">c</span>(<span class="st">"Temperature"</span>, </span>
<span id="cb5-11"><a href="#cb5-11"></a>                                     <span class="at">TempFac =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>), </span>
<span id="cb5-12"><a href="#cb5-12"></a>                       <span class="at">cols_remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-13"><a href="#cb5-13"></a>  </span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="co"># Convert Temp into TempFac, a 3-level factor</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="fu">mutate</span>(<span class="at">TempFac =</span> <span class="fu">factor</span>(<span class="at">x =</span> TempFac,</span>
<span id="cb5-16"><a href="#cb5-16"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">18</span>,<span class="dv">25</span>), </span>
<span id="cb5-17"><a href="#cb5-17"></a>                              <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"13"</span>, <span class="st">"18"</span>, <span class="st">"25"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb5-18"><a href="#cb5-18"></a>  <span class="fu">rename</span>(<span class="st">"Id"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Frogspawn sample id</span><span class="st">`</span>)</span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a>frogs_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["TempFac"],"name":[2],"type":["fct"],"align":["left"]},{"label":["Time"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"13","3":"24"},{"1":"2","2":"18","3":"21"},{"1":"3","2":"25","3":"18"},{"1":"4","2":"13","3":"26"},{"1":"5","2":"18","3":"22"},{"1":"6","2":"25","3":"14"},{"1":"7","2":"13","3":"27"},{"1":"8","2":"18","3":"22"},{"1":"9","2":"25","3":"15"},{"1":"10","2":"13","3":"27"},{"1":"11","2":"18","3":"21"},{"1":"12","2":"25","3":"15"},{"1":"13","2":"13","3":"26"},{"1":"14","2":"18","3":"20"},{"1":"15","2":"25","3":"16"},{"1":"16","2":"13","3":"27"},{"1":"17","2":"18","3":"20"},{"1":"18","2":"25","3":"16"},{"1":"19","2":"13","3":"27"},{"1":"20","2":"18","3":"19"},{"1":"21","2":"25","3":"17"},{"1":"22","2":"13","3":"25"},{"1":"23","2":"18","3":"21"},{"1":"24","2":"25","3":"17"},{"1":"25","2":"13","3":"26"},{"1":"26","2":"18","3":"23"},{"1":"27","2":"25","3":"17"},{"1":"28","2":"13","3":"28"},{"1":"29","2":"18","3":"21"},{"1":"30","2":"25","3":"17"},{"1":"31","2":"13","3":"24"},{"1":"32","2":"18","3":"21"},{"1":"33","2":"25","3":"18"},{"1":"34","2":"13","3":"26"},{"1":"35","2":"18","3":"22"},{"1":"36","2":"25","3":"14"},{"1":"37","2":"13","3":"27"},{"1":"38","2":"18","3":"22"},{"1":"39","2":"25","3":"15"},{"1":"40","2":"13","3":"27"},{"1":"41","2":"18","3":"21"},{"1":"42","2":"25","3":"15"},{"1":"43","2":"13","3":"26"},{"1":"44","2":"18","3":"20"},{"1":"45","2":"25","3":"16"},{"1":"46","2":"13","3":"27"},{"1":"47","2":"18","3":"20"},{"1":"48","2":"25","3":"16"},{"1":"49","2":"13","3":"27"},{"1":"50","2":"18","3":"19"},{"1":"51","2":"25","3":"17"},{"1":"52","2":"13","3":"25"},{"1":"53","2":"18","3":"21"},{"1":"54","2":"25","3":"17"},{"1":"55","2":"13","3":"26"},{"1":"56","2":"18","3":"23"},{"1":"57","2":"25","3":"17"},{"1":"58","2":"13","3":"28"},{"1":"59","2":"18","3":"21"},{"1":"60","2":"25","3":"17"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-5_a510ab87f8a21b49a8bc1a5ac87ca436">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>frogs_long <span class="sc">%&gt;%</span> <span class="fu">count</span>(TempFac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["TempFac"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"13","2":"20"},{"1":"18","2":"20"},{"1":"25","2":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>So we have <code>20</code> samples for Hatching <code>Time</code> per <code>TempFac</code> setting.</p>
</section></section><section id="eda" class="level2"><h2 class="anchored" data-anchor-id="eda">EDA</h2>
<p>Let us set a plot theme:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-6_27a32d0647dda9b9d4160aea60044698">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Data visualisation</span></span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>theme_frogs <span class="ot">&lt;-</span> <span class="cf">function</span>(){  <span class="co"># Creating a function</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span>  <span class="co"># Using pre-defined theme as base</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Customizing axes text      </span></span>
<span id="cb7-6"><a href="#cb7-6"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb7-7"><a href="#cb7-7"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Customizing axis title</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),  <span class="co"># Taking off the default grid</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">units =</span> , <span class="st">"cm"</span>),</span>
<span id="cb7-10"><a href="#cb7-10"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"italic"</span>),  <span class="co"># Customizing legend text</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),  <span class="co"># Customizing legend title</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>,  <span class="co"># Customizing legend position</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))  <span class="co"># Customizing plot caption</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>}                                                                              </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us plot some histograms of Hatching Time:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-7_dd6df457c3053dfa9299d1c8bb204095">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">gf_histogram</span>(<span class="at">data =</span> frogs_long, </span>
<span id="cb8-2"><a href="#cb8-2"></a>             <span class="sc">~</span> Time, </span>
<span id="cb8-3"><a href="#cb8-3"></a>             <span class="at">fill =</span> <span class="sc">~</span> TempFac,</span>
<span id="cb8-4"><a href="#cb8-4"></a>             <span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> <span class="sc">~</span> <span class="fu">mean</span>(Time)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="fu">gf_labs</span>(<span class="at">x =</span> <span class="st">"Hatching Time"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">gf_theme</span>(<span class="at">theme =</span> <span class="fu">theme_frogs</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">gf_theme</span>(<span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Temperature level (°C)"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="LinReg_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We should also look at boxplots</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-8_846ccdb30874707133ce7ab4bd979915">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">gf_boxplot</span>(<span class="at">data =</span> frogs_long, </span>
<span id="cb9-2"><a href="#cb9-2"></a>             Time <span class="sc">~</span> TempFac, </span>
<span id="cb9-3"><a href="#cb9-3"></a>             <span class="at">fill =</span> <span class="sc">~</span> TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> <span class="sc">~</span> <span class="fu">mean</span>(Time)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">gf_labs</span>(<span class="at">x =</span> <span class="st">"Hatching Time"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">gf_theme</span>(<span class="at">theme =</span> <span class="fu">theme_frogs</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="fu">gf_theme</span>(<span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Temperature level (°C)"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="LinReg_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="anova" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="anova">ANOVA</h2>
<p>We will first execute the ANOVA test with code and evaluate the results. Then we will do an intuitive walk through of the process and finally, hand-calculate entire analysis for clear understanding.</p>
<div class="panel-tabset page-columns page-full">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">ANOVA Test with Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">ANOVA Intuitive</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">ANOVA Manually Demonstrated (Apologies to Spinoza)</a></li>
</ul>
<div class="tab-content page-columns page-full">
<div id="tabset-1-1" class="tab-pane active page-columns page-full" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>R offers a very simple command to execute an ANOVA test: Note the familiar <code>formula</code> of stating the variables:</p>
<div class="cell" data-hash="LinReg_cache/html/ANOVA with code_c361f08e88ad3f3ee2ebec5fecb65e3e">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>frogs_anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(Time <span class="sc">~</span> TempFac, <span class="at">data =</span> frogs_long)</span>
<span id="cb10-2"><a href="#cb10-2"></a>frogs_anova <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sumsq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["meansq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"TempFac","2":"2","3":"1020.933","4":"510.466667","5":"385.8966","6":"7.357304e-34"},{"1":"Residuals","2":"57","3":"75.400","4":"1.322807","5":"NA","6":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">summary</span>(frogs_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)    
TempFac      2 1020.9   510.5   385.9 &lt;2e-16 ***
Residuals   57   75.4     1.3                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The effect of Temperature on Hatching time is significant, with a p-value of <span class="math inline">\(&lt;2e-16\)</span>. The F-statistic for the ANOVA test is given by <span class="math inline">\(385.9\)</span>, which is very high. Clearly <code>Temperature</code> has a very significant effect on the hatching <code>Time</code>.</p>
<div class="page-columns page-full"><p>To find which specific value of <code>TempFac</code> has the most effect will require <em>pairwise comparison</em> of the group means, using a standard t-test. The confidence level for such repeated comparisons will need what is called <strong>Bonferroni correction</strong><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> to prevent us from detecting a significant (pair-wise) difference simply by chance. To do this we take <span class="math inline">\(\alpha\)</span> the confidence level used and divide it by <span class="math inline">\(K\)</span>, the number of pair-wise comparisons we intend to make. So using an <span class="math inline">\(\alpha = 0.05\)</span> for ANOVA, the pairwise comparisons in our current data will have to use <span class="math inline">\(\alpha/3 = 0.0166\)</span> as the confidence level. We will discuss this more in the section titled “ANOVA Intuitive”.</p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;https://www.openintro.org/go/?id=anova-supplement&amp;referrer=/book/ahss/index.php</p></li></div></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>All that is very well, but what is happening under the hood of the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> command?</p>
<p>Consider a data set with a single Quant and a single Qual variable. The Qual variable has two levels, the Quant data has 20 observations per Qual level.</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-10_aa0efddc86cd2a5e8ed5cdd5dd48edf4">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb13-2"><a href="#cb13-2"></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())</span>
<span id="cb13-3"><a href="#cb13-3"></a>data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>,</span>
<span id="cb13-4"><a href="#cb13-4"></a>              <span class="at">qual =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="at">x =</span> <span class="st">"A"</span>, <span class="dv">20</span>),<span class="fu">rep</span>(<span class="at">x =</span> <span class="st">"B"</span>, <span class="dv">20</span>)),</span>
<span id="cb13-5"><a href="#cb13-5"></a>              <span class="at">quant =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>), </span>
<span id="cb13-6"><a href="#cb13-6"></a>                        <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)))</span>
<span id="cb13-7"><a href="#cb13-7"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["index"],"name":[1],"type":["int"],"align":["right"]},{"label":["qual"],"name":[2],"type":["chr"],"align":["left"]},{"label":["quant"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"A","3":"-2.1230723"},{"1":"2","2":"A","3":"-1.4646611"},{"1":"3","2":"A","3":"-0.9520868"},{"1":"4","2":"A","3":"-1.1168300"},{"1":"5","2":"A","3":"1.8442954"},{"1":"6","2":"A","3":"3.3949330"},{"1":"7","2":"A","3":"1.3557339"},{"1":"8","2":"A","3":"-0.5603111"},{"1":"9","2":"A","3":"-2.6197981"},{"1":"10","2":"A","3":"0.3424702"},{"1":"11","2":"A","3":"-1.0696037"},{"1":"12","2":"A","3":"-1.7396733"},{"1":"13","2":"A","3":"0.5668913"},{"1":"14","2":"A","3":"0.6460653"},{"1":"15","2":"A","3":"-3.2415088"},{"1":"16","2":"A","3":"2.3039745"},{"1":"17","2":"A","3":"0.9229890"},{"1":"18","2":"A","3":"-3.2318443"},{"1":"19","2":"A","3":"-3.0162159"},{"1":"20","2":"A","3":"-1.1399487"},{"1":"21","2":"B","3":"9.7064871"},{"1":"22","2":"B","3":"9.4003360"},{"1":"23","2":"B","3":"9.2718368"},{"1":"24","2":"B","3":"7.6012225"},{"1":"25","2":"B","3":"11.8417890"},{"1":"26","2":"B","3":"6.5399586"},{"1":"27","2":"B","3":"15.9393918"},{"1":"28","2":"B","3":"10.8188365"},{"1":"29","2":"B","3":"9.7207960"},{"1":"30","2":"B","3":"8.6189615"},{"1":"31","2":"B","3":"10.7532632"},{"1":"32","2":"B","3":"10.1256586"},{"1":"33","2":"B","3":"10.8051748"},{"1":"34","2":"B","3":"13.1867305"},{"1":"35","2":"B","3":"11.3698993"},{"1":"36","2":"B","3":"7.1003912"},{"1":"37","2":"B","3":"9.0459796"},{"1":"38","2":"B","3":"10.7097495"},{"1":"39","2":"B","3":"8.2552018"},{"1":"40","2":"B","3":"8.4484074"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>overall_mean <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>             <span class="fu">summarise</span>(<span class="at">overall_mean =</span> <span class="fu">mean</span>(quant))</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#overall_mean</span></span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a>grouped_means <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="fu">group_by</span>(qual) <span class="sc">%&gt;%</span> </span>
<span id="cb14-7"><a href="#cb14-7"></a>             <span class="fu">summarise</span>(<span class="at">grouped_means =</span> <span class="fu">mean</span>(quant))</span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#grouped_means</span></span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a>p1 <span class="ot">&lt;-</span> <span class="fu">gf_point</span>(quant <span class="sc">~</span> index, </span>
<span id="cb14-11"><a href="#cb14-11"></a>               <span class="at">color =</span> <span class="sc">~</span> qual,</span>
<span id="cb14-12"><a href="#cb14-12"></a>         <span class="at">data =</span> data) <span class="sc">%&gt;%</span> </span>
<span id="cb14-13"><a href="#cb14-13"></a>  <span class="fu">gf_hline</span>(<span class="at">yintercept =</span>  <span class="sc">~</span> overall_mean,</span>
<span id="cb14-14"><a href="#cb14-14"></a>             <span class="at">data =</span> overall_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb14-15"><a href="#cb14-15"></a>  <span class="fu">gf_segment</span>(<span class="at">data =</span> data, </span>
<span id="cb14-16"><a href="#cb14-16"></a>             <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb14-17"><a href="#cb14-17"></a>             overall_mean<span class="sc">$</span>overall_mean <span class="sc">+</span> quant <span class="sc">~</span> index <span class="sc">+</span> index)</span>
<span id="cb14-18"><a href="#cb14-18"></a></span>
<span id="cb14-19"><a href="#cb14-19"></a>p2 <span class="ot">&lt;-</span> <span class="fu">gf_point</span>(quant <span class="sc">~</span> index, </span>
<span id="cb14-20"><a href="#cb14-20"></a>         <span class="at">group =</span> <span class="sc">~</span> qual, </span>
<span id="cb14-21"><a href="#cb14-21"></a>         <span class="at">colour =</span> <span class="sc">~</span> qual, </span>
<span id="cb14-22"><a href="#cb14-22"></a>         <span class="at">data =</span> data) <span class="sc">%&gt;%</span> </span>
<span id="cb14-23"><a href="#cb14-23"></a>  </span>
<span id="cb14-24"><a href="#cb14-24"></a>  <span class="fu">gf_hline</span>(<span class="at">yintercept =</span> <span class="sc">~</span> mean, </span>
<span id="cb14-25"><a href="#cb14-25"></a>           <span class="at">colour =</span> <span class="sc">~</span> qual,</span>
<span id="cb14-26"><a href="#cb14-26"></a>           <span class="at">data =</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb14-27"><a href="#cb14-27"></a>             <span class="fu">group_by</span>(qual) <span class="sc">%&gt;%</span> </span>
<span id="cb14-28"><a href="#cb14-28"></a>             <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(quant))) <span class="sc">%&gt;%</span> </span>
<span id="cb14-29"><a href="#cb14-29"></a>  <span class="fu">gf_segment</span>(<span class="at">data =</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(qual <span class="sc">==</span> <span class="st">"A"</span>),</span>
<span id="cb14-30"><a href="#cb14-30"></a>             grouped_means<span class="sc">$</span>grouped_means[<span class="dv">1</span>] <span class="sc">+</span> quant <span class="sc">~</span> index <span class="sc">+</span> index</span>
<span id="cb14-31"><a href="#cb14-31"></a>             ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-32"><a href="#cb14-32"></a>    <span class="fu">gf_segment</span>(<span class="at">data =</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(qual <span class="sc">==</span> <span class="st">"B"</span>),</span>
<span id="cb14-33"><a href="#cb14-33"></a>             grouped_means<span class="sc">$</span>grouped_means[<span class="dv">2</span>] <span class="sc">+</span> quant <span class="sc">~</span> index <span class="sc">+</span> index</span>
<span id="cb14-34"><a href="#cb14-34"></a>             ) </span>
<span id="cb14-35"><a href="#cb14-35"></a></span>
<span id="cb14-36"><a href="#cb14-36"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="LinReg_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In Fig A, the <em>horizontal</em> black line is the overall mean of <code>quant</code>, denoted as <span class="math inline">\(\mu_{tot}\)</span>. The vertical black lines to the points show the departures of each point from this overall mean. The sum of <em>squares</em> of these vertical black lines in Fig A is called the <strong>Total Sum of Squares</strong> (SST).</p>
<p><span id="eq-SST"><span class="math display">\[
SST = \Sigma (y - \mu_{tot})^2
\tag{1}\]</span></span></p>
<p>If there are <span class="math inline">\(k\)</span> levels in <code>qual</code> and <span class="math inline">\(n\)</span> observations <span class="math inline">\(y_ n\)</span> for each level, we can also write:</p>
<p><span class="math display">\[
SST =
\sum_{i=1}^{kn}y_i^2 - \frac{ \left( \sum_{i=1}^{kn}
y_i \right)^2}{kn}
\]</span></p>
<p>In Fig B, the <em>horizontal</em> green and red lines are the means of the individual groups, respectively <span class="math inline">\(\mu_A\)</span> and <span class="math inline">\(\mu_B\)</span>. The green and red vertical lines are the departures, or errors, of each point from <em>its own group-mean</em>. The sum of the <em>squares</em> of the green and red lines is called the <strong>Total Error Sum of Squares</strong> (SSE).</p>
<p><span id="eq-SSE"><span class="math display">\[
SSE = \Sigma [(y - \mu_i)^2 +... (y - \mu_k)^2]
\tag{2}\]</span></span></p>
<p>If the <span class="math inline">\(\mu_A\)</span> and <span class="math inline">\(\mu_B\)</span> are different from <span class="math inline">\(\mu_{tot}\)</span>, then what would be the relationship between <span class="math inline">\(SSA\)</span> and <span class="math inline">\(SSE\)</span> ? Clearly if the all means are identical then the <span class="math inline">\(SST\)</span> and <span class="math inline">\(SSE\)</span> are equal, since the two coloured lines would be in the same place as the black line. It should be clear that if <span class="math inline">\(\mu_A\)</span> and <span class="math inline">\(\mu_B\)</span> are different from the overall mean, then <span class="math inline">\(SSE &lt; SST\)</span>.</p>
<p>So, when we desire to detect if the two groups are different in their means, we take the difference:</p>
<p><span id="eq-SSA"><span class="math display">\[
SSA = SST - SSE
\tag{3}\]</span></span></p>
<p><span class="math inline">\(SSA\)</span> is called the <strong>Treatment Sum of Squares</strong> and is a measure the differences in means of observations at different levels of the factor.</p>
<p><span class="math inline">\(SSA\)</span> can also directly be re-written in a very symmetric fashion as:</p>
<p>$$ SSA = - </p>
<p>$$ {#eg-SSA}</p>
<p>Note that in the first term, we are calculating sums of observations within each group in the inner summation, which is like a per-group mean(without the division). The outer summation takes the sum of squares of these undivided summations and divides by <span class="math inline">\(n\)</span>.</p>
<p>Comparing <span class="math inline">\(SSA\)</span> and <span class="math inline">\(SSE\)</span> now provides us with a method that helps us decide whether these means are different. The logic is that we compare global differences and local differences. The comparison is of course in the form of a ratio, the F-statistic. Since each of these measures uses a different sets of observations, the comparison is done after scaling each of <span class="math inline">\(SSA\)</span> and <span class="math inline">\(SSE\)</span> by the number of observations influencing them. This means that we need to divide each of <span class="math inline">\(SSA\)</span> and <span class="math inline">\(SSE\)</span> by their <em>degrees of freedom</em>, which gives us a ratio of <strong>variances</strong>:</p>
<p><span class="math display">\[
F_{stat} = \frac{SSA / df_{SSA}}{SSE / df_{SSE}}
\]</span></p>
<p>where <span class="math inline">\(df_{SSA}\)</span> and <span class="math inline">\(df_{SSE}\)</span> are respectively the degrees of freedom in <span class="math inline">\(SSA\)</span> and <span class="math inline">\(SSE\)</span>. And so we are in effect deciding if means are significantly different by analyzing (a ratio of) variances! Hence <em>AN-alysis O-f VA-riance</em>, ANOVA.</p>
<p>In order to find which of the means is significantly different from others, we need to make a pair-wise comparison of the means, applying the Bonferroni correction as stated before.</p>
</div>
<div id="tabset-1-3" class="tab-pane page-columns page-full" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Let us hand-calculate the numbers so we know what the test is doing.</p>
<p>Here is the SST:</p>
<div class="cell" data-hash="LinReg_cache/html/SST Total Sum of Squares_59550a29629282b7b3f2614c8af2d3d9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Calculate overall sum squares SST</span></span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a>frogs_overall <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">summarise</span>(<span class="at">mean_time =</span> <span class="fu">mean</span>(Time), </span>
<span id="cb15-6"><a href="#cb15-6"></a>            <span class="co"># Overall mean across all readings</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>            <span class="co"># The Black Line</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>            </span>
<span id="cb15-9"><a href="#cb15-9"></a>            <span class="at">SST =</span> <span class="fu">sum</span>((Time <span class="sc">-</span> mean_time)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb15-10"><a href="#cb15-10"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb15-11"><a href="#cb15-11"></a>frogs_overall</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mean_time"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SST"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"21.16667","2":"1096.333","3":"60"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>SST <span class="ot">&lt;-</span> frogs_overall<span class="sc">$</span>SST</span>
<span id="cb16-2"><a href="#cb16-2"></a>SST</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1096.333</code></pre>
</div>
</div>
<p>And here is our plot to understand the SST:</p>
<div class="cell" data-hash="LinReg_cache/html/Frogs SST Graph_8767b13ab01a0c491bdcbf8e76c083c1">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>frogs_plot <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">arrange</span>(TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3"></a>           <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">"index"</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a>frogs_mean <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>             <span class="fu">summarise</span>(<span class="at">overall_mean =</span> <span class="fu">mean</span>(Time))</span>
<span id="cb18-7"><a href="#cb18-7"></a></span>
<span id="cb18-8"><a href="#cb18-8"></a>frogs_grouped_means <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>  <span class="fu">group_by</span>(TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb18-10"><a href="#cb18-10"></a>             <span class="fu">summarise</span>(<span class="at">grouped_means =</span> <span class="fu">mean</span>(Time))</span>
<span id="cb18-11"><a href="#cb18-11"></a></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="fu">gf_point</span>(Time <span class="sc">~</span> index, </span>
<span id="cb18-13"><a href="#cb18-13"></a>         <span class="at">color =</span> <span class="sc">~</span> TempFac,</span>
<span id="cb18-14"><a href="#cb18-14"></a>         <span class="at">data =</span> frogs_plot) <span class="sc">%&gt;%</span> </span>
<span id="cb18-15"><a href="#cb18-15"></a>  </span>
<span id="cb18-16"><a href="#cb18-16"></a> <span class="fu">gf_hline</span>(<span class="at">yintercept =</span>  <span class="sc">~</span> overall_mean,</span>
<span id="cb18-17"><a href="#cb18-17"></a>             <span class="at">data =</span> frogs_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb18-18"><a href="#cb18-18"></a>  </span>
<span id="cb18-19"><a href="#cb18-19"></a>  <span class="fu">gf_segment</span>(<span class="at">data =</span> frogs_plot, </span>
<span id="cb18-20"><a href="#cb18-20"></a>             <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb18-21"><a href="#cb18-21"></a>             frogs_mean<span class="sc">$</span>overall_mean <span class="sc">+</span> Time <span class="sc">~</span> index <span class="sc">+</span> index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="LinReg_files/figure-html/Frogs SST Graph-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And here is the SSE:</p>
<div class="cell" data-hash="LinReg_cache/html/SSE Within Group Sum of Squares_95eb1a8d8df231d29f8241015e3cd62b">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Calculate sums of square errors *within* each group</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># with respect to individual group means</span></span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a>frogs_within_groups <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span> </span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="fu">group_by</span>(TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6"></a>   <span class="fu">summarise</span>(<span class="at">mean_time =</span> <span class="fu">mean</span>(Time),</span>
<span id="cb19-7"><a href="#cb19-7"></a>            <span class="at">variance_time =</span> <span class="fu">var</span>(Time),</span>
<span id="cb19-8"><a href="#cb19-8"></a>            <span class="at">group_error_squares =</span> <span class="fu">sum</span>((Time <span class="sc">-</span> mean_time)<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb19-9"><a href="#cb19-9"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb19-10"><a href="#cb19-10"></a>frogs_within_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["TempFac"],"name":[1],"type":["fct"],"align":["left"]},{"label":["mean_time"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["variance_time"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["group_error_squares"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"13","2":"26.3","3":"1.273684","4":"24.2","5":"20"},{"1":"18","2":"21.0","3":"1.263158","4":"24.0","5":"20"},{"1":"25","2":"16.2","3":"1.431579","4":"27.2","5":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>frogs_SSE <span class="ot">&lt;-</span> frogs_within_groups <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">summarise</span>(<span class="at">SSE =</span> <span class="fu">sum</span>(group_error_squares))</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a>SSE <span class="ot">&lt;-</span> frogs_SSE<span class="sc">$</span>SSE</span>
<span id="cb20-5"><a href="#cb20-5"></a>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75.4</code></pre>
</div>
</div>
<div class="cell" data-hash="LinReg_cache/html/Frogs SSE Plot_5cfa69adeba0fb2e36fb2fa629efda8e">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>frogs_plot <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">arrange</span>(TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3"></a>           <span class="fu">rowid_to_column</span>(<span class="at">var =</span> <span class="st">"index"</span>)</span>
<span id="cb22-4"><a href="#cb22-4"></a></span>
<span id="cb22-5"><a href="#cb22-5"></a>frogs_mean <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>             <span class="fu">summarise</span>(<span class="at">overall_mean =</span> <span class="fu">mean</span>(Time))</span>
<span id="cb22-7"><a href="#cb22-7"></a></span>
<span id="cb22-8"><a href="#cb22-8"></a>frogs_grouped_means <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9"></a>  <span class="fu">group_by</span>(TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb22-10"><a href="#cb22-10"></a>             <span class="fu">summarise</span>(<span class="at">grouped_means =</span> <span class="fu">mean</span>(Time))</span>
<span id="cb22-11"><a href="#cb22-11"></a></span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="fu">gf_point</span>(Time <span class="sc">~</span> index, </span>
<span id="cb22-13"><a href="#cb22-13"></a>         <span class="at">group =</span> <span class="sc">~</span> TempFac, </span>
<span id="cb22-14"><a href="#cb22-14"></a>         <span class="at">colour =</span> <span class="sc">~</span> TempFac, </span>
<span id="cb22-15"><a href="#cb22-15"></a>         <span class="at">data =</span> frogs_plot) <span class="sc">%&gt;%</span> </span>
<span id="cb22-16"><a href="#cb22-16"></a>  </span>
<span id="cb22-17"><a href="#cb22-17"></a>  <span class="fu">gf_hline</span>(<span class="at">yintercept =</span> <span class="sc">~</span> grouped_means, </span>
<span id="cb22-18"><a href="#cb22-18"></a>           <span class="at">colour =</span> <span class="sc">~</span> TempFac,</span>
<span id="cb22-19"><a href="#cb22-19"></a>           <span class="at">data =</span> frogs_grouped_means) <span class="sc">%&gt;%</span> </span>
<span id="cb22-20"><a href="#cb22-20"></a>  </span>
<span id="cb22-21"><a href="#cb22-21"></a>  <span class="fu">gf_segment</span>(<span class="at">data =</span> frogs_plot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TempFac <span class="sc">==</span> <span class="dv">13</span> ),</span>
<span id="cb22-22"><a href="#cb22-22"></a>             frogs_grouped_means<span class="sc">$</span>grouped_means[<span class="dv">1</span>] <span class="sc">+</span> Time <span class="sc">~</span> index <span class="sc">+</span> index</span>
<span id="cb22-23"><a href="#cb22-23"></a>             ) <span class="sc">%&gt;%</span> </span>
<span id="cb22-24"><a href="#cb22-24"></a>  </span>
<span id="cb22-25"><a href="#cb22-25"></a>  <span class="fu">gf_segment</span>(<span class="at">data =</span> frogs_plot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TempFac <span class="sc">==</span> <span class="dv">18</span>),</span>
<span id="cb22-26"><a href="#cb22-26"></a>             frogs_grouped_means<span class="sc">$</span>grouped_means[<span class="dv">2</span>] <span class="sc">+</span> Time <span class="sc">~</span> index <span class="sc">+</span> index</span>
<span id="cb22-27"><a href="#cb22-27"></a>             ) <span class="sc">%&gt;%</span> </span>
<span id="cb22-28"><a href="#cb22-28"></a>  </span>
<span id="cb22-29"><a href="#cb22-29"></a>  <span class="fu">gf_segment</span>(<span class="at">data =</span> frogs_plot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TempFac <span class="sc">==</span> <span class="dv">25</span>),</span>
<span id="cb22-30"><a href="#cb22-30"></a>             frogs_grouped_means<span class="sc">$</span>grouped_means[<span class="dv">3</span>] <span class="sc">+</span> Time <span class="sc">~</span> index <span class="sc">+</span> index</span>
<span id="cb22-31"><a href="#cb22-31"></a>             ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="LinReg_files/figure-html/Frogs SSE Plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>OK, we have <span class="math inline">\(SST\)</span> and <span class="math inline">\(SSE\)</span>, so let’s get <span class="math inline">\(SSA\)</span>:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-15_22edab2b1470bbf286bdba11351d1267">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>SST</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1096.333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>SSA <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSE</span>
<span id="cb27-2"><a href="#cb27-2"></a>SSA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1020.933</code></pre>
</div>
</div>
<p>We have <span class="math inline">\(SST = 1096\)</span>, <span class="math inline">\(SSE = 75.4\)</span> and therefore <span class="math inline">\(SSA = 1020.9\)</span>.</p>
<p>In order to calculate the F-Statistic, we need to compute the variances, using these sum of squares. We obtain variances by dividing by their <em>Degrees of Freedom</em>:</p>
<p><span class="math display">\[
F_{stat} = \frac{SSA / df_{SSA}}{SSE / df_{SSE}}
\]</span></p>
<p>where <span class="math inline">\(df_{SSA}\)</span> and <span class="math inline">\(df_{SSE}\)</span> are respectively the degrees of freedom in SSA and SSE.</p>
<p>Let us calculate these Degrees of Freedom. With <span class="math inline">\(k = 2\)</span> levels in the factor <code>TempFac</code>, and <span class="math inline">\(n = 20\)</span> points per level, <span class="math inline">\(SST\)</span> clearly has degree of freedom <span class="math inline">\(kn-1\)</span>, since it uses all observations but loses one degree to calculate the global mean. (If each level did not have the same number of points <span class="math inline">\(n\)</span>, we simply take all observations less one as the degrees of freedom for <span class="math inline">\(SST\)</span>).</p>
<p><span class="math inline">\(SSE\)</span> has <span class="math inline">\(k*(n-1)\)</span> as degrees of freedom, since each of the <span class="math inline">\(k\)</span> groups there are <span class="math inline">\(n\)</span> observations and each group loses one degree to calculate its own group mean.</p>
<p>And therefore <span class="math inline">\(SSA\)</span> has <span class="math inline">\(k-1\)</span> degrees of freedom.</p>
<p>We can still calculate these in R, for the sake of method and clarity:</p>
<div class="cell" data-hash="LinReg_cache/html/Degrees of Freedom_d9ba9a6db41e96a2ff5e2cab1a6ab694">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Error Sum of Squares SSE</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>df_SSE <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a>  </span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="co"># Takes into account "unbalanced" situations</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>  <span class="fu">group_by</span>(TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb29-6"><a href="#cb29-6"></a>  <span class="fu">summarise</span>(<span class="at">per_group_df_SSE =</span> <span class="fu">n</span>() <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-7"><a href="#cb29-7"></a>  <span class="fu">summarise</span>(<span class="at">df_SSE =</span> <span class="fu">sum</span>(per_group_df_SSE)) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb29-8"><a href="#cb29-8"></a></span>
<span id="cb29-9"><a href="#cb29-9"></a></span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="do">## Overall Sum of Squares SST</span></span>
<span id="cb29-11"><a href="#cb29-11"></a>df_SST <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span> </span>
<span id="cb29-12"><a href="#cb29-12"></a>  <span class="fu">summarise</span>(<span class="at">df_SST =</span> <span class="fu">n</span>() <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()</span>
<span id="cb29-13"><a href="#cb29-13"></a></span>
<span id="cb29-14"><a href="#cb29-14"></a></span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="co"># Treatment Sum of Squares SSA</span></span>
<span id="cb29-16"><a href="#cb29-16"></a>k <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(frogs_long<span class="sc">$</span>TempFac))</span>
<span id="cb29-17"><a href="#cb29-17"></a>df_SSA <span class="ot">&lt;-</span> k <span class="sc">-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The degrees of freedom for the quantities are:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-17_b8b39a9c61d18b27e80fe27fda4c0f2d">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>df_SST</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 59</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>df_SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 57</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>df_SSA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>Now we are ready to compute the F-statistic:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-18_295b60e185b39846de1229e6bb6099e5">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># Finally F_Stat!</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="do">## Combine the sum-square_error for each level of the factor</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="co"># weighted by degrees of freedom per level</span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="co"># Which are of course equal here ;-D</span></span>
<span id="cb36-5"><a href="#cb36-5"></a></span>
<span id="cb36-6"><a href="#cb36-6"></a>MSE <span class="ot">&lt;-</span> frogs_within_groups <span class="sc">%&gt;%</span> </span>
<span id="cb36-7"><a href="#cb36-7"></a>  <span class="fu">summarise</span>(<span class="at">mean_square_error =</span> <span class="fu">sum</span>(group_error_squares<span class="sc">/</span>df_SSE)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-8"><a href="#cb36-8"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb36-9"><a href="#cb36-9"></a>MSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.322807</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>MSA <span class="ot">&lt;-</span> SSA<span class="sc">/</span>df_SSA <span class="co"># This is OK</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>MSA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 510.4667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>F_stat <span class="ot">&lt;-</span> MSA<span class="sc">/</span>MSE</span>
<span id="cb40-2"><a href="#cb40-2"></a>F_stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 385.8966</code></pre>
</div>
</div>
<p>The F-stat is compared with a <strong>critical value</strong> of the F-statistic, which is computed using the formula for the f-distribution in R. As with our hypothesis tests, we set the significance level to 0.95, and quote the two relevant degrees of freedom as parameters to <code><a href="https://rdrr.io/r/stats/Fdist.html">qf()</a></code> which computes the critical F value as a <strong>quartile</strong>:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-19_1ba55ddcb89854b15b8221e126781e7e">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>F_crit <span class="ot">&lt;-</span>  <span class="fu">qf</span>(<span class="at">p =</span> <span class="fl">0.95</span>,     <span class="co"># Significance level is 5%</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>              <span class="at">df1 =</span> df_SSA, <span class="co"># Numerator degrees of freedom </span></span>
<span id="cb42-3"><a href="#cb42-3"></a>              <span class="at">df2 =</span> df_SSE) <span class="co"># Denominator degrees of freedom</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>F_crit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.158843</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>F_stat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 385.8966</code></pre>
</div>
</div>
<div class="page-columns page-full"><p>The F_crit value can also be seen in a plot<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>:</p><div class="no-row-height column-margin column-container"><li id="fn3"><p><sup>3</sup>&nbsp;Pruim R, Kaplan DT, Horton NJ (2017). “The mosaic Package: Helping Students to ‘Think with Data’ Using R.” The R Journal, 9(1), 77–102. https://journal.r-project.org/archive/2017/RJ-2017-024/index.html.</p></li></div></div>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-20_a411a49f0778c8164d64a34a57b4d315">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>mosaic<span class="sc">::</span><span class="fu">pdist</span>(<span class="at">dist =</span> <span class="st">"f"</span>,</span>
<span id="cb46-2"><a href="#cb46-2"></a>              <span class="at">q =</span> <span class="fl">3.158843</span>, </span>
<span id="cb46-3"><a href="#cb46-3"></a>              <span class="at">df1=</span>df_SSA, <span class="at">df2=</span>df_SSE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="LinReg_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.95</code></pre>
</div>
</div>
<p>Any value of F more than the F_crit occurs with smaller probability than 0,05. Our F_stat is much higher than F_crit, by orders of magnitude! And so we can say with confidence that Temperature has a significant effect on spawn Time.</p>
<p>And that is how ANOVA computes!</p>
</div>
</div>
</div>
</section><section id="checking-anova-assumptions" class="level2"><h2 class="anchored" data-anchor-id="checking-anova-assumptions">Checking ANOVA Assumptions</h2>
<p>ANOVA makes 3 fundamental assumptions:</p>
<ol type="a">
<li><p>Data are normally distributed.</p></li>
<li><p>Variances are homogeneous.</p></li>
<li><p>Observations are independent.</p></li>
</ol>
<p>We can check these using checks and graphs:</p>
<section id="checks-for-normality" class="level4"><h4 class="anchored" data-anchor-id="checks-for-normality">Checks for Normality</h4>
<p>The <code>shapiro.wilk</code> test tests if a vector of numeric data is normally distributed and rejects the hypothesis of normality when the <a href="https://variation.com/wp-content/distribution_analyzer_help/hs132.htm">p-value</a> is less than or equal to 0.05.&nbsp;</p>
<div class="cell" data-hash="LinReg_cache/html/Check for Normality_6a8f30cc15c4e4dfd95ab446a039eb40">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">shapiro.test</span>(<span class="at">x =</span> frogs_long<span class="sc">$</span>Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  frogs_long$Time
W = 0.92752, p-value = 0.001561</code></pre>
</div>
</div>
<p>The p-value is very low and we cannot reject the (alternative) hypothesis that the overall data is <strong>not</strong> normal. How about normality at each level of the factor?</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-22_8e456ad4e22a5e9454f49eacce58cb36">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>frogs_grouped <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="fu">group_by</span>(TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="fu">nest</span>(<span class="at">.key =</span> <span class="st">"list"</span>) </span>
<span id="cb50-4"><a href="#cb50-4"></a></span>
<span id="cb50-5"><a href="#cb50-5"></a>frogs_grouped <span class="sc">%&gt;%</span> </span>
<span id="cb50-6"><a href="#cb50-6"></a>  <span class="fu">pluck</span>(<span class="st">"list"</span>, <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># naming the nested column "list"</span></span>
<span id="cb50-7"><a href="#cb50-7"></a>  <span class="fu">select</span>(Time) <span class="sc">%&gt;%</span> </span>
<span id="cb50-8"><a href="#cb50-8"></a>  <span class="fu">as_vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-9"><a href="#cb50-9"></a>  <span class="fu">shapiro.test</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  .
W = 0.88954, p-value = 0.02638</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># OK now we are set for group-wise Shapiro-Wilk testing:</span></span>
<span id="cb52-2"><a href="#cb52-2"></a></span>
<span id="cb52-3"><a href="#cb52-3"></a>frogs_grouped <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4"></a>  <span class="fu">mutate</span>(<span class="at">shaptest =</span> </span>
<span id="cb52-5"><a href="#cb52-5"></a>           purrr<span class="sc">::</span><span class="fu">map</span>(<span class="at">.x =</span> list, <span class="co"># Column name is "list"</span></span>
<span id="cb52-6"><a href="#cb52-6"></a>                      <span class="at">.f =</span> \(.x) <span class="fu">select</span>(<span class="at">.data =</span> .x, </span>
<span id="cb52-7"><a href="#cb52-7"></a>                                        Time) <span class="sc">%&gt;%</span> </span>
<span id="cb52-8"><a href="#cb52-8"></a>                                 <span class="fu">as_vector</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-9"><a href="#cb52-9"></a>                                 <span class="fu">shapiro.test</span>(.)),</span>
<span id="cb52-10"><a href="#cb52-10"></a>         </span>
<span id="cb52-11"><a href="#cb52-11"></a>         <span class="at">params =</span> <span class="fu">map</span>(<span class="at">.x =</span> shaptest,</span>
<span id="cb52-12"><a href="#cb52-12"></a>                      <span class="at">.f =</span> \(.x) broom<span class="sc">::</span><span class="fu">tidy</span>(.x))) <span class="sc">%&gt;%</span> </span>
<span id="cb52-13"><a href="#cb52-13"></a>  </span>
<span id="cb52-14"><a href="#cb52-14"></a>  <span class="fu">select</span>(TempFac, params) <span class="sc">%&gt;%</span> </span>
<span id="cb52-15"><a href="#cb52-15"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> params)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["TempFac"],"name":[1],"type":["fct"],"align":["left"]},{"label":["statistic"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"13","2":"0.8895426","3":"0.02637682","4":"Shapiro-Wilk normality test"},{"1":"18","2":"0.9254425","3":"0.12614802","4":"Shapiro-Wilk normality test"},{"1":"25","2":"0.8978947","3":"0.03766278","4":"Shapiro-Wilk normality test"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The <code>shapiro.wilk</code> test makes a NULL Hypothesis that the data <strong>are</strong> normally distributed and estimates the probability that this could have happened by chance. Except for <code>TempFac = 18</code> the p-values are less than 0.05 and we can reject the NULL hypothesis that each of these is normally distributed. Perhaps this is a sign that we need more than 20 samples per factor level.</p>
<p>We can also check the residuals post-model:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-23_f3e8d4a075feefde6d95bc709a59f15e">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>frogs_anova<span class="sc">$</span>residuals <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="fu">gf_histogram</span>(<span class="sc">~</span> value,<span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4"></a>  <span class="fu">gf_theme</span>(<span class="at">theme =</span> <span class="fu">theme_frogs</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="LinReg_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>frogs_anova<span class="sc">$</span>residuals <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3"></a>  <span class="fu">gf_qq</span>(<span class="sc">~</span> value, <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4"></a>  <span class="fu">gf_qqstep</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href="#cb54-5"></a>  <span class="fu">gf_qqline</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-6"><a href="#cb54-6"></a>  <span class="fu">gf_theme</span>(<span class="at">theme =</span> <span class="fu">theme_frogs</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: sample
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output-display">
<p><img src="LinReg_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">shapiro.test</span>(frogs_anova<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  frogs_anova$residuals
W = 0.94814, p-value = 0.01275</code></pre>
</div>
</div>
<p>Unsurprisingly, the residuals are also not normally distributed either.</p>
</section><section id="check-for-similar-variance" class="level3"><h3 class="anchored" data-anchor-id="check-for-similar-variance">Check for Similar Variance</h3>
<p>Response data with different variances at different levels of an <em>explanatory</em> variable are said to exhibit <strong>heteroscedasticity</strong>. This violates one of the assumptions of ANOVA.</p>
<p>To check if the <code>Time</code> readings are similar in <code>variance</code> across levels of <code>TempFac</code>, we can use the Levene Test, or since our per-group observations are not normally distributed, a non-parametric rank-based Fligner-Killeen test. The NULL hypothesis is that the data <strong>are</strong> with similar variances. The tests assess how probable this is with the given data assuming this NULL hypothesis:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-24_32a6627283394e63fabd81e603650ff5">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>frogs_long <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="fu">group_by</span>(TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3"></a>  <span class="fu">summarise</span>(<span class="at">variance =</span> <span class="fu">var</span>(Time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["TempFac"],"name":[1],"type":["fct"],"align":["left"]},{"label":["variance"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"13","2":"1.273684"},{"1":"18","2":"1.263158"},{"1":"25","2":"1.431579"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># Not too different...OK on with the test</span></span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="fu">fligner.test</span>(Time <span class="sc">~</span> TempFac, <span class="at">data =</span> frogs_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fligner-Killeen test of homogeneity of variances

data:  Time by TempFac
Fligner-Killeen:med chi-squared = 0.53898, df = 2, p-value = 0.7638</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>DescTools<span class="sc">::</span><span class="fu">LeveneTest</span>(Time <span class="sc">~</span> TempFac, <span class="at">data =</span> frogs_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["F value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"0.3931034","3":"0.6767746","_rn_":"group"},{"1":"57","2":"NA","3":"NA","_rn_":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>It seems that there is no cause for concern here; the data do not have significantly different variances.</p>
</section><section id="independent-observations" class="level3"><h3 class="anchored" data-anchor-id="independent-observations">Independent Observations</h3>
<p>This is an experiment <em>design</em> concern; the way the data is gathered must be specified such that data for each level of the factors ( factor combinations if there are more than one) should be independent.</p>
</section></section><section id="effect-size" class="level2"><h2 class="anchored" data-anchor-id="effect-size">Effect Size</h2>
<p>The simplest way to find the actual <code>effect sizes</code> detected by an ANOVA test is to use (paradoxically) the <code><a href="https://rdrr.io/r/stats/summary.lm.html">summary.lm()</a></code> command:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-25_013401b73206a3ff4cea956f69c3dd76">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">summary.lm</span>(frogs_anova) <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"26.3","3":"0.2571777","4":"102.26394","5":"2.781059e-66"},{"1":"TempFac18","2":"-5.3","3":"0.3637041","4":"-14.57228","5":"7.081214e-21"},{"1":"TempFac25","2":"-10.1","3":"0.3637041","4":"-27.76982","5":"8.187867e-35"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>It may take a bit of effort to understand this. First the <code>TempFac</code> is arranged in order of levels, and the <code>mean</code> at the <span class="math inline">\(`TempFac` = 13\)</span> is titled <code>intercept</code>. That is <span class="math inline">\(26.3\)</span>. The other two means for levels <span class="math inline">\(18\)</span> and <span class="math inline">\(25\)</span> are stated as <strong>differences</strong> from this intercept, <span class="math inline">\(-5.3\)</span> and <span class="math inline">\(-10.1\)</span> respectively. The <code>p.value</code> for all these effect sizes is well below the desired confidence level of <span class="math inline">\(0.05\)</span>.</p>
<p>We can easily plot bar-chart with error bars for the effect size:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-26_a19248a8c6f62d009eb76d7f08f1a64a">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>tidy_anova <span class="ot">&lt;-</span> frogs_anova <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="fu">summary.lm</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb63-4"><a href="#cb63-4"></a>tidy_anova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"26.3","3":"0.2571777","4":"102.26394","5":"2.781059e-66"},{"1":"TempFac18","2":"-5.3","3":"0.3637041","4":"-14.57228","5":"7.081214e-21"},{"1":"TempFac25","2":"-10.1","3":"0.3637041","4":"-27.76982","5":"8.187867e-35"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># Merging group averages with `std.error`</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>frogs_long <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="#cb64-3"></a>  <span class="fu">group_by</span>(TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb64-4"><a href="#cb64-4"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Time)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-5"><a href="#cb64-5"></a>  <span class="fu">cbind</span>(<span class="at">std.error =</span> tidy_anova<span class="sc">$</span>std.error) <span class="sc">%&gt;%</span> </span>
<span id="cb64-6"><a href="#cb64-6"></a>  <span class="fu">mutate</span>(<span class="at">hi =</span> mean <span class="sc">+</span> std.error,</span>
<span id="cb64-7"><a href="#cb64-7"></a>         <span class="at">lo =</span> mean <span class="sc">-</span> std.error) <span class="sc">%&gt;%</span> </span>
<span id="cb64-8"><a href="#cb64-8"></a>  <span class="fu">gf_col</span>(<span class="at">data =</span> ., mean <span class="sc">~</span> TempFac, </span>
<span id="cb64-9"><a href="#cb64-9"></a>         <span class="at">fill =</span> <span class="st">"grey"</span>, </span>
<span id="cb64-10"><a href="#cb64-10"></a>         <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-11"><a href="#cb64-11"></a>  <span class="fu">gf_point</span>(mean <span class="sc">~</span> TempFac, </span>
<span id="cb64-12"><a href="#cb64-12"></a>           <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb64-13"><a href="#cb64-13"></a>           <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-14"><a href="#cb64-14"></a>    <span class="fu">gf_errorbar</span>(hi <span class="sc">+</span> lo <span class="sc">~</span> TempFac,</span>
<span id="cb64-15"><a href="#cb64-15"></a>                <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb64-16"><a href="#cb64-16"></a>                <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="LinReg_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="anova-using-permutation-tests" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="anova-using-permutation-tests">ANOVA using Permutation Tests</h2>
<p>We wish to establish the significance of the effect size due to each of the levels in <code>TempFac</code>. From the normality tests conducted earlier we see that except at one level of <code>TempFac</code>, the times are are not normally distributed. Hence we opt for a Permutation Test to check for significance of effect.</p>
<div class="page-columns page-full"><p>As remarked in Ernst<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, the non-parametric permutation test can be both <em>exact</em> and also <strong>intuitively easier</strong> for students to grasp. Permutations are easily executed in R, using packages such as <code>mosaic</code><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p><div class="no-row-height column-margin column-container"><li id="fn4"><p><sup>4</sup>&nbsp;Ernst, Michael D. 2004. “Permutation Methods: A Basis for Exact Inference.” Statistical Science 19 (4): 676–85. doi:10.1214/088342304000000396.</p></li><li id="fn5"><p><sup>5</sup>&nbsp;Pruim R, Kaplan DT, Horton NJ (2017). “The mosaic Package: Helping Students to ‘Think with Data’ Using R.” The R Journal, 9(1), 77–102. https://journal.r-project.org/archive/2017/RJ-2017-024/index.html.</p></li></div></div>
<p>We proceed with a Permutation Test for <code>TempFac</code>. We shuffle the levels (13, 18, 25) randomly between the Times and repeat the ANOVA test each time and calculate the F-statistic. The Null distribution is the distribution of the F-statistic over the many permutations and the p-value is given by the proportion of times the F-statistic equals or exceeds that observed.</p>
<p>We will use <code>mosaic</code> and also try with <code>infer</code>.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Using <code>mosaic</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Using <code>infer</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p><code>mosaic</code> offers an easy and intuitive way of doing a repeated permutation test, using the <code>do()</code> command. We will <code>shuffle</code> the <code>TempFac</code> factor to jumble up the <code>Time</code> observations, 10000 times. Each time we shuffle, we compute the F_statistic and record it. We then plot the 10000 F-statistics and compare that with the real-world observation of <code>F-stat</code>.</p>
<div class="cell" data-hash="LinReg_cache/html/permutation test for ANOVA with mosaic_764d1471eccdf4afcf2f907f6ca2201d">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>obs_F_stat <span class="ot">&lt;-</span> frogs_anova <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="fu">select</span>(statistic)</span>
<span id="cb65-4"><a href="#cb65-4"></a>observed_mosaic <span class="ot">&lt;-</span> obs_F_stat<span class="sc">$</span>statistic[<span class="dv">1</span>]</span>
<span id="cb65-5"><a href="#cb65-5"></a></span>
<span id="cb65-6"><a href="#cb65-6"></a>null_dist_mosaic <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">10000</span>) <span class="sc">*</span> <span class="fu">aov</span>(Time <span class="sc">~</span> <span class="fu">shuffle</span>(TempFac), <span class="at">data =</span> frogs_long)</span>
<span id="cb65-7"><a href="#cb65-7"></a>null_dist_mosaic <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["source"],"name":[1],"type":["chr"],"align":["left"]},{"label":["df"],"name":[2],"type":["int"],"align":["right"]},{"label":["SS"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["MS"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["pval"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".row"],"name":[7],"type":["int"],"align":["right"]},{"label":[".index"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"shuffle(TempFac)","2":"2","3":"11.23333","4":"5.616667","5":"0.2950419","6":"0.74563043","7":"1","8":"1","_rn_":"shuffle(TempFac)...1"},{"1":"Residuals","2":"57","3":"1085.10000","4":"19.036842","5":"NA","6":"NA","7":"2","8":"1","_rn_":"Residuals...2"},{"1":"shuffle(TempFac)","2":"2","3":"115.63333","4":"57.816667","5":"3.3604058","6":"0.04172692","7":"1","8":"2","_rn_":"shuffle(TempFac)...3"},{"1":"Residuals","2":"57","3":"980.70000","4":"17.205263","5":"NA","6":"NA","7":"2","8":"2","_rn_":"Residuals...4"},{"1":"shuffle(TempFac)","2":"2","3":"44.43333","4":"22.216667","5":"1.2038692","6":"0.30754405","7":"1","8":"3","_rn_":"shuffle(TempFac)...5"},{"1":"Residuals","2":"57","3":"1051.90000","4":"18.454386","5":"NA","6":"NA","7":"2","8":"3","_rn_":"Residuals...6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>null_dist_mosaic <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="#cb66-2"></a>  <span class="fu">select</span>(F) <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="fu">gf_histogram</span>(<span class="at">data =</span> ., <span class="sc">~</span> F, </span>
<span id="cb66-4"><a href="#cb66-4"></a>               <span class="at">fill =</span> <span class="sc">~</span> F <span class="sc">&gt;=</span> observed_mosaic,</span>
<span id="cb66-5"><a href="#cb66-5"></a>               <span class="at">title =</span> <span class="st">"Null Distribution of ANOVA F-statistic"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="LinReg_files/figure-html/permutation test for ANOVA with mosaic-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The Null distribution of the F_statistic under permutation shows it never crosses the real-world observed value, testifying the strength of the effect of <code>TempFac</code> on hatching <code>Time</code>. And the p-value is:</p>
<div class="cell" data-hash="LinReg_cache/html/unnamed-chunk-28_3d032ef3f00c67afb6173f2b4675a7e8">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(null_dist_mosaic<span class="sc">$</span>F <span class="sc">&gt;=</span> observed_mosaic, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-2"><a href="#cb67-2"></a>p_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>We calculate the observed F-stat with <code>infer</code>, which also has a very direct, if verbose, syntax for doing permutation tests:</p>
<div class="cell" data-hash="LinReg_cache/html/ANOVA F-statistic with infer_cb622ec78f61187b6a82fe443baffb50">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>observed_infer <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2"></a>  <span class="fu">specify</span>(Time <span class="sc">~</span> TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb69-3"><a href="#cb69-3"></a>  <span class="fu">hypothesise</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-4"><a href="#cb69-4"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"F"</span>)</span>
<span id="cb69-5"><a href="#cb69-5"></a>observed_infer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"385.8966"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We see that the observed F-Statistic is of course <span class="math inline">\(385.8966\)</span> as before. Now we use <code>infer</code> to generate a NULL distribution using permutation of the factor <code>TempFac</code>:</p>
<div class="cell" data-hash="LinReg_cache/html/Permutation using infer_1b3de439a7029fe74c41cffc547388f7">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>null_dist_infer <span class="ot">&lt;-</span> frogs_long <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="fu">specify</span>(Time <span class="sc">~</span> TempFac) <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="#cb70-3"></a>  <span class="fu">hypothesise</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="#cb70-4"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-5"><a href="#cb70-5"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"F"</span>)</span>
<span id="cb70-6"><a href="#cb70-6"></a></span>
<span id="cb70-7"><a href="#cb70-7"></a><span class="fu">head</span>(null_dist_infer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["replicate"],"name":[1],"type":["int"],"align":["right"]},{"label":["stat"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1.59294038"},{"1":"2","2":"0.23413647"},{"1":"3","2":"5.46619198"},{"1":"4","2":"2.84895154"},{"1":"5","2":"0.02688761"},{"1":"6","2":"1.20386919"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>null_dist_infer <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2"></a>  <span class="fu">visualise</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="LinReg_files/figure-html/Permutation using infer-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As seen, the <code>infer</code> based permutation test also shows that the permutationally generated F-statistics are nowhere near that which was observed. The effect of <code>TempFac</code> is very strong.</p>
</div>
</div>
</div>
</section><section id="conclusions" class="level2"><h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>We have discussed ANOVA as a means of modelling the effects of a Categorical variable on a Continuous (Quant) variable. ANOVA can be carried out using the standard formula <code>aov</code> when assumptions on distributions, variances, and independence are met. Permutation ANOVA tests can be carried out when these assumptions do not quite hold.</p>
</section><section id="references" class="level2"><h2 class="anchored" data-anchor-id="references">References</h2>
<ol type="1">
<li>The ANOVA tutorial at <a href="https://ourcodingclub.github.io/tutorials/anova/">Our Coding Club</a>.</li>
<li>Michael Crawley, The R Book,second edition, 2013. Chapter 11.</li>
<li>David C Howell, <a href="https://www.uvm.edu/~statdhtx/StatPages/Permutation%20Anova/PermTestsAnova.html">Permutation Tests for Factorial ANOVA Designs</a>
</li>
<li>Marti Anderson, <a href="https://www.academia.edu/50056272/Permutation_tests_for_univariate_or_multivariate_analysis_of_variance_and_regression?auto=download">Permutation tests for univariate or multivariate analysis of variance and regression</a>
</li>
</ol>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/av-quarto\.netlify\.app/);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Website made with 💜 and <a href="https://quarto.org/">Quarto</a>, by Arvind Venkatadri. License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>.</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:arvind.venkatadri@gmail.com">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


<script src="../../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>