<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Arvind Venkatadri">
<meta name="dcterms.date" content="2022-11-25">
<meta name="keywords" content="Statistics ; Tests; p-value; Feynman Technique">
<title>The Foundation Series in Quarto - Linear Models: Comparing Proportions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="The Foundation Series in Quarto - Linear Models: Comparing Proportions">
<meta property="og:description" content="This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats.">
<meta property="og:site-name" content="The Foundation Series in Quarto">
<meta name="twitter:title" content="The Foundation Series in Quarto - Linear Models: Comparing Proportions">
<meta name="twitter:description" content="This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats.">
<meta name="twitter:creator" content="@arvind_v">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">The Foundation Series in Quarto</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/my-quarto-website"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../../../blog.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Linear Models: Comparing Proportions</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../blog.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Teaching</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/posts/posts.html" class="sidebar-item-text sidebar-link">Posts</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/projects/projects.html" class="sidebar-item-text sidebar-link">Projects</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#a-workflow-in-orange" id="toc-a-workflow-in-orange" class="nav-link active" data-scroll-target="#a-workflow-in-orange">A Workflow in Orange</a></li>
  <li><a href="#a-workflow-in-radiant" id="toc-a-workflow-in-radiant" class="nav-link" data-scroll-target="#a-workflow-in-radiant">A Workflow in Radiant</a></li>
  <li><a href="#a-workflow-in-r" id="toc-a-workflow-in-r" class="nav-link" data-scroll-target="#a-workflow-in-r">A Workflow in R</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li>
<a href="#structure-of-this-document" id="toc-structure-of-this-document" class="nav-link" data-scroll-target="#structure-of-this-document">Structure of this document</a>
  <ul class="collapse">
<li>
<a href="#test" id="toc-test" class="nav-link" data-scroll-target="#test">Test</a>
  <ul class="collapse">
<li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a></li>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code">Code</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
<li><a href="#sample-values" id="toc-sample-values" class="nav-link" data-scroll-target="#sample-values">Sample Values</a></li>
  <li><a href="#signed-rank-values" id="toc-signed-rank-values" class="nav-link" data-scroll-target="#signed-rank-values">“Signed Rank” Values</a></li>
  <li><a href="#plotting-original-and-signed-rank-data" id="toc-plotting-original-and-signed-rank-data" class="nav-link" data-scroll-target="#plotting-original-and-signed-rank-data">Plotting Original and Signed Rank Data</a></li>
  <li><a href="#how-does-sign-rank-data-work" id="toc-how-does-sign-rank-data-work" class="nav-link" data-scroll-target="#how-does-sign-rank-data-work">How does Sign-Rank data work?</a></li>
  </ul>
</li>
  <li>
<a href="#the-linear-regression-model" id="toc-the-linear-regression-model" class="nav-link" data-scroll-target="#the-linear-regression-model">The Linear ( Regression ) Model</a>
  <ul class="collapse">
<li><a href="#linear-models-as-hypothesis-tests" id="toc-linear-models-as-hypothesis-tests" class="nav-link" data-scroll-target="#linear-models-as-hypothesis-tests">Linear Models as Hypothesis Tests</a></li>
  <li><a href="#linear-models-in-r" id="toc-linear-models-in-r" class="nav-link" data-scroll-target="#linear-models-in-r">Linear Models in R</a></li>
  <li><a href="#assumptions-in-linear-models" id="toc-assumptions-in-linear-models" class="nav-link" data-scroll-target="#assumptions-in-linear-models">Assumptions in Linear Models</a></li>
  </ul>
</li>
  <li>
<a href="#tests-for-correlation" id="toc-tests-for-correlation" class="nav-link" data-scroll-target="#tests-for-correlation">Tests for Correlation</a>
  <ul class="collapse">
<li>
<a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation">Pearson Correlation</a>
  <ul class="collapse">
<li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1">Model</a></li>
  <li><a href="#code-1" id="toc-code-1" class="nav-link" data-scroll-target="#code-1">Code</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  </ul>
</li>
  <li>
<a href="#spearman-correlation" id="toc-spearman-correlation" class="nav-link" data-scroll-target="#spearman-correlation">Spearman Correlation</a>
  <ul class="collapse">
<li><a href="#model-2" id="toc-model-2" class="nav-link" data-scroll-target="#model-2">Model</a></li>
  <li><a href="#code-2" id="toc-code-2" class="nav-link" data-scroll-target="#code-2">Code</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#tests-on-one-mean" id="toc-tests-on-one-mean" class="nav-link" data-scroll-target="#tests-on-one-mean">Tests on One Mean</a>
  <ul class="collapse">
<li>
<a href="#the-students-t-test-with-one-sample" id="toc-the-students-t-test-with-one-sample" class="nav-link" data-scroll-target="#the-students-t-test-with-one-sample">The Student’s t-test with one sample</a>
  <ul class="collapse">
<li><a href="#model-3" id="toc-model-3" class="nav-link" data-scroll-target="#model-3">Model</a></li>
  <li><a href="#code-3" id="toc-code-3" class="nav-link" data-scroll-target="#code-3">Code</a></li>
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3">Example</a></li>
  </ul>
</li>
  <li>
<a href="#wilcoxons-signed-rank-test" id="toc-wilcoxons-signed-rank-test" class="nav-link" data-scroll-target="#wilcoxons-signed-rank-test">Wilcoxon’s Signed-Rank Test</a>
  <ul class="collapse">
<li><a href="#model-4" id="toc-model-4" class="nav-link" data-scroll-target="#model-4">Model</a></li>
  <li><a href="#code-4" id="toc-code-4" class="nav-link" data-scroll-target="#code-4">Code</a></li>
  <li><a href="#example-4" id="toc-example-4" class="nav-link" data-scroll-target="#example-4">Example</a></li>
  <li><a href="#plots-for-both-t-test-and-wilcoxon-test" id="toc-plots-for-both-t-test-and-wilcoxon-test" class="nav-link" data-scroll-target="#plots-for-both-t-test-and-wilcoxon-test">Plots for both t-test and Wilcoxon test</a></li>
  </ul>
</li>
  <li>
<a href="#paired-sample-t-test" id="toc-paired-sample-t-test" class="nav-link" data-scroll-target="#paired-sample-t-test">Paired Sample t-test</a>
  <ul class="collapse">
<li><a href="#model-5" id="toc-model-5" class="nav-link" data-scroll-target="#model-5">Model</a></li>
  <li><a href="#code-5" id="toc-code-5" class="nav-link" data-scroll-target="#code-5">Code</a></li>
  <li><a href="#example-5" id="toc-example-5" class="nav-link" data-scroll-target="#example-5">Example</a></li>
  </ul>
</li>
  <li>
<a href="#wilcoxon-paired-test" id="toc-wilcoxon-paired-test" class="nav-link" data-scroll-target="#wilcoxon-paired-test">Wilcoxon Paired Test</a>
  <ul class="collapse">
<li><a href="#model-6" id="toc-model-6" class="nav-link" data-scroll-target="#model-6">Model</a></li>
  <li><a href="#code-6" id="toc-code-6" class="nav-link" data-scroll-target="#code-6">Code</a></li>
  <li><a href="#example-6" id="toc-example-6" class="nav-link" data-scroll-target="#example-6">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#tests-with-two-means" id="toc-tests-with-two-means" class="nav-link" data-scroll-target="#tests-with-two-means">Tests with Two Means</a>
  <ul class="collapse">
<li><a href="#dummy-group-variable-concept" id="toc-dummy-group-variable-concept" class="nav-link" data-scroll-target="#dummy-group-variable-concept">Dummy Group Variable Concept</a></li>
  <li><a href="#model-7" id="toc-model-7" class="nav-link" data-scroll-target="#model-7">Model</a></li>
  </ul>
</li>
  <li>
<a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a>
  <ul class="collapse">
<li>
<a href="#independent-t-test" id="toc-independent-t-test" class="nav-link" data-scroll-target="#independent-t-test">Independent t-test</a>
  <ul class="collapse">
<li><a href="#model-8" id="toc-model-8" class="nav-link" data-scroll-target="#model-8">Model</a></li>
  <li><a href="#code-7" id="toc-code-7" class="nav-link" data-scroll-target="#code-7">Code</a></li>
  <li><a href="#example-7" id="toc-example-7" class="nav-link" data-scroll-target="#example-7">Example</a></li>
  </ul>
</li>
  <li>
<a href="#welchs-t-test" id="toc-welchs-t-test" class="nav-link" data-scroll-target="#welchs-t-test">Welch’s t-test</a>
  <ul class="collapse">
<li><a href="#model-9" id="toc-model-9" class="nav-link" data-scroll-target="#model-9">Model</a></li>
  <li><a href="#code-8" id="toc-code-8" class="nav-link" data-scroll-target="#code-8">Code</a></li>
  <li><a href="#example-8" id="toc-example-8" class="nav-link" data-scroll-target="#example-8">Example</a></li>
  </ul>
</li>
  <li>
<a href="#mann-whitney-u-test" id="toc-mann-whitney-u-test" class="nav-link" data-scroll-target="#mann-whitney-u-test">Mann-Whitney U Test</a>
  <ul class="collapse">
<li><a href="#model-10" id="toc-model-10" class="nav-link" data-scroll-target="#model-10">Model</a></li>
  <li><a href="#code-9" id="toc-code-9" class="nav-link" data-scroll-target="#code-9">Code</a></li>
  <li><a href="#example-9" id="toc-example-9" class="nav-link" data-scroll-target="#example-9">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#tests-with-three-or-more-means" id="toc-tests-with-three-or-more-means" class="nav-link" data-scroll-target="#tests-with-three-or-more-means">Tests with Three or More Means</a>
  <ul class="collapse">
<li><a href="#model-11" id="toc-model-11" class="nav-link" data-scroll-target="#model-11">Model</a></li>
  <li>
<a href="#one-way-anova" id="toc-one-way-anova" class="nav-link" data-scroll-target="#one-way-anova">One-way ANOVA</a>
  <ul class="collapse">
<li><a href="#model-12" id="toc-model-12" class="nav-link" data-scroll-target="#model-12">Model</a></li>
  <li><a href="#code-10" id="toc-code-10" class="nav-link" data-scroll-target="#code-10">Code</a></li>
  <li><a href="#example-10" id="toc-example-10" class="nav-link" data-scroll-target="#example-10">Example</a></li>
  </ul>
</li>
  <li>
<a href="#two-way-anova" id="toc-two-way-anova" class="nav-link" data-scroll-target="#two-way-anova">Two-way ANOVA</a>
  <ul class="collapse">
<li><a href="#model-13" id="toc-model-13" class="nav-link" data-scroll-target="#model-13">Model</a></li>
  <li><a href="#code-11" id="toc-code-11" class="nav-link" data-scroll-target="#code-11">Code</a></li>
  <li><a href="#example-11" id="toc-example-11" class="nav-link" data-scroll-target="#example-11">Example</a></li>
  </ul>
</li>
  <li>
<a href="#ancova" id="toc-ancova" class="nav-link" data-scroll-target="#ancova">ANCOVA</a>
  <ul class="collapse">
<li><a href="#model-14" id="toc-model-14" class="nav-link" data-scroll-target="#model-14">Model</a></li>
  <li><a href="#code-12" id="toc-code-12" class="nav-link" data-scroll-target="#code-12">Code</a></li>
  <li><a href="#example-12" id="toc-example-12" class="nav-link" data-scroll-target="#example-12">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#proportions" id="toc-proportions" class="nav-link" data-scroll-target="#proportions">Proportions</a>
  <ul class="collapse">
<li><a href="#model-15" id="toc-model-15" class="nav-link" data-scroll-target="#model-15">Model</a></li>
  <li>
<a href="#discrete-variables" id="toc-discrete-variables" class="nav-link" data-scroll-target="#discrete-variables">Discrete Variables</a>
  <ul class="collapse">
<li><a href="#model-16" id="toc-model-16" class="nav-link" data-scroll-target="#model-16">Model</a></li>
  <li><a href="#code-13" id="toc-code-13" class="nav-link" data-scroll-target="#code-13">Code</a></li>
  <li><a href="#example-13" id="toc-example-13" class="nav-link" data-scroll-target="#example-13">Example</a></li>
  </ul>
</li>
  <li>
<a href="#continuous-variables" id="toc-continuous-variables" class="nav-link" data-scroll-target="#continuous-variables">Continuous Variables</a>
  <ul class="collapse">
<li><a href="#model-17" id="toc-model-17" class="nav-link" data-scroll-target="#model-17">Model</a></li>
  <li><a href="#code-14" id="toc-code-14" class="nav-link" data-scroll-target="#code-14">Code</a></li>
  <li><a href="#example-14" id="toc-example-14" class="nav-link" data-scroll-target="#example-14">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Linear Models: Comparing Proportions</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Arvind Venkatadri </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 25, 2022</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">January 12, 2023</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats. The method followed is that of Jonas Lindoloev, wherein every stat test is treated as a linear model y = mx + c.
  </div>
</div>

</header><section id="a-workflow-in-orange" class="level2"><h2 class="anchored" data-anchor-id="a-workflow-in-orange">A Workflow in Orange</h2>
</section><section id="a-workflow-in-radiant" class="level2"><h2 class="anchored" data-anchor-id="a-workflow-in-radiant">A Workflow in Radiant</h2>
</section><section id="a-workflow-in-r" class="level2"><h2 class="anchored" data-anchor-id="a-workflow-in-r">A Workflow in R</h2>
</section><section id="references" class="level1"><h1>References</h1>
<ol type="1">
<li>
<em>Common statistical tests are linear models (or: how to teach stats)</em> by <a href="https://lindeloev.github.io/tests-as-linear/">Jonas Kristoffer Lindeløv</a>
</li>
<li><a href="https://lindeloev.github.io/tests-as-linear/linear_tests_cheat_sheet.pdf">CheatSheet</a></li>
<li>
<em>Common statistical tests are linear models: a work through</em> by <a href="https://steverxd.github.io/Stat_tests/">Steve Doogue</a>
</li>
<li><a href="https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/">Jeffrey Walker “Elements of Statistical Modeling for Experimental Biology”</a></li>
<li>Text: Diez, David M &amp; Barr, Christopher D &amp; Çetinkaya-Rundel, Mine: <a href="https://www.openintro.org/book/os/">OpenIntro Statistics</a>
</li>
<li>Modern Statistics with R: From wrangling and exploring data to inference and predictive modelling by <a href="http://www.modernstatisticswithr.com/">Måns Thulin</a>
</li>
</ol></section><section id="structure-of-this-document" class="level1"><h1>Structure of this document</h1>
<p>We will follow the following structure: Each kind of Test is described in a separate Chapter. The Test <em>Model</em> is laid out in formula <span class="math inline">\(y = mx + c\)</span> and in <em>Code</em>.</p>
<p>The Structure looks like this:</p>
<section id="test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="test">Test</h2>
<section id="model" class="level3"><h3 class="anchored" data-anchor-id="model">Model</h3>
<p>Explanation, formula etc.</p>
</section><section id="code" class="level3"><h3 class="anchored" data-anchor-id="code">Code</h3>
<p>With Toy Data; Graphs</p>
</section><section id="example" class="level3"><h3 class="anchored" data-anchor-id="example">Example</h3>
<p>With another “real world” data set; Graphs</p>
</section></section></section><section id="data" class="level1"><h1>Data</h1>
<section id="sample-values" class="level2"><h2 class="anchored" data-anchor-id="sample-values">Sample Values</h2>
<p>Most examples in this exposition are based on three “imaginary” samples, <span class="math inline">\(x, y, y2\)</span>. Each is normally distributed and made up of 50 observations.</p>
<p>We start by creating a function that will allow us to produce samples of a given size (N) with a specified mean (mu) and standard deviation (sd): Note: this gives a <em>matrix</em> of numbers, as opposed to a vector using <code>rnorm</code> by itself. The data are created both in vector form and tibble form for flexibility of use in diverse packages and formulae in what follows.</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>rnorm_fixed  <span class="ot">&lt;-</span> <span class="cf">function</span>(N, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) {</span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="fu">scale</span>(<span class="fu">rnorm</span>(N))<span class="sc">*</span> sd <span class="sc">+</span> mu</span>
<span id="cb1-3"><a href="#cb1-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We create three variables: x ( explanatory) and y, y2 ( dependent ).</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">set.seed</span>(<span class="dv">40</span>) <span class="co"># for replication</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># Data as vectors ( for t.tests etc)</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co">#explanatory</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.3</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="co"># dependent #1</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>y2 <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="fl">1.5</span>) <span class="co"># dependent #2</span></span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># Make a tibble with all variables</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>mydata_wide <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">y2 =</span> y2)</span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co"># Long form data</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>mydata_long <span class="ot">&lt;-</span> </span>
<span id="cb2-13"><a href="#cb2-13"></a>  mydata_wide <span class="sc">%&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>  <span class="fu">pivot_longer</span>(., <span class="at">cols =</span> <span class="fu">c</span>(x,y,y2), </span>
<span id="cb2-15"><a href="#cb2-15"></a>               <span class="at">names_to =</span> <span class="st">"group"</span>, </span>
<span id="cb2-16"><a href="#cb2-16"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co"># Long form data with only dependent variables</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>mydata_long_y <span class="ot">&lt;-</span> </span>
<span id="cb2-20"><a href="#cb2-20"></a>  mydata_wide <span class="sc">%&gt;%</span> </span>
<span id="cb2-21"><a href="#cb2-21"></a>  <span class="fu">select</span>(<span class="sc">-</span>x) <span class="sc">%&gt;%</span> </span>
<span id="cb2-22"><a href="#cb2-22"></a>  <span class="fu">pivot_longer</span>(., <span class="at">cols =</span> <span class="fu">c</span>(y,y2), </span>
<span id="cb2-23"><a href="#cb2-23"></a>               <span class="at">names_to =</span> <span class="st">"group"</span>, </span>
<span id="cb2-24"><a href="#cb2-24"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb2-25"><a href="#cb2-25"></a>mydata_wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 3
    x[,1]  y[,1] y2[,1]
    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1  0.427  1.98   0.103
 2  0.444  1.27  -0.281
 3 -0.828 -0.944  0.624
 4 -0.799  0.103  5.43 
 5 -0.323  2.19   0.168
 6 -1.24   0.192 -0.549
 7 -1.36   4.81   0.309
 8  1.62   1.55  -0.990
 9 -0.292  3.36  -0.172
10 -1.25   1.92  -0.158
# … with 40 more rows</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>mydata_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 2
   group value[,1]
   &lt;chr&gt;     &lt;dbl&gt;
 1 x         0.427
 2 y         1.98 
 3 y2        0.103
 4 x         0.444
 5 y         1.27 
 6 y2       -0.281
 7 x        -0.828
 8 y        -0.944
 9 y2        0.624
10 x        -0.799
# … with 140 more rows</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>mydata_long_y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 2
   group value[,1]
   &lt;chr&gt;     &lt;dbl&gt;
 1 y         1.98 
 2 y2        0.103
 3 y         1.27 
 4 y2       -0.281
 5 y        -0.944
 6 y2        0.624
 7 y         0.103
 8 y2        5.43 
 9 y         2.19 
10 y2        0.168
# … with 90 more rows</code></pre>
</div>
</div>
</section><section id="signed-rank-values" class="level2"><h2 class="anchored" data-anchor-id="signed-rank-values">“Signed Rank” Values</h2>
<p>Most statistical tests use the <strong>actual values</strong> of the data variables. However, in some <em>non-parametric</em> statistical tests, the data are used in <strong>rank-transformed</strong> sense/order. In some cases the <strong>signed-rank</strong> of the data values is used instead of the data itself.</p>
<p>Signed Rank is calculated as follows:<br>
1. Take the absolute value of each observation in a sample<br>
2. Place the <u><em>ranks</em></u> in order of (absolute magnitude). The smallest number has <em>rank = 1</em> and so on.<br>
3. Give each of the ranks the sign of the original observation ( + or - )</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>signed_rank <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">sign</span>(x) <span class="sc">*</span> <span class="fu">rank</span>(<span class="fu">abs</span>(x))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="plotting-original-and-signed-rank-data" class="level2"><h2 class="anchored" data-anchor-id="plotting-original-and-signed-rank-data">Plotting Original and Signed Rank Data</h2>
<p>A quick plot:</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_long,<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.02</span>, <span class="at">height =</span> <span class="dv">0</span>,<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb9-4"><a href="#cb9-4"></a>                                       <span class="at">x =</span> .<span class="dv">75</span>, </span>
<span id="cb9-5"><a href="#cb9-5"></a>                                       <span class="at">xend =</span> <span class="fl">1.25</span> )) <span class="sc">+</span> </span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="st">"0"</span>)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.3</span>, <span class="at">yend =</span> <span class="fl">0.3</span>, </span>
<span id="cb9-8"><a href="#cb9-8"></a>                                       <span class="at">x =</span> <span class="fl">1.75</span> , </span>
<span id="cb9-9"><a href="#cb9-9"></a>                                       <span class="at">xend =</span> <span class="fl">2.25</span> )) <span class="sc">+</span> </span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">0.6</span>, <span class="at">label =</span> <span class="st">"0.3"</span>)) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">yend =</span> <span class="fl">0.5</span>, </span>
<span id="cb9-12"><a href="#cb9-12"></a>                                       <span class="at">x =</span> <span class="fl">2.75</span>, </span>
<span id="cb9-13"><a href="#cb9-13"></a>                                       <span class="at">xend =</span> <span class="fl">3.25</span> )) <span class="sc">+</span> </span>
<span id="cb9-14"><a href="#cb9-14"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.8</span>, <span class="at">label =</span> <span class="st">"0.5"</span>)) <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Original Data"</span>) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>  <span class="fu">ylab</span>(<span class="st">"Response Variable"</span>)</span>
<span id="cb9-17"><a href="#cb9-17"></a></span>
<span id="cb9-18"><a href="#cb9-18"></a>p2 <span class="ot">&lt;-</span> mydata_long <span class="sc">%&gt;%</span> </span>
<span id="cb9-19"><a href="#cb9-19"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> </span>
<span id="cb9-20"><a href="#cb9-20"></a>  <span class="fu">mutate</span>( <span class="at">s_value =</span> <span class="fu">signed_rank</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-21"><a href="#cb9-21"></a>  <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> s_value)) <span class="sc">+</span> </span>
<span id="cb9-22"><a href="#cb9-22"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.02</span>, <span class="at">height =</span> <span class="dv">0</span>,<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb9-23"><a href="#cb9-23"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, </span>
<span id="cb9-24"><a href="#cb9-24"></a>               <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb9-25"><a href="#cb9-25"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Signed Rank of Data"</span>) <span class="sc">+</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>  <span class="fu">ylab</span>(<span class="st">"Signed Rank of Response Variable"</span>)</span>
<span id="cb9-27"><a href="#cb9-27"></a></span>
<span id="cb9-28"><a href="#cb9-28"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/data_plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="how-does-sign-rank-data-work" class="level2"><h2 class="anchored" data-anchor-id="how-does-sign-rank-data-work">How does Sign-Rank data work?</h2>
<p>TBD: need to add some explanation here.</p>
</section></section><section id="the-linear-regression-model" class="level1 tabset"><h1 class="tabset">The Linear ( Regression ) Model</h1>
<p>The premise here is that many common statistical tests are special cases of the linear model.</p>
<p>A linear model estimates the relationship between one <em>continuous</em> or <em>ordinal</em> variable (dependent variable or “response” ) and one or more other variables ( explanatory variable or “predictors” ). It is assumed that the relationship is linear:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 *x
\]</span> <span class="math inline">\(\beta_0\)</span> is the <em>intercept</em> and <span class="math inline">\(\beta_1\)</span> is the slope of the linear fit, that <strong>predicts</strong> the value of y based the value of x. Each prediction leaves a small “residual” error between the actual and predicted values. <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are calculated based on minimizing the <em>sum of square</em>s of these residuals, and hence this method is called “ordinary least squares” regression.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="OLS.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Least Squares</figcaption><p></p>
</figure>
</div>
<p>The net <em>area</em> of all the shaded squares is minimized in the calculation of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. It is also possible that there is more than one explanatory variable: this is <strong>multiple regression.</strong></p>
<p><span class="math display">\[
y = \beta_0 + \beta_1*x_1 + \beta_2*x_2 ...+ \beta_n*x_n
\]</span></p>
<p>where each of the <span class="math inline">\(\beta_i\)</span> are slopes defining the relationship between y and <span class="math inline">\(x_i\)</span>. Together, the RHS of that equation defines an n-dimensional <em>plane</em>.</p>
<p>As per Lindoloev, many statistical tests, going from one-sample t-tests to two-way ANOVA, are special cases of this system.</p>
<p>Also see <a href="https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables">Jeffrey Walker “A linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables”</a></p>
<section id="linear-models-as-hypothesis-tests" class="level2"><h2 class="anchored" data-anchor-id="linear-models-as-hypothesis-tests">Linear Models as Hypothesis Tests</h2>
<p>Using linear models is based on the idea of <strong>Testing of Hypotheses</strong>. The Hypothesis Testing method typically defines a NULL Hypothesis where the statements read as “<strong>there is no relationship</strong>” between the variables at hand, explanatory and responses. The Alternative Hypothesis typically states that there <em>is</em> a relationship between the variables.</p>
<p>Accordingly, in fitting a linear model, we follow the process as follows:</p>
<ol type="1">
<li>Make the following hypotheses: <span class="math display">\[
y = \beta_0 + \beta_1 *x \\
NULL\ Hypothesis\ H_0 =&gt; x\ and\ y\ are\ unrelated.\ (\beta_1 = 0)
\]</span> <span class="math display">\[
y = \beta_0 + \beta_1 *x \\
Alternate\ Hypothesis\ H_1 =&gt; x\ and\ y\ are\ linearly\ related\ (\beta_1 \ne 0)
\]</span>
</li>
<li>We “assume” that <span class="math inline">\(H_0\)</span> is true.</li>
<li>We calculate <span class="math inline">\(\beta_1\)</span>.</li>
<li>We then find probability <strong>p</strong> that [<span class="math inline">\(\beta_1 = Estimated\ Value\)</span>] <strong>when the NULL Hypothesis</strong> is <strong>assumed</strong> TRUE. This is the <strong>p-value</strong>. If that probability is <strong>p&gt;=0.05</strong>, we say we “cannot reject” <span class="math inline">\(H_0\)</span> and there is unlikely to be significant linear relationship.</li>
</ol>
<p>However, if <strong>p&lt;= 0.05</strong> can we reject the NULL hypothesis, and say that there could be a significant linear relationship,because <span class="math inline">\(\beta_1 = Estimated\ Value\)</span> by mere chance under <span class="math inline">\(H_0\)</span> is very small.</p>
<p>Pheeew !!</p>
</section><section id="linear-models-in-r" class="level2"><h2 class="anchored" data-anchor-id="linear-models-in-r">Linear Models in R</h2>
<p><code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> is the function to create linear models in R. In R we are lazy and write :</p>
<p><span class="math display">\[
y \sim 1 + x\\
which\ reads\ like\\
y = 1*number + x* another\ number
\]</span></p>
<p>Note: there are very many ways in which linear models can be coded in R. See <a href="https://cran.r-project.org/doc/contrib/Ricci-refcard-regression.pdf">Vito Ricci on CRAN.</a></p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># using lm()</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span>   </span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ 1 + x, data = mydata_wide)

Residuals:
     Min       1Q   Median       3Q      Max 
-3.93980 -1.09967  0.12548  1.27904  3.88372 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  0.30000    0.27799  1.0792   0.2859
x           -0.46355    0.28081 -1.6507   0.1053

Residual standard error: 1.9657 on 48 degrees of freedom
Multiple R-squared:  0.05372,   Adjusted R-squared:  0.034006 
F-statistic:  2.725 on 1 and 48 DF,  p-value: 0.10532</code></pre>
</div>
</div>
<p>Since the <em>p-value</em> is &gt;=0.05, we <em>fail to reject the NULL Hypothesis that there is no relationship between x and y</em>.</p>
</section><section id="assumptions-in-linear-models" class="level2"><h2 class="anchored" data-anchor-id="assumptions-in-linear-models">Assumptions in Linear Models</h2>
<ol type="1">
<li>
<strong>L</strong>: <span class="math inline">\(\color{blue}{linear}\)</span> relationship</li>
<li>
<strong>I</strong>: Errors are <strong>independent</strong> (across observations)</li>
<li>
<strong>N</strong>: y is <span class="math inline">\(\color{red}{normally}\)</span> distributed at each “level” of
<ol start="24" type="a">
<li>
</li></ol>
</li>
<li>
<strong>E</strong>: equal variance at all levels of x. No <em>heteroscedasticity</em>. <img src="ols_assumptions.png" class="img-fluid" alt="OLS Assumptions">
</li>
</ol>
<p>Let us now see which standard statistical tests can be re-formulated as Linear Models.</p>
</section></section><section id="tests-for-correlation" class="level1 tabset"><h1 class="tabset">Tests for Correlation</h1>
<p>Correlation <strong>r</strong> is a measure of <em>strength</em> and <em>direction</em> of <em>linear association</em> between two variables. <strong>r</strong> is between [-1,+1], with 0 implying no association/correlation.</p>
<p>From this definition, the <em>linear model</em> lends itself in a straightforward way as a model to interpret <em>correlation</em>. Intuitively, the slope of the linear model could be related to the correlation between y and x.</p>
<p>Now we look at the numbers.</p>
<section id="pearson-correlation" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="pearson-correlation">Pearson Correlation</h2>
<section id="model-1" class="level3"><h3 class="anchored" data-anchor-id="model-1">Model</h3>
<p>The model for Pearson Correlation tests is exactly the Linear Model:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 * x
\\
H_0: \beta_1 = 0
\]</span></p>
<p>See the Code section for further insights into the relationship between the Correlation Score and the Slope of the Linear Model.</p>
</section><section id="code-1" class="level3"><h3 class="anchored" data-anchor-id="code-1">Code</h3>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Pearson (built-in test)</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>cor <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(y,x,<span class="at">method =</span> <span class="st">"pearson"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># Linear Model</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>lin <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb12-7"><a href="#cb12-7"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co"># Scaled linear model</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>lin_scl <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">scale</span>(y) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">scale</span>(x), <span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb12-11"><a href="#cb12-11"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb12-12"><a href="#cb12-12"></a></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="fu">print</span>(cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  estimate p.value
     &lt;dbl&gt;   &lt;dbl&gt;
1   -0.232   0.105</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">print</span>(lin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  estimate p.value
     &lt;dbl&gt;   &lt;dbl&gt;
1    0.3     0.286
2   -0.464   0.105</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">print</span>(lin_scl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   estimate p.value
      &lt;dbl&gt;   &lt;dbl&gt;
1 -9.06e-17   1    
2 -2.32e- 1   0.105</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># All together</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">rbind</span>(cor, lin, lin_scl) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
   estimate p.value
      &lt;dbl&gt;   &lt;dbl&gt;
1 -2.32e- 1   0.105
2  3   e- 1   0.286
3 -4.64e- 1   0.105
4 -9.06e-17   1    
5 -2.32e- 1   0.105</code></pre>
</div>
</div>
<p>Notes: 1. The <em>p-value</em> for Pearson Correlation and that for the <em>slope</em> in the linear model is the same ( 0.1053 ). Which means we cannot reject the NULL hypothesis of “no relationship”.</p>
<ol start="2" type="1">
<li>Here is the relationship between the slope and correlation:</li>
</ol>
<p><span class="math display">\[
Slope\ \beta_1 = \frac{sd_y}{sd_x} * r
\]</span></p>
<p>When both x and y have the same standard deviation, the slope and correlation are the same. Here, since x has twice the <code>sd</code> of y, the ratio of <strong>slope</strong> = -0.4635533 to <strong>r</strong> = -0.2317767 is 0.5. Hence a linear model using <code><a href="https://rdrr.io/r/base/scale.html">scale()</a></code> for both variables will show slope = <strong>r</strong>.</p>
<p>Slope_Scaled: -0.2317767 = Correlation: -0.2317767</p>
</section><section id="example-1" class="level3"><h3 class="anchored" data-anchor-id="example-1">Example</h3>
<p>We choose to look at the <code>gpa_study_hours</code> dataset. It has two numeric columns <code>gpa</code> and <code>study_hours</code>:</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">glimpse</span>(gpa_study_hours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>Rows: 193
Columns: 2
$ gpa         &lt;dbl&gt; 4.000, 3.800, 3.930, 3.400, 3.200, 3.520, 3.680, 3.400, 3.…
$ study_hours &lt;dbl&gt; 10, 25, 45, 10, 4, 10, 24, 40, 10, 10, 30, 7, 15, 60, 10, …</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Checks for Normal/Symmetric distributions</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gpa_study_hours) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(gpa))</span>
<span id="cb22-3"><a href="#cb22-3"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gpa_study_hours) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(study_hours))</span>
<span id="cb22-4"><a href="#cb22-4"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gpa_study_hours) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(gpa, study_hours))</span>
<span id="cb22-5"><a href="#cb22-5"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Pearson_example_1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hmm…not normally distributed, and the relationship is also not linear, and there is some evidence of heterscedasticity, so Pearson correlation would not be the best idea here.</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Pearson Correlation as Linear Model</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="fu">lm</span>(gpa <span class="sc">~</span> study_hours, <span class="at">data =</span> gpa_study_hours) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gpa ~ study_hours, data = gpa_study_hours)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.95130 -0.19456  0.03879  0.21708  0.73872 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 3.527997   0.037424  94.272   &lt;2e-16 ***
study_hours 0.003328   0.001794   1.855   0.0652 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2837 on 191 degrees of freedom
Multiple R-squared:  0.01769,   Adjusted R-squared:  0.01255 
F-statistic:  3.44 on 1 and 191 DF,  p-value: 0.06517</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Other ways using other packages</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>mosaic<span class="sc">::</span><span class="fu">cor_test</span>(gpa <span class="sc">~</span> study_hours, <span class="at">data =</span> gpa_study_hours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  gpa and study_hours
t = 1.8548, df = 191, p-value = 0.06517
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.008383868  0.269196552
sample estimates:
      cor 
0.1330138 </code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>statsExpressions<span class="sc">::</span><span class="fu">corr_test</span>(<span class="at">data =</span> gpa_study_hours, </span>
<span id="cb28-2"><a href="#cb28-2"></a>                            <span class="at">x =</span> study_hours, </span>
<span id="cb28-3"><a href="#cb28-3"></a>                            <span class="at">y =</span> gpa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 14
  parameter1  paramet…¹ effec…² estim…³ conf.…⁴ conf.low conf.…⁵ stati…⁶ df.er…⁷
  &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;int&gt;
1 study_hours gpa       Pearso…   0.133    0.95 -0.00838   0.269    1.85     191
# … with 5 more variables: p.value &lt;dbl&gt;, method &lt;chr&gt;, n.obs &lt;int&gt;,
#   conf.method &lt;chr&gt;, expression &lt;list&gt;, and abbreviated variable names
#   ¹​parameter2, ²​effectsize, ³​estimate, ⁴​conf.level, ⁵​conf.high, ⁶​statistic,
#   ⁷​df.error</code></pre>
</div>
</div>
<p>The correlation estimate is <span class="math inline">\(0.133\)</span>; the <code>p-value</code> is 0.065 and the confidence interval includes 0. Hence we fail to reject the NULL hypothesis that <code>study_hours</code> and <code>gpa</code> have no relationship.</p>
<p>We can use a later package <code>ggstaplot</code> to plot this:</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggscatterstats</span>(<span class="at">data =</span> gpa_study_hours, </span>
<span id="cb30-2"><a href="#cb30-2"></a>                            <span class="at">x =</span> study_hours, </span>
<span id="cb30-3"><a href="#cb30-3"></a>                            <span class="at">y =</span> gpa,</span>
<span id="cb30-4"><a href="#cb30-4"></a>                            <span class="at">type =</span> <span class="st">"robust"</span>,</span>
<span id="cb30-5"><a href="#cb30-5"></a>                            <span class="at">marginal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-6"><a href="#cb30-6"></a>                            <span class="at">title =</span> <span class="st">"GPA vs Study Hours"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'ggside':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Pearson_example_3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="spearman-correlation" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="spearman-correlation">Spearman Correlation</h2>
<section id="model-2" class="level3"><h3 class="anchored" data-anchor-id="model-2">Model</h3>
<p>In some cases the <strong>LINE</strong> assumptions may not hold. Nonlinear relationships, non-normally distributed data ( with large outliers ) and working with <em>ordinal</em> rather than continuous data: these situations necessitate the use of Spearman’s <em>ranked</em> correlation scores. (<strong>Ranked</strong>, not <strong>sign-ranked</strong>.)</p>
<p><span class="math display">\[
rank(y) = \beta_0 + \beta_1 * rank(x) \\
H_0: \beta_1 = 0
\]</span></p>
<p>Spearman correlation = Pearson correlation using the rank of the data observations. Let’s check how this holds for a our x and y data:</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># Plot the data</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>  <span class="fu">ggtitle</span>(<span class="st">" Pearson Correlation</span><span class="sc">\n</span><span class="st"> and Linear Models"</span>)</span>
<span id="cb33-6"><a href="#cb33-6"></a></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="co"># Plot ranked data</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>p2 <span class="ot">&lt;-</span> mydata_wide <span class="sc">%&gt;%</span> </span>
<span id="cb33-9"><a href="#cb33-9"></a>  <span class="fu">mutate</span>(<span class="at">x_rank =</span> <span class="fu">rank</span>(x),</span>
<span id="cb33-10"><a href="#cb33-10"></a>         <span class="at">y_rank =</span> <span class="fu">rank</span>(y)) <span class="sc">%&gt;%</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(x_rank, y_rank)) <span class="sc">+</span> </span>
<span id="cb33-12"><a href="#cb33-12"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">15</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb33-14"><a href="#cb33-14"></a>  <span class="fu">ggtitle</span>(<span class="st">" Spearman Ranked Correlation</span><span class="sc">\n</span><span class="st"> and Linear Models"</span>)</span>
<span id="cb33-15"><a href="#cb33-15"></a></span>
<span id="cb33-16"><a href="#cb33-16"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Spearman_Plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Slopes are almost identical, ~ 0.25.</p>
</section><section id="code-2" class="level3"><h3 class="anchored" data-anchor-id="code-2">Code</h3>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Spearman</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>cor1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(y,x, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb35-4"><a href="#cb35-4"></a></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="co"># Pearson using ranks</span></span>
<span id="cb35-6"><a href="#cb35-6"></a>cor2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(<span class="fu">rank</span>(y), <span class="fu">rank</span>(x), <span class="at">method =</span> <span class="st">"pearson"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href="#cb35-7"></a>broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb35-8"><a href="#cb35-8"></a></span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="co"># Linear Models using rank</span></span>
<span id="cb35-10"><a href="#cb35-10"></a>cor3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">rank</span>(y) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">rank</span>(x),<span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb35-11"><a href="#cb35-11"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb35-12"><a href="#cb35-12"></a></span>
<span id="cb35-13"><a href="#cb35-13"></a><span class="fu">rbind</span>(cor1, cor2, cor3) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  estimate  p.value
     &lt;dbl&gt;    &lt;dbl&gt;
1   -0.227 1.13e- 1
2   -0.227 1.14e- 1
3   31.3   9.11e-10
4   -0.227 1.14e- 1</code></pre>
</div>
</div>
<p>Notes:</p>
<ol type="1">
<li><p>When ranks are used, the slope of the linear model (<span class="math inline">\(\beta_1\)</span>) has the same value as the correlation coefficient ( <span class="math inline">\(\rho\)</span> ).</p></li>
<li><p>Note that the slope from the linear model now has an intuitive interpretation: <strong>the number of ranks y changes for each change in rank of x</strong>. ( Ranks are “independent” of <code>sd</code> )</p></li>
</ol></section><section id="example-2" class="level3"><h3 class="anchored" data-anchor-id="example-2">Example</h3>
<p>We examine the <code>cars93</code> data, where the numeric variables of interest are <code>weight</code> and <code>price</code>.</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>cars93 <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(weight, price)) <span class="sc">+</span> </span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Car Weight and Car Price have a nonlinear relationship"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Spearman_example_1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let us try a Spearman Correlation score for these variables, since the data are not linearly related and the variance of <code>price</code> also is not constant over <code>weight</code></p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">cor.test</span>(cars93<span class="sc">$</span>price, cars93<span class="sc">$</span>weight, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in cor.test.default(x, y, ...): Cannot compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  estimate statistic  p.value method                          alternative
     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;                           &lt;chr&gt;      
1    0.883     3074. 1.07e-18 Spearman's rank correlation rho two.sided  </code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Using linear Model</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">lm</span>(<span class="fu">rank</span>(price) <span class="sc">~</span> <span class="fu">rank</span>(weight), <span class="at">data =</span> cars93) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rank(price) ~ rank(weight), data = cars93)

Residuals:
     Min       1Q   Median       3Q      Max 
-20.0676  -3.0135   0.7815   3.6926  20.4099 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.22074    2.05894   1.564    0.124    
rank(weight)  0.88288    0.06514  13.554   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.46 on 52 degrees of freedom
Multiple R-squared:  0.7794,    Adjusted R-squared:  0.7751 
F-statistic: 183.7 on 1 and 52 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># Stats Plot</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggscatterstats</span>(<span class="at">data =</span> cars93, <span class="at">x =</span> weight, </span>
<span id="cb44-3"><a href="#cb44-3"></a>                            <span class="at">y =</span> price,</span>
<span id="cb44-4"><a href="#cb44-4"></a>                            <span class="at">type =</span> <span class="st">"nonparametric"</span>,</span>
<span id="cb44-5"><a href="#cb44-5"></a>                            <span class="at">title =</span> <span class="st">"Cars93: Weight vs Price"</span>,</span>
<span id="cb44-6"><a href="#cb44-6"></a>                            <span class="at">subtitle =</span> <span class="st">"Spearman Correlation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Spearman_example_2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that using ranks of the <code>price</code> variable, we obtain a Spearman’s <span class="math inline">\(\rho = 0.882\)</span> with a <code>p-value</code> that is very small. Hence we are able to reject the NULL hypothesis and state that there is a relationship between these two variables. The <strong>linear</strong> relationship is evaluated as a correlation of <code>0.882</code>.</p>
</section></section></section><section id="tests-on-one-mean" class="level1 tabset"><h1 class="tabset">Tests on One Mean</h1>
<p>A series of tests deal with one mean value of a sample. The idea is to evaluate whether that mean is representative of the mean of the underlying population.</p>
<p>This uses the <em>Student’s t-test</em> for parametric data and the <em>Wilcoxon signed-rank test</em> for non-parametric data.</p>
<p>Tests can involve a <em>single sample</em> or <em>paired samples</em>.</p>
<section id="the-students-t-test-with-one-sample" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="the-students-t-test-with-one-sample">The Student’s t-test with one sample</h2>
<section id="model-3" class="level3"><h3 class="anchored" data-anchor-id="model-3">Model</h3>
<p>A single number predicts y:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1*x \\
\\and\ further \ actually\\
y = \beta_0
\]</span></p>
<p>and the second term vanishes, since “there is no x”: all the x-values are made equal to zero in the linear model !! The NULL Hypothesis therefore is:</p>
<p><span class="math display">\[
\ H_0: \beta_0 = 0
\]</span></p>
<p>This NULL Hypothesis makes sense, because in the accompanying linear model all values of the <u>explanatory</u> variable x are zero, and therefore the NULL Hypothesis for the model should be that y also should be zero mean. Note that if we <strong>want</strong> the NULL hypothesis to be that the mean is other than zero, we can use the <code>lm(...., mu = some_number, ..)</code> parameter in the command.</p>
</section><section id="code-3" class="level3"><h3 class="anchored" data-anchor-id="code-3">Code</h3>
<p>If we compare the <code>t.test</code> with the appropriate <code>lm</code> model:</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># t-test</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>t1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="fu">print</span>(t1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  y
t = 1.0607, df = 49, p-value = 0.294
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.2683937  0.8683937
sample estimates:
mean of x 
      0.3 </code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># linear model</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mydata_wide)</span>
<span id="cb48-3"><a href="#cb48-3"></a>lm1 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ 1, data = mydata_wide)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5554 -1.4845 -0.0392  1.5559  4.5119 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.3000     0.2828   1.061    0.294

Residual standard error: 2 on 49 degrees of freedom</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>lm1 <span class="sc">%&gt;%</span> <span class="fu">confint</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %    97.5 %
(Intercept) -0.2683937 0.8683937</code></pre>
</div>
</div>
<p>The confidence intervals for both the <code>t.test</code> and the <code>lm</code> model are identical.</p>
<p>t-test confidence intervals: -0.2683937, 0.8683937<br>
linear model confidence intervals: -0.2683937, 0.8683937</p>
<p>So even though y has a mean of 0.3, the confidence intervals straddle zero, and hence we cannot reject the NULL hypothesis that the true population, of which y is a sample, could have mean=0.</p>
</section><section id="example-3" class="level3"><h3 class="anchored" data-anchor-id="example-3">Example</h3>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>exam_grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 233 × 6
   semester sex   exam1 exam2 exam3 course_grade
   &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
 1 2000-1   Man    84.5  69.5  86.5         76.3
 2 2000-1   Man    80    74    67           75.4
 3 2000-1   Man    56    70    71.5         67.1
 4 2000-1   Man    64    61    67.5         63.5
 5 2000-1   Man    90.5  72.5  75           72.4
 6 2000-1   Man    74    78.5  84.5         71.4
 7 2000-1   Man    60.5  44    58           56.1
 8 2000-1   Man    89    82    88           78.0
 9 2000-1   Woman  87.5  86.5  95           82.9
10 2000-1   Man    91    98    88           89.1
# … with 223 more rows</code></pre>
</div>
</div>
</section></section><section id="wilcoxons-signed-rank-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="wilcoxons-signed-rank-test">Wilcoxon’s Signed-Rank Test</h2>
<p>Since we are dealing with the <strong>mean</strong>, the <em>sign</em> of the rank becomes important to use, in the case of a non-parametric single mean test.</p>
<section id="model-4" class="level3"><h3 class="anchored" data-anchor-id="model-4">Model</h3>
<p><span class="math display">\[
signed\_rank(y) = \beta_0 \\
H_0: \beta_0 = 0
\]</span></p>
</section><section id="code-4" class="level3"><h3 class="anchored" data-anchor-id="code-4">Code</h3>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># Standard Wilcoxon Signed_Rank Test</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>w1 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y)</span>
<span id="cb54-3"><a href="#cb54-3"></a>w1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  y
V = 754, p-value = 0.2628
alternative hypothesis: true location is not equal to 0</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># Wilcoxon test with lm</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>w2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y) <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data =</span> mydata_wide)</span>
<span id="cb56-3"><a href="#cb56-3"></a>w2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = signed_rank(y) ~ 1, data = mydata_wide)

Coefficients:
(Intercept)  
       4.66  </code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># t-test with signed_rank data</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>w3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="fu">signed_rank</span>(y))</span>
<span id="cb58-3"><a href="#cb58-3"></a>w3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  signed_rank(y)
t = 1.1277, df = 49, p-value = 0.265
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -3.644491 12.964491
sample estimates:
mean of x 
     4.66 </code></pre>
</div>
</div>
<p>We can plot the y data both original and ranked to see where the mean lies in each case. The approximation to the true $_0&nbsp;( is good when the number of observations N is &gt;=50. Lindoloev has a <a href="https://lindeloev.github.io/tests-as-linear/simulations/simulate_wilcoxon.html">simulation on this.</a>. We can also plot the model using <em>lm</em> for both the original data and the sign-ranked data.</p>
</section><section id="example-4" class="level3"><h3 class="anchored" data-anchor-id="example-4">Example</h3>
</section><section id="plots-for-both-t-test-and-wilcoxon-test" class="level3"><h3 class="anchored" data-anchor-id="plots-for-both-t-test-and-wilcoxon-test">Plots for both t-test and Wilcoxon test</h3>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> t1<span class="sc">$</span>estimate, </span>
<span id="cb60-4"><a href="#cb60-4"></a>                   <span class="at">yend =</span> t1<span class="sc">$</span>estimate, </span>
<span id="cb60-5"><a href="#cb60-5"></a>                   <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb60-6"><a href="#cb60-6"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Student's</span><span class="sc">\n</span><span class="st"> t-Test"</span>)</span>
<span id="cb60-7"><a href="#cb60-7"></a></span>
<span id="cb60-8"><a href="#cb60-8"></a><span class="co"># t-test using linear model</span></span>
<span id="cb60-9"><a href="#cb60-9"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb60-10"><a href="#cb60-10"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb60-11"><a href="#cb60-11"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb60-12"><a href="#cb60-12"></a>                   <span class="at">yend =</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb60-13"><a href="#cb60-13"></a>                   <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb60-14"><a href="#cb60-14"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Student's</span><span class="sc">\n</span><span class="st"> t-Test </span><span class="sc">\n</span><span class="st"> using lm"</span>)</span>
<span id="cb60-15"><a href="#cb60-15"></a></span>
<span id="cb60-16"><a href="#cb60-16"></a><span class="co"># Wilcoxon test, using signed-ranks of data</span></span>
<span id="cb60-17"><a href="#cb60-17"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fu">signed_rank</span>(y))) <span class="sc">+</span></span>
<span id="cb60-18"><a href="#cb60-18"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb60-19"><a href="#cb60-19"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">signed_rank</span>(y)), <span class="at">yend =</span> <span class="fu">mean</span>(<span class="fu">signed_rank</span>(y)), <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb60-20"><a href="#cb60-20"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wilcoxon </span><span class="sc">\n</span><span class="st">Signed-Rank</span><span class="sc">\n</span><span class="st"> Test"</span>)</span>
<span id="cb60-21"><a href="#cb60-21"></a></span>
<span id="cb60-22"><a href="#cb60-22"></a><span class="co"># Wilcoxon test, using signed-ranks of data, and lm</span></span>
<span id="cb60-23"><a href="#cb60-23"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fu">signed_rank</span>(y))) <span class="sc">+</span></span>
<span id="cb60-24"><a href="#cb60-24"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb60-25"><a href="#cb60-25"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y) <span class="sc">~</span><span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb60-26"><a href="#cb60-26"></a>                   <span class="at">yend =</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y) <span class="sc">~</span><span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb60-27"><a href="#cb60-27"></a>                   <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb60-28"><a href="#cb60-28"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wilcoxon </span><span class="sc">\n</span><span class="st"> Signed-Rank </span><span class="sc">\n</span><span class="st"> Test with lm"</span>)</span>
<span id="cb60-29"><a href="#cb60-29"></a></span>
<span id="cb60-30"><a href="#cb60-30"></a></span>
<span id="cb60-31"><a href="#cb60-31"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(p1,p2,p3,p4, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Mean_Related_Plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="paired-sample-t-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="paired-sample-t-test">Paired Sample t-test</h2>
<p>We use this when we have two samples and the observations from one sample can be “paired” with observations in the other sample. Controlled studies for interventions/measures, such as before/after kind of data, comparisons between two interventions on the same set of subjects, and two measurements made on the same subjects using different methods etc.</p>
<section id="model-5" class="level3"><h3 class="anchored" data-anchor-id="model-5">Model</h3>
<p><span class="math display">\[
y_2 - y_1 = \beta_0 \\
H_0 : \beta_0 = 0
\]</span></p>
<p>The NULL Hypothesis is that there is no difference, <strong>either way</strong>, between the two samples. Again, in the linear model, we assume as before that “the explanatory x variable has been equated to zero.</p>
<p>We therefore set <code>two.sided</code> and <code>mu = 0</code> in the <code>t.test</code>.</p>
</section><section id="code-5" class="level3"><h3 class="anchored" data-anchor-id="code-5">Code</h3>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># Using paired t-test</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>t2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y2, y, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">mu =</span> <span class="dv">0</span>, </span>
<span id="cb61-3"><a href="#cb61-3"></a>             <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb61-4"><a href="#cb61-4"></a>t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  y2 and y
t = 0.54264, df = 49, p-value = 0.5898
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -0.54067  0.94067
sample estimates:
mean difference 
            0.2 </code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># linear model</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y2<span class="sc">-</span>y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mydata_wide)</span>
<span id="cb63-3"><a href="#cb63-3"></a>lm2 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y2 - y ~ 1, data = mydata_wide)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.7027 -2.1872 -0.1367  1.3835  5.7262 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.2000     0.3686   0.543     0.59

Residual standard error: 2.606 on 49 degrees of freedom</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>lm2 <span class="sc">%&gt;%</span> <span class="fu">confint</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>               2.5 %  97.5 %
(Intercept) -0.54067 0.94067</code></pre>
</div>
</div>
<p>Both tests report the difference to be 0.2. However the p-value in both tests is about 0.6, so the result is not statistically significant.</p>
</section><section id="example-5" class="level3"><h3 class="anchored" data-anchor-id="example-5">Example</h3>
</section></section><section id="wilcoxon-paired-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="wilcoxon-paired-test">Wilcoxon Paired Test</h2>
<p>When the original data is not normally distributed or has outliers etc,. we use a nonparametric Wilcoxon paired test. The difference between the paired and unpaired Wilcoxon test is that the test is run on the signed-ranks of the <strong>pairwise differences</strong> y2- y.</p>
<section id="model-6" class="level3"><h3 class="anchored" data-anchor-id="model-6">Model</h3>
<p>$$ signed_rank(y2 - y1) = _0 \</p>
<p>H_0: _0 = 0</p>
<p>$$</p>
</section><section id="code-6" class="level3"><h3 class="anchored" data-anchor-id="code-6">Code</h3>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># Paired Wilcoxon Test</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>w4 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y, y2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-3"><a href="#cb67-3"></a>w4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  y and y2
V = 608, p-value = 0.7795
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># Linear Model</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y2<span class="sc">-</span>y) <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data =</span> mydata_wide)</span>
<span id="cb69-3"><a href="#cb69-3"></a>lm4 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = signed_rank(y2 - y) ~ 1, data = mydata_wide)

Residuals:
   Min     1Q Median     3Q    Max 
-48.18 -27.93   0.82  22.57  48.82 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    1.180      4.182   0.282    0.779

Residual standard error: 29.57 on 49 degrees of freedom</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># t-test with Signed Rank</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>t4 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="fu">signed_rank</span>(y2<span class="sc">-</span>y), <span class="at">mu =</span> <span class="dv">0</span> , <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb71-3"><a href="#cb71-3"></a>t4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  signed_rank(y2 - y)
t = 0.28214, df = 49, p-value = 0.779
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -7.224733  9.584733
sample estimates:
mean of x 
     1.18 </code></pre>
</div>
</div>
<p>Here too, the p-values reported by the three tests are p = 0.779 so the difference reported is not significant.</p>
</section><section id="example-6" class="level3"><h3 class="anchored" data-anchor-id="example-6">Example</h3>
</section></section></section><section id="tests-with-two-means" class="level1 tabset"><h1 class="tabset">Tests with Two Means</h1>
<p>When we have two independent samples and these are <em>not paired</em> as earlier. The intent is to test if there is a significant difference to their means. An example is identical measurements on two sets of subjects.</p>
<p>There is considerable discussion on what test to use when: 1.If variances are equal between samples, observations are normally distributed within groups, no outliers, then <code>independent t-test</code> 2. If unequal variance, <code>t-test</code> with <code>Welch correction</code> ( Welch’s t-test) 3. If samples are not normal, then nonparametric test ( Wilcoxon with two samples = <code>Mann-Whitney test</code>). Symmetry of the distribution is assumed here.</p>
<section id="dummy-group-variable-concept" class="level2"><h2 class="anchored" data-anchor-id="dummy-group-variable-concept">Dummy Group Variable Concept</h2>
<p>An important construct here is the <strong>dummy variable</strong>. When there is more than one group in the data, a dummy <em>categorical variable</em> is set up, whose entries specify the group ID. The group IDs are <strong>still numerical</strong> ( as with factors, remember ). The dummy variable is plotted on the x-axis. The consecutive IDs in the dummy variable x are separated by <em>1</em>. Hence the <em>between-groups difference</em> in the stat measures computed on y are numerically equivalent to the <strong>slope</strong> in the linear model. Thus the <em>dummy variable</em> allows us to **mathematically* use the linear model, as presented in the equations above.</p>
<p>Dummy variables become even more useful when the explanatory variable ( “x-planatory” ) is already categorical, as with ANOVA and friends.</p>
<p>We can visualize this as follows:</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>mydata_wide_new <span class="ot">&lt;-</span> </span>
<span id="cb73-2"><a href="#cb73-2"></a>  <span class="fu">tibble</span>(<span class="at">y1 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>),</span>
<span id="cb73-3"><a href="#cb73-3"></a>         <span class="at">y2 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="fl">1.2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(y1, y2),</span>
<span id="cb73-5"><a href="#cb73-5"></a>               <span class="at">names_to =</span> <span class="st">"variable"</span>,  </span>
<span id="cb73-6"><a href="#cb73-6"></a>               <span class="at">values_to =</span> <span class="st">"values"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb73-7"><a href="#cb73-7"></a>  <span class="fu">cbind</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">50</span>))</span>
<span id="cb73-8"><a href="#cb73-8"></a></span>
<span id="cb73-9"><a href="#cb73-9"></a>mydata_wide_new <span class="sc">%&gt;%</span> </span>
<span id="cb73-10"><a href="#cb73-10"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> values)) <span class="sc">+</span> </span>
<span id="cb73-11"><a href="#cb73-11"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb73-12"><a href="#cb73-12"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">geom =</span><span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb73-13"><a href="#cb73-13"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom=</span> <span class="st">"line"</span>, <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb73-14"><a href="#cb73-14"></a>  <span class="fu">xlab</span>(<span class="st">"Dummy Variable to show groups"</span>) <span class="sc">+</span></span>
<span id="cb73-15"><a href="#cb73-15"></a>  <span class="fu">ylab</span>(<span class="st">"y1 and y2, on the same scale"</span>) <span class="sc">+</span></span>
<span id="cb73-16"><a href="#cb73-16"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"Dummy Variable x_i  [0,1]"</span>,</span>
<span id="cb73-17"><a href="#cb73-17"></a>                <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb73-18"><a href="#cb73-18"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">label =</span> <span class="st">"Difference in means </span><span class="sc">\n</span><span class="st"> equals slope in linear model"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Continuous limits supplied to discrete scale.
ℹ Did you mean `limits = factor(...)` or `scale_*_continuous()`?</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Independent_Data_Plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co"># Need to use `glue` here to add more annotations</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="co"># Math annotation on graphs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="model-7" class="level2"><h2 class="anchored" data-anchor-id="model-7">Model</h2>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 * x_i \\
where\\
x_i= \left\{\begin{matrix}
1\ when\ x\ \in\ Group 1\\
0\ when\ x\ \in\ Group2
\end{matrix}\right.
\]</span></p>
</section></section><section id="section" class="level1 unnumbered"><h1 class="unnumbered"></h1>
<p>Let us now look at the tests.</p>
<section id="independent-t-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="independent-t-test">Independent t-test</h2>
<section id="model-8" class="level3"><h3 class="anchored" data-anchor-id="model-8">Model</h3>
<p>The assumptions here are: - both data sets are normally distributed. Small samples may be assumned to be <code>t-distributed</code> - variances are the same - no outliers - observations across data sets are independent (obviously)</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 * x_i \\
where \\
x_i= \left\{\begin{matrix}
1\ when\ x\ \in\ Group 1\\
0\ when\ x\ \in\ Group2
\end{matrix}\right.
\\
H_0 : \beta_1 = 0
\]</span></p>
<p>The t.test computes a statistic as follows:</p>
<p><span class="math display">\[
t \ \ = \mod(\bar{x_1}\ - \bar{x_2}) / std.error(\bar{x_1}\ - \bar{x_2}) \\
= \mod(\bar{x_1} - \bar{x_2})\ / \sqrt{s_x^2 /n_x + s_y^2/n_y}  \\
and\\
df = n_1 + n_2 - 2\ \ \ \ ( degrees\ of\ freedom)
\]</span></p>
<p>The t-test uses an approximation to the sampling distribution of the difference in sample means based on the Central Limit Theorem, which ensures that for sufficiently large samples, the sampling distribution will be very close to Normal. The mean of the sampling distribution will be the difference in (underlying) population means, and the variance of the sampling distribution will be the standard error of the difference in sample means.</p>
<p>For the <code>t-statistic</code>, note that the numerator of the formula is the difference between means. The denominator is a measurement of experimental error in the two groups combined. The wider the difference between means, the more confident you are in the data. The more experimental error you have, the less confident you are in the data. Thus the higher the value of t, the greater the confidence that there is a difference.</p>
<p>The <code>t-statistic</code> has a t-distribution. It is compared to a <em>critical value</em> of t, for a given probability value ( 0.05 usually). If the calculated t exceeds the critical value, we can assert that the NULL Hypothesis can be rejected and there could be a significant difference in means. <img src="t-distribution.png" class="img-fluid" alt="t-distribution curves"></p>
</section><section id="code-7" class="level3"><h3 class="anchored" data-anchor-id="code-7">Code</h3>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="co"># Independent t-test</span></span>
<span id="cb76-2"><a href="#cb76-2"></a>t5 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y2, y, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-3"><a href="#cb76-3"></a>t5 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
  estim…¹ estim…² estim…³ stati…⁴ p.value param…⁵ conf.…⁶ conf.…⁷ method alter…⁸
    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  
1     0.2     0.5     0.3   0.566   0.573      98  -0.502   0.902 Two S… two.si…
# … with abbreviated variable names ¹​estimate, ²​estimate1, ³​estimate2,
#   ⁴​statistic, ⁵​parameter, ⁶​conf.low, ⁷​conf.high, ⁸​alternative</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co"># Welch test when variances are not equal</span></span>
<span id="cb78-2"><a href="#cb78-2"></a>t6 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y2,y, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb78-3"><a href="#cb78-3"></a>t6 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
  estim…¹ estim…² estim…³ stati…⁴ p.value param…⁵ conf.…⁶ conf.…⁷ method alter…⁸
    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  
1     0.2     0.5     0.3   0.566   0.573    90.9  -0.502   0.902 Welch… two.si…
# … with abbreviated variable names ¹​estimate, ²​estimate1, ³​estimate2,
#   ⁴​statistic, ⁵​parameter, ⁶​conf.low, ⁷​conf.high, ⁸​alternative</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="co"># Linear Model with Dummy variable</span></span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="co"># lm(value ~ 1 + group, data = mydata_long_y) # also works</span></span>
<span id="cb80-3"><a href="#cb80-3"></a>lm6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(group <span class="sc">==</span> <span class="st">"y2"</span>), <span class="at">data =</span> mydata_long_y)</span>
<span id="cb80-4"><a href="#cb80-4"></a>lm6 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term                     estimate std.error statistic p.value
  &lt;chr&gt;                       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 "(Intercept)"                 0.3     0.25      1.2     0.233
2 "I(group == \"y2\")TRUE"      0.2     0.354     0.566   0.573</code></pre>
</div>
</div>
<p>We get the same estimates for means of y and y2 ( 0.3 and 0.5 respectively).</p>
</section><section id="example-7" class="level3"><h3 class="anchored" data-anchor-id="example-7">Example</h3>
</section></section><section id="welchs-t-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="welchs-t-test">Welch’s t-test</h2>
<section id="model-9" class="level3"><h3 class="anchored" data-anchor-id="model-9">Model</h3>
<p>Welch’s test we have already explored as a variant of the t.test for two means, with variances unequal.</p>
<p>Welch’s test is also stated as a <em>Generalized</em> Linear Model using, not <code>lm</code> but the <code>gls</code> command from the <code>nlme</code> package. This is explained on <a href="https://stats.stackexchange.com/questions/142685/equivalent-to-welchs-t-test-in-gls-framework">StackExchange</a> but we need not digress now.</p>
<p>When the variances are unequal, there is a difference in the t-statistic that is computed <em>only</em> when the group **sizes* are different ( Denominator of t-statistic ).</p>
<p>From StackExchange:<br><span class="math display">\[
t_w =\ \frac {\bar{x_1}-\bar{x_2}}{\sqrt{{s_1^2/n_1}{s_2^2/n_2}}}
\\\\
=\ \frac{\bar{x_1}-\bar{x_2}} {{\sqrt{\frac{s_1^2 + s_2^2}{n}}}}
\\\\
=\ \frac{\bar{x_1}-\bar{x_2}} {{\sqrt{\frac{s_1^2 + s_2^2} {2} * (\frac{2}{n})}}}
\\\\
=\ t_s
\]</span></p>
<p>So under these conditions the t-statistic for the Welch t-test is the same as that for the standard t-test.</p>
</section><section id="code-8" class="level3"><h3 class="anchored" data-anchor-id="code-8">Code</h3>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>t7 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y, y2, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="example-8" class="level3"><h3 class="anchored" data-anchor-id="example-8">Example</h3>
</section></section><section id="mann-whitney-u-test" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="mann-whitney-u-test">Mann-Whitney U Test</h2>
<p>(Wilcoxon Independent Sample test)</p>
<p>As before, when sample groups are not normally distributed, and when variances are different, and they are outliers, a nonparametric rank-sum test is preferred. This is the same as the Wilcoxon Test for independent variables, and is called the Mann-Whitney Test.</p>
<section id="model-10" class="level3"><h3 class="anchored" data-anchor-id="model-10">Model</h3>
<p>As before:</p>
<p><span class="math display">\[
rank(y_i) = \beta_0 + \beta_1 * rank(x_i) \\
where \\
x_i= \left\{\begin{matrix}
1\ when\ x\ \in\ Group 1\\
0\ when\ x\ \in\ Group2
\end{matrix}\right.
\\
H_0 : \beta_1 = 0
\]</span></p>
</section><section id="code-9" class="level3"><h3 class="anchored" data-anchor-id="code-9">Code</h3>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co"># As Wilcoxon Test</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>w5 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y2,y, <span class="at">paired =</span> <span class="cn">FALSE</span>)</span>
<span id="cb83-3"><a href="#cb83-3"></a>w5 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic p.value method                                            alternat…¹
      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                                             &lt;chr&gt;     
1      1264   0.926 Wilcoxon rank sum test with continuity correction two.sided 
# … with abbreviated variable name ¹​alternative</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="co"># As Linear model</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>lm5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">rank</span>(value) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(group <span class="sc">==</span> <span class="st">"y2"</span>), </span>
<span id="cb85-3"><a href="#cb85-3"></a>          <span class="at">data =</span> mydata_long_y)</span>
<span id="cb85-4"><a href="#cb85-4"></a>lm5 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term                     estimate std.error statistic  p.value
  &lt;chr&gt;                       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 "(Intercept)"              50.2        4.12   12.2    2.50e-21
2 "I(group == \"y2\")TRUE"    0.560      5.83    0.0960 9.24e- 1</code></pre>
</div>
</div>
<p>Not clear how to explain this. Need to dig more into Mann-Whitney.</p>
</section><section id="example-9" class="level3"><h3 class="anchored" data-anchor-id="example-9">Example</h3>
</section></section></section><section id="tests-with-three-or-more-means" class="level1 tabset"><h1 class="tabset">Tests with Three or More Means</h1>
<section id="model-11" class="level2"><h2 class="anchored" data-anchor-id="model-11">Model</h2>
<p>ANOVAs are linear models with (only) categorical predictors so they simply extend everything we did above, relying heavily on dummy coding.</p>
</section><section id="one-way-anova" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="one-way-anova">One-way ANOVA</h2>
<section id="model-12" class="level3"><h3 class="anchored" data-anchor-id="model-12">Model</h3>
<p>One mean for each group predicts y.</p>
<p><span class="math display">\[
y=\beta_0 + \beta_1*x_1 + \beta_2*x_2...+\beta_n*x_n\\
H0:y=β0
\]</span></p>
<p>where <span class="math inline">\(x_i\)</span> are indicators (x=0 or x=1) where at most one <span class="math inline">\(x_i=1\)</span> while all others are <span class="math inline">\(x_i=0\)</span>.</p>
<p>Notice how this is just “more of the same” of what we already did in other models above. When there are only two groups, this model is <span class="math inline">\(y=β0+β1∗x\)</span>, i.e.&nbsp;the <em>independent t-test</em>. If there is only one group, it is <span class="math inline">\(y=β0\)</span>, i.e.&nbsp;the <em>one-sample t-test</em>. This makes <em>one-way ANOVA</em> a <strong>multiple regression</strong> model.</p>
<p>This is easy to see in the visualization below - just cover up a few groups and see that it matches the other visualizations above. Let’s visualize this using toy data:</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>N <span class="ot">=</span> <span class="dv">15</span></span>
<span id="cb87-2"><a href="#cb87-2"></a>D_anova1 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb87-3"><a href="#cb87-3"></a>  <span class="at">y =</span> <span class="fu">c</span>(</span>
<span id="cb87-4"><a href="#cb87-4"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="fl">0.5</span>, <span class="fl">0.3</span>),</span>
<span id="cb87-5"><a href="#cb87-5"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="dv">0</span>, <span class="fl">0.3</span>),</span>
<span id="cb87-6"><a href="#cb87-6"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="dv">1</span>, <span class="fl">0.3</span>),</span>
<span id="cb87-7"><a href="#cb87-7"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="fl">0.8</span>, <span class="fl">0.3</span>)</span>
<span id="cb87-8"><a href="#cb87-8"></a>  ),</span>
<span id="cb87-9"><a href="#cb87-9"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">15</span>)</span>
<span id="cb87-10"><a href="#cb87-10"></a>)</span>
<span id="cb87-11"><a href="#cb87-11"></a>ymeans <span class="ot">=</span> <span class="fu">aggregate</span>(y<span class="sc">~</span>x, D_anova1, mean)<span class="sc">$</span>y</span>
<span id="cb87-12"><a href="#cb87-12"></a>P_anova1 <span class="ot">=</span> <span class="fu">ggplot</span>(D_anova1, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> </span>
<span id="cb87-13"><a href="#cb87-13"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span>mean, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> ..y.., <span class="at">ymin =</span> ..y.., <span class="at">color=</span><span class="st">'intercepts'</span>), <span class="at">lwd=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb87-14"><a href="#cb87-14"></a>  </span>
<span id="cb87-15"><a href="#cb87-15"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">xend =</span> <span class="dv">100</span>, </span>
<span id="cb87-16"><a href="#cb87-16"></a>               <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">yend =</span> <span class="fl">0.5</span>, </span>
<span id="cb87-17"><a href="#cb87-17"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'beta_0'</span>)) <span class="sc">+</span></span>
<span id="cb87-18"><a href="#cb87-18"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">xend =</span> <span class="dv">1</span>, </span>
<span id="cb87-19"><a href="#cb87-19"></a>               <span class="at">y =</span> ymeans[<span class="dv">1</span>], <span class="at">yend =</span> ymeans[<span class="dv">2</span>], </span>
<span id="cb87-20"><a href="#cb87-20"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'betas'</span>)) <span class="sc">+</span></span>
<span id="cb87-21"><a href="#cb87-21"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="dv">2</span>, </span>
<span id="cb87-22"><a href="#cb87-22"></a>               <span class="at">y =</span> ymeans[<span class="dv">1</span>], <span class="at">yend =</span> ymeans[<span class="dv">3</span>], </span>
<span id="cb87-23"><a href="#cb87-23"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'betas'</span>)) <span class="sc">+</span></span>
<span id="cb87-24"><a href="#cb87-24"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">xend =</span> <span class="dv">3</span>, </span>
<span id="cb87-25"><a href="#cb87-25"></a>               <span class="at">y =</span> ymeans[<span class="dv">1</span>], <span class="at">yend =</span> ymeans[<span class="dv">4</span>], </span>
<span id="cb87-26"><a href="#cb87-26"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'betas'</span>)) <span class="sc">+</span></span>
<span id="cb87-27"><a href="#cb87-27"></a>  </span>
<span id="cb87-28"><a href="#cb87-28"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, </span>
<span id="cb87-29"><a href="#cb87-29"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkblue"</span>),</span>
<span id="cb87-30"><a href="#cb87-30"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">bquote</span>(beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">" (group 1 mean)"</span>),</span>
<span id="cb87-31"><a href="#cb87-31"></a>                              <span class="fu">bquote</span>(beta[<span class="dv">1</span>]<span class="sc">*</span><span class="st">", "</span><span class="sc">*</span>beta[<span class="dv">2</span>]<span class="sc">*</span><span class="st">", </span></span>
<span id="cb87-32"><a href="#cb87-32"></a><span class="st">                                     etc. (slopes/differences to "</span><span class="sc">*</span>beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb87-33"><a href="#cb87-33"></a>      <span class="fu">bquote</span>(beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">"+"</span><span class="sc">*</span>beta[<span class="dv">1</span>]<span class="sc">*</span><span class="st">", "</span><span class="sc">*</span>beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">"+"</span><span class="sc">*</span>beta[<span class="dv">2</span>]<span class="sc">*</span><span class="st">", etc. (group 2, 3, ... means)"</span>)</span>
<span id="cb87-34"><a href="#cb87-34"></a>    )</span>
<span id="cb87-35"><a href="#cb87-35"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: The `fun.y` argument of `stat_summary()` is deprecated as of ggplot2 3.3.0.
ℹ Please use the `fun` argument instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<details><summary>Show the Code</summary><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>P_anova1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..y..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(y)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Visualizing_One_way_ANOVA-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="code-10" class="level3"><h3 class="anchored" data-anchor-id="code-10">Code</h3>
</section><section id="example-10" class="level3"><h3 class="anchored" data-anchor-id="example-10">Example</h3>
</section></section><section id="two-way-anova" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="two-way-anova">Two-way ANOVA</h2>
<section id="model-13" class="level3"><h3 class="anchored" data-anchor-id="model-13">Model</h3>
</section><section id="code-11" class="level3"><h3 class="anchored" data-anchor-id="code-11">Code</h3>
</section><section id="example-11" class="level3"><h3 class="anchored" data-anchor-id="example-11">Example</h3>
</section></section><section id="ancova" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="ancova">ANCOVA</h2>
<section id="model-14" class="level3"><h3 class="anchored" data-anchor-id="model-14">Model</h3>
</section><section id="code-12" class="level3"><h3 class="anchored" data-anchor-id="code-12">Code</h3>
</section><section id="example-12" class="level3"><h3 class="anchored" data-anchor-id="example-12">Example</h3>
</section></section></section><section id="proportions" class="level1 tabset"><h1 class="tabset">Proportions</h1>
<section id="model-15" class="level2"><h2 class="anchored" data-anchor-id="model-15">Model</h2>
</section><section id="discrete-variables" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="discrete-variables">Discrete Variables</h2>
<section id="model-16" class="level3"><h3 class="anchored" data-anchor-id="model-16">Model</h3>
</section><section id="code-13" class="level3"><h3 class="anchored" data-anchor-id="code-13">Code</h3>
</section><section id="example-13" class="level3"><h3 class="anchored" data-anchor-id="example-13">Example</h3>
</section></section><section id="continuous-variables" class="level2 tabset"><h2 class="tabset anchored" data-anchor-id="continuous-variables">Continuous Variables</h2>
<section id="model-17" class="level3"><h3 class="anchored" data-anchor-id="model-17">Model</h3>
</section><section id="code-14" class="level3"><h3 class="anchored" data-anchor-id="code-14">Code</h3>
</section><section id="example-14" class="level3"><h3 class="anchored" data-anchor-id="example-14">Example</h3>


<!-- -->

</section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/av-quarto\.netlify\.app/);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><script src="https://utteranc.es/client.js" repo="arvindvenkatadri/my-quarto-website" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb92" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb92-1"><a href="#cb92-1"></a><span class="co">---</span></span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="an">title:</span><span class="co"> "Linear Models: Comparing Proportions"</span></span>
<span id="cb92-3"><a href="#cb92-3"></a><span class="an">author:</span><span class="co"> "Arvind Venkatadri"</span></span>
<span id="cb92-4"><a href="#cb92-4"></a><span class="an">date:</span><span class="co"> 25/Nov/2022</span></span>
<span id="cb92-5"><a href="#cb92-5"></a><span class="an">date-modified:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb92-6"><a href="#cb92-6"></a><span class="an">order:</span><span class="co"> 30</span></span>
<span id="cb92-7"><a href="#cb92-7"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb92-8"><a href="#cb92-8"></a><span class="an">code-summary:</span><span class="co"> "Show the Code"</span></span>
<span id="cb92-9"><a href="#cb92-9"></a><span class="an">code-copy:</span><span class="co"> true</span></span>
<span id="cb92-10"><a href="#cb92-10"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb92-11"><a href="#cb92-11"></a><span class="an">code-line-numbers:</span><span class="co"> true</span></span>
<span id="cb92-12"><a href="#cb92-12"></a><span class="an">keywords:</span><span class="co"> Statistics ; Tests; p-value; Feynman Technique</span></span>
<span id="cb92-13"><a href="#cb92-13"></a><span class="an">abstract:</span><span class="co">  This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats. The method followed is that of Jonas Lindoloev, wherein every stat test is treated as a linear model y = mx + c.</span></span>
<span id="cb92-14"><a href="#cb92-14"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb92-15"><a href="#cb92-15"></a><span class="co">  freeze: auto</span></span>
<span id="cb92-16"><a href="#cb92-16"></a><span class="co">---</span></span>
<span id="cb92-17"><a href="#cb92-17"></a></span>
<span id="cb92-18"><a href="#cb92-18"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb92-19"><a href="#cb92-19"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>,<span class="at">fig.align =</span> <span class="st">"center"</span>, <span class="at">fig.width =</span> <span class="dv">7</span>, <span class="at">fig.height =</span> <span class="dv">5</span>)</span>
<span id="cb92-20"><a href="#cb92-20"></a><span class="co"># CRAN Packages</span></span>
<span id="cb92-21"><a href="#cb92-21"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb92-22"><a href="#cb92-22"></a><span class="fu">library</span>(broom)</span>
<span id="cb92-23"><a href="#cb92-23"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb92-24"><a href="#cb92-24"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb92-25"><a href="#cb92-25"></a></span>
<span id="cb92-26"><a href="#cb92-26"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb92-27"><a href="#cb92-27"></a><span class="fu">library</span>(mosaicCore)</span>
<span id="cb92-28"><a href="#cb92-28"></a><span class="fu">library</span>(mosaicData)</span>
<span id="cb92-29"><a href="#cb92-29"></a></span>
<span id="cb92-30"><a href="#cb92-30"></a><span class="fu">library</span>(openintro) <span class="co"># datasets and methods</span></span>
<span id="cb92-31"><a href="#cb92-31"></a><span class="fu">library</span>(statsExpressions) <span class="co"># datasets and methods</span></span>
<span id="cb92-32"><a href="#cb92-32"></a><span class="fu">library</span>(ggstatsplot) <span class="co"># special stats plots</span></span>
<span id="cb92-33"><a href="#cb92-33"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb92-34"><a href="#cb92-34"></a></span>
<span id="cb92-35"><a href="#cb92-35"></a><span class="co"># Non-CRAN Packages</span></span>
<span id="cb92-36"><a href="#cb92-36"></a><span class="co"># remotes::install_github("easystats/easystats")</span></span>
<span id="cb92-37"><a href="#cb92-37"></a><span class="fu">library</span>(easystats)</span>
<span id="cb92-38"><a href="#cb92-38"></a></span>
<span id="cb92-39"><a href="#cb92-39"></a><span class="co"># Project Related</span></span>
<span id="cb92-40"><a href="#cb92-40"></a>here<span class="sc">::</span><span class="fu">here</span>()</span>
<span id="cb92-41"><a href="#cb92-41"></a><span class="in">```</span></span>
<span id="cb92-42"><a href="#cb92-42"></a></span>
<span id="cb92-43"><a href="#cb92-43"></a><span class="fu">## A Workflow in Orange</span></span>
<span id="cb92-44"><a href="#cb92-44"></a></span>
<span id="cb92-45"><a href="#cb92-45"></a><span class="fu">## A Workflow in Radiant</span></span>
<span id="cb92-46"><a href="#cb92-46"></a></span>
<span id="cb92-47"><a href="#cb92-47"></a><span class="fu">## A Workflow in R</span></span>
<span id="cb92-48"><a href="#cb92-48"></a></span>
<span id="cb92-49"><a href="#cb92-49"></a><span class="fu"># References</span></span>
<span id="cb92-50"><a href="#cb92-50"></a></span>
<span id="cb92-51"><a href="#cb92-51"></a><span class="ss">1.  </span>*Common statistical tests are linear models (or: how to teach</span>
<span id="cb92-52"><a href="#cb92-52"></a>    stats)* by [Jonas Kristoffer</span>
<span id="cb92-53"><a href="#cb92-53"></a>    Lindeløv](https://lindeloev.github.io/tests-as-linear/)</span>
<span id="cb92-54"><a href="#cb92-54"></a><span class="ss">2.  </span><span class="co">[</span><span class="ot">CheatSheet</span><span class="co">](https://lindeloev.github.io/tests-as-linear/linear_tests_cheat_sheet.pdf)</span></span>
<span id="cb92-55"><a href="#cb92-55"></a><span class="ss">3.  </span>*Common statistical tests are linear models: a work through* by</span>
<span id="cb92-56"><a href="#cb92-56"></a>    <span class="co">[</span><span class="ot">Steve Doogue</span><span class="co">](https://steverxd.github.io/Stat_tests/)</span></span>
<span id="cb92-57"><a href="#cb92-57"></a><span class="ss">4.  </span>[Jeffrey Walker "Elements of Statistical Modeling for Experimental</span>
<span id="cb92-58"><a href="#cb92-58"></a>    Biology"](https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/)</span>
<span id="cb92-59"><a href="#cb92-59"></a><span class="ss">5.  </span>Text: Diez, David M &amp; Barr, Christopher D &amp; Çetinkaya-Rundel, Mine:</span>
<span id="cb92-60"><a href="#cb92-60"></a>    <span class="co">[</span><span class="ot">OpenIntro Statistics</span><span class="co">](https://www.openintro.org/book/os/)</span></span>
<span id="cb92-61"><a href="#cb92-61"></a><span class="ss">6.  </span>Modern Statistics with R: From wrangling and exploring data to</span>
<span id="cb92-62"><a href="#cb92-62"></a>    inference and predictive modelling by [Måns</span>
<span id="cb92-63"><a href="#cb92-63"></a>    Thulin](http://www.modernstatisticswithr.com/)</span>
<span id="cb92-64"><a href="#cb92-64"></a></span>
<span id="cb92-65"><a href="#cb92-65"></a><span class="fu"># Structure of this document</span></span>
<span id="cb92-66"><a href="#cb92-66"></a></span>
<span id="cb92-67"><a href="#cb92-67"></a>We will follow the following structure: Each kind of Test is described</span>
<span id="cb92-68"><a href="#cb92-68"></a>in a separate Chapter. The Test *Model* is laid out in formula</span>
<span id="cb92-69"><a href="#cb92-69"></a>$y = mx + c$ and in *Code*.</span>
<span id="cb92-70"><a href="#cb92-70"></a></span>
<span id="cb92-71"><a href="#cb92-71"></a>The Structure looks like this:</span>
<span id="cb92-72"><a href="#cb92-72"></a></span>
<span id="cb92-73"><a href="#cb92-73"></a><span class="fu">## Test {.tabset}</span></span>
<span id="cb92-74"><a href="#cb92-74"></a></span>
<span id="cb92-75"><a href="#cb92-75"></a><span class="fu">### Model</span></span>
<span id="cb92-76"><a href="#cb92-76"></a></span>
<span id="cb92-77"><a href="#cb92-77"></a>Explanation, formula etc.</span>
<span id="cb92-78"><a href="#cb92-78"></a></span>
<span id="cb92-79"><a href="#cb92-79"></a><span class="fu">### Code</span></span>
<span id="cb92-80"><a href="#cb92-80"></a></span>
<span id="cb92-81"><a href="#cb92-81"></a>With Toy Data; Graphs</span>
<span id="cb92-82"><a href="#cb92-82"></a></span>
<span id="cb92-83"><a href="#cb92-83"></a><span class="fu">### Example</span></span>
<span id="cb92-84"><a href="#cb92-84"></a></span>
<span id="cb92-85"><a href="#cb92-85"></a>With another "real world" data set; Graphs</span>
<span id="cb92-86"><a href="#cb92-86"></a></span>
<span id="cb92-87"><a href="#cb92-87"></a><span class="fu"># Data</span></span>
<span id="cb92-88"><a href="#cb92-88"></a></span>
<span id="cb92-89"><a href="#cb92-89"></a><span class="fu">## Sample Values</span></span>
<span id="cb92-90"><a href="#cb92-90"></a></span>
<span id="cb92-91"><a href="#cb92-91"></a>Most examples in this exposition are based on three "imaginary" samples,</span>
<span id="cb92-92"><a href="#cb92-92"></a>$x, y, y2$. Each is normally distributed and made up of 50 observations.</span>
<span id="cb92-93"><a href="#cb92-93"></a></span>
<span id="cb92-94"><a href="#cb92-94"></a>We start by creating a function that will allow us to produce samples of</span>
<span id="cb92-95"><a href="#cb92-95"></a>a given size (N) with a specified mean (mu) and standard deviation (sd):</span>
<span id="cb92-96"><a href="#cb92-96"></a>Note: this gives a *matrix* of numbers, as opposed to a vector using</span>
<span id="cb92-97"><a href="#cb92-97"></a><span class="in">`rnorm`</span> by itself. The data are created both in vector form and tibble</span>
<span id="cb92-98"><a href="#cb92-98"></a>form for flexibility of use in diverse packages and formulae in what</span>
<span id="cb92-99"><a href="#cb92-99"></a>follows.</span>
<span id="cb92-100"><a href="#cb92-100"></a></span>
<span id="cb92-101"><a href="#cb92-101"></a><span class="in">```{r data_genr}</span></span>
<span id="cb92-102"><a href="#cb92-102"></a>rnorm_fixed  <span class="ot">&lt;-</span> <span class="cf">function</span>(N, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) {</span>
<span id="cb92-103"><a href="#cb92-103"></a>  <span class="fu">scale</span>(<span class="fu">rnorm</span>(N))<span class="sc">*</span> sd <span class="sc">+</span> mu</span>
<span id="cb92-104"><a href="#cb92-104"></a>}</span>
<span id="cb92-105"><a href="#cb92-105"></a><span class="in">```</span></span>
<span id="cb92-106"><a href="#cb92-106"></a></span>
<span id="cb92-107"><a href="#cb92-107"></a>We create three variables: x ( explanatory) and y, y2 ( dependent ).</span>
<span id="cb92-108"><a href="#cb92-108"></a></span>
<span id="cb92-109"><a href="#cb92-109"></a><span class="in">```{r toy_data}</span></span>
<span id="cb92-110"><a href="#cb92-110"></a><span class="fu">set.seed</span>(<span class="dv">40</span>) <span class="co"># for replication</span></span>
<span id="cb92-111"><a href="#cb92-111"></a></span>
<span id="cb92-112"><a href="#cb92-112"></a><span class="co"># Data as vectors ( for t.tests etc)</span></span>
<span id="cb92-113"><a href="#cb92-113"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co">#explanatory</span></span>
<span id="cb92-114"><a href="#cb92-114"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.3</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="co"># dependent #1</span></span>
<span id="cb92-115"><a href="#cb92-115"></a>y2 <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="fl">1.5</span>) <span class="co"># dependent #2</span></span>
<span id="cb92-116"><a href="#cb92-116"></a></span>
<span id="cb92-117"><a href="#cb92-117"></a><span class="co"># Make a tibble with all variables</span></span>
<span id="cb92-118"><a href="#cb92-118"></a>mydata_wide <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">y2 =</span> y2)</span>
<span id="cb92-119"><a href="#cb92-119"></a></span>
<span id="cb92-120"><a href="#cb92-120"></a><span class="co"># Long form data</span></span>
<span id="cb92-121"><a href="#cb92-121"></a>mydata_long <span class="ot">&lt;-</span> </span>
<span id="cb92-122"><a href="#cb92-122"></a>  mydata_wide <span class="sc">%&gt;%</span></span>
<span id="cb92-123"><a href="#cb92-123"></a>  <span class="fu">pivot_longer</span>(., <span class="at">cols =</span> <span class="fu">c</span>(x,y,y2), </span>
<span id="cb92-124"><a href="#cb92-124"></a>               <span class="at">names_to =</span> <span class="st">"group"</span>, </span>
<span id="cb92-125"><a href="#cb92-125"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb92-126"><a href="#cb92-126"></a></span>
<span id="cb92-127"><a href="#cb92-127"></a><span class="co"># Long form data with only dependent variables</span></span>
<span id="cb92-128"><a href="#cb92-128"></a>mydata_long_y <span class="ot">&lt;-</span> </span>
<span id="cb92-129"><a href="#cb92-129"></a>  mydata_wide <span class="sc">%&gt;%</span> </span>
<span id="cb92-130"><a href="#cb92-130"></a>  <span class="fu">select</span>(<span class="sc">-</span>x) <span class="sc">%&gt;%</span> </span>
<span id="cb92-131"><a href="#cb92-131"></a>  <span class="fu">pivot_longer</span>(., <span class="at">cols =</span> <span class="fu">c</span>(y,y2), </span>
<span id="cb92-132"><a href="#cb92-132"></a>               <span class="at">names_to =</span> <span class="st">"group"</span>, </span>
<span id="cb92-133"><a href="#cb92-133"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb92-134"><a href="#cb92-134"></a>mydata_wide</span>
<span id="cb92-135"><a href="#cb92-135"></a>mydata_long</span>
<span id="cb92-136"><a href="#cb92-136"></a>mydata_long_y</span>
<span id="cb92-137"><a href="#cb92-137"></a><span class="in">```</span></span>
<span id="cb92-138"><a href="#cb92-138"></a></span>
<span id="cb92-139"><a href="#cb92-139"></a><span class="fu">## "Signed Rank" Values</span></span>
<span id="cb92-140"><a href="#cb92-140"></a></span>
<span id="cb92-141"><a href="#cb92-141"></a>Most statistical tests use the **actual values** of the data variables.</span>
<span id="cb92-142"><a href="#cb92-142"></a>However, in some *non-parametric* statistical tests, the data are used</span>
<span id="cb92-143"><a href="#cb92-143"></a>in **rank-transformed** sense/order. In some cases the **signed-rank**</span>
<span id="cb92-144"><a href="#cb92-144"></a>of the data values is used instead of the data itself.</span>
<span id="cb92-145"><a href="#cb92-145"></a></span>
<span id="cb92-146"><a href="#cb92-146"></a>Signed Rank is calculated as follows:\</span>
<span id="cb92-147"><a href="#cb92-147"></a><span class="ss">1. </span>Take the absolute value of each observation in a sample\</span>
<span id="cb92-148"><a href="#cb92-148"></a><span class="ss">2. </span>Place the <span class="kw">&lt;u&gt;</span>*ranks*<span class="kw">&lt;/u&gt;</span> in order of (absolute magnitude). The</span>
<span id="cb92-149"><a href="#cb92-149"></a>smallest number has *rank = 1* and so on.\</span>
<span id="cb92-150"><a href="#cb92-150"></a><span class="ss">3. </span>Give each of the ranks the sign of the original observation ( + or -</span>
<span id="cb92-151"><a href="#cb92-151"></a>)</span>
<span id="cb92-152"><a href="#cb92-152"></a></span>
<span id="cb92-153"><a href="#cb92-153"></a><span class="in">```{r signed_rank_function}</span></span>
<span id="cb92-154"><a href="#cb92-154"></a>signed_rank <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">sign</span>(x) <span class="sc">*</span> <span class="fu">rank</span>(<span class="fu">abs</span>(x))}</span>
<span id="cb92-155"><a href="#cb92-155"></a><span class="in">```</span></span>
<span id="cb92-156"><a href="#cb92-156"></a></span>
<span id="cb92-157"><a href="#cb92-157"></a><span class="fu">## Plotting Original and Signed Rank Data</span></span>
<span id="cb92-158"><a href="#cb92-158"></a></span>
<span id="cb92-159"><a href="#cb92-159"></a>A quick plot:</span>
<span id="cb92-160"><a href="#cb92-160"></a></span>
<span id="cb92-161"><a href="#cb92-161"></a><span class="in">```{r data_plots}</span></span>
<span id="cb92-162"><a href="#cb92-162"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_long,<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb92-163"><a href="#cb92-163"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.02</span>, <span class="at">height =</span> <span class="dv">0</span>,<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb92-164"><a href="#cb92-164"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb92-165"><a href="#cb92-165"></a>                                       <span class="at">x =</span> .<span class="dv">75</span>, </span>
<span id="cb92-166"><a href="#cb92-166"></a>                                       <span class="at">xend =</span> <span class="fl">1.25</span> )) <span class="sc">+</span> </span>
<span id="cb92-167"><a href="#cb92-167"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="st">"0"</span>)) <span class="sc">+</span></span>
<span id="cb92-168"><a href="#cb92-168"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.3</span>, <span class="at">yend =</span> <span class="fl">0.3</span>, </span>
<span id="cb92-169"><a href="#cb92-169"></a>                                       <span class="at">x =</span> <span class="fl">1.75</span> , </span>
<span id="cb92-170"><a href="#cb92-170"></a>                                       <span class="at">xend =</span> <span class="fl">2.25</span> )) <span class="sc">+</span> </span>
<span id="cb92-171"><a href="#cb92-171"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">0.6</span>, <span class="at">label =</span> <span class="st">"0.3"</span>)) <span class="sc">+</span></span>
<span id="cb92-172"><a href="#cb92-172"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">yend =</span> <span class="fl">0.5</span>, </span>
<span id="cb92-173"><a href="#cb92-173"></a>                                       <span class="at">x =</span> <span class="fl">2.75</span>, </span>
<span id="cb92-174"><a href="#cb92-174"></a>                                       <span class="at">xend =</span> <span class="fl">3.25</span> )) <span class="sc">+</span> </span>
<span id="cb92-175"><a href="#cb92-175"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.8</span>, <span class="at">label =</span> <span class="st">"0.5"</span>)) <span class="sc">+</span></span>
<span id="cb92-176"><a href="#cb92-176"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Original Data"</span>) <span class="sc">+</span></span>
<span id="cb92-177"><a href="#cb92-177"></a>  <span class="fu">ylab</span>(<span class="st">"Response Variable"</span>)</span>
<span id="cb92-178"><a href="#cb92-178"></a></span>
<span id="cb92-179"><a href="#cb92-179"></a>p2 <span class="ot">&lt;-</span> mydata_long <span class="sc">%&gt;%</span> </span>
<span id="cb92-180"><a href="#cb92-180"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> </span>
<span id="cb92-181"><a href="#cb92-181"></a>  <span class="fu">mutate</span>( <span class="at">s_value =</span> <span class="fu">signed_rank</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb92-182"><a href="#cb92-182"></a>  <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> s_value)) <span class="sc">+</span> </span>
<span id="cb92-183"><a href="#cb92-183"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.02</span>, <span class="at">height =</span> <span class="dv">0</span>,<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb92-184"><a href="#cb92-184"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, </span>
<span id="cb92-185"><a href="#cb92-185"></a>               <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb92-186"><a href="#cb92-186"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Signed Rank of Data"</span>) <span class="sc">+</span></span>
<span id="cb92-187"><a href="#cb92-187"></a>  <span class="fu">ylab</span>(<span class="st">"Signed Rank of Response Variable"</span>)</span>
<span id="cb92-188"><a href="#cb92-188"></a></span>
<span id="cb92-189"><a href="#cb92-189"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb92-190"><a href="#cb92-190"></a></span>
<span id="cb92-191"><a href="#cb92-191"></a><span class="in">```</span></span>
<span id="cb92-192"><a href="#cb92-192"></a></span>
<span id="cb92-193"><a href="#cb92-193"></a><span class="fu">## How does Sign-Rank data work?</span></span>
<span id="cb92-194"><a href="#cb92-194"></a></span>
<span id="cb92-195"><a href="#cb92-195"></a>TBD: need to add some explanation here.</span>
<span id="cb92-196"><a href="#cb92-196"></a></span>
<span id="cb92-197"><a href="#cb92-197"></a><span class="fu"># The Linear ( Regression ) Model {.tabset}</span></span>
<span id="cb92-198"><a href="#cb92-198"></a></span>
<span id="cb92-199"><a href="#cb92-199"></a>The premise here is that many common statistical tests are special cases</span>
<span id="cb92-200"><a href="#cb92-200"></a>of the linear model.</span>
<span id="cb92-201"><a href="#cb92-201"></a></span>
<span id="cb92-202"><a href="#cb92-202"></a>A linear model estimates the relationship between one *continuous* or</span>
<span id="cb92-203"><a href="#cb92-203"></a>*ordinal* variable (dependent variable or "response" ) and one or more</span>
<span id="cb92-204"><a href="#cb92-204"></a>other variables ( explanatory variable or "predictors" ). It is assumed</span>
<span id="cb92-205"><a href="#cb92-205"></a>that the relationship is linear:</span>
<span id="cb92-206"><a href="#cb92-206"></a></span>
<span id="cb92-207"><a href="#cb92-207"></a>$$</span>
<span id="cb92-208"><a href="#cb92-208"></a>y = \beta_0 + \beta_1 *x</span>
<span id="cb92-209"><a href="#cb92-209"></a>$$ $\beta_0$ is the *intercept* and $\beta_1$ is the slope of the linear</span>
<span id="cb92-210"><a href="#cb92-210"></a>fit, that **predicts** the value of y based the value of x. Each</span>
<span id="cb92-211"><a href="#cb92-211"></a>prediction leaves a small "residual" error between the actual and</span>
<span id="cb92-212"><a href="#cb92-212"></a>predicted values. $\beta_0$ and $\beta_1$ are calculated based on</span>
<span id="cb92-213"><a href="#cb92-213"></a>minimizing the *sum of square*s of these residuals, and hence this</span>
<span id="cb92-214"><a href="#cb92-214"></a>method is called "ordinary least squares" regression.</span>
<span id="cb92-215"><a href="#cb92-215"></a></span>
<span id="cb92-216"><a href="#cb92-216"></a><span class="al">![Least Squares](OLS.png)</span></span>
<span id="cb92-217"><a href="#cb92-217"></a></span>
<span id="cb92-218"><a href="#cb92-218"></a>The net *area* of all the shaded squares is minimized in the calculation</span>
<span id="cb92-219"><a href="#cb92-219"></a>of $\beta_0$ and $\beta_1$. It is also possible that there is more than</span>
<span id="cb92-220"><a href="#cb92-220"></a>one explanatory variable: this is **multiple regression.**</span>
<span id="cb92-221"><a href="#cb92-221"></a></span>
<span id="cb92-222"><a href="#cb92-222"></a>$$</span>
<span id="cb92-223"><a href="#cb92-223"></a>y = \beta_0 + \beta_1*x_1 + \beta_2*x_2 ...+ \beta_n*x_n</span>
<span id="cb92-224"><a href="#cb92-224"></a>$$</span>
<span id="cb92-225"><a href="#cb92-225"></a></span>
<span id="cb92-226"><a href="#cb92-226"></a>where each of the $\beta_i$ are slopes defining the relationship between</span>
<span id="cb92-227"><a href="#cb92-227"></a>y and $x_i$. Together, the RHS of that equation defines an n-dimensional</span>
<span id="cb92-228"><a href="#cb92-228"></a>*plane*.</span>
<span id="cb92-229"><a href="#cb92-229"></a></span>
<span id="cb92-230"><a href="#cb92-230"></a>As per Lindoloev, many statistical tests, going from one-sample t-tests</span>
<span id="cb92-231"><a href="#cb92-231"></a>to two-way ANOVA, are special cases of this system.</span>
<span id="cb92-232"><a href="#cb92-232"></a></span>
<span id="cb92-233"><a href="#cb92-233"></a>Also see [Jeffrey Walker "A</span>
<span id="cb92-234"><a href="#cb92-234"></a>linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"](https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables)</span>
<span id="cb92-235"><a href="#cb92-235"></a></span>
<span id="cb92-236"><a href="#cb92-236"></a><span class="fu">## Linear Models as Hypothesis Tests</span></span>
<span id="cb92-237"><a href="#cb92-237"></a></span>
<span id="cb92-238"><a href="#cb92-238"></a>Using linear models is based on the idea of **Testing of Hypotheses**.</span>
<span id="cb92-239"><a href="#cb92-239"></a>The Hypothesis Testing method typically defines a NULL Hypothesis where</span>
<span id="cb92-240"><a href="#cb92-240"></a>the statements read as "**there is no relationship**" between the</span>
<span id="cb92-241"><a href="#cb92-241"></a>variables at hand, explanatory and responses. The Alternative Hypothesis</span>
<span id="cb92-242"><a href="#cb92-242"></a>typically states that there *is* a relationship between the variables.</span>
<span id="cb92-243"><a href="#cb92-243"></a></span>
<span id="cb92-244"><a href="#cb92-244"></a>Accordingly, in fitting a linear model, we follow the process as</span>
<span id="cb92-245"><a href="#cb92-245"></a>follows:</span>
<span id="cb92-246"><a href="#cb92-246"></a></span>
<span id="cb92-247"><a href="#cb92-247"></a><span class="ss">1.  </span>Make the following hypotheses: $$</span>
<span id="cb92-248"><a href="#cb92-248"></a>    y = \beta_0 + \beta_1 *x <span class="sc">\\</span></span>
<span id="cb92-249"><a href="#cb92-249"></a>    NULL\ Hypothesis\ H_0 =&gt; x\ and\ y\ are\ unrelated.\ (\beta_1 = 0)</span>
<span id="cb92-250"><a href="#cb92-250"></a>    $$ $$</span>
<span id="cb92-251"><a href="#cb92-251"></a>    y = \beta_0 + \beta_1 *x <span class="sc">\\</span></span>
<span id="cb92-252"><a href="#cb92-252"></a>    Alternate\ Hypothesis\ H_1 =&gt; x\ and\ y\ are\ linearly\ related\ (\beta_1 \ne 0)</span>
<span id="cb92-253"><a href="#cb92-253"></a>    $$</span>
<span id="cb92-254"><a href="#cb92-254"></a><span class="ss">2.  </span>We "assume" that $H_0$ is true.</span>
<span id="cb92-255"><a href="#cb92-255"></a><span class="ss">3.  </span>We calculate $\beta_1$.</span>
<span id="cb92-256"><a href="#cb92-256"></a><span class="ss">4.  </span>We then find probability **p** that <span class="sc">\[</span>$\beta_1 = Estimated\ Value$<span class="sc">\]</span></span>
<span id="cb92-257"><a href="#cb92-257"></a>    **when the NULL Hypothesis** is **assumed** TRUE. This is the</span>
<span id="cb92-258"><a href="#cb92-258"></a>    **p-value**. If that probability is **p\&gt;=0.05**, we say we "cannot</span>
<span id="cb92-259"><a href="#cb92-259"></a>    reject" $H_0$ and there is unlikely to be significant linear</span>
<span id="cb92-260"><a href="#cb92-260"></a>    relationship.</span>
<span id="cb92-261"><a href="#cb92-261"></a></span>
<span id="cb92-262"><a href="#cb92-262"></a>However, if **p\&lt;= 0.05** can we reject the NULL hypothesis, and say</span>
<span id="cb92-263"><a href="#cb92-263"></a>that there could be a significant linear relationship,because</span>
<span id="cb92-264"><a href="#cb92-264"></a>$\beta_1 = Estimated\ Value$ by mere chance under $H_0$ is very small.</span>
<span id="cb92-265"><a href="#cb92-265"></a></span>
<span id="cb92-266"><a href="#cb92-266"></a>Pheeew !!</span>
<span id="cb92-267"><a href="#cb92-267"></a></span>
<span id="cb92-268"><a href="#cb92-268"></a><span class="fu">## Linear Models in R</span></span>
<span id="cb92-269"><a href="#cb92-269"></a></span>
<span id="cb92-270"><a href="#cb92-270"></a><span class="in">`lm()`</span> is the function to create linear models in R. In R we are lazy</span>
<span id="cb92-271"><a href="#cb92-271"></a>and write :</span>
<span id="cb92-272"><a href="#cb92-272"></a></span>
<span id="cb92-273"><a href="#cb92-273"></a>$$</span>
<span id="cb92-274"><a href="#cb92-274"></a>y \sim 1 + x<span class="sc">\\</span></span>
<span id="cb92-275"><a href="#cb92-275"></a>which\ reads\ like<span class="sc">\\</span></span>
<span id="cb92-276"><a href="#cb92-276"></a>y = 1*number + x* another\ number</span>
<span id="cb92-277"><a href="#cb92-277"></a>$$</span>
<span id="cb92-278"><a href="#cb92-278"></a></span>
<span id="cb92-279"><a href="#cb92-279"></a>Note: there are very many ways in which linear models can be coded in R.</span>
<span id="cb92-280"><a href="#cb92-280"></a>See [Vito Ricci on</span>
<span id="cb92-281"><a href="#cb92-281"></a>CRAN.](https://cran.r-project.org/doc/contrib/Ricci-refcard-regression.pdf)</span>
<span id="cb92-282"><a href="#cb92-282"></a></span>
<span id="cb92-283"><a href="#cb92-283"></a><span class="in">```{r linear_model}</span></span>
<span id="cb92-284"><a href="#cb92-284"></a><span class="co"># using lm()</span></span>
<span id="cb92-285"><a href="#cb92-285"></a><span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb92-286"><a href="#cb92-286"></a>  <span class="fu">summary</span>() <span class="sc">%&gt;%</span>   </span>
<span id="cb92-287"><a href="#cb92-287"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">5</span>)</span>
<span id="cb92-288"><a href="#cb92-288"></a><span class="in">```</span></span>
<span id="cb92-289"><a href="#cb92-289"></a></span>
<span id="cb92-290"><a href="#cb92-290"></a>Since the *p-value* is <span class="sc">\&gt;</span>=0.05, we *fail to reject the NULL Hypothesis</span>
<span id="cb92-291"><a href="#cb92-291"></a>that there is no relationship between x and y*.</span>
<span id="cb92-292"><a href="#cb92-292"></a></span>
<span id="cb92-293"><a href="#cb92-293"></a><span class="fu">## Assumptions in Linear Models</span></span>
<span id="cb92-294"><a href="#cb92-294"></a></span>
<span id="cb92-295"><a href="#cb92-295"></a><span class="ss">1.  </span>**L**: $\color{blue}{linear}$ relationship</span>
<span id="cb92-296"><a href="#cb92-296"></a><span class="ss">2.  </span>**I**: Errors are **independent** (across observations)</span>
<span id="cb92-297"><a href="#cb92-297"></a><span class="ss">3.  </span>**N**: y is $\color{red}{normally}$ distributed at each "level" of</span>
<span id="cb92-298"><a href="#cb92-298"></a>    x.  </span>
<span id="cb92-299"><a href="#cb92-299"></a><span class="ss">4.  </span>**E**: equal variance at all levels of x. No *heteroscedasticity*.</span>
<span id="cb92-300"><a href="#cb92-300"></a>    <span class="al">![OLS Assumptions](ols_assumptions.png)</span></span>
<span id="cb92-301"><a href="#cb92-301"></a></span>
<span id="cb92-302"><a href="#cb92-302"></a>Let us now see which standard statistical tests can be re-formulated as</span>
<span id="cb92-303"><a href="#cb92-303"></a>Linear Models.</span>
<span id="cb92-304"><a href="#cb92-304"></a></span>
<span id="cb92-305"><a href="#cb92-305"></a><span class="fu"># Tests for Correlation {.tabset}</span></span>
<span id="cb92-306"><a href="#cb92-306"></a></span>
<span id="cb92-307"><a href="#cb92-307"></a>Correlation **r** is a measure of *strength* and *direction* of *linear</span>
<span id="cb92-308"><a href="#cb92-308"></a>association* between two variables. **r** is between <span class="sc">\[</span>-1,+1<span class="sc">\]</span>, with 0</span>
<span id="cb92-309"><a href="#cb92-309"></a>implying no association/correlation.</span>
<span id="cb92-310"><a href="#cb92-310"></a></span>
<span id="cb92-311"><a href="#cb92-311"></a>From this definition, the *linear model* lends itself in a</span>
<span id="cb92-312"><a href="#cb92-312"></a>straightforward way as a model to interpret *correlation*. Intuitively,</span>
<span id="cb92-313"><a href="#cb92-313"></a>the slope of the linear model could be related to the correlation</span>
<span id="cb92-314"><a href="#cb92-314"></a>between y and x.</span>
<span id="cb92-315"><a href="#cb92-315"></a></span>
<span id="cb92-316"><a href="#cb92-316"></a>Now we look at the numbers.</span>
<span id="cb92-317"><a href="#cb92-317"></a></span>
<span id="cb92-318"><a href="#cb92-318"></a><span class="fu">## Pearson Correlation {.tabset}</span></span>
<span id="cb92-319"><a href="#cb92-319"></a></span>
<span id="cb92-320"><a href="#cb92-320"></a><span class="fu">### Model</span></span>
<span id="cb92-321"><a href="#cb92-321"></a></span>
<span id="cb92-322"><a href="#cb92-322"></a>The model for Pearson Correlation tests is exactly the Linear Model:</span>
<span id="cb92-323"><a href="#cb92-323"></a></span>
<span id="cb92-324"><a href="#cb92-324"></a>$$</span>
<span id="cb92-325"><a href="#cb92-325"></a>y = \beta_0 + \beta_1 * x </span>
<span id="cb92-326"><a href="#cb92-326"></a><span class="sc">\\</span></span>
<span id="cb92-327"><a href="#cb92-327"></a>H_0: \beta_1 = 0</span>
<span id="cb92-328"><a href="#cb92-328"></a>$$</span>
<span id="cb92-329"><a href="#cb92-329"></a></span>
<span id="cb92-330"><a href="#cb92-330"></a>See the Code section for further insights into the relationship between</span>
<span id="cb92-331"><a href="#cb92-331"></a>the Correlation Score and the Slope of the Linear Model.</span>
<span id="cb92-332"><a href="#cb92-332"></a></span>
<span id="cb92-333"><a href="#cb92-333"></a><span class="fu">### Code</span></span>
<span id="cb92-334"><a href="#cb92-334"></a></span>
<span id="cb92-335"><a href="#cb92-335"></a><span class="in">```{r Pearson_Correlation}</span></span>
<span id="cb92-336"><a href="#cb92-336"></a><span class="co"># Pearson (built-in test)</span></span>
<span id="cb92-337"><a href="#cb92-337"></a>cor <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(y,x,<span class="at">method =</span> <span class="st">"pearson"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-338"><a href="#cb92-338"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb92-339"><a href="#cb92-339"></a></span>
<span id="cb92-340"><a href="#cb92-340"></a><span class="co"># Linear Model</span></span>
<span id="cb92-341"><a href="#cb92-341"></a>lin <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb92-342"><a href="#cb92-342"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb92-343"><a href="#cb92-343"></a></span>
<span id="cb92-344"><a href="#cb92-344"></a><span class="co"># Scaled linear model</span></span>
<span id="cb92-345"><a href="#cb92-345"></a>lin_scl <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">scale</span>(y) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">scale</span>(x), <span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb92-346"><a href="#cb92-346"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb92-347"><a href="#cb92-347"></a></span>
<span id="cb92-348"><a href="#cb92-348"></a><span class="fu">print</span>(cor)</span>
<span id="cb92-349"><a href="#cb92-349"></a><span class="fu">print</span>(lin)</span>
<span id="cb92-350"><a href="#cb92-350"></a><span class="fu">print</span>(lin_scl)</span>
<span id="cb92-351"><a href="#cb92-351"></a></span>
<span id="cb92-352"><a href="#cb92-352"></a><span class="co"># All together</span></span>
<span id="cb92-353"><a href="#cb92-353"></a><span class="fu">rbind</span>(cor, lin, lin_scl) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span>
<span id="cb92-354"><a href="#cb92-354"></a><span class="in">```</span></span>
<span id="cb92-355"><a href="#cb92-355"></a></span>
<span id="cb92-356"><a href="#cb92-356"></a>Notes: 1. The *p-value* for Pearson Correlation and that for the *slope*</span>
<span id="cb92-357"><a href="#cb92-357"></a>in the linear model is the same ( 0.1053 ). Which means we cannot reject</span>
<span id="cb92-358"><a href="#cb92-358"></a>the NULL hypothesis of "no relationship".</span>
<span id="cb92-359"><a href="#cb92-359"></a></span>
<span id="cb92-360"><a href="#cb92-360"></a><span class="ss">2.  </span>Here is the relationship between the slope and correlation:</span>
<span id="cb92-361"><a href="#cb92-361"></a></span>
<span id="cb92-362"><a href="#cb92-362"></a>$$</span>
<span id="cb92-363"><a href="#cb92-363"></a>Slope\ \beta_1 = \frac{sd_y}{sd_x} * r</span>
<span id="cb92-364"><a href="#cb92-364"></a>$$</span>
<span id="cb92-365"><a href="#cb92-365"></a></span>
<span id="cb92-366"><a href="#cb92-366"></a>When both x and y have the same standard deviation, the slope and</span>
<span id="cb92-367"><a href="#cb92-367"></a>correlation are the same. Here, since x has twice the <span class="in">`sd`</span> of y, the</span>
<span id="cb92-368"><a href="#cb92-368"></a>ratio of **slope** = `r lin$estimate[2]` to **r** = <span class="in">`r cor$estimate`</span> is</span>
<span id="cb92-369"><a href="#cb92-369"></a>0.5. Hence a linear model using <span class="in">`scale()`</span> for both variables will show</span>
<span id="cb92-370"><a href="#cb92-370"></a>slope = **r**.</span>
<span id="cb92-371"><a href="#cb92-371"></a></span>
<span id="cb92-372"><a href="#cb92-372"></a>Slope_Scaled: <span class="in">`r lin_scl$estimate[2]`</span> = Correlation: <span class="in">`r cor$estimate`</span></span>
<span id="cb92-373"><a href="#cb92-373"></a></span>
<span id="cb92-374"><a href="#cb92-374"></a><span class="fu">### Example</span></span>
<span id="cb92-375"><a href="#cb92-375"></a></span>
<span id="cb92-376"><a href="#cb92-376"></a>We choose to look at the <span class="in">`gpa_study_hours`</span> dataset. It has two numeric</span>
<span id="cb92-377"><a href="#cb92-377"></a>columns <span class="in">`gpa`</span> and <span class="in">`study_hours`</span>:</span>
<span id="cb92-378"><a href="#cb92-378"></a></span>
<span id="cb92-379"><a href="#cb92-379"></a><span class="in">```{r gpa_study_hours}</span></span>
<span id="cb92-380"><a href="#cb92-380"></a><span class="fu">glimpse</span>(gpa_study_hours)</span>
<span id="cb92-381"><a href="#cb92-381"></a><span class="in">```</span></span>
<span id="cb92-382"><a href="#cb92-382"></a></span>
<span id="cb92-383"><a href="#cb92-383"></a><span class="in">```{r Pearson_example_1}</span></span>
<span id="cb92-384"><a href="#cb92-384"></a><span class="co"># Checks for Normal/Symmetric distributions</span></span>
<span id="cb92-385"><a href="#cb92-385"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gpa_study_hours) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(gpa))</span>
<span id="cb92-386"><a href="#cb92-386"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gpa_study_hours) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(study_hours))</span>
<span id="cb92-387"><a href="#cb92-387"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gpa_study_hours) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(gpa, study_hours))</span>
<span id="cb92-388"><a href="#cb92-388"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3</span>
<span id="cb92-389"><a href="#cb92-389"></a></span>
<span id="cb92-390"><a href="#cb92-390"></a><span class="in">```</span></span>
<span id="cb92-391"><a href="#cb92-391"></a></span>
<span id="cb92-392"><a href="#cb92-392"></a>Hmm...not normally distributed, and the relationship is also not linear,</span>
<span id="cb92-393"><a href="#cb92-393"></a>and there is some evidence of heterscedasticity, so Pearson correlation</span>
<span id="cb92-394"><a href="#cb92-394"></a>would not be the best idea here.</span>
<span id="cb92-395"><a href="#cb92-395"></a></span>
<span id="cb92-396"><a href="#cb92-396"></a><span class="in">```{r Pearson_example_2}</span></span>
<span id="cb92-397"><a href="#cb92-397"></a></span>
<span id="cb92-398"><a href="#cb92-398"></a><span class="co"># Pearson Correlation as Linear Model</span></span>
<span id="cb92-399"><a href="#cb92-399"></a><span class="fu">lm</span>(gpa <span class="sc">~</span> study_hours, <span class="at">data =</span> gpa_study_hours) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb92-400"><a href="#cb92-400"></a></span>
<span id="cb92-401"><a href="#cb92-401"></a><span class="co"># Other ways using other packages</span></span>
<span id="cb92-402"><a href="#cb92-402"></a>mosaic<span class="sc">::</span><span class="fu">cor_test</span>(gpa <span class="sc">~</span> study_hours, <span class="at">data =</span> gpa_study_hours)</span>
<span id="cb92-403"><a href="#cb92-403"></a></span>
<span id="cb92-404"><a href="#cb92-404"></a>statsExpressions<span class="sc">::</span><span class="fu">corr_test</span>(<span class="at">data =</span> gpa_study_hours, </span>
<span id="cb92-405"><a href="#cb92-405"></a>                            <span class="at">x =</span> study_hours, </span>
<span id="cb92-406"><a href="#cb92-406"></a>                            <span class="at">y =</span> gpa)</span>
<span id="cb92-407"><a href="#cb92-407"></a><span class="in">```</span></span>
<span id="cb92-408"><a href="#cb92-408"></a></span>
<span id="cb92-409"><a href="#cb92-409"></a>The correlation estimate is $0.133$; the <span class="in">`p-value`</span> is 0.065 and the</span>
<span id="cb92-410"><a href="#cb92-410"></a>confidence interval includes 0. Hence we fail to reject the NULL</span>
<span id="cb92-411"><a href="#cb92-411"></a>hypothesis that <span class="in">`study_hours`</span> and <span class="in">`gpa`</span> have no relationship.</span>
<span id="cb92-412"><a href="#cb92-412"></a></span>
<span id="cb92-413"><a href="#cb92-413"></a>We can use a later package <span class="in">`ggstaplot`</span> to plot this:</span>
<span id="cb92-414"><a href="#cb92-414"></a></span>
<span id="cb92-415"><a href="#cb92-415"></a><span class="in">```{r Pearson_example_3}</span></span>
<span id="cb92-416"><a href="#cb92-416"></a></span>
<span id="cb92-417"><a href="#cb92-417"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggscatterstats</span>(<span class="at">data =</span> gpa_study_hours, </span>
<span id="cb92-418"><a href="#cb92-418"></a>                            <span class="at">x =</span> study_hours, </span>
<span id="cb92-419"><a href="#cb92-419"></a>                            <span class="at">y =</span> gpa,</span>
<span id="cb92-420"><a href="#cb92-420"></a>                            <span class="at">type =</span> <span class="st">"robust"</span>,</span>
<span id="cb92-421"><a href="#cb92-421"></a>                            <span class="at">marginal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb92-422"><a href="#cb92-422"></a>                            <span class="at">title =</span> <span class="st">"GPA vs Study Hours"</span>)</span>
<span id="cb92-423"><a href="#cb92-423"></a></span>
<span id="cb92-424"><a href="#cb92-424"></a><span class="in">```</span></span>
<span id="cb92-425"><a href="#cb92-425"></a></span>
<span id="cb92-426"><a href="#cb92-426"></a><span class="fu">## Spearman Correlation {.tabset}</span></span>
<span id="cb92-427"><a href="#cb92-427"></a></span>
<span id="cb92-428"><a href="#cb92-428"></a><span class="fu">### Model</span></span>
<span id="cb92-429"><a href="#cb92-429"></a></span>
<span id="cb92-430"><a href="#cb92-430"></a>In some cases the **LINE** assumptions may not hold. Nonlinear</span>
<span id="cb92-431"><a href="#cb92-431"></a>relationships, non-normally distributed data ( with large outliers ) and</span>
<span id="cb92-432"><a href="#cb92-432"></a>working with *ordinal* rather than continuous data: these situations</span>
<span id="cb92-433"><a href="#cb92-433"></a>necessitate the use of Spearman's *ranked* correlation scores.</span>
<span id="cb92-434"><a href="#cb92-434"></a>(**Ranked**, not **sign-ranked**.)</span>
<span id="cb92-435"><a href="#cb92-435"></a></span>
<span id="cb92-436"><a href="#cb92-436"></a>$$</span>
<span id="cb92-437"><a href="#cb92-437"></a>rank(y) = \beta_0 + \beta_1 * rank(x) <span class="sc">\\</span></span>
<span id="cb92-438"><a href="#cb92-438"></a>H_0: \beta_1 = 0</span>
<span id="cb92-439"><a href="#cb92-439"></a>$$</span>
<span id="cb92-440"><a href="#cb92-440"></a></span>
<span id="cb92-441"><a href="#cb92-441"></a>Spearman correlation = Pearson correlation using the rank of the data</span>
<span id="cb92-442"><a href="#cb92-442"></a>observations. Let's check how this holds for a our x and y data:</span>
<span id="cb92-443"><a href="#cb92-443"></a></span>
<span id="cb92-444"><a href="#cb92-444"></a><span class="in">```{r Spearman_Plot}</span></span>
<span id="cb92-445"><a href="#cb92-445"></a><span class="co"># Plot the data</span></span>
<span id="cb92-446"><a href="#cb92-446"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb92-447"><a href="#cb92-447"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb92-448"><a href="#cb92-448"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb92-449"><a href="#cb92-449"></a>  <span class="fu">ggtitle</span>(<span class="st">" Pearson Correlation</span><span class="sc">\n</span><span class="st"> and Linear Models"</span>)</span>
<span id="cb92-450"><a href="#cb92-450"></a></span>
<span id="cb92-451"><a href="#cb92-451"></a><span class="co"># Plot ranked data</span></span>
<span id="cb92-452"><a href="#cb92-452"></a>p2 <span class="ot">&lt;-</span> mydata_wide <span class="sc">%&gt;%</span> </span>
<span id="cb92-453"><a href="#cb92-453"></a>  <span class="fu">mutate</span>(<span class="at">x_rank =</span> <span class="fu">rank</span>(x),</span>
<span id="cb92-454"><a href="#cb92-454"></a>         <span class="at">y_rank =</span> <span class="fu">rank</span>(y)) <span class="sc">%&gt;%</span></span>
<span id="cb92-455"><a href="#cb92-455"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(x_rank, y_rank)) <span class="sc">+</span> </span>
<span id="cb92-456"><a href="#cb92-456"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">15</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb92-457"><a href="#cb92-457"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb92-458"><a href="#cb92-458"></a>  <span class="fu">ggtitle</span>(<span class="st">" Spearman Ranked Correlation</span><span class="sc">\n</span><span class="st"> and Linear Models"</span>)</span>
<span id="cb92-459"><a href="#cb92-459"></a></span>
<span id="cb92-460"><a href="#cb92-460"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb92-461"><a href="#cb92-461"></a><span class="in">```</span></span>
<span id="cb92-462"><a href="#cb92-462"></a></span>
<span id="cb92-463"><a href="#cb92-463"></a>Slopes are almost identical, \~ 0.25.</span>
<span id="cb92-464"><a href="#cb92-464"></a></span>
<span id="cb92-465"><a href="#cb92-465"></a><span class="fu">### Code</span></span>
<span id="cb92-466"><a href="#cb92-466"></a></span>
<span id="cb92-467"><a href="#cb92-467"></a><span class="in">```{r Spearman_Correlation}</span></span>
<span id="cb92-468"><a href="#cb92-468"></a><span class="co"># Spearman</span></span>
<span id="cb92-469"><a href="#cb92-469"></a>cor1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(y,x, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-470"><a href="#cb92-470"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb92-471"><a href="#cb92-471"></a></span>
<span id="cb92-472"><a href="#cb92-472"></a><span class="co"># Pearson using ranks</span></span>
<span id="cb92-473"><a href="#cb92-473"></a>cor2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(<span class="fu">rank</span>(y), <span class="fu">rank</span>(x), <span class="at">method =</span> <span class="st">"pearson"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-474"><a href="#cb92-474"></a>broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb92-475"><a href="#cb92-475"></a></span>
<span id="cb92-476"><a href="#cb92-476"></a><span class="co"># Linear Models using rank</span></span>
<span id="cb92-477"><a href="#cb92-477"></a>cor3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">rank</span>(y) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">rank</span>(x),<span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb92-478"><a href="#cb92-478"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb92-479"><a href="#cb92-479"></a></span>
<span id="cb92-480"><a href="#cb92-480"></a><span class="fu">rbind</span>(cor1, cor2, cor3) <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span>
<span id="cb92-481"><a href="#cb92-481"></a><span class="in">```</span></span>
<span id="cb92-482"><a href="#cb92-482"></a></span>
<span id="cb92-483"><a href="#cb92-483"></a>Notes:</span>
<span id="cb92-484"><a href="#cb92-484"></a></span>
<span id="cb92-485"><a href="#cb92-485"></a><span class="ss">1.  </span>When ranks are used, the slope of the linear model ($\beta_1$) has</span>
<span id="cb92-486"><a href="#cb92-486"></a>    the same value as the correlation coefficient ( $\rho$ ).</span>
<span id="cb92-487"><a href="#cb92-487"></a></span>
<span id="cb92-488"><a href="#cb92-488"></a><span class="ss">2.  </span>Note that the slope from the linear model now has an intuitive</span>
<span id="cb92-489"><a href="#cb92-489"></a>    interpretation: **the number of ranks y changes for each change in</span>
<span id="cb92-490"><a href="#cb92-490"></a>    rank of x**. ( Ranks are "independent" of <span class="in">`sd`</span> )</span>
<span id="cb92-491"><a href="#cb92-491"></a></span>
<span id="cb92-492"><a href="#cb92-492"></a><span class="fu">### Example</span></span>
<span id="cb92-493"><a href="#cb92-493"></a></span>
<span id="cb92-494"><a href="#cb92-494"></a>We examine the <span class="in">`cars93`</span> data, where the numeric variables of interest</span>
<span id="cb92-495"><a href="#cb92-495"></a>are <span class="in">`weight`</span> and <span class="in">`price`</span>.</span>
<span id="cb92-496"><a href="#cb92-496"></a></span>
<span id="cb92-497"><a href="#cb92-497"></a><span class="in">```{r Spearman_example_1}</span></span>
<span id="cb92-498"><a href="#cb92-498"></a>cars93 <span class="sc">%&gt;%</span> </span>
<span id="cb92-499"><a href="#cb92-499"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(weight, price)) <span class="sc">+</span> </span>
<span id="cb92-500"><a href="#cb92-500"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb92-501"><a href="#cb92-501"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Car Weight and Car Price have a nonlinear relationship"</span>)</span>
<span id="cb92-502"><a href="#cb92-502"></a><span class="in">```</span></span>
<span id="cb92-503"><a href="#cb92-503"></a></span>
<span id="cb92-504"><a href="#cb92-504"></a>Let us try a Spearman Correlation score for these variables, since the</span>
<span id="cb92-505"><a href="#cb92-505"></a>data are not linearly related and the variance of <span class="in">`price`</span> also is not</span>
<span id="cb92-506"><a href="#cb92-506"></a>constant over <span class="in">`weight`</span></span>
<span id="cb92-507"><a href="#cb92-507"></a></span>
<span id="cb92-508"><a href="#cb92-508"></a><span class="in">```{r Spearman_example_2}</span></span>
<span id="cb92-509"><a href="#cb92-509"></a><span class="fu">cor.test</span>(cars93<span class="sc">$</span>price, cars93<span class="sc">$</span>weight, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb92-510"><a href="#cb92-510"></a></span>
<span id="cb92-511"><a href="#cb92-511"></a><span class="co"># Using linear Model</span></span>
<span id="cb92-512"><a href="#cb92-512"></a><span class="fu">lm</span>(<span class="fu">rank</span>(price) <span class="sc">~</span> <span class="fu">rank</span>(weight), <span class="at">data =</span> cars93) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb92-513"><a href="#cb92-513"></a></span>
<span id="cb92-514"><a href="#cb92-514"></a><span class="co"># Stats Plot</span></span>
<span id="cb92-515"><a href="#cb92-515"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggscatterstats</span>(<span class="at">data =</span> cars93, <span class="at">x =</span> weight, </span>
<span id="cb92-516"><a href="#cb92-516"></a>                            <span class="at">y =</span> price,</span>
<span id="cb92-517"><a href="#cb92-517"></a>                            <span class="at">type =</span> <span class="st">"nonparametric"</span>,</span>
<span id="cb92-518"><a href="#cb92-518"></a>                            <span class="at">title =</span> <span class="st">"Cars93: Weight vs Price"</span>,</span>
<span id="cb92-519"><a href="#cb92-519"></a>                            <span class="at">subtitle =</span> <span class="st">"Spearman Correlation"</span>)</span>
<span id="cb92-520"><a href="#cb92-520"></a><span class="in">```</span></span>
<span id="cb92-521"><a href="#cb92-521"></a></span>
<span id="cb92-522"><a href="#cb92-522"></a>We see that using ranks of the <span class="in">`price`</span> variable, we obtain a Spearman's</span>
<span id="cb92-523"><a href="#cb92-523"></a>$\rho = 0.882$ with a <span class="in">`p-value`</span> that is very small. Hence we are able to</span>
<span id="cb92-524"><a href="#cb92-524"></a>reject the NULL hypothesis and state that there is a relationship</span>
<span id="cb92-525"><a href="#cb92-525"></a>between these two variables. The **linear** relationship is evaluated as</span>
<span id="cb92-526"><a href="#cb92-526"></a>a correlation of <span class="in">`0.882`</span>.</span>
<span id="cb92-527"><a href="#cb92-527"></a></span>
<span id="cb92-528"><a href="#cb92-528"></a><span class="fu"># Tests on One Mean {.tabset}</span></span>
<span id="cb92-529"><a href="#cb92-529"></a></span>
<span id="cb92-530"><a href="#cb92-530"></a>A series of tests deal with one mean value of a sample. The idea is to</span>
<span id="cb92-531"><a href="#cb92-531"></a>evaluate whether that mean is representative of the mean of the</span>
<span id="cb92-532"><a href="#cb92-532"></a>underlying population.</span>
<span id="cb92-533"><a href="#cb92-533"></a></span>
<span id="cb92-534"><a href="#cb92-534"></a>This uses the *Student's t-test* for parametric data and the *Wilcoxon</span>
<span id="cb92-535"><a href="#cb92-535"></a>signed-rank test* for non-parametric data.</span>
<span id="cb92-536"><a href="#cb92-536"></a></span>
<span id="cb92-537"><a href="#cb92-537"></a>Tests can involve a *single sample* or *paired samples*.</span>
<span id="cb92-538"><a href="#cb92-538"></a></span>
<span id="cb92-539"><a href="#cb92-539"></a><span class="fu">## The Student's t-test with one sample {.tabset}</span></span>
<span id="cb92-540"><a href="#cb92-540"></a></span>
<span id="cb92-541"><a href="#cb92-541"></a><span class="fu">### Model</span></span>
<span id="cb92-542"><a href="#cb92-542"></a></span>
<span id="cb92-543"><a href="#cb92-543"></a>A single number predicts y:</span>
<span id="cb92-544"><a href="#cb92-544"></a></span>
<span id="cb92-545"><a href="#cb92-545"></a>$$ </span>
<span id="cb92-546"><a href="#cb92-546"></a>y = \beta_0 + \beta_1*x <span class="sc">\\</span></span>
<span id="cb92-547"><a href="#cb92-547"></a><span class="sc">\\</span>and\ further \ actually<span class="sc">\\</span></span>
<span id="cb92-548"><a href="#cb92-548"></a>y = \beta_0</span>
<span id="cb92-549"><a href="#cb92-549"></a>$$</span>
<span id="cb92-550"><a href="#cb92-550"></a></span>
<span id="cb92-551"><a href="#cb92-551"></a>and the second term vanishes, since "there is no x": all the x-values</span>
<span id="cb92-552"><a href="#cb92-552"></a>are made equal to zero in the linear model !! The NULL Hypothesis</span>
<span id="cb92-553"><a href="#cb92-553"></a>therefore is:</span>
<span id="cb92-554"><a href="#cb92-554"></a></span>
<span id="cb92-555"><a href="#cb92-555"></a>$$</span>
<span id="cb92-556"><a href="#cb92-556"></a>\ H_0: \beta_0 = 0</span>
<span id="cb92-557"><a href="#cb92-557"></a>$$</span>
<span id="cb92-558"><a href="#cb92-558"></a></span>
<span id="cb92-559"><a href="#cb92-559"></a>This NULL Hypothesis makes sense, because in the accompanying linear</span>
<span id="cb92-560"><a href="#cb92-560"></a>model all values of the <span class="kw">&lt;u&gt;</span>explanatory<span class="kw">&lt;/u&gt;</span> variable x are zero, and</span>
<span id="cb92-561"><a href="#cb92-561"></a>therefore the NULL Hypothesis for the model should be that y also should</span>
<span id="cb92-562"><a href="#cb92-562"></a>be zero mean. Note that if we **want** the NULL hypothesis to be that</span>
<span id="cb92-563"><a href="#cb92-563"></a>the mean is other than zero, we can use the</span>
<span id="cb92-564"><a href="#cb92-564"></a><span class="in">`lm(...., mu = some_number, ..)`</span> parameter in the command.</span>
<span id="cb92-565"><a href="#cb92-565"></a></span>
<span id="cb92-566"><a href="#cb92-566"></a><span class="fu">### Code</span></span>
<span id="cb92-567"><a href="#cb92-567"></a></span>
<span id="cb92-568"><a href="#cb92-568"></a>If we compare the <span class="in">`t.test`</span> with the appropriate <span class="in">`lm`</span> model:</span>
<span id="cb92-569"><a href="#cb92-569"></a></span>
<span id="cb92-570"><a href="#cb92-570"></a><span class="in">```{r t_test_one_mean}</span></span>
<span id="cb92-571"><a href="#cb92-571"></a><span class="co"># t-test</span></span>
<span id="cb92-572"><a href="#cb92-572"></a>t1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb92-573"><a href="#cb92-573"></a><span class="fu">print</span>(t1)</span>
<span id="cb92-574"><a href="#cb92-574"></a></span>
<span id="cb92-575"><a href="#cb92-575"></a><span class="co"># linear model</span></span>
<span id="cb92-576"><a href="#cb92-576"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mydata_wide)</span>
<span id="cb92-577"><a href="#cb92-577"></a>lm1 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb92-578"><a href="#cb92-578"></a>lm1 <span class="sc">%&gt;%</span> <span class="fu">confint</span>()</span>
<span id="cb92-579"><a href="#cb92-579"></a></span>
<span id="cb92-580"><a href="#cb92-580"></a><span class="in">```</span></span>
<span id="cb92-581"><a href="#cb92-581"></a></span>
<span id="cb92-582"><a href="#cb92-582"></a>The confidence intervals for both the <span class="in">`t.test`</span> and the <span class="in">`lm`</span> model are</span>
<span id="cb92-583"><a href="#cb92-583"></a>identical.</span>
<span id="cb92-584"><a href="#cb92-584"></a></span>
<span id="cb92-585"><a href="#cb92-585"></a>t-test confidence intervals: <span class="in">`r t1$conf.int`</span>\</span>
<span id="cb92-586"><a href="#cb92-586"></a>linear model confidence intervals: <span class="in">`r confint(lm1)`</span></span>
<span id="cb92-587"><a href="#cb92-587"></a></span>
<span id="cb92-588"><a href="#cb92-588"></a>So even though y has a mean of 0.3, the confidence intervals straddle</span>
<span id="cb92-589"><a href="#cb92-589"></a>zero, and hence we cannot reject the NULL hypothesis that the true</span>
<span id="cb92-590"><a href="#cb92-590"></a>population, of which y is a sample, could have mean=0.</span>
<span id="cb92-591"><a href="#cb92-591"></a></span>
<span id="cb92-592"><a href="#cb92-592"></a><span class="fu">### Example</span></span>
<span id="cb92-593"><a href="#cb92-593"></a></span>
<span id="cb92-596"><a href="#cb92-596"></a><span class="in">```{r}</span></span>
<span id="cb92-597"><a href="#cb92-597"></a>exam_grades</span>
<span id="cb92-598"><a href="#cb92-598"></a><span class="in">```</span></span>
<span id="cb92-599"><a href="#cb92-599"></a></span>
<span id="cb92-600"><a href="#cb92-600"></a><span class="fu">## Wilcoxon's Signed-Rank Test {.tabset}</span></span>
<span id="cb92-601"><a href="#cb92-601"></a></span>
<span id="cb92-602"><a href="#cb92-602"></a>Since we are dealing with the **mean**, the *sign* of the rank becomes</span>
<span id="cb92-603"><a href="#cb92-603"></a>important to use, in the case of a non-parametric single mean test.</span>
<span id="cb92-604"><a href="#cb92-604"></a></span>
<span id="cb92-605"><a href="#cb92-605"></a><span class="fu">### Model</span></span>
<span id="cb92-606"><a href="#cb92-606"></a></span>
<span id="cb92-607"><a href="#cb92-607"></a>$$</span>
<span id="cb92-608"><a href="#cb92-608"></a>signed<span class="sc">\_</span>rank(y) = \beta_0 <span class="sc">\\</span></span>
<span id="cb92-609"><a href="#cb92-609"></a>H_0: \beta_0 = 0</span>
<span id="cb92-610"><a href="#cb92-610"></a>$$</span>
<span id="cb92-611"><a href="#cb92-611"></a></span>
<span id="cb92-612"><a href="#cb92-612"></a><span class="fu">### Code</span></span>
<span id="cb92-613"><a href="#cb92-613"></a></span>
<span id="cb92-614"><a href="#cb92-614"></a><span class="in">```{r Wilcoxon_Signed_Rank_test_One_Mean}</span></span>
<span id="cb92-615"><a href="#cb92-615"></a><span class="co"># Standard Wilcoxon Signed_Rank Test</span></span>
<span id="cb92-616"><a href="#cb92-616"></a>w1 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y)</span>
<span id="cb92-617"><a href="#cb92-617"></a>w1</span>
<span id="cb92-618"><a href="#cb92-618"></a><span class="co"># Wilcoxon test with lm</span></span>
<span id="cb92-619"><a href="#cb92-619"></a>w2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y) <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data =</span> mydata_wide)</span>
<span id="cb92-620"><a href="#cb92-620"></a>w2</span>
<span id="cb92-621"><a href="#cb92-621"></a></span>
<span id="cb92-622"><a href="#cb92-622"></a><span class="co"># t-test with signed_rank data</span></span>
<span id="cb92-623"><a href="#cb92-623"></a>w3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="fu">signed_rank</span>(y))</span>
<span id="cb92-624"><a href="#cb92-624"></a>w3</span>
<span id="cb92-625"><a href="#cb92-625"></a><span class="in">```</span></span>
<span id="cb92-626"><a href="#cb92-626"></a></span>
<span id="cb92-627"><a href="#cb92-627"></a>We can plot the y data both original and ranked to see where the mean</span>
<span id="cb92-628"><a href="#cb92-628"></a>lies in each case. The approximation to the true \$\beta<span class="sc">\_</span>0&nbsp;( is good</span>
<span id="cb92-629"><a href="#cb92-629"></a>when the number of observations N is <span class="sc">\&gt;</span>=50. Lindoloev has a [simulation</span>
<span id="cb92-630"><a href="#cb92-630"></a>on</span>
<span id="cb92-631"><a href="#cb92-631"></a>this.](https://lindeloev.github.io/tests-as-linear/simulations/simulate_wilcoxon.html).</span>
<span id="cb92-632"><a href="#cb92-632"></a>We can also plot the model using *lm* for both the original data and the</span>
<span id="cb92-633"><a href="#cb92-633"></a>sign-ranked data.</span>
<span id="cb92-634"><a href="#cb92-634"></a></span>
<span id="cb92-635"><a href="#cb92-635"></a><span class="fu">### Example</span></span>
<span id="cb92-636"><a href="#cb92-636"></a></span>
<span id="cb92-637"><a href="#cb92-637"></a><span class="fu">### Plots for both t-test and Wilcoxon test</span></span>
<span id="cb92-638"><a href="#cb92-638"></a></span>
<span id="cb92-639"><a href="#cb92-639"></a><span class="in">```{r Mean_Related_Plots}</span></span>
<span id="cb92-640"><a href="#cb92-640"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb92-641"><a href="#cb92-641"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb92-642"><a href="#cb92-642"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> t1<span class="sc">$</span>estimate, </span>
<span id="cb92-643"><a href="#cb92-643"></a>                   <span class="at">yend =</span> t1<span class="sc">$</span>estimate, </span>
<span id="cb92-644"><a href="#cb92-644"></a>                   <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb92-645"><a href="#cb92-645"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Student's</span><span class="sc">\n</span><span class="st"> t-Test"</span>)</span>
<span id="cb92-646"><a href="#cb92-646"></a></span>
<span id="cb92-647"><a href="#cb92-647"></a><span class="co"># t-test using linear model</span></span>
<span id="cb92-648"><a href="#cb92-648"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb92-649"><a href="#cb92-649"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb92-650"><a href="#cb92-650"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb92-651"><a href="#cb92-651"></a>                   <span class="at">yend =</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb92-652"><a href="#cb92-652"></a>                   <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb92-653"><a href="#cb92-653"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Student's</span><span class="sc">\n</span><span class="st"> t-Test </span><span class="sc">\n</span><span class="st"> using lm"</span>)</span>
<span id="cb92-654"><a href="#cb92-654"></a></span>
<span id="cb92-655"><a href="#cb92-655"></a><span class="co"># Wilcoxon test, using signed-ranks of data</span></span>
<span id="cb92-656"><a href="#cb92-656"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fu">signed_rank</span>(y))) <span class="sc">+</span></span>
<span id="cb92-657"><a href="#cb92-657"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb92-658"><a href="#cb92-658"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">mean</span>(<span class="fu">signed_rank</span>(y)), <span class="at">yend =</span> <span class="fu">mean</span>(<span class="fu">signed_rank</span>(y)), <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb92-659"><a href="#cb92-659"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wilcoxon </span><span class="sc">\n</span><span class="st">Signed-Rank</span><span class="sc">\n</span><span class="st"> Test"</span>)</span>
<span id="cb92-660"><a href="#cb92-660"></a></span>
<span id="cb92-661"><a href="#cb92-661"></a><span class="co"># Wilcoxon test, using signed-ranks of data, and lm</span></span>
<span id="cb92-662"><a href="#cb92-662"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>( <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fu">signed_rank</span>(y))) <span class="sc">+</span></span>
<span id="cb92-663"><a href="#cb92-663"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb92-664"><a href="#cb92-664"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y) <span class="sc">~</span><span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb92-665"><a href="#cb92-665"></a>                   <span class="at">yend =</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y) <span class="sc">~</span><span class="dv">1</span>)<span class="sc">$</span>coefficient, </span>
<span id="cb92-666"><a href="#cb92-666"></a>                   <span class="at">x =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">xend =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb92-667"><a href="#cb92-667"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wilcoxon </span><span class="sc">\n</span><span class="st"> Signed-Rank </span><span class="sc">\n</span><span class="st"> Test with lm"</span>)</span>
<span id="cb92-668"><a href="#cb92-668"></a></span>
<span id="cb92-669"><a href="#cb92-669"></a></span>
<span id="cb92-670"><a href="#cb92-670"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(p1,p2,p3,p4, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb92-671"><a href="#cb92-671"></a><span class="in">```</span></span>
<span id="cb92-672"><a href="#cb92-672"></a></span>
<span id="cb92-673"><a href="#cb92-673"></a><span class="fu">## Paired Sample t-test {.tabset}</span></span>
<span id="cb92-674"><a href="#cb92-674"></a></span>
<span id="cb92-675"><a href="#cb92-675"></a>We use this when we have two samples and the observations from one</span>
<span id="cb92-676"><a href="#cb92-676"></a>sample can be "paired" with observations in the other sample. Controlled</span>
<span id="cb92-677"><a href="#cb92-677"></a>studies for interventions/measures, such as before/after kind of data,</span>
<span id="cb92-678"><a href="#cb92-678"></a>comparisons between two interventions on the same set of subjects, and</span>
<span id="cb92-679"><a href="#cb92-679"></a>two measurements made on the same subjects using different methods etc.</span>
<span id="cb92-680"><a href="#cb92-680"></a></span>
<span id="cb92-681"><a href="#cb92-681"></a><span class="fu">### Model</span></span>
<span id="cb92-682"><a href="#cb92-682"></a></span>
<span id="cb92-683"><a href="#cb92-683"></a>$$</span>
<span id="cb92-684"><a href="#cb92-684"></a>y_2 - y_1 = \beta_0 <span class="sc">\\</span></span>
<span id="cb92-685"><a href="#cb92-685"></a>H_0 : \beta_0 = 0</span>
<span id="cb92-686"><a href="#cb92-686"></a>$$</span>
<span id="cb92-687"><a href="#cb92-687"></a></span>
<span id="cb92-688"><a href="#cb92-688"></a>The NULL Hypothesis is that there is no difference, **either way**,</span>
<span id="cb92-689"><a href="#cb92-689"></a>between the two samples. Again, in the linear model, we assume as before</span>
<span id="cb92-690"><a href="#cb92-690"></a>that "the explanatory x variable has been equated to zero.</span>
<span id="cb92-691"><a href="#cb92-691"></a></span>
<span id="cb92-692"><a href="#cb92-692"></a>We therefore set <span class="in">`two.sided`</span> and <span class="in">`mu = 0`</span> in the <span class="in">`t.test`</span>.</span>
<span id="cb92-693"><a href="#cb92-693"></a></span>
<span id="cb92-694"><a href="#cb92-694"></a><span class="fu">### Code</span></span>
<span id="cb92-695"><a href="#cb92-695"></a></span>
<span id="cb92-696"><a href="#cb92-696"></a><span class="in">```{r Paired_t_test}</span></span>
<span id="cb92-697"><a href="#cb92-697"></a><span class="co"># Using paired t-test</span></span>
<span id="cb92-698"><a href="#cb92-698"></a>t2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y2, y, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">mu =</span> <span class="dv">0</span>, </span>
<span id="cb92-699"><a href="#cb92-699"></a>             <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb92-700"><a href="#cb92-700"></a>t2</span>
<span id="cb92-701"><a href="#cb92-701"></a><span class="co"># linear model</span></span>
<span id="cb92-702"><a href="#cb92-702"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y2<span class="sc">-</span>y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mydata_wide)</span>
<span id="cb92-703"><a href="#cb92-703"></a>lm2 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb92-704"><a href="#cb92-704"></a>lm2 <span class="sc">%&gt;%</span> <span class="fu">confint</span>()</span>
<span id="cb92-705"><a href="#cb92-705"></a><span class="in">```</span></span>
<span id="cb92-706"><a href="#cb92-706"></a></span>
<span id="cb92-707"><a href="#cb92-707"></a>Both tests report the difference to be 0.2. However the p-value in both</span>
<span id="cb92-708"><a href="#cb92-708"></a>tests is about 0.6, so the result is not statistically significant.</span>
<span id="cb92-709"><a href="#cb92-709"></a></span>
<span id="cb92-710"><a href="#cb92-710"></a><span class="fu">### Example</span></span>
<span id="cb92-711"><a href="#cb92-711"></a></span>
<span id="cb92-712"><a href="#cb92-712"></a><span class="fu">## Wilcoxon Paired Test {.tabset}</span></span>
<span id="cb92-713"><a href="#cb92-713"></a></span>
<span id="cb92-714"><a href="#cb92-714"></a>When the original data is not normally distributed or has outliers etc,.</span>
<span id="cb92-715"><a href="#cb92-715"></a>we use a nonparametric Wilcoxon paired test. The difference between the</span>
<span id="cb92-716"><a href="#cb92-716"></a>paired and unpaired Wilcoxon test is that the test is run on the</span>
<span id="cb92-717"><a href="#cb92-717"></a>signed-ranks of the **pairwise differences** y2- y.</span>
<span id="cb92-718"><a href="#cb92-718"></a></span>
<span id="cb92-719"><a href="#cb92-719"></a><span class="fu">### Model</span></span>
<span id="cb92-720"><a href="#cb92-720"></a></span>
<span id="cb92-721"><a href="#cb92-721"></a>\$\$ signed_rank(y2 - y1) = \beta<span class="sc">\_</span>0 <span class="sc">\\</span></span>
<span id="cb92-722"><a href="#cb92-722"></a></span>
<span id="cb92-723"><a href="#cb92-723"></a>H_0: \beta<span class="sc">\_</span>0 = 0</span>
<span id="cb92-724"><a href="#cb92-724"></a></span>
<span id="cb92-725"><a href="#cb92-725"></a>\$\$</span>
<span id="cb92-726"><a href="#cb92-726"></a></span>
<span id="cb92-727"><a href="#cb92-727"></a><span class="fu">### Code</span></span>
<span id="cb92-728"><a href="#cb92-728"></a></span>
<span id="cb92-729"><a href="#cb92-729"></a><span class="in">```{r Paired_Wilcoxon_Test}</span></span>
<span id="cb92-730"><a href="#cb92-730"></a><span class="co"># Paired Wilcoxon Test</span></span>
<span id="cb92-731"><a href="#cb92-731"></a>w4 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y, y2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb92-732"><a href="#cb92-732"></a>w4</span>
<span id="cb92-733"><a href="#cb92-733"></a></span>
<span id="cb92-734"><a href="#cb92-734"></a><span class="co"># Linear Model</span></span>
<span id="cb92-735"><a href="#cb92-735"></a>lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(y2<span class="sc">-</span>y) <span class="sc">~</span> <span class="dv">1</span> , <span class="at">data =</span> mydata_wide)</span>
<span id="cb92-736"><a href="#cb92-736"></a>lm4 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb92-737"><a href="#cb92-737"></a></span>
<span id="cb92-738"><a href="#cb92-738"></a><span class="co"># t-test with Signed Rank</span></span>
<span id="cb92-739"><a href="#cb92-739"></a>t4 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="fu">signed_rank</span>(y2<span class="sc">-</span>y), <span class="at">mu =</span> <span class="dv">0</span> , <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb92-740"><a href="#cb92-740"></a>t4</span>
<span id="cb92-741"><a href="#cb92-741"></a><span class="in">```</span></span>
<span id="cb92-742"><a href="#cb92-742"></a></span>
<span id="cb92-743"><a href="#cb92-743"></a>Here too, the p-values reported by the three tests are p = 0.779 so the</span>
<span id="cb92-744"><a href="#cb92-744"></a>difference reported is not significant.</span>
<span id="cb92-745"><a href="#cb92-745"></a></span>
<span id="cb92-746"><a href="#cb92-746"></a><span class="fu">### Example</span></span>
<span id="cb92-747"><a href="#cb92-747"></a></span>
<span id="cb92-748"><a href="#cb92-748"></a><span class="fu"># Tests with Two Means {.tabset}</span></span>
<span id="cb92-749"><a href="#cb92-749"></a></span>
<span id="cb92-750"><a href="#cb92-750"></a>When we have two independent samples and these are *not paired* as</span>
<span id="cb92-751"><a href="#cb92-751"></a>earlier. The intent is to test if there is a significant difference to</span>
<span id="cb92-752"><a href="#cb92-752"></a>their means. An example is identical measurements on two sets of</span>
<span id="cb92-753"><a href="#cb92-753"></a>subjects.</span>
<span id="cb92-754"><a href="#cb92-754"></a></span>
<span id="cb92-755"><a href="#cb92-755"></a>There is considerable discussion on what test to use when: 1.If</span>
<span id="cb92-756"><a href="#cb92-756"></a>variances are equal between samples, observations are normally</span>
<span id="cb92-757"><a href="#cb92-757"></a>distributed within groups, no outliers, then <span class="in">`independent t-test`</span> 2. If</span>
<span id="cb92-758"><a href="#cb92-758"></a>unequal variance, <span class="in">`t-test`</span> with <span class="in">`Welch correction`</span> ( Welch's t-test) 3.</span>
<span id="cb92-759"><a href="#cb92-759"></a>If samples are not normal, then nonparametric test ( Wilcoxon with two</span>
<span id="cb92-760"><a href="#cb92-760"></a>samples = <span class="in">`Mann-Whitney test`</span>). Symmetry of the distribution is assumed</span>
<span id="cb92-761"><a href="#cb92-761"></a>here.</span>
<span id="cb92-762"><a href="#cb92-762"></a></span>
<span id="cb92-763"><a href="#cb92-763"></a><span class="fu">## Dummy Group Variable Concept</span></span>
<span id="cb92-764"><a href="#cb92-764"></a></span>
<span id="cb92-765"><a href="#cb92-765"></a>An important construct here is the **dummy variable**. When there is</span>
<span id="cb92-766"><a href="#cb92-766"></a>more than one group in the data, a dummy *categorical variable* is set</span>
<span id="cb92-767"><a href="#cb92-767"></a>up, whose entries specify the group ID. The group IDs are **still</span>
<span id="cb92-768"><a href="#cb92-768"></a>numerical** ( as with factors, remember ). The dummy variable is plotted</span>
<span id="cb92-769"><a href="#cb92-769"></a>on the x-axis. The consecutive IDs in the dummy variable x are separated</span>
<span id="cb92-770"><a href="#cb92-770"></a>by *1*. Hence the *between-groups difference* in the stat measures</span>
<span id="cb92-771"><a href="#cb92-771"></a>computed on y are numerically equivalent to the **slope** in the linear</span>
<span id="cb92-772"><a href="#cb92-772"></a>model. Thus the *dummy variable* allows us to <span class="sc">\*\*</span>mathematically<span class="sc">\*</span> use</span>
<span id="cb92-773"><a href="#cb92-773"></a>the linear model, as presented in the equations above.</span>
<span id="cb92-774"><a href="#cb92-774"></a></span>
<span id="cb92-775"><a href="#cb92-775"></a>Dummy variables become even more useful when the explanatory variable (</span>
<span id="cb92-776"><a href="#cb92-776"></a>"x-planatory" ) is already categorical, as with ANOVA and friends.</span>
<span id="cb92-777"><a href="#cb92-777"></a></span>
<span id="cb92-778"><a href="#cb92-778"></a>We can visualize this as follows:</span>
<span id="cb92-779"><a href="#cb92-779"></a></span>
<span id="cb92-780"><a href="#cb92-780"></a><span class="in">```{r Independent_Data_Plots}</span></span>
<span id="cb92-781"><a href="#cb92-781"></a>mydata_wide_new <span class="ot">&lt;-</span> </span>
<span id="cb92-782"><a href="#cb92-782"></a>  <span class="fu">tibble</span>(<span class="at">y1 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.5</span>),</span>
<span id="cb92-783"><a href="#cb92-783"></a>         <span class="at">y2 =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="fl">1.2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb92-784"><a href="#cb92-784"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(y1, y2),</span>
<span id="cb92-785"><a href="#cb92-785"></a>               <span class="at">names_to =</span> <span class="st">"variable"</span>,  </span>
<span id="cb92-786"><a href="#cb92-786"></a>               <span class="at">values_to =</span> <span class="st">"values"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-787"><a href="#cb92-787"></a>  <span class="fu">cbind</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">50</span>))</span>
<span id="cb92-788"><a href="#cb92-788"></a></span>
<span id="cb92-789"><a href="#cb92-789"></a>mydata_wide_new <span class="sc">%&gt;%</span> </span>
<span id="cb92-790"><a href="#cb92-790"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> values)) <span class="sc">+</span> </span>
<span id="cb92-791"><a href="#cb92-791"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb92-792"><a href="#cb92-792"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">geom =</span><span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb92-793"><a href="#cb92-793"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom=</span> <span class="st">"line"</span>, <span class="at">colour =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb92-794"><a href="#cb92-794"></a>  <span class="fu">xlab</span>(<span class="st">"Dummy Variable to show groups"</span>) <span class="sc">+</span></span>
<span id="cb92-795"><a href="#cb92-795"></a>  <span class="fu">ylab</span>(<span class="st">"y1 and y2, on the same scale"</span>) <span class="sc">+</span></span>
<span id="cb92-796"><a href="#cb92-796"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">"Dummy Variable x_i  [0,1]"</span>,</span>
<span id="cb92-797"><a href="#cb92-797"></a>                <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb92-798"><a href="#cb92-798"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">label =</span> <span class="st">"Difference in means </span><span class="sc">\n</span><span class="st"> equals slope in linear model"</span>) </span>
<span id="cb92-799"><a href="#cb92-799"></a><span class="co"># Need to use `glue` here to add more annotations</span></span>
<span id="cb92-800"><a href="#cb92-800"></a><span class="co"># Math annotation on graphs</span></span>
<span id="cb92-801"><a href="#cb92-801"></a></span>
<span id="cb92-802"><a href="#cb92-802"></a><span class="in">```</span></span>
<span id="cb92-803"><a href="#cb92-803"></a></span>
<span id="cb92-804"><a href="#cb92-804"></a><span class="fu">## Model</span></span>
<span id="cb92-805"><a href="#cb92-805"></a></span>
<span id="cb92-806"><a href="#cb92-806"></a>$$</span>
<span id="cb92-807"><a href="#cb92-807"></a>y_i = \beta_0 + \beta_1 * x_i <span class="sc">\\</span></span>
<span id="cb92-808"><a href="#cb92-808"></a>where<span class="sc">\\</span></span>
<span id="cb92-809"><a href="#cb92-809"></a>x_i= \left<span class="sc">\{</span>\begin{matrix}</span>
<span id="cb92-810"><a href="#cb92-810"></a>1\ when\ x\ \in\ Group 1<span class="sc">\\</span> </span>
<span id="cb92-811"><a href="#cb92-811"></a>0\ when\ x\ \in\ Group2</span>
<span id="cb92-812"><a href="#cb92-812"></a>\end{matrix}\right.</span>
<span id="cb92-813"><a href="#cb92-813"></a>$$</span>
<span id="cb92-814"><a href="#cb92-814"></a></span>
<span id="cb92-815"><a href="#cb92-815"></a><span class="fu">#  {.unnumbered}</span></span>
<span id="cb92-816"><a href="#cb92-816"></a></span>
<span id="cb92-817"><a href="#cb92-817"></a>Let us now look at the tests.</span>
<span id="cb92-818"><a href="#cb92-818"></a></span>
<span id="cb92-819"><a href="#cb92-819"></a><span class="fu">## Independent t-test {.tabset}</span></span>
<span id="cb92-820"><a href="#cb92-820"></a></span>
<span id="cb92-821"><a href="#cb92-821"></a><span class="fu">### Model</span></span>
<span id="cb92-822"><a href="#cb92-822"></a></span>
<span id="cb92-823"><a href="#cb92-823"></a>The assumptions here are: - both data sets are normally distributed.</span>
<span id="cb92-824"><a href="#cb92-824"></a>Small samples may be assumned to be <span class="in">`t-distributed`</span> - variances are the</span>
<span id="cb92-825"><a href="#cb92-825"></a>same - no outliers - observations across data sets are independent</span>
<span id="cb92-826"><a href="#cb92-826"></a>(obviously)</span>
<span id="cb92-827"><a href="#cb92-827"></a></span>
<span id="cb92-828"><a href="#cb92-828"></a>$$</span>
<span id="cb92-829"><a href="#cb92-829"></a>y_i = \beta_0 + \beta_1 * x_i <span class="sc">\\</span></span>
<span id="cb92-830"><a href="#cb92-830"></a>where <span class="sc">\\</span></span>
<span id="cb92-831"><a href="#cb92-831"></a>x_i= \left<span class="sc">\{</span>\begin{matrix}</span>
<span id="cb92-832"><a href="#cb92-832"></a>1\ when\ x\ \in\ Group 1<span class="sc">\\</span> </span>
<span id="cb92-833"><a href="#cb92-833"></a>0\ when\ x\ \in\ Group2</span>
<span id="cb92-834"><a href="#cb92-834"></a>\end{matrix}\right.</span>
<span id="cb92-835"><a href="#cb92-835"></a><span class="sc">\\</span></span>
<span id="cb92-836"><a href="#cb92-836"></a>H_0 : \beta_1 = 0</span>
<span id="cb92-837"><a href="#cb92-837"></a>$$</span>
<span id="cb92-838"><a href="#cb92-838"></a></span>
<span id="cb92-839"><a href="#cb92-839"></a>The t.test computes a statistic as follows:</span>
<span id="cb92-840"><a href="#cb92-840"></a></span>
<span id="cb92-841"><a href="#cb92-841"></a>$$</span>
<span id="cb92-842"><a href="#cb92-842"></a>t \ \ = \mod(\bar{x_1}\ - \bar{x_2}) / std.error(\bar{x_1}\ - \bar{x_2}) <span class="sc">\\</span></span>
<span id="cb92-843"><a href="#cb92-843"></a>= \mod(\bar{x_1} - \bar{x_2})\ / \sqrt{s_x^2 /n_x + s_y^2/n_y}  <span class="sc">\\</span></span>
<span id="cb92-844"><a href="#cb92-844"></a>and<span class="sc">\\</span></span>
<span id="cb92-845"><a href="#cb92-845"></a>df = n_1 + n_2 - 2\ \ \ \ ( degrees\ of\ freedom)</span>
<span id="cb92-846"><a href="#cb92-846"></a>$$</span>
<span id="cb92-847"><a href="#cb92-847"></a></span>
<span id="cb92-848"><a href="#cb92-848"></a>The t-test uses an approximation to the sampling distribution of the</span>
<span id="cb92-849"><a href="#cb92-849"></a>difference in sample means based on the Central Limit Theorem, which</span>
<span id="cb92-850"><a href="#cb92-850"></a>ensures that for sufficiently large samples, the sampling distribution</span>
<span id="cb92-851"><a href="#cb92-851"></a>will be very close to Normal. The mean of the sampling distribution will</span>
<span id="cb92-852"><a href="#cb92-852"></a>be the difference in (underlying) population means, and the variance of</span>
<span id="cb92-853"><a href="#cb92-853"></a>the sampling distribution will be the standard error of the difference</span>
<span id="cb92-854"><a href="#cb92-854"></a>in sample means.</span>
<span id="cb92-855"><a href="#cb92-855"></a></span>
<span id="cb92-856"><a href="#cb92-856"></a>For the <span class="in">`t-statistic`</span>, note that the numerator of the formula is the</span>
<span id="cb92-857"><a href="#cb92-857"></a>difference between means. The denominator is a measurement of</span>
<span id="cb92-858"><a href="#cb92-858"></a>experimental error in the two groups combined. The wider the difference</span>
<span id="cb92-859"><a href="#cb92-859"></a>between means, the more confident you are in the data. The more</span>
<span id="cb92-860"><a href="#cb92-860"></a>experimental error you have, the less confident you are in the data.</span>
<span id="cb92-861"><a href="#cb92-861"></a>Thus the higher the value of t, the greater the confidence that there is</span>
<span id="cb92-862"><a href="#cb92-862"></a>a difference.</span>
<span id="cb92-863"><a href="#cb92-863"></a></span>
<span id="cb92-864"><a href="#cb92-864"></a>The <span class="in">`t-statistic`</span> has a t-distribution. It is compared to a *critical</span>
<span id="cb92-865"><a href="#cb92-865"></a>value* of t, for a given probability value ( 0.05 usually). If the</span>
<span id="cb92-866"><a href="#cb92-866"></a>calculated t exceeds the critical value, we can assert that the NULL</span>
<span id="cb92-867"><a href="#cb92-867"></a>Hypothesis can be rejected and there could be a significant difference</span>
<span id="cb92-868"><a href="#cb92-868"></a>in means. <span class="al">![t-distribution curves](t-distribution.png)</span></span>
<span id="cb92-869"><a href="#cb92-869"></a></span>
<span id="cb92-870"><a href="#cb92-870"></a><span class="fu">### Code</span></span>
<span id="cb92-871"><a href="#cb92-871"></a></span>
<span id="cb92-874"><a href="#cb92-874"></a><span class="in">```{r}</span></span>
<span id="cb92-875"><a href="#cb92-875"></a><span class="co"># Independent t-test</span></span>
<span id="cb92-876"><a href="#cb92-876"></a>t5 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y2, y, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb92-877"><a href="#cb92-877"></a>t5 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() </span>
<span id="cb92-878"><a href="#cb92-878"></a></span>
<span id="cb92-879"><a href="#cb92-879"></a><span class="co"># Welch test when variances are not equal</span></span>
<span id="cb92-880"><a href="#cb92-880"></a>t6 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y2,y, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb92-881"><a href="#cb92-881"></a>t6 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span>
<span id="cb92-882"><a href="#cb92-882"></a></span>
<span id="cb92-883"><a href="#cb92-883"></a><span class="co"># Linear Model with Dummy variable</span></span>
<span id="cb92-884"><a href="#cb92-884"></a><span class="co"># lm(value ~ 1 + group, data = mydata_long_y) # also works</span></span>
<span id="cb92-885"><a href="#cb92-885"></a>lm6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(group <span class="sc">==</span> <span class="st">"y2"</span>), <span class="at">data =</span> mydata_long_y)</span>
<span id="cb92-886"><a href="#cb92-886"></a>lm6 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span>
<span id="cb92-887"><a href="#cb92-887"></a><span class="in">```</span></span>
<span id="cb92-888"><a href="#cb92-888"></a></span>
<span id="cb92-889"><a href="#cb92-889"></a>We get the same estimates for means of y and y2 ( 0.3 and 0.5</span>
<span id="cb92-890"><a href="#cb92-890"></a>respectively).</span>
<span id="cb92-891"><a href="#cb92-891"></a></span>
<span id="cb92-892"><a href="#cb92-892"></a><span class="fu">### Example</span></span>
<span id="cb92-893"><a href="#cb92-893"></a></span>
<span id="cb92-894"><a href="#cb92-894"></a><span class="fu">## Welch's t-test {.tabset}</span></span>
<span id="cb92-895"><a href="#cb92-895"></a></span>
<span id="cb92-896"><a href="#cb92-896"></a><span class="fu">### Model</span></span>
<span id="cb92-897"><a href="#cb92-897"></a></span>
<span id="cb92-898"><a href="#cb92-898"></a>Welch's test we have already explored as a variant of the t.test for two</span>
<span id="cb92-899"><a href="#cb92-899"></a>means, with variances unequal.</span>
<span id="cb92-900"><a href="#cb92-900"></a></span>
<span id="cb92-901"><a href="#cb92-901"></a>Welch's test is also stated as a *Generalized* Linear Model using, not</span>
<span id="cb92-902"><a href="#cb92-902"></a><span class="in">`lm`</span> but the <span class="in">`gls`</span> command from the <span class="in">`nlme`</span> package. This is explained on</span>
<span id="cb92-903"><a href="#cb92-903"></a><span class="co">[</span><span class="ot">StackExchange</span><span class="co">](https://stats.stackexchange.com/questions/142685/equivalent-to-welchs-t-test-in-gls-framework)</span></span>
<span id="cb92-904"><a href="#cb92-904"></a>but we need not digress now.</span>
<span id="cb92-905"><a href="#cb92-905"></a></span>
<span id="cb92-906"><a href="#cb92-906"></a>When the variances are unequal, there is a difference in the t-statistic</span>
<span id="cb92-907"><a href="#cb92-907"></a>that is computed *only* when the group <span class="sc">\*\*</span>sizes<span class="sc">\*</span> are different (</span>
<span id="cb92-908"><a href="#cb92-908"></a>Denominator of t-statistic ).</span>
<span id="cb92-909"><a href="#cb92-909"></a></span>
<span id="cb92-910"><a href="#cb92-910"></a>From StackExchange:\</span>
<span id="cb92-911"><a href="#cb92-911"></a>$$</span>
<span id="cb92-912"><a href="#cb92-912"></a>t_w =\ \frac {\bar{x_1}-\bar{x_2}}{\sqrt{{s_1^2/n_1}{s_2^2/n_2}}} </span>
<span id="cb92-913"><a href="#cb92-913"></a><span class="sc">\\\\</span></span>
<span id="cb92-914"><a href="#cb92-914"></a>=\ \frac{\bar{x_1}-\bar{x_2}} {{\sqrt{\frac{s_1^2 + s_2^2}{n}}}} </span>
<span id="cb92-915"><a href="#cb92-915"></a><span class="sc">\\\\</span></span>
<span id="cb92-916"><a href="#cb92-916"></a>=\ \frac{\bar{x_1}-\bar{x_2}} {{\sqrt{\frac{s_1^2 + s_2^2} {2} * (\frac{2}{n})}}} </span>
<span id="cb92-917"><a href="#cb92-917"></a><span class="sc">\\\\</span></span>
<span id="cb92-918"><a href="#cb92-918"></a>=\ t_s</span>
<span id="cb92-919"><a href="#cb92-919"></a>$$</span>
<span id="cb92-920"><a href="#cb92-920"></a></span>
<span id="cb92-921"><a href="#cb92-921"></a>So under these conditions the t-statistic for the Welch t-test is the</span>
<span id="cb92-922"><a href="#cb92-922"></a>same as that for the standard t-test.</span>
<span id="cb92-923"><a href="#cb92-923"></a></span>
<span id="cb92-924"><a href="#cb92-924"></a><span class="fu">### Code</span></span>
<span id="cb92-925"><a href="#cb92-925"></a></span>
<span id="cb92-926"><a href="#cb92-926"></a><span class="in">```{r Welch_independent_sample_t_test}</span></span>
<span id="cb92-927"><a href="#cb92-927"></a>t7 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y, y2, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb92-928"><a href="#cb92-928"></a><span class="in">```</span></span>
<span id="cb92-929"><a href="#cb92-929"></a></span>
<span id="cb92-930"><a href="#cb92-930"></a><span class="fu">### Example</span></span>
<span id="cb92-931"><a href="#cb92-931"></a></span>
<span id="cb92-932"><a href="#cb92-932"></a><span class="fu">## Mann-Whitney U Test {.tabset}</span></span>
<span id="cb92-933"><a href="#cb92-933"></a></span>
<span id="cb92-934"><a href="#cb92-934"></a>(Wilcoxon Independent Sample test)</span>
<span id="cb92-935"><a href="#cb92-935"></a></span>
<span id="cb92-936"><a href="#cb92-936"></a>As before, when sample groups are not normally distributed, and when</span>
<span id="cb92-937"><a href="#cb92-937"></a>variances are different, and they are outliers, a nonparametric rank-sum</span>
<span id="cb92-938"><a href="#cb92-938"></a>test is preferred. This is the same as the Wilcoxon Test for independent</span>
<span id="cb92-939"><a href="#cb92-939"></a>variables, and is called the Mann-Whitney Test.</span>
<span id="cb92-940"><a href="#cb92-940"></a></span>
<span id="cb92-941"><a href="#cb92-941"></a><span class="fu">### Model</span></span>
<span id="cb92-942"><a href="#cb92-942"></a></span>
<span id="cb92-943"><a href="#cb92-943"></a>As before:</span>
<span id="cb92-944"><a href="#cb92-944"></a></span>
<span id="cb92-945"><a href="#cb92-945"></a>$$</span>
<span id="cb92-946"><a href="#cb92-946"></a>rank(y_i) = \beta_0 + \beta_1 * rank(x_i) <span class="sc">\\</span></span>
<span id="cb92-947"><a href="#cb92-947"></a>where <span class="sc">\\</span></span>
<span id="cb92-948"><a href="#cb92-948"></a>x_i= \left<span class="sc">\{</span>\begin{matrix}</span>
<span id="cb92-949"><a href="#cb92-949"></a>1\ when\ x\ \in\ Group 1<span class="sc">\\</span> </span>
<span id="cb92-950"><a href="#cb92-950"></a>0\ when\ x\ \in\ Group2</span>
<span id="cb92-951"><a href="#cb92-951"></a>\end{matrix}\right.</span>
<span id="cb92-952"><a href="#cb92-952"></a><span class="sc">\\</span></span>
<span id="cb92-953"><a href="#cb92-953"></a>H_0 : \beta_1 = 0</span>
<span id="cb92-954"><a href="#cb92-954"></a>$$</span>
<span id="cb92-955"><a href="#cb92-955"></a></span>
<span id="cb92-956"><a href="#cb92-956"></a><span class="fu">### Code</span></span>
<span id="cb92-957"><a href="#cb92-957"></a></span>
<span id="cb92-958"><a href="#cb92-958"></a><span class="in">```{r Mann_Whitney_U_Test}</span></span>
<span id="cb92-959"><a href="#cb92-959"></a><span class="co"># As Wilcoxon Test</span></span>
<span id="cb92-960"><a href="#cb92-960"></a>w5 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y2,y, <span class="at">paired =</span> <span class="cn">FALSE</span>)</span>
<span id="cb92-961"><a href="#cb92-961"></a>w5 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span>
<span id="cb92-962"><a href="#cb92-962"></a></span>
<span id="cb92-963"><a href="#cb92-963"></a><span class="co"># As Linear model</span></span>
<span id="cb92-964"><a href="#cb92-964"></a>lm5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">rank</span>(value) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(group <span class="sc">==</span> <span class="st">"y2"</span>), </span>
<span id="cb92-965"><a href="#cb92-965"></a>          <span class="at">data =</span> mydata_long_y)</span>
<span id="cb92-966"><a href="#cb92-966"></a>lm5 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span>
<span id="cb92-967"><a href="#cb92-967"></a><span class="in">```</span></span>
<span id="cb92-968"><a href="#cb92-968"></a></span>
<span id="cb92-969"><a href="#cb92-969"></a>Not clear how to explain this. Need to dig more into Mann-Whitney.</span>
<span id="cb92-970"><a href="#cb92-970"></a></span>
<span id="cb92-971"><a href="#cb92-971"></a><span class="fu">### Example</span></span>
<span id="cb92-972"><a href="#cb92-972"></a></span>
<span id="cb92-973"><a href="#cb92-973"></a><span class="fu"># Tests with Three or More Means {.tabset}</span></span>
<span id="cb92-974"><a href="#cb92-974"></a></span>
<span id="cb92-975"><a href="#cb92-975"></a><span class="fu">## Model</span></span>
<span id="cb92-976"><a href="#cb92-976"></a></span>
<span id="cb92-977"><a href="#cb92-977"></a>ANOVAs are linear models with (only) categorical predictors so they</span>
<span id="cb92-978"><a href="#cb92-978"></a>simply extend everything we did above, relying heavily on dummy coding.</span>
<span id="cb92-979"><a href="#cb92-979"></a></span>
<span id="cb92-980"><a href="#cb92-980"></a><span class="fu">## One-way ANOVA {.tabset}</span></span>
<span id="cb92-981"><a href="#cb92-981"></a></span>
<span id="cb92-982"><a href="#cb92-982"></a><span class="fu">### Model</span></span>
<span id="cb92-983"><a href="#cb92-983"></a></span>
<span id="cb92-984"><a href="#cb92-984"></a>One mean for each group predicts y.</span>
<span id="cb92-985"><a href="#cb92-985"></a></span>
<span id="cb92-986"><a href="#cb92-986"></a>$$</span>
<span id="cb92-987"><a href="#cb92-987"></a>y=\beta_0 + \beta_1*x_1 + \beta_2*x_2...+\beta_n*x_n<span class="sc">\\</span></span>
<span id="cb92-988"><a href="#cb92-988"></a>H0:y=β0</span>
<span id="cb92-989"><a href="#cb92-989"></a>$$</span>
<span id="cb92-990"><a href="#cb92-990"></a></span>
<span id="cb92-991"><a href="#cb92-991"></a>where $x_i$ are indicators (x=0 or x=1) where at most one $x_i=1$ while</span>
<span id="cb92-992"><a href="#cb92-992"></a>all others are $x_i=0$.</span>
<span id="cb92-993"><a href="#cb92-993"></a></span>
<span id="cb92-994"><a href="#cb92-994"></a>Notice how this is just "more of the same" of what we already did in</span>
<span id="cb92-995"><a href="#cb92-995"></a>other models above. When there are only two groups, this model is</span>
<span id="cb92-996"><a href="#cb92-996"></a>$y=β0+β1∗x$, i.e. the *independent t-test*. If there is only one group,</span>
<span id="cb92-997"><a href="#cb92-997"></a>it is $y=β0$, i.e. the *one-sample t-test*. This makes *one-way ANOVA* a</span>
<span id="cb92-998"><a href="#cb92-998"></a>**multiple regression** model.</span>
<span id="cb92-999"><a href="#cb92-999"></a></span>
<span id="cb92-1000"><a href="#cb92-1000"></a>This is easy to see in the visualization below - just cover up a few</span>
<span id="cb92-1001"><a href="#cb92-1001"></a>groups and see that it matches the other visualizations above. Let's</span>
<span id="cb92-1002"><a href="#cb92-1002"></a>visualize this using toy data:</span>
<span id="cb92-1003"><a href="#cb92-1003"></a></span>
<span id="cb92-1004"><a href="#cb92-1004"></a><span class="in">```{r Visualizing_One_way_ANOVA}</span></span>
<span id="cb92-1005"><a href="#cb92-1005"></a>N <span class="ot">=</span> <span class="dv">15</span></span>
<span id="cb92-1006"><a href="#cb92-1006"></a>D_anova1 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb92-1007"><a href="#cb92-1007"></a>  <span class="at">y =</span> <span class="fu">c</span>(</span>
<span id="cb92-1008"><a href="#cb92-1008"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="fl">0.5</span>, <span class="fl">0.3</span>),</span>
<span id="cb92-1009"><a href="#cb92-1009"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="dv">0</span>, <span class="fl">0.3</span>),</span>
<span id="cb92-1010"><a href="#cb92-1010"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="dv">1</span>, <span class="fl">0.3</span>),</span>
<span id="cb92-1011"><a href="#cb92-1011"></a>    <span class="fu">rnorm_fixed</span>(N, <span class="fl">0.8</span>, <span class="fl">0.3</span>)</span>
<span id="cb92-1012"><a href="#cb92-1012"></a>  ),</span>
<span id="cb92-1013"><a href="#cb92-1013"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">15</span>)</span>
<span id="cb92-1014"><a href="#cb92-1014"></a>)</span>
<span id="cb92-1015"><a href="#cb92-1015"></a>ymeans <span class="ot">=</span> <span class="fu">aggregate</span>(y<span class="sc">~</span>x, D_anova1, mean)<span class="sc">$</span>y</span>
<span id="cb92-1016"><a href="#cb92-1016"></a>P_anova1 <span class="ot">=</span> <span class="fu">ggplot</span>(D_anova1, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> </span>
<span id="cb92-1017"><a href="#cb92-1017"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span>mean, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> ..y.., <span class="at">ymin =</span> ..y.., <span class="at">color=</span><span class="st">'intercepts'</span>), <span class="at">lwd=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb92-1018"><a href="#cb92-1018"></a>  </span>
<span id="cb92-1019"><a href="#cb92-1019"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">xend =</span> <span class="dv">100</span>, </span>
<span id="cb92-1020"><a href="#cb92-1020"></a>               <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">yend =</span> <span class="fl">0.5</span>, </span>
<span id="cb92-1021"><a href="#cb92-1021"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'beta_0'</span>)) <span class="sc">+</span></span>
<span id="cb92-1022"><a href="#cb92-1022"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">xend =</span> <span class="dv">1</span>, </span>
<span id="cb92-1023"><a href="#cb92-1023"></a>               <span class="at">y =</span> ymeans[<span class="dv">1</span>], <span class="at">yend =</span> ymeans[<span class="dv">2</span>], </span>
<span id="cb92-1024"><a href="#cb92-1024"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'betas'</span>)) <span class="sc">+</span></span>
<span id="cb92-1025"><a href="#cb92-1025"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="dv">2</span>, </span>
<span id="cb92-1026"><a href="#cb92-1026"></a>               <span class="at">y =</span> ymeans[<span class="dv">1</span>], <span class="at">yend =</span> ymeans[<span class="dv">3</span>], </span>
<span id="cb92-1027"><a href="#cb92-1027"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'betas'</span>)) <span class="sc">+</span></span>
<span id="cb92-1028"><a href="#cb92-1028"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">xend =</span> <span class="dv">3</span>, </span>
<span id="cb92-1029"><a href="#cb92-1029"></a>               <span class="at">y =</span> ymeans[<span class="dv">1</span>], <span class="at">yend =</span> ymeans[<span class="dv">4</span>], </span>
<span id="cb92-1030"><a href="#cb92-1030"></a>               <span class="at">lwd =</span> <span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">'betas'</span>)) <span class="sc">+</span></span>
<span id="cb92-1031"><a href="#cb92-1031"></a>  </span>
<span id="cb92-1032"><a href="#cb92-1032"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, </span>
<span id="cb92-1033"><a href="#cb92-1033"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"darkblue"</span>),</span>
<span id="cb92-1034"><a href="#cb92-1034"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">bquote</span>(beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">" (group 1 mean)"</span>),</span>
<span id="cb92-1035"><a href="#cb92-1035"></a>                              <span class="fu">bquote</span>(beta[<span class="dv">1</span>]<span class="sc">*</span><span class="st">", "</span><span class="sc">*</span>beta[<span class="dv">2</span>]<span class="sc">*</span><span class="st">", </span></span>
<span id="cb92-1036"><a href="#cb92-1036"></a><span class="st">                                     etc. (slopes/differences to "</span><span class="sc">*</span>beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">")"</span>),</span>
<span id="cb92-1037"><a href="#cb92-1037"></a>      <span class="fu">bquote</span>(beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">"+"</span><span class="sc">*</span>beta[<span class="dv">1</span>]<span class="sc">*</span><span class="st">", "</span><span class="sc">*</span>beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">"+"</span><span class="sc">*</span>beta[<span class="dv">2</span>]<span class="sc">*</span><span class="st">", etc. (group 2, 3, ... means)"</span>)</span>
<span id="cb92-1038"><a href="#cb92-1038"></a>    )</span>
<span id="cb92-1039"><a href="#cb92-1039"></a>  )</span>
<span id="cb92-1040"><a href="#cb92-1040"></a>P_anova1</span>
<span id="cb92-1041"><a href="#cb92-1041"></a><span class="in">```</span></span>
<span id="cb92-1042"><a href="#cb92-1042"></a></span>
<span id="cb92-1043"><a href="#cb92-1043"></a><span class="fu">### Code</span></span>
<span id="cb92-1044"><a href="#cb92-1044"></a></span>
<span id="cb92-1045"><a href="#cb92-1045"></a><span class="fu">### Example</span></span>
<span id="cb92-1046"><a href="#cb92-1046"></a></span>
<span id="cb92-1047"><a href="#cb92-1047"></a><span class="fu">## Two-way ANOVA {.tabset}</span></span>
<span id="cb92-1048"><a href="#cb92-1048"></a></span>
<span id="cb92-1049"><a href="#cb92-1049"></a><span class="fu">### Model</span></span>
<span id="cb92-1050"><a href="#cb92-1050"></a></span>
<span id="cb92-1051"><a href="#cb92-1051"></a><span class="fu">### Code</span></span>
<span id="cb92-1052"><a href="#cb92-1052"></a></span>
<span id="cb92-1053"><a href="#cb92-1053"></a><span class="fu">### Example</span></span>
<span id="cb92-1054"><a href="#cb92-1054"></a></span>
<span id="cb92-1055"><a href="#cb92-1055"></a><span class="fu">## ANCOVA {.tabset}</span></span>
<span id="cb92-1056"><a href="#cb92-1056"></a></span>
<span id="cb92-1057"><a href="#cb92-1057"></a><span class="fu">### Model</span></span>
<span id="cb92-1058"><a href="#cb92-1058"></a></span>
<span id="cb92-1059"><a href="#cb92-1059"></a><span class="fu">### Code</span></span>
<span id="cb92-1060"><a href="#cb92-1060"></a></span>
<span id="cb92-1061"><a href="#cb92-1061"></a><span class="fu">### Example</span></span>
<span id="cb92-1062"><a href="#cb92-1062"></a></span>
<span id="cb92-1063"><a href="#cb92-1063"></a><span class="fu"># Proportions {.tabset}</span></span>
<span id="cb92-1064"><a href="#cb92-1064"></a></span>
<span id="cb92-1065"><a href="#cb92-1065"></a><span class="fu">## Model</span></span>
<span id="cb92-1066"><a href="#cb92-1066"></a></span>
<span id="cb92-1067"><a href="#cb92-1067"></a><span class="fu">## Discrete Variables {.tabset}</span></span>
<span id="cb92-1068"><a href="#cb92-1068"></a></span>
<span id="cb92-1069"><a href="#cb92-1069"></a><span class="fu">### Model</span></span>
<span id="cb92-1070"><a href="#cb92-1070"></a></span>
<span id="cb92-1071"><a href="#cb92-1071"></a><span class="fu">### Code</span></span>
<span id="cb92-1072"><a href="#cb92-1072"></a></span>
<span id="cb92-1073"><a href="#cb92-1073"></a><span class="fu">### Example</span></span>
<span id="cb92-1074"><a href="#cb92-1074"></a></span>
<span id="cb92-1075"><a href="#cb92-1075"></a><span class="fu">## Continuous Variables {.tabset}</span></span>
<span id="cb92-1076"><a href="#cb92-1076"></a></span>
<span id="cb92-1077"><a href="#cb92-1077"></a><span class="fu">### Model</span></span>
<span id="cb92-1078"><a href="#cb92-1078"></a></span>
<span id="cb92-1079"><a href="#cb92-1079"></a><span class="fu">### Code</span></span>
<span id="cb92-1080"><a href="#cb92-1080"></a></span>
<span id="cb92-1081"><a href="#cb92-1081"></a><span class="fu">### Example</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>