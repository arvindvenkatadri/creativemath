<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Arvind Venkatadri">
<meta name="dcterms.date" content="2022-11-25">
<meta name="keywords" content="Statistics ; Tests; p-value; Feynman Technique">
<title>The Foundation Series in Quarto - Linear Model: Correlation Test</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="The Foundation Series in Quarto - Linear Model: Correlation Test">
<meta property="og:description" content="This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats.">
<meta property="og:site-name" content="The Foundation Series in Quarto">
<meta name="twitter:title" content="The Foundation Series in Quarto - Linear Model: Correlation Test">
<meta name="twitter:description" content="This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats.">
<meta name="twitter:creator" content="@arvind_v">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">The Foundation Series in Quarto</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/arvindvenkatadri/my-quarto-website"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/arvind_v"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../../../blog.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Linear Model: Correlation Test</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../blog.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Teaching</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/posts/posts.html" class="sidebar-item-text sidebar-link">Posts</a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../content/projects/projects.html" class="sidebar-item-text sidebar-link">Projects</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#the-linear-model" id="toc-the-linear-model" class="nav-link active" data-scroll-target="#the-linear-model">The Linear Model</a></li>
  <li>
<a href="#the-correlation-test" id="toc-the-correlation-test" class="nav-link" data-scroll-target="#the-correlation-test">The Correlation Test</a>
  <ul class="collapse">
<li><a href="#some-toy-data" id="toc-some-toy-data" class="nav-link" data-scroll-target="#some-toy-data">Some Toy Data</a></li>
  </ul>
</li>
  <li>
<a href="#tests-for-correlation" id="toc-tests-for-correlation" class="nav-link" data-scroll-target="#tests-for-correlation">Tests for Correlation</a>
  <ul class="collapse">
<li>
<a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation">Pearson Correlation</a>
  <ul class="collapse">
<li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul>
</li>
  <li>
<a href="#spearman-correlation" id="toc-spearman-correlation" class="nav-link" data-scroll-target="#spearman-correlation">Spearman Correlation</a>
  <ul class="collapse">
<li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1">Model</a></li>
  </ul>
</li>
  <li><a href="#signed-rank-values" id="toc-signed-rank-values" class="nav-link" data-scroll-target="#signed-rank-values">“Signed Rank” Values</a></li>
  <li><a href="#plotting-original-and-signed-rank-data" id="toc-plotting-original-and-signed-rank-data" class="nav-link" data-scroll-target="#plotting-original-and-signed-rank-data">Plotting Original and Signed Rank Data</a></li>
  <li>
<a href="#how-does-sign-rank-data-work" id="toc-how-does-sign-rank-data-work" class="nav-link" data-scroll-target="#how-does-sign-rank-data-work">How does Sign-Rank data work?</a>
  <ul class="collapse">
<li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code">Code</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Linear Model: Correlation Test</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Arvind Venkatadri </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 25, 2022</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">January 12, 2023</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats. The method followed is that of Jonas Lindoloev, wherein every stat test is treated as a linear model <span class="math inline">\(y = mx + c\)</span>
  </div>
</div>

</header><p><i class="fa-solid fa-folder-open" aria-label="folder-open"></i> Slides and Tutorials</p>
<p><a href="./files/cortests.qmd"> <i class="fa-solid fa-file-powerpoint fa-2x"></i></a> .nbsp;.nbsp;</p>
<p><a href="./files/cortests.ows"> <iconify-icon icon="icon-park-solid:orange"></iconify-icon></a> .nbsp;.nbsp;</p>
<p><a href="./files/cortestss.rda"> <i class="fa-solid fa-person-rays"></i></a> .nbsp;.nbsp;</p>
<p><a href="./data/data.zip"> <i class="fa-solid fa-database"></i></a></p>
<section id="the-linear-model" class="level2"><h2 class="anchored" data-anchor-id="the-linear-model">The Linear Model</h2>
<p>The premise here is that <strong>many common statistical tests are special cases of the linear model</strong>. A <strong>linear model</strong> estimates the relationship between dependent variable or “response” variable (<span class="math inline">\(y\)</span>) and an explanatory variable or “predictor” (<span class="math inline">\(x\)</span>). It is assumed that the relationship is <strong>linear</strong>. <span class="math inline">\(\beta_0\)</span> is the <em>intercept</em> and <span class="math inline">\(\beta_1\)</span> is the slope of the linear fit, that <strong>predicts</strong> the value of y based the value of x.</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 *x
\]</span></p>
</section><section id="the-correlation-test" class="level2"><h2 class="anchored" data-anchor-id="the-correlation-test">The Correlation Test</h2>
<p>TBD: Some introductory text here on Correlation itself)</p>
<p>One of the basic Questions we would have of our data is: Does some variable depend upon another in some way? Does <span class="math inline">\(y\)</span> depend upon <span class="math inline">\(x\)</span>?</p>
<p>A <strong>Correlation Test</strong> is designed to answer exactly this question.</p>
<p>Let us now see how a Correlation Test can be re-formulated as a Linear Model + Hypothesis Test.</p>
<section id="some-toy-data" class="level3"><h3 class="anchored" data-anchor-id="some-toy-data">Some Toy Data</h3>
<p>Most examples in this exposition are based on three “imaginary” samples, <span class="math inline">\(x, y1, y2\)</span>. Each is normally distributed and made up of 50 observations. The means and the sds are, respectively:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
     mu    sd
  &lt;dbl&gt; &lt;dbl&gt;
1   0     1  
2   0.3   2  
3   0.5   1.5</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">

</div>
<p>Let us look at our toy data in three ways:</p>
<ol type="1">
<li>All three variables:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 3
    x[,1] y1[,1] y2[,1]
    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1  0.427  1.98   0.103
 2  0.444  1.27  -0.281
 3 -0.828 -0.944  0.624
 4 -0.799  0.103  5.43 
 5 -0.323  2.19   0.168
 6 -1.24   0.192 -0.549
 7 -1.36   4.81   0.309
 8  1.62   1.55  -0.990
 9 -0.292  3.36  -0.172
10 -1.25   1.92  -0.158
# … with 40 more rows</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Variables stacked and labelled (Note: <code>group</code> is now a Qual variable !!)</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 2
   group value[,1]
   &lt;chr&gt;     &lt;dbl&gt;
 1 x         0.427
 2 y1        1.98 
 3 y2        0.103
 4 x         0.444
 5 y1        1.27 
 6 y2       -0.281
 7 x        -0.828
 8 y1       -0.944
 9 y2        0.624
10 x        -0.799
# … with 140 more rows</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Same as 2, but only for the dependent <code>y</code> variables:</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 2
   group value[,1]
   &lt;chr&gt;     &lt;dbl&gt;
 1 y1        1.98 
 2 y2        0.103
 3 y1        1.27 
 4 y2       -0.281
 5 y1       -0.944
 6 y2        0.624
 7 y1        0.103
 8 y2        5.43 
 9 y1        2.19 
10 y2        0.168
# … with 90 more rows</code></pre>
</div>
</div>
</section></section><section id="tests-for-correlation" class="level1"><h1>Tests for Correlation</h1>
<p>Correlation <strong>r</strong> is a measure of <em>strength</em> and <em>direction</em> of <em>linear association</em> between two variables. <strong>r</strong> is between <span class="math inline">\([-1,+1]\)</span>, with <span class="math inline">\(0\)</span> implying no association/correlation.</p>
<p>From this definition, the <em>linear model</em> lends itself in a straightforward way as a model to interpret <em>correlation</em>. Intuitively, the slope of the linear model could be related to the correlation between y and x.</p>
<p>Now we look at the numbers.</p>
<section id="pearson-correlation" class="level2"><h2 class="anchored" data-anchor-id="pearson-correlation">Pearson Correlation</h2>
<section id="model" class="level3"><h3 class="anchored" data-anchor-id="model">Model</h3>
<p>The model for Pearson Correlation tests is exactly the Linear Model:</p>
<p><span class="math display">\[
\begin{aligned}
y = \beta_0 + \beta_1 \times x\\
\\
H_0: Null\ Hypothesis\ =&gt; \beta_1 = 0\\\
H_a: Alternate\ Hypothesis\ =&gt; \beta_1 \ne 0\\
\end{aligned}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  term                  estimate p.value
  &lt;chr&gt;                    &lt;dbl&gt;   &lt;dbl&gt;
1 Pearson Correlation r   -0.232   0.105</code></pre>
</div>
</div>
<p>Using the <em>linear model</em> method we get:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  term   estimate p.value
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 beta_0    0.3     0.286
2 beta_1   -0.464   0.105</code></pre>
</div>
</div>
<p>Why are <span class="math inline">\(r\)</span> and <span class="math inline">\(\beta_1\)</span> different, though the <code>p-value</code> is suspiciously the same!?</p>
<p>Did we miss a factor of <span class="math inline">\(\frac{-0.463}{-0.231} = 2\)</span> somewhere…??</p>
<p>Let us <strong>scale</strong> the variables to within <code>{-1, +1}</code> : (subtract the mean and divide by sd) and re-do the Linear Model with <strong>scaled</strong> versions <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  term    estimate p.value
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
1 beta_0 -9.06e-17   1    
2 beta_1 -2.32e- 1   0.105</code></pre>
</div>
</div>
<p>So we conclude:</p>
<ol type="1">
<li><p><strong>When both x and y have the same standard deviation, the slope from the linear model and the Pearson correlation are the same</strong>. Here, since x has twice the <code>sd</code> of y, the ratio of <strong>slope</strong> = -0.4635533 to <strong>r</strong> = -0.2317767 is 0.5.</p></li>
<li><p>There is this relationship between the <strong>slope in the linear model</strong> and <strong>Pearson correlation</strong>:</p></li>
</ol>
<p><span class="math display">\[
Slope\ \beta_1 = \frac{sd_y}{sd_x} * r
\]</span></p>
<p>The slope is usually much more interpretable and informative than the correlation coefficient.</p>
<ol start="2" type="1">
<li>Hence a linear model using <code><a href="https://rdrr.io/r/base/scale.html">scale()</a></code> for both variables will show slope = <strong>r</strong>.</li>
</ol>
<p>Slope_Scaled: -0.2317767 = Correlation: -0.2317767</p>
<ol start="3" type="1">
<li>Finally, the <em>p-value</em> for Pearson Correlation and that for the <em>slope</em> in the linear model is the same (<span class="math inline">\(0.1053\)</span>). Which means we cannot reject the NULL hypothesis of “no relationship”.</li>
</ol></section><section id="example" class="level3"><h3 class="anchored" data-anchor-id="example">Example</h3>
<p>TBD</p>
</section></section><section id="spearman-correlation" class="level2"><h2 class="anchored" data-anchor-id="spearman-correlation">Spearman Correlation</h2>
<section id="model-1" class="level3"><h3 class="anchored" data-anchor-id="model-1">Model</h3>
<p>In some cases the <strong>LINE</strong> assumptions may not hold.</p>
<p>Nonlinear relationships, non-normally distributed data ( with large <strong>outliers</strong> ) and working with <em>ordinal</em> rather than continuous data: these situations necessitate the use of Spearman’s <em>ranked</em> correlation scores. (<strong>Ranked</strong>, not <strong>sign-ranked</strong>.).</p>
<p>See the example below: We choose to look at the <code>gpa_study_hours</code> dataset. It has two numeric columns <code>gpa</code> and <code>study_hours</code>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 193
Columns: 2
$ gpa         &lt;dbl&gt; 4.000, 3.800, 3.930, 3.400, 3.200, 3.520, 3.680, 3.400, 3.…
$ study_hours &lt;dbl&gt; 10, 25, 45, 10, 4, 10, 24, 40, 10, 10, 30, 7, 15, 60, 10, …</code></pre>
</div>
</div>
<p>We can plot this:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Pearson_example_3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hmm…not normally distributed, and there is a sort of increasing relationship, however is it linear? And there is some evidence of heteroscedasticity, so the LINE assumptions are clearly in violation. Pearson correlation would not be the best idea here.</p>
<p>Let us quickly try it anyway, using a Linear Model for the <strong>scaled</strong> <code>gpa</code> and <code>study_hours</code> variables, from where we get:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>    term     estimate    p.value        2.5 %    97.5 %
1 beta_0 3.047040e-16 1.00000000 -0.141087199 0.1410872
2 beta_1 1.330138e-01 0.06517072 -0.008440359 0.2744679</code></pre>
</div>
</div>
<p>The correlation estimate is <span class="math inline">\(0.133\)</span>; the <code>p-value</code> is <span class="math inline">\(0.065\)</span> (and the <code>confidence interval</code> includes <span class="math inline">\(0\)</span>).</p>
<p>Hence we fail to reject the NULL hypothesis that <code>study_hours</code> and <code>gpa</code> have no relationship. But can this be right?</p>
<p>Should we use another test, that does not <strong>need</strong> the LINE assumptions?</p>
</section></section><section id="signed-rank-values" class="level2"><h2 class="anchored" data-anchor-id="signed-rank-values">“Signed Rank” Values</h2>
<p>Most statistical tests use the <strong>actual values</strong> of the data variables. However, in some <em>non-parametric</em> statistical tests, the data are used in <strong>rank-transformed</strong> sense/order. (In some cases the <strong>signed-rank</strong> of the data values is used instead of the data itself.)</p>
<p><strong>Signed Rank</strong> is calculated as follows:</p>
<ol type="1">
<li><p>Take the absolute value of each observation in a sample</p></li>
<li><p>Place the <u><em>ranks</em></u> in order of (absolute magnitude). The smallest number has <em>rank = 1</em> and so on. This gives is <strong>ranked data</strong>.</p></li>
<li><p>Give each of the ranks the sign of the original observation ( + or -). This gives us <strong>signed</strong> ranked data.</p></li>
</ol>
<div class="cell" data-layout-align="center">

</div>
</section><section id="plotting-original-and-signed-rank-data" class="level2"><h2 class="anchored" data-anchor-id="plotting-original-and-signed-rank-data">Plotting Original and Signed Rank Data</h2>
<p>Let us see how this might work by comparing data and its signed-rank version…A quick set of plots:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/data_plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>So the means of the <strong>ranks</strong> three separate variables seem to be in the same order as the means of the data variables themselves.</p>
<p>How about associations between data? Do ranks reflect well what the data might?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Spearman_Plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The slopes are almost identical, <span class="math inline">\(0.25\)</span> for both original data and ranked data for <span class="math inline">\(y1\sim x\)</span>. So maybe <em>ranked</em> and even <em>sign_ranked</em> data could work, and if it can work despite LINE assumptions not being satisfied, that would be nice!</p>
</section><section id="how-does-sign-rank-data-work" class="level2"><h2 class="anchored" data-anchor-id="how-does-sign-rank-data-work">How does Sign-Rank data work?</h2>
<p>TBD: need to add some explanation here.</p>
<p>Spearman correlation = Pearson correlation using the rank of the data observations. Let’s check how this holds for a our x and y1 data:</p>
<p>So the Linear Model for the Ranked Data would be:</p>
<p><span class="math display">\[
\begin{aligned}
y = \beta_0 + \beta_1 \times rank(x)\\
\\
H_0: Null\ Hypothesis\ =&gt; \beta_1 = 0\\\
H_a: Alternate\ Hypothesis\ =&gt; \beta_1 \ne 0\\
\end{aligned}
\]</span></p>
<section id="code" class="level3"><h3 class="anchored" data-anchor-id="code">Code</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  term                    estimate p.value
  &lt;chr&gt;                      &lt;dbl&gt;   &lt;dbl&gt;
1 "Spearman Correlation "   -0.227   0.113</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  estimate p.value
     &lt;dbl&gt;   &lt;dbl&gt;
1   -0.227   0.114</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  estimate  p.value
     &lt;dbl&gt;    &lt;dbl&gt;
1   31.3   9.11e-10
2   -0.227 1.14e- 1</code></pre>
</div>
</div>
<p>Notes:</p>
<ol type="1">
<li><p>When ranks are used, the slope of the linear model (<span class="math inline">\(\beta_1\)</span>) has the same value as the Spearman correlation coefficient ( <span class="math inline">\(\rho\)</span> ).</p></li>
<li><p>Note that the slope from the linear model now has an intuitive interpretation: <strong>the number of ranks y changes for each change in rank of x</strong>. ( Ranks are “independent” of <code>sd</code> )</p></li>
</ol></section><section id="example-1" class="level3"><h3 class="anchored" data-anchor-id="example-1">Example</h3>
<p>We examine the <code>cars93</code> data, where the numeric variables of interest are <code>weight</code> and <code>price</code>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Spearman_example_1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let us try a Spearman Correlation score for these variables, since the data are not linearly related and the variance of <code>price</code> also is not constant over <code>weight</code></p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  estimate statistic  p.value method                          alternative
     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;                           &lt;chr&gt;      
1    0.883     3074. 1.07e-18 Spearman's rank correlation rho two.sided  </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = rank(price) ~ rank(weight), data = cars93)

Residuals:
     Min       1Q   Median       3Q      Max 
-20.0676  -3.0135   0.7815   3.6926  20.4099 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.22074    2.05894   1.564    0.124    
rank(weight)  0.88288    0.06514  13.554   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.46 on 52 degrees of freedom
Multiple R-squared:  0.7794,    Adjusted R-squared:  0.7751 
F-statistic: 183.7 on 1 and 52 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/Spearman_example_2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that using ranks of the <code>price</code> variable, we obtain a Spearman’s <span class="math inline">\(\rho = 0.882\)</span> with a <code>p-value</code> that is very small. Hence we are able to reject the NULL hypothesis and state that there is a relationship between these two variables. The <strong>linear</strong> relationship is evaluated as a correlation of <code>0.882</code>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  estimate p.value conf.low conf.high
     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1    0.133  0.0652 -0.00838     0.269</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 14
  parameter1  paramet…¹ effec…² estim…³ conf.…⁴ conf.low conf.…⁵ stati…⁶ df.er…⁷
  &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;int&gt;
1 study_hours gpa       Pearso…   0.133    0.95 -0.00838   0.269    1.85     191
# … with 5 more variables: p.value &lt;dbl&gt;, method &lt;chr&gt;, n.obs &lt;int&gt;,
#   conf.method &lt;chr&gt;, expression &lt;list&gt;, and abbreviated variable names
#   ¹​parameter2, ²​effectsize, ³​estimate, ⁴​conf.level, ⁵​conf.high, ⁶​statistic,
#   ⁷​df.error</code></pre>
</div>
</div>
</section></section></section><section id="references" class="level1"><h1>References</h1>
<ol type="1">
<li><p><em>Common statistical tests are linear models (or: how to teach stats)</em> by <a href="https://lindeloev.github.io/tests-as-linear/">Jonas Kristoffer Lindeløv</a></p></li>
<li><p><a href="https://lindeloev.github.io/tests-as-linear/linear_tests_cheat_sheet.pdf">CheatSheet</a></p></li>
<li><p><em>Common statistical tests are linear models: a work through</em> by <a href="https://steverxd.github.io/Stat_tests/">Steve Doogue</a></p></li>
<li><p><a href="https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/">Jeffrey Walker “Elements of Statistical Modeling for Experimental Biology”</a></p></li>
<li><p>Diez, David M &amp; Barr, Christopher D &amp; Çetinkaya-Rundel, Mine: <a href="https://www.openintro.org/book/os/">OpenIntro Statistics</a></p></li>
<li><p>Modern Statistics with R: From wrangling and exploring data to inference and predictive modelling by <a href="http://www.modernstatisticswithr.com/">Måns Thulin</a></p></li>
<li><p><a href="https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables">Jeffrey Walker “A linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables”</a></p></li>
</ol>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/av-quarto\.netlify\.app/);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><script src="https://utteranc.es/client.js" repo="arvindvenkatadri/my-quarto-website" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="an">title:</span><span class="co"> "Linear Model: Correlation Test"</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="an">author:</span><span class="co"> "Arvind Venkatadri"</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="an">date:</span><span class="co"> 25/Nov/2022</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="an">date-modified:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="an">order:</span><span class="co"> 20</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">  freeze: auto</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="an">code-summary:</span><span class="co"> "Show the Code"</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="an">code-line-numbers:</span><span class="co"> true</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="an">code-copy:</span><span class="co"> true</span></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="an">keywords:</span><span class="co"> Statistics ; Tests; p-value; Feynman Technique</span></span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="an">abstract:</span><span class="co"> "This module is intended to assist with making statistically significant insights that drive business decisions. This document deals with the basics of stats. The method followed is that of Jonas Lindoloev, wherein every stat test is treated as a linear model $y = mx + c$"</span></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="co">---</span></span>
<span id="cb17-18"><a href="#cb17-18"></a></span>
<span id="cb17-19"><a href="#cb17-19"></a>{{&lt; fa folder-open &gt;}} Slides and Tutorials</span>
<span id="cb17-20"><a href="#cb17-20"></a></span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"./files/cortests.qmd"</span><span class="kw">&gt;</span></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="kw">&lt;i</span> <span class="er">class</span><span class="ot">=</span><span class="st">"fa-solid fa-file-powerpoint fa-2x"</span><span class="kw">&gt;&lt;/i&gt;&lt;/a&gt;</span> .nbsp;.nbsp;</span>
<span id="cb17-23"><a href="#cb17-23"></a></span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"./files/cortests.ows"</span><span class="kw">&gt;</span></span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="kw">&lt;iconify-icon</span> <span class="er">icon</span><span class="ot">=</span><span class="st">"icon-park-solid:orange"</span><span class="kw">&gt;&lt;/iconify-icon&gt;&lt;/a&gt;</span></span>
<span id="cb17-26"><a href="#cb17-26"></a>.nbsp;.nbsp;</span>
<span id="cb17-27"><a href="#cb17-27"></a></span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"./files/cortestss.rda"</span><span class="kw">&gt;</span></span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="kw">&lt;i</span> <span class="er">class</span><span class="ot">=</span><span class="st">"fa-solid fa-person-rays"</span><span class="kw">&gt;&lt;/i&gt;&lt;/a&gt;</span> .nbsp;.nbsp;</span>
<span id="cb17-30"><a href="#cb17-30"></a></span>
<span id="cb17-31"><a href="#cb17-31"></a><span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">"./data/data.zip"</span><span class="kw">&gt;</span> <span class="kw">&lt;i</span> <span class="er">class</span><span class="ot">=</span><span class="st">"fa-solid fa-database"</span><span class="kw">&gt;&lt;/i&gt;&lt;/a&gt;</span></span>
<span id="cb17-32"><a href="#cb17-32"></a></span>
<span id="cb17-33"><a href="#cb17-33"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb17-34"><a href="#cb17-34"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">FALSE</span>,<span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">fig.align =</span> <span class="st">"center"</span>, <span class="at">scipen =</span> <span class="dv">1</span>, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">fig.width =</span> <span class="dv">7</span>, <span class="at">fig.height =</span> <span class="dv">5</span>)</span>
<span id="cb17-35"><a href="#cb17-35"></a><span class="co"># CRAN Packages</span></span>
<span id="cb17-36"><a href="#cb17-36"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-37"><a href="#cb17-37"></a><span class="fu">library</span>(broom)</span>
<span id="cb17-38"><a href="#cb17-38"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb17-39"><a href="#cb17-39"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb17-40"><a href="#cb17-40"></a></span>
<span id="cb17-41"><a href="#cb17-41"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb17-42"><a href="#cb17-42"></a><span class="fu">library</span>(mosaicCore)</span>
<span id="cb17-43"><a href="#cb17-43"></a><span class="fu">library</span>(mosaicData)</span>
<span id="cb17-44"><a href="#cb17-44"></a></span>
<span id="cb17-45"><a href="#cb17-45"></a><span class="fu">library</span>(openintro) <span class="co"># datasets and methods</span></span>
<span id="cb17-46"><a href="#cb17-46"></a><span class="fu">library</span>(statsExpressions) <span class="co"># datasets and methods</span></span>
<span id="cb17-47"><a href="#cb17-47"></a><span class="fu">library</span>(ggstatsplot) <span class="co"># special stats plots</span></span>
<span id="cb17-48"><a href="#cb17-48"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb17-49"><a href="#cb17-49"></a></span>
<span id="cb17-50"><a href="#cb17-50"></a><span class="co"># Non-CRAN Packages</span></span>
<span id="cb17-51"><a href="#cb17-51"></a><span class="co"># remotes::install_github("easystats/easystats")</span></span>
<span id="cb17-52"><a href="#cb17-52"></a><span class="fu">library</span>(easystats)</span>
<span id="cb17-53"><a href="#cb17-53"></a></span>
<span id="cb17-54"><a href="#cb17-54"></a><span class="in">```</span></span>
<span id="cb17-55"><a href="#cb17-55"></a></span>
<span id="cb17-56"><a href="#cb17-56"></a><span class="fu">## The Linear Model</span></span>
<span id="cb17-57"><a href="#cb17-57"></a></span>
<span id="cb17-58"><a href="#cb17-58"></a>The premise here is that **many common statistical tests are special</span>
<span id="cb17-59"><a href="#cb17-59"></a>cases of the linear model**. A **linear model** estimates the</span>
<span id="cb17-60"><a href="#cb17-60"></a>relationship between dependent variable or "response" variable ($y$) and</span>
<span id="cb17-61"><a href="#cb17-61"></a>an explanatory variable or "predictor" ($x$). It is assumed that the</span>
<span id="cb17-62"><a href="#cb17-62"></a>relationship is **linear**. $\beta_0$ is the *intercept* and $\beta_1$</span>
<span id="cb17-63"><a href="#cb17-63"></a>is the slope of the linear fit, that **predicts** the value of y based</span>
<span id="cb17-64"><a href="#cb17-64"></a>the value of x.</span>
<span id="cb17-65"><a href="#cb17-65"></a></span>
<span id="cb17-66"><a href="#cb17-66"></a>$$</span>
<span id="cb17-67"><a href="#cb17-67"></a>y = \beta_0 + \beta_1 *x</span>
<span id="cb17-68"><a href="#cb17-68"></a>$$</span>
<span id="cb17-69"><a href="#cb17-69"></a></span>
<span id="cb17-70"><a href="#cb17-70"></a><span class="fu">## The Correlation Test</span></span>
<span id="cb17-71"><a href="#cb17-71"></a></span>
<span id="cb17-72"><a href="#cb17-72"></a>TBD: Some introductory text here on Correlation itself)</span>
<span id="cb17-73"><a href="#cb17-73"></a></span>
<span id="cb17-74"><a href="#cb17-74"></a>One of the basic Questions we would have of our data is: Does some</span>
<span id="cb17-75"><a href="#cb17-75"></a>variable depend upon another in some way? Does $y$ depend upon $x$?</span>
<span id="cb17-76"><a href="#cb17-76"></a></span>
<span id="cb17-77"><a href="#cb17-77"></a>A **Correlation Test** is designed to answer exactly this question.</span>
<span id="cb17-78"><a href="#cb17-78"></a></span>
<span id="cb17-79"><a href="#cb17-79"></a>Let us now see how a Correlation Test can be re-formulated as a Linear</span>
<span id="cb17-80"><a href="#cb17-80"></a>Model + Hypothesis Test.</span>
<span id="cb17-81"><a href="#cb17-81"></a></span>
<span id="cb17-82"><a href="#cb17-82"></a><span class="fu">### Some Toy Data</span></span>
<span id="cb17-83"><a href="#cb17-83"></a></span>
<span id="cb17-84"><a href="#cb17-84"></a>Most examples in this exposition are based on three "imaginary" samples,</span>
<span id="cb17-85"><a href="#cb17-85"></a>$x, y1, y2$. Each is normally distributed and made up of 50</span>
<span id="cb17-86"><a href="#cb17-86"></a>observations. The means and the sds are, respectively:</span>
<span id="cb17-87"><a href="#cb17-87"></a></span>
<span id="cb17-88"><a href="#cb17-88"></a><span class="in">```{r data_genr}</span></span>
<span id="cb17-89"><a href="#cb17-89"></a>rnorm_fixed  <span class="ot">&lt;-</span> <span class="cf">function</span>(N, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) {</span>
<span id="cb17-90"><a href="#cb17-90"></a>  <span class="fu">scale</span>(<span class="fu">rnorm</span>(N))<span class="sc">*</span> sd <span class="sc">+</span> mu</span>
<span id="cb17-91"><a href="#cb17-91"></a>}</span>
<span id="cb17-92"><a href="#cb17-92"></a>params <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>), <span class="at">sd =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">1.5</span>))</span>
<span id="cb17-93"><a href="#cb17-93"></a>params </span>
<span id="cb17-94"><a href="#cb17-94"></a><span class="in">```</span></span>
<span id="cb17-95"><a href="#cb17-95"></a></span>
<span id="cb17-96"><a href="#cb17-96"></a><span class="in">```{r toy_data}</span></span>
<span id="cb17-97"><a href="#cb17-97"></a><span class="fu">set.seed</span>(<span class="dv">40</span>) <span class="co"># for replication</span></span>
<span id="cb17-98"><a href="#cb17-98"></a></span>
<span id="cb17-99"><a href="#cb17-99"></a><span class="co"># Data as vectors ( for t.tests etc)</span></span>
<span id="cb17-100"><a href="#cb17-100"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co">#explanatory</span></span>
<span id="cb17-101"><a href="#cb17-101"></a>y1 <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.3</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="co"># dependent #1</span></span>
<span id="cb17-102"><a href="#cb17-102"></a>y2 <span class="ot">&lt;-</span> <span class="fu">rnorm_fixed</span>(<span class="dv">50</span>, <span class="at">mu =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="fl">1.5</span>) <span class="co"># dependent #2</span></span>
<span id="cb17-103"><a href="#cb17-103"></a></span>
<span id="cb17-104"><a href="#cb17-104"></a><span class="co"># Make a tibble with all variables</span></span>
<span id="cb17-105"><a href="#cb17-105"></a>mydata_wide <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="at">y1 =</span> y1, <span class="at">y2 =</span> y2)</span>
<span id="cb17-106"><a href="#cb17-106"></a></span>
<span id="cb17-107"><a href="#cb17-107"></a><span class="co"># Long form data</span></span>
<span id="cb17-108"><a href="#cb17-108"></a>mydata_long <span class="ot">&lt;-</span> </span>
<span id="cb17-109"><a href="#cb17-109"></a>  mydata_wide <span class="sc">%&gt;%</span></span>
<span id="cb17-110"><a href="#cb17-110"></a>  <span class="fu">pivot_longer</span>(., <span class="at">cols =</span> <span class="fu">c</span>(x,y1,y2), </span>
<span id="cb17-111"><a href="#cb17-111"></a>               <span class="at">names_to =</span> <span class="st">"group"</span>, </span>
<span id="cb17-112"><a href="#cb17-112"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb17-113"><a href="#cb17-113"></a></span>
<span id="cb17-114"><a href="#cb17-114"></a><span class="co"># Long form data with only dependent variables</span></span>
<span id="cb17-115"><a href="#cb17-115"></a>mydata_long_y <span class="ot">&lt;-</span> </span>
<span id="cb17-116"><a href="#cb17-116"></a>  mydata_wide <span class="sc">%&gt;%</span> </span>
<span id="cb17-117"><a href="#cb17-117"></a>  <span class="fu">select</span>(<span class="sc">-</span>x) <span class="sc">%&gt;%</span> </span>
<span id="cb17-118"><a href="#cb17-118"></a>  <span class="fu">pivot_longer</span>(., <span class="at">cols =</span> <span class="fu">c</span>(y1,y2), </span>
<span id="cb17-119"><a href="#cb17-119"></a>               <span class="at">names_to =</span> <span class="st">"group"</span>, </span>
<span id="cb17-120"><a href="#cb17-120"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb17-121"><a href="#cb17-121"></a><span class="in">```</span></span>
<span id="cb17-122"><a href="#cb17-122"></a></span>
<span id="cb17-123"><a href="#cb17-123"></a>Let us look at our toy data in three ways:</span>
<span id="cb17-124"><a href="#cb17-124"></a></span>
<span id="cb17-125"><a href="#cb17-125"></a><span class="ss">1.  </span>All three variables:</span>
<span id="cb17-126"><a href="#cb17-126"></a></span>
<span id="cb17-129"><a href="#cb17-129"></a><span class="in">```{r}</span></span>
<span id="cb17-130"><a href="#cb17-130"></a>mydata_wide </span>
<span id="cb17-131"><a href="#cb17-131"></a><span class="in">```</span></span>
<span id="cb17-132"><a href="#cb17-132"></a></span>
<span id="cb17-133"><a href="#cb17-133"></a><span class="ss">2.  </span>Variables stacked and labelled (Note: <span class="in">`group`</span> is now a Qual variable</span>
<span id="cb17-134"><a href="#cb17-134"></a>    !!)</span>
<span id="cb17-135"><a href="#cb17-135"></a></span>
<span id="cb17-138"><a href="#cb17-138"></a><span class="in">```{r}</span></span>
<span id="cb17-139"><a href="#cb17-139"></a>mydata_long </span>
<span id="cb17-140"><a href="#cb17-140"></a><span class="in">```</span></span>
<span id="cb17-141"><a href="#cb17-141"></a></span>
<span id="cb17-142"><a href="#cb17-142"></a><span class="ss">3.  </span>Same as 2, but only for the dependent <span class="in">`y`</span> variables:</span>
<span id="cb17-143"><a href="#cb17-143"></a></span>
<span id="cb17-146"><a href="#cb17-146"></a><span class="in">```{r}</span></span>
<span id="cb17-147"><a href="#cb17-147"></a>mydata_long_y </span>
<span id="cb17-148"><a href="#cb17-148"></a><span class="in">```</span></span>
<span id="cb17-149"><a href="#cb17-149"></a></span>
<span id="cb17-150"><a href="#cb17-150"></a><span class="fu"># Tests for Correlation</span></span>
<span id="cb17-151"><a href="#cb17-151"></a></span>
<span id="cb17-152"><a href="#cb17-152"></a>Correlation **r** is a measure of *strength* and *direction* of *linear</span>
<span id="cb17-153"><a href="#cb17-153"></a>association* between two variables. **r** is between $<span class="co">[</span><span class="ot">-1,+1</span><span class="co">]</span>$, with $0$</span>
<span id="cb17-154"><a href="#cb17-154"></a>implying no association/correlation.</span>
<span id="cb17-155"><a href="#cb17-155"></a></span>
<span id="cb17-156"><a href="#cb17-156"></a>From this definition, the *linear model* lends itself in a</span>
<span id="cb17-157"><a href="#cb17-157"></a>straightforward way as a model to interpret *correlation*. Intuitively,</span>
<span id="cb17-158"><a href="#cb17-158"></a>the slope of the linear model could be related to the correlation</span>
<span id="cb17-159"><a href="#cb17-159"></a>between y and x.</span>
<span id="cb17-160"><a href="#cb17-160"></a></span>
<span id="cb17-161"><a href="#cb17-161"></a>Now we look at the numbers.</span>
<span id="cb17-162"><a href="#cb17-162"></a></span>
<span id="cb17-163"><a href="#cb17-163"></a><span class="fu">## Pearson Correlation</span></span>
<span id="cb17-164"><a href="#cb17-164"></a></span>
<span id="cb17-165"><a href="#cb17-165"></a><span class="fu">### Model</span></span>
<span id="cb17-166"><a href="#cb17-166"></a></span>
<span id="cb17-167"><a href="#cb17-167"></a>The model for Pearson Correlation tests is exactly the Linear Model:</span>
<span id="cb17-168"><a href="#cb17-168"></a></span>
<span id="cb17-169"><a href="#cb17-169"></a>$$</span>
<span id="cb17-170"><a href="#cb17-170"></a>\begin{aligned}</span>
<span id="cb17-171"><a href="#cb17-171"></a>y = \beta_0 + \beta_1 \times x<span class="sc">\\</span></span>
<span id="cb17-172"><a href="#cb17-172"></a><span class="sc">\\</span></span>
<span id="cb17-173"><a href="#cb17-173"></a>H_0: Null\ Hypothesis\ =&gt; \beta_1 = 0<span class="sc">\\</span>\</span>
<span id="cb17-174"><a href="#cb17-174"></a>H_a: Alternate\ Hypothesis\ =&gt; \beta_1 \ne 0<span class="sc">\\</span></span>
<span id="cb17-175"><a href="#cb17-175"></a>\end{aligned}</span>
<span id="cb17-176"><a href="#cb17-176"></a>$$</span>
<span id="cb17-177"><a href="#cb17-177"></a></span>
<span id="cb17-178"><a href="#cb17-178"></a><span class="in">```{r Pearson_Correlation}</span></span>
<span id="cb17-179"><a href="#cb17-179"></a><span class="co"># Pearson (built-in test)</span></span>
<span id="cb17-180"><a href="#cb17-180"></a>cor <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(y1,x,<span class="at">method =</span> <span class="st">"pearson"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-181"><a href="#cb17-181"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">term =</span> <span class="st">"Pearson Correlation r"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(term, estimate, p.value) </span>
<span id="cb17-182"><a href="#cb17-182"></a>cor </span>
<span id="cb17-183"><a href="#cb17-183"></a></span>
<span id="cb17-184"><a href="#cb17-184"></a></span>
<span id="cb17-185"><a href="#cb17-185"></a><span class="in">```</span></span>
<span id="cb17-186"><a href="#cb17-186"></a></span>
<span id="cb17-187"><a href="#cb17-187"></a>Using the *linear model* method we get:</span>
<span id="cb17-188"><a href="#cb17-188"></a></span>
<span id="cb17-191"><a href="#cb17-191"></a><span class="in">```{r}</span></span>
<span id="cb17-192"><a href="#cb17-192"></a><span class="co"># Linear Model</span></span>
<span id="cb17-193"><a href="#cb17-193"></a>lin <span class="ot">&lt;-</span> <span class="fu">lm</span>(y1 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x, <span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb17-194"><a href="#cb17-194"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"beta_0"</span>, <span class="st">"beta_1"</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(term, estimate, p.value)</span>
<span id="cb17-195"><a href="#cb17-195"></a>lin </span>
<span id="cb17-196"><a href="#cb17-196"></a></span>
<span id="cb17-197"><a href="#cb17-197"></a><span class="in">```</span></span>
<span id="cb17-198"><a href="#cb17-198"></a></span>
<span id="cb17-199"><a href="#cb17-199"></a>Why are $r$ and $\beta_1$ different, though the <span class="in">`p-value`</span> is</span>
<span id="cb17-200"><a href="#cb17-200"></a>suspiciously the same!?</span>
<span id="cb17-201"><a href="#cb17-201"></a></span>
<span id="cb17-202"><a href="#cb17-202"></a>Did we miss a factor of $\frac{-0.463}{-0.231} = 2$ somewhere...??</span>
<span id="cb17-203"><a href="#cb17-203"></a></span>
<span id="cb17-204"><a href="#cb17-204"></a>Let us **scale** the variables to within <span class="in">`{-1, +1}`</span> : (subtract the mean</span>
<span id="cb17-205"><a href="#cb17-205"></a>and divide by sd) and re-do the Linear Model with **scaled** versions</span>
<span id="cb17-206"><a href="#cb17-206"></a>$x$ and $y$:</span>
<span id="cb17-207"><a href="#cb17-207"></a></span>
<span id="cb17-210"><a href="#cb17-210"></a><span class="in">```{r}</span></span>
<span id="cb17-211"><a href="#cb17-211"></a><span class="co"># Scaled linear model</span></span>
<span id="cb17-212"><a href="#cb17-212"></a>lin_scl <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">scale</span>(y1) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">scale</span>(x), <span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb17-213"><a href="#cb17-213"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"beta_0"</span>, <span class="st">"beta_1"</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(term, estimate, p.value) <span class="sc">%&gt;%</span> <span class="fu">select</span>(term, estimate, p.value)</span>
<span id="cb17-214"><a href="#cb17-214"></a>lin_scl </span>
<span id="cb17-215"><a href="#cb17-215"></a></span>
<span id="cb17-216"><a href="#cb17-216"></a><span class="in">```</span></span>
<span id="cb17-217"><a href="#cb17-217"></a></span>
<span id="cb17-218"><a href="#cb17-218"></a>So we conclude:</span>
<span id="cb17-219"><a href="#cb17-219"></a></span>
<span id="cb17-220"><a href="#cb17-220"></a><span class="ss">1.  </span>**When both x and y have the same standard deviation, the slope from</span>
<span id="cb17-221"><a href="#cb17-221"></a>    the linear model and the Pearson correlation are the same**. Here,</span>
<span id="cb17-222"><a href="#cb17-222"></a>    since x has twice the <span class="in">`sd`</span> of y, the ratio of **slope** =</span>
<span id="cb17-223"><a href="#cb17-223"></a>    <span class="in">`r lin$estimate[2]`</span> to **r** = <span class="in">`r cor$estimate`</span> is 0.5.</span>
<span id="cb17-224"><a href="#cb17-224"></a></span>
<span id="cb17-225"><a href="#cb17-225"></a><span class="ss">2.  </span>There is this relationship between the **slope in the linear model**</span>
<span id="cb17-226"><a href="#cb17-226"></a>    and **Pearson correlation**:</span>
<span id="cb17-227"><a href="#cb17-227"></a></span>
<span id="cb17-228"><a href="#cb17-228"></a>$$</span>
<span id="cb17-229"><a href="#cb17-229"></a>Slope\ \beta_1 = \frac{sd_y}{sd_x} * r</span>
<span id="cb17-230"><a href="#cb17-230"></a>$$</span>
<span id="cb17-231"><a href="#cb17-231"></a></span>
<span id="cb17-232"><a href="#cb17-232"></a>The slope is usually much more interpretable and informative than the</span>
<span id="cb17-233"><a href="#cb17-233"></a>correlation coefficient.</span>
<span id="cb17-234"><a href="#cb17-234"></a></span>
<span id="cb17-235"><a href="#cb17-235"></a><span class="ss">2.  </span>Hence a linear model using <span class="in">`scale()`</span> for both variables will show</span>
<span id="cb17-236"><a href="#cb17-236"></a>    slope = **r**.</span>
<span id="cb17-237"><a href="#cb17-237"></a></span>
<span id="cb17-238"><a href="#cb17-238"></a>Slope_Scaled: <span class="in">`r lin_scl$estimate[2]`</span> = Correlation: <span class="in">`r cor$estimate`</span></span>
<span id="cb17-239"><a href="#cb17-239"></a></span>
<span id="cb17-240"><a href="#cb17-240"></a><span class="ss">3.  </span>Finally, the *p-value* for Pearson Correlation and that for the</span>
<span id="cb17-241"><a href="#cb17-241"></a>    *slope* in the linear model is the same ($0.1053$). Which means we</span>
<span id="cb17-242"><a href="#cb17-242"></a>    cannot reject the NULL hypothesis of "no relationship".</span>
<span id="cb17-243"><a href="#cb17-243"></a></span>
<span id="cb17-244"><a href="#cb17-244"></a><span class="fu">### Example</span></span>
<span id="cb17-245"><a href="#cb17-245"></a></span>
<span id="cb17-246"><a href="#cb17-246"></a>TBD</span>
<span id="cb17-247"><a href="#cb17-247"></a></span>
<span id="cb17-248"><a href="#cb17-248"></a><span class="fu">## Spearman Correlation</span></span>
<span id="cb17-249"><a href="#cb17-249"></a></span>
<span id="cb17-250"><a href="#cb17-250"></a><span class="fu">### Model</span></span>
<span id="cb17-251"><a href="#cb17-251"></a></span>
<span id="cb17-252"><a href="#cb17-252"></a>In some cases the **LINE** assumptions may not hold.</span>
<span id="cb17-253"><a href="#cb17-253"></a></span>
<span id="cb17-254"><a href="#cb17-254"></a>Nonlinear relationships, non-normally distributed data ( with large</span>
<span id="cb17-255"><a href="#cb17-255"></a>**outliers** ) and working with *ordinal* rather than continuous data:</span>
<span id="cb17-256"><a href="#cb17-256"></a>these situations necessitate the use of Spearman's *ranked* correlation</span>
<span id="cb17-257"><a href="#cb17-257"></a>scores. (**Ranked**, not **sign-ranked**.).</span>
<span id="cb17-258"><a href="#cb17-258"></a></span>
<span id="cb17-259"><a href="#cb17-259"></a>See the example below: We choose to look at the <span class="in">`gpa_study_hours`</span></span>
<span id="cb17-260"><a href="#cb17-260"></a>dataset. It has two numeric columns <span class="in">`gpa`</span> and <span class="in">`study_hours`</span>:</span>
<span id="cb17-261"><a href="#cb17-261"></a></span>
<span id="cb17-262"><a href="#cb17-262"></a><span class="in">```{r gpa_study_hours}</span></span>
<span id="cb17-263"><a href="#cb17-263"></a><span class="fu">glimpse</span>(gpa_study_hours)</span>
<span id="cb17-264"><a href="#cb17-264"></a></span>
<span id="cb17-265"><a href="#cb17-265"></a><span class="in">```</span></span>
<span id="cb17-266"><a href="#cb17-266"></a></span>
<span id="cb17-267"><a href="#cb17-267"></a>We can plot this:</span>
<span id="cb17-268"><a href="#cb17-268"></a></span>
<span id="cb17-269"><a href="#cb17-269"></a><span class="in">```{r Pearson_example_3}</span></span>
<span id="cb17-270"><a href="#cb17-270"></a></span>
<span id="cb17-271"><a href="#cb17-271"></a><span class="fu">ggplot</span>(gpa_study_hours, <span class="fu">aes</span>(<span class="at">x =</span> study_hours, <span class="at">y =</span> gpa)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb17-272"><a href="#cb17-272"></a><span class="co"># ggstatsplot::ggscatterstats(data = gpa_study_hours, </span></span>
<span id="cb17-273"><a href="#cb17-273"></a><span class="co">#                             x = study_hours, </span></span>
<span id="cb17-274"><a href="#cb17-274"></a><span class="co">#                             y = gpa,</span></span>
<span id="cb17-275"><a href="#cb17-275"></a><span class="co">#                             marginal = TRUE,</span></span>
<span id="cb17-276"><a href="#cb17-276"></a><span class="co">#                             title = "GPA vs Study Hours")</span></span>
<span id="cb17-277"><a href="#cb17-277"></a></span>
<span id="cb17-278"><a href="#cb17-278"></a><span class="in">```</span></span>
<span id="cb17-279"><a href="#cb17-279"></a></span>
<span id="cb17-280"><a href="#cb17-280"></a>Hmm...not normally distributed, and there is a sort of increasing</span>
<span id="cb17-281"><a href="#cb17-281"></a>relationship, however is it linear? And there is some evidence of</span>
<span id="cb17-282"><a href="#cb17-282"></a>heteroscedasticity, so the LINE assumptions are clearly in violation.</span>
<span id="cb17-283"><a href="#cb17-283"></a>Pearson correlation would not be the best idea here.</span>
<span id="cb17-284"><a href="#cb17-284"></a></span>
<span id="cb17-285"><a href="#cb17-285"></a>Let us quickly try it anyway, using a Linear Model for the **scaled**</span>
<span id="cb17-286"><a href="#cb17-286"></a><span class="in">`gpa`</span> and <span class="in">`study_hours`</span> variables, from where we get:</span>
<span id="cb17-287"><a href="#cb17-287"></a></span>
<span id="cb17-288"><a href="#cb17-288"></a><span class="in">```{r Pearson_example_1}</span></span>
<span id="cb17-289"><a href="#cb17-289"></a></span>
<span id="cb17-290"><a href="#cb17-290"></a></span>
<span id="cb17-291"><a href="#cb17-291"></a><span class="co"># Pearson Correlation as Linear Model</span></span>
<span id="cb17-292"><a href="#cb17-292"></a>model_gpa <span class="ot">&lt;-</span></span>
<span id="cb17-293"><a href="#cb17-293"></a>  <span class="fu">lm</span>(<span class="fu">scale</span>(gpa) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">scale</span>(study_hours), <span class="at">data =</span> gpa_study_hours)</span>
<span id="cb17-294"><a href="#cb17-294"></a></span>
<span id="cb17-295"><a href="#cb17-295"></a>model_gpa <span class="sc">%&gt;%</span></span>
<span id="cb17-296"><a href="#cb17-296"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-297"><a href="#cb17-297"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">"beta_0"</span>, <span class="st">"beta_1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-298"><a href="#cb17-298"></a>  <span class="fu">cbind</span>(<span class="fu">confint</span>(model_gpa) <span class="sc">%&gt;%</span>                                              <span class="fu">as_tibble</span>()) <span class="sc">%&gt;%</span>  </span>
<span id="cb17-299"><a href="#cb17-299"></a>  <span class="fu">select</span>(term, estimate, p.value, <span class="st">`</span><span class="at">2.5 %</span><span class="st">`</span>, <span class="st">`</span><span class="at">97.5 %</span><span class="st">`</span>)</span>
<span id="cb17-300"><a href="#cb17-300"></a></span>
<span id="cb17-301"><a href="#cb17-301"></a><span class="in">```</span></span>
<span id="cb17-302"><a href="#cb17-302"></a></span>
<span id="cb17-303"><a href="#cb17-303"></a>The correlation estimate is $0.133$; the <span class="in">`p-value`</span> is $0.065$ (and the</span>
<span id="cb17-304"><a href="#cb17-304"></a><span class="in">`confidence interval`</span> includes $0$).</span>
<span id="cb17-305"><a href="#cb17-305"></a></span>
<span id="cb17-306"><a href="#cb17-306"></a>Hence we fail to reject the NULL hypothesis that <span class="in">`study_hours`</span> and <span class="in">`gpa`</span></span>
<span id="cb17-307"><a href="#cb17-307"></a>have no relationship. But can this be right?</span>
<span id="cb17-308"><a href="#cb17-308"></a></span>
<span id="cb17-309"><a href="#cb17-309"></a>Should we use another test, that does not **need** the LINE assumptions?</span>
<span id="cb17-310"><a href="#cb17-310"></a></span>
<span id="cb17-311"><a href="#cb17-311"></a><span class="fu">## "Signed Rank" Values</span></span>
<span id="cb17-312"><a href="#cb17-312"></a></span>
<span id="cb17-313"><a href="#cb17-313"></a>Most statistical tests use the **actual values** of the data variables.</span>
<span id="cb17-314"><a href="#cb17-314"></a>However, in some *non-parametric* statistical tests, the data are used</span>
<span id="cb17-315"><a href="#cb17-315"></a>in **rank-transformed** sense/order. (In some cases the **signed-rank**</span>
<span id="cb17-316"><a href="#cb17-316"></a>of the data values is used instead of the data itself.)</span>
<span id="cb17-317"><a href="#cb17-317"></a></span>
<span id="cb17-318"><a href="#cb17-318"></a>**Signed Rank** is calculated as follows:</span>
<span id="cb17-319"><a href="#cb17-319"></a></span>
<span id="cb17-320"><a href="#cb17-320"></a><span class="ss">1.  </span>Take the absolute value of each observation in a sample</span>
<span id="cb17-321"><a href="#cb17-321"></a></span>
<span id="cb17-322"><a href="#cb17-322"></a><span class="ss">2.  </span>Place the <span class="kw">&lt;u&gt;</span>*ranks*<span class="kw">&lt;/u&gt;</span> in order of (absolute magnitude). The</span>
<span id="cb17-323"><a href="#cb17-323"></a>    smallest number has *rank = 1* and so on. This gives is **ranked</span>
<span id="cb17-324"><a href="#cb17-324"></a>    data**.</span>
<span id="cb17-325"><a href="#cb17-325"></a></span>
<span id="cb17-326"><a href="#cb17-326"></a><span class="ss">3.  </span>Give each of the ranks the sign of the original observation ( + or</span>
<span id="cb17-327"><a href="#cb17-327"></a>    -). This gives us **signed** ranked data.</span>
<span id="cb17-328"><a href="#cb17-328"></a></span>
<span id="cb17-329"><a href="#cb17-329"></a><span class="in">```{r signed_rank_function}</span></span>
<span id="cb17-330"><a href="#cb17-330"></a>signed_rank <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">sign</span>(x) <span class="sc">*</span> <span class="fu">rank</span>(<span class="fu">abs</span>(x))}</span>
<span id="cb17-331"><a href="#cb17-331"></a></span>
<span id="cb17-332"><a href="#cb17-332"></a><span class="in">```</span></span>
<span id="cb17-333"><a href="#cb17-333"></a></span>
<span id="cb17-334"><a href="#cb17-334"></a><span class="fu">## Plotting Original and Signed Rank Data</span></span>
<span id="cb17-335"><a href="#cb17-335"></a></span>
<span id="cb17-336"><a href="#cb17-336"></a>Let us see how this might work by comparing data and its signed-rank</span>
<span id="cb17-337"><a href="#cb17-337"></a>version...A quick set of plots:</span>
<span id="cb17-338"><a href="#cb17-338"></a></span>
<span id="cb17-339"><a href="#cb17-339"></a><span class="in">```{r data_plots}</span></span>
<span id="cb17-340"><a href="#cb17-340"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_long,<span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb17-341"><a href="#cb17-341"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.02</span>, <span class="at">height =</span> <span class="dv">0</span>,<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb17-342"><a href="#cb17-342"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>, </span>
<span id="cb17-343"><a href="#cb17-343"></a>                                       <span class="at">x =</span> .<span class="dv">75</span>, </span>
<span id="cb17-344"><a href="#cb17-344"></a>                                       <span class="at">xend =</span> <span class="fl">1.25</span> )) <span class="sc">+</span> </span>
<span id="cb17-345"><a href="#cb17-345"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="st">"0"</span>)) <span class="sc">+</span></span>
<span id="cb17-346"><a href="#cb17-346"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.3</span>, <span class="at">yend =</span> <span class="fl">0.3</span>, </span>
<span id="cb17-347"><a href="#cb17-347"></a>                                       <span class="at">x =</span> <span class="fl">1.75</span> , </span>
<span id="cb17-348"><a href="#cb17-348"></a>                                       <span class="at">xend =</span> <span class="fl">2.25</span> )) <span class="sc">+</span> </span>
<span id="cb17-349"><a href="#cb17-349"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">0.6</span>, <span class="at">label =</span> <span class="st">"0.3"</span>)) <span class="sc">+</span></span>
<span id="cb17-350"><a href="#cb17-350"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> mydata_wide, <span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">yend =</span> <span class="fl">0.5</span>, </span>
<span id="cb17-351"><a href="#cb17-351"></a>                                       <span class="at">x =</span> <span class="fl">2.75</span>, </span>
<span id="cb17-352"><a href="#cb17-352"></a>                                       <span class="at">xend =</span> <span class="fl">3.25</span> )) <span class="sc">+</span> </span>
<span id="cb17-353"><a href="#cb17-353"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.8</span>, <span class="at">label =</span> <span class="st">"0.5"</span>)) <span class="sc">+</span></span>
<span id="cb17-354"><a href="#cb17-354"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Original Data"</span>, <span class="at">subtitle =</span> <span class="st">"Black Lines show Means"</span>) <span class="sc">+</span></span>
<span id="cb17-355"><a href="#cb17-355"></a>  <span class="fu">ylab</span>(<span class="st">"Response Variable"</span>)</span>
<span id="cb17-356"><a href="#cb17-356"></a></span>
<span id="cb17-357"><a href="#cb17-357"></a>p2 <span class="ot">&lt;-</span> mydata_long <span class="sc">%&gt;%</span> </span>
<span id="cb17-358"><a href="#cb17-358"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> </span>
<span id="cb17-359"><a href="#cb17-359"></a>  <span class="fu">mutate</span>( <span class="at">s_value =</span> <span class="fu">signed_rank</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-360"><a href="#cb17-360"></a>  <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> s_value)) <span class="sc">+</span> </span>
<span id="cb17-361"><a href="#cb17-361"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.02</span>, <span class="at">height =</span> <span class="dv">0</span>,<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb17-362"><a href="#cb17-362"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, </span>
<span id="cb17-363"><a href="#cb17-363"></a>               <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb17-364"><a href="#cb17-364"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Signed Rank of Data"</span>, <span class="at">subtitle =</span> <span class="st">"Red Points are means of Ranks!"</span>) <span class="sc">+</span></span>
<span id="cb17-365"><a href="#cb17-365"></a>  <span class="fu">ylab</span>(<span class="st">"Signed Rank of Response Variable"</span>)</span>
<span id="cb17-366"><a href="#cb17-366"></a></span>
<span id="cb17-367"><a href="#cb17-367"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb17-368"><a href="#cb17-368"></a></span>
<span id="cb17-369"><a href="#cb17-369"></a><span class="in">```</span></span>
<span id="cb17-370"><a href="#cb17-370"></a></span>
<span id="cb17-371"><a href="#cb17-371"></a>So the means of the **ranks** three separate variables seem to be in the</span>
<span id="cb17-372"><a href="#cb17-372"></a>same order as the means of the data variables themselves.</span>
<span id="cb17-373"><a href="#cb17-373"></a></span>
<span id="cb17-374"><a href="#cb17-374"></a>How about associations between data? Do ranks reflect well what the data</span>
<span id="cb17-375"><a href="#cb17-375"></a>might?</span>
<span id="cb17-376"><a href="#cb17-376"></a></span>
<span id="cb17-377"><a href="#cb17-377"></a><span class="in">```{r Spearman_Plot}</span></span>
<span id="cb17-378"><a href="#cb17-378"></a><span class="co"># Plot the data</span></span>
<span id="cb17-379"><a href="#cb17-379"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata_wide, <span class="fu">aes</span>(x, y1)) <span class="sc">+</span> </span>
<span id="cb17-380"><a href="#cb17-380"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-381"><a href="#cb17-381"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb17-382"><a href="#cb17-382"></a>  <span class="fu">ggtitle</span>(<span class="st">" Pearson Correlation</span><span class="sc">\n</span><span class="st"> and Linear Models"</span>)</span>
<span id="cb17-383"><a href="#cb17-383"></a></span>
<span id="cb17-384"><a href="#cb17-384"></a><span class="co"># Plot ranked data</span></span>
<span id="cb17-385"><a href="#cb17-385"></a>p2 <span class="ot">&lt;-</span> mydata_wide <span class="sc">%&gt;%</span> </span>
<span id="cb17-386"><a href="#cb17-386"></a>  <span class="fu">mutate</span>(<span class="at">x_rank =</span> <span class="fu">rank</span>(x),</span>
<span id="cb17-387"><a href="#cb17-387"></a>         <span class="at">y_rank =</span> <span class="fu">rank</span>(y1)) <span class="sc">%&gt;%</span></span>
<span id="cb17-388"><a href="#cb17-388"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(x_rank, y_rank)) <span class="sc">+</span> </span>
<span id="cb17-389"><a href="#cb17-389"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">15</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-390"><a href="#cb17-390"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb17-391"><a href="#cb17-391"></a>  <span class="fu">ggtitle</span>(<span class="st">" Spearman Ranked Correlation</span><span class="sc">\n</span><span class="st"> and Linear Models"</span>)</span>
<span id="cb17-392"><a href="#cb17-392"></a></span>
<span id="cb17-393"><a href="#cb17-393"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb17-394"><a href="#cb17-394"></a></span>
<span id="cb17-395"><a href="#cb17-395"></a><span class="in">```</span></span>
<span id="cb17-396"><a href="#cb17-396"></a></span>
<span id="cb17-397"><a href="#cb17-397"></a>The slopes are almost identical, $0.25$ for both original data and</span>
<span id="cb17-398"><a href="#cb17-398"></a>ranked data for $y1\sim x$. So maybe *ranked* and even *sign_ranked*</span>
<span id="cb17-399"><a href="#cb17-399"></a>data could work, and if it can work despite LINE assumptions not being</span>
<span id="cb17-400"><a href="#cb17-400"></a>satisfied, that would be nice!</span>
<span id="cb17-401"><a href="#cb17-401"></a></span>
<span id="cb17-402"><a href="#cb17-402"></a><span class="fu">## How does Sign-Rank data work?</span></span>
<span id="cb17-403"><a href="#cb17-403"></a></span>
<span id="cb17-404"><a href="#cb17-404"></a>TBD: need to add some explanation here.</span>
<span id="cb17-405"><a href="#cb17-405"></a></span>
<span id="cb17-406"><a href="#cb17-406"></a>Spearman correlation = Pearson correlation using the rank of the data</span>
<span id="cb17-407"><a href="#cb17-407"></a>observations. Let's check how this holds for a our x and y1 data:</span>
<span id="cb17-408"><a href="#cb17-408"></a></span>
<span id="cb17-409"><a href="#cb17-409"></a>So the Linear Model for the Ranked Data would be:</span>
<span id="cb17-410"><a href="#cb17-410"></a></span>
<span id="cb17-411"><a href="#cb17-411"></a>$$</span>
<span id="cb17-412"><a href="#cb17-412"></a>\begin{aligned}</span>
<span id="cb17-413"><a href="#cb17-413"></a>y = \beta_0 + \beta_1 \times rank(x)<span class="sc">\\</span></span>
<span id="cb17-414"><a href="#cb17-414"></a><span class="sc">\\</span></span>
<span id="cb17-415"><a href="#cb17-415"></a>H_0: Null\ Hypothesis\ =&gt; \beta_1 = 0<span class="sc">\\</span>\</span>
<span id="cb17-416"><a href="#cb17-416"></a>H_a: Alternate\ Hypothesis\ =&gt; \beta_1 \ne 0<span class="sc">\\</span></span>
<span id="cb17-417"><a href="#cb17-417"></a>\end{aligned}</span>
<span id="cb17-418"><a href="#cb17-418"></a>$$</span>
<span id="cb17-419"><a href="#cb17-419"></a></span>
<span id="cb17-420"><a href="#cb17-420"></a><span class="fu">### Code</span></span>
<span id="cb17-421"><a href="#cb17-421"></a></span>
<span id="cb17-422"><a href="#cb17-422"></a><span class="in">```{r Spearman_Correlation}</span></span>
<span id="cb17-423"><a href="#cb17-423"></a><span class="co"># Spearman</span></span>
<span id="cb17-424"><a href="#cb17-424"></a>cor1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y1, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-425"><a href="#cb17-425"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">term =</span> <span class="st">"Spearman Correlation "</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(term, estimate, p.value)</span>
<span id="cb17-426"><a href="#cb17-426"></a>cor1</span>
<span id="cb17-427"><a href="#cb17-427"></a></span>
<span id="cb17-428"><a href="#cb17-428"></a><span class="in">```</span></span>
<span id="cb17-429"><a href="#cb17-429"></a></span>
<span id="cb17-432"><a href="#cb17-432"></a><span class="in">```{r}</span></span>
<span id="cb17-433"><a href="#cb17-433"></a><span class="co"># Pearson using ranks</span></span>
<span id="cb17-434"><a href="#cb17-434"></a>cor2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(<span class="fu">rank</span>(y1), <span class="fu">rank</span>(x), <span class="at">method =</span> <span class="st">"pearson"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-435"><a href="#cb17-435"></a>broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb17-436"><a href="#cb17-436"></a>cor2</span>
<span id="cb17-437"><a href="#cb17-437"></a><span class="in">```</span></span>
<span id="cb17-438"><a href="#cb17-438"></a></span>
<span id="cb17-441"><a href="#cb17-441"></a><span class="in">```{r}</span></span>
<span id="cb17-442"><a href="#cb17-442"></a><span class="co"># Linear Models using rank</span></span>
<span id="cb17-443"><a href="#cb17-443"></a>cor3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">rank</span>(y1) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">rank</span>(x),<span class="at">data =</span> mydata_wide) <span class="sc">%&gt;%</span> </span>
<span id="cb17-444"><a href="#cb17-444"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value)</span>
<span id="cb17-445"><a href="#cb17-445"></a>cor3</span>
<span id="cb17-446"><a href="#cb17-446"></a><span class="in">```</span></span>
<span id="cb17-447"><a href="#cb17-447"></a></span>
<span id="cb17-448"><a href="#cb17-448"></a>Notes:</span>
<span id="cb17-449"><a href="#cb17-449"></a></span>
<span id="cb17-450"><a href="#cb17-450"></a><span class="ss">1.  </span>When ranks are used, the slope of the linear model ($\beta_1$) has</span>
<span id="cb17-451"><a href="#cb17-451"></a>    the same value as the Spearman correlation coefficient ( $\rho$ ).</span>
<span id="cb17-452"><a href="#cb17-452"></a></span>
<span id="cb17-453"><a href="#cb17-453"></a><span class="ss">2.  </span>Note that the slope from the linear model now has an intuitive</span>
<span id="cb17-454"><a href="#cb17-454"></a>    interpretation: **the number of ranks y changes for each change in</span>
<span id="cb17-455"><a href="#cb17-455"></a>    rank of x**. ( Ranks are "independent" of <span class="in">`sd`</span> )</span>
<span id="cb17-456"><a href="#cb17-456"></a></span>
<span id="cb17-457"><a href="#cb17-457"></a><span class="fu">### Example</span></span>
<span id="cb17-458"><a href="#cb17-458"></a></span>
<span id="cb17-459"><a href="#cb17-459"></a>We examine the <span class="in">`cars93`</span> data, where the numeric variables of interest</span>
<span id="cb17-460"><a href="#cb17-460"></a>are <span class="in">`weight`</span> and <span class="in">`price`</span>.</span>
<span id="cb17-461"><a href="#cb17-461"></a></span>
<span id="cb17-462"><a href="#cb17-462"></a><span class="in">```{r Spearman_example_1}</span></span>
<span id="cb17-463"><a href="#cb17-463"></a>cars93 <span class="sc">%&gt;%</span> </span>
<span id="cb17-464"><a href="#cb17-464"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(weight, price)) <span class="sc">+</span> </span>
<span id="cb17-465"><a href="#cb17-465"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb17-466"><a href="#cb17-466"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Car Weight and Car Price have a nonlinear relationship"</span>)</span>
<span id="cb17-467"><a href="#cb17-467"></a><span class="in">```</span></span>
<span id="cb17-468"><a href="#cb17-468"></a></span>
<span id="cb17-469"><a href="#cb17-469"></a>Let us try a Spearman Correlation score for these variables, since the</span>
<span id="cb17-470"><a href="#cb17-470"></a>data are not linearly related and the variance of <span class="in">`price`</span> also is not</span>
<span id="cb17-471"><a href="#cb17-471"></a>constant over <span class="in">`weight`</span></span>
<span id="cb17-472"><a href="#cb17-472"></a></span>
<span id="cb17-473"><a href="#cb17-473"></a><span class="in">```{r Spearman_example_2}</span></span>
<span id="cb17-474"><a href="#cb17-474"></a><span class="fu">cor.test</span>(cars93<span class="sc">$</span>price, cars93<span class="sc">$</span>weight, <span class="at">method =</span> <span class="st">"spearman"</span>) <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb17-475"><a href="#cb17-475"></a></span>
<span id="cb17-476"><a href="#cb17-476"></a><span class="co"># Using linear Model</span></span>
<span id="cb17-477"><a href="#cb17-477"></a><span class="fu">lm</span>(<span class="fu">rank</span>(price) <span class="sc">~</span> <span class="fu">rank</span>(weight), <span class="at">data =</span> cars93) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb17-478"><a href="#cb17-478"></a></span>
<span id="cb17-479"><a href="#cb17-479"></a><span class="co"># Stats Plot</span></span>
<span id="cb17-480"><a href="#cb17-480"></a>ggstatsplot<span class="sc">::</span><span class="fu">ggscatterstats</span>(<span class="at">data =</span> cars93, <span class="at">x =</span> weight, </span>
<span id="cb17-481"><a href="#cb17-481"></a>                            <span class="at">y =</span> price,</span>
<span id="cb17-482"><a href="#cb17-482"></a>                            <span class="at">type =</span> <span class="st">"nonparametric"</span>,</span>
<span id="cb17-483"><a href="#cb17-483"></a>                            <span class="at">title =</span> <span class="st">"Cars93: Weight vs Price"</span>,</span>
<span id="cb17-484"><a href="#cb17-484"></a>                            <span class="at">subtitle =</span> <span class="st">"Spearman Correlation"</span>)</span>
<span id="cb17-485"><a href="#cb17-485"></a><span class="in">```</span></span>
<span id="cb17-486"><a href="#cb17-486"></a></span>
<span id="cb17-487"><a href="#cb17-487"></a>We see that using ranks of the <span class="in">`price`</span> variable, we obtain a Spearman's</span>
<span id="cb17-488"><a href="#cb17-488"></a>$\rho = 0.882$ with a <span class="in">`p-value`</span> that is very small. Hence we are able to</span>
<span id="cb17-489"><a href="#cb17-489"></a>reject the NULL hypothesis and state that there is a relationship</span>
<span id="cb17-490"><a href="#cb17-490"></a>between these two variables. The **linear** relationship is evaluated as</span>
<span id="cb17-491"><a href="#cb17-491"></a>a correlation of <span class="in">`0.882`</span>.</span>
<span id="cb17-492"><a href="#cb17-492"></a></span>
<span id="cb17-495"><a href="#cb17-495"></a><span class="in">```{r}</span></span>
<span id="cb17-496"><a href="#cb17-496"></a><span class="co"># Other ways using other packages</span></span>
<span id="cb17-497"><a href="#cb17-497"></a>mosaic<span class="sc">::</span><span class="fu">cor_test</span>(gpa <span class="sc">~</span> study_hours, <span class="at">data =</span> gpa_study_hours) <span class="sc">%&gt;%</span> broom<span class="sc">::</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(estimate, p.value, conf.low, conf.high)</span>
<span id="cb17-498"><a href="#cb17-498"></a></span>
<span id="cb17-499"><a href="#cb17-499"></a><span class="in">```</span></span>
<span id="cb17-500"><a href="#cb17-500"></a></span>
<span id="cb17-503"><a href="#cb17-503"></a><span class="in">```{r}</span></span>
<span id="cb17-504"><a href="#cb17-504"></a>statsExpressions<span class="sc">::</span><span class="fu">corr_test</span>(<span class="at">data =</span> gpa_study_hours, </span>
<span id="cb17-505"><a href="#cb17-505"></a>                            <span class="at">x =</span> study_hours, </span>
<span id="cb17-506"><a href="#cb17-506"></a>                            <span class="at">y =</span> gpa)</span>
<span id="cb17-507"><a href="#cb17-507"></a><span class="in">```</span></span>
<span id="cb17-508"><a href="#cb17-508"></a></span>
<span id="cb17-509"><a href="#cb17-509"></a><span class="fu"># References</span></span>
<span id="cb17-510"><a href="#cb17-510"></a></span>
<span id="cb17-511"><a href="#cb17-511"></a><span class="ss">1.  </span>*Common statistical tests are linear models (or: how to teach</span>
<span id="cb17-512"><a href="#cb17-512"></a>    stats)* by [Jonas Kristoffer</span>
<span id="cb17-513"><a href="#cb17-513"></a>    Lindeløv](https://lindeloev.github.io/tests-as-linear/)</span>
<span id="cb17-514"><a href="#cb17-514"></a></span>
<span id="cb17-515"><a href="#cb17-515"></a><span class="ss">2.  </span><span class="co">[</span><span class="ot">CheatSheet</span><span class="co">](https://lindeloev.github.io/tests-as-linear/linear_tests_cheat_sheet.pdf)</span></span>
<span id="cb17-516"><a href="#cb17-516"></a></span>
<span id="cb17-517"><a href="#cb17-517"></a><span class="ss">3.  </span>*Common statistical tests are linear models: a work through* by</span>
<span id="cb17-518"><a href="#cb17-518"></a>    <span class="co">[</span><span class="ot">Steve Doogue</span><span class="co">](https://steverxd.github.io/Stat_tests/)</span></span>
<span id="cb17-519"><a href="#cb17-519"></a></span>
<span id="cb17-520"><a href="#cb17-520"></a><span class="ss">4.  </span>[Jeffrey Walker "Elements of Statistical Modeling for Experimental</span>
<span id="cb17-521"><a href="#cb17-521"></a>    Biology"](https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/)</span>
<span id="cb17-522"><a href="#cb17-522"></a></span>
<span id="cb17-523"><a href="#cb17-523"></a><span class="ss">5.  </span>Diez, David M &amp; Barr, Christopher D &amp; Çetinkaya-Rundel, Mine:</span>
<span id="cb17-524"><a href="#cb17-524"></a>    <span class="co">[</span><span class="ot">OpenIntro Statistics</span><span class="co">](https://www.openintro.org/book/os/)</span></span>
<span id="cb17-525"><a href="#cb17-525"></a></span>
<span id="cb17-526"><a href="#cb17-526"></a><span class="ss">6.  </span>Modern Statistics with R: From wrangling and exploring data to</span>
<span id="cb17-527"><a href="#cb17-527"></a>    inference and predictive modelling by [Måns</span>
<span id="cb17-528"><a href="#cb17-528"></a>    Thulin](http://www.modernstatisticswithr.com/)</span>
<span id="cb17-529"><a href="#cb17-529"></a></span>
<span id="cb17-530"><a href="#cb17-530"></a><span class="ss">7.  </span>[Jeffrey Walker "A</span>
<span id="cb17-531"><a href="#cb17-531"></a>    linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables"](https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#a-linear-model-can-be-fit-to-data-with-continuous-discrete-or-categorical-x-variables)</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>