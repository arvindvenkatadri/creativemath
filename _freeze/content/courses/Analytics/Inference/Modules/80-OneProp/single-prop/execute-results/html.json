{
  "hash": "b32b0b7774e10aab4ae39af216a89ca6",
  "result": {
    "markdown": "---\ntitle: \"\\U0001F0CF Testing a Single Proportion\"\nauthor: \"Arvind Venkatadri\"\ndate: 10/Nov/2022\ndate-modified: \"2023-04-24\"\nabstract: \"Using Permutation Tests to check the significance of a proportion\"\norder: 80\nimage: preview.jpg\nimage-alt: From The Internet Archive\ncategories:\n- Permutation\n- Monte Carlo Simulation\n- Random Number Generation\n- Distributions\n- Generating Parallel Worlds\n---\n\n\n\n## {{< iconify noto-v1 package >}} Setting up R packages\n\n\n::: {.cell hash='single-prop_cache/html/setup_4fe4ac7a4836ef812b74eafe2f452e27'}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE,message = TRUE,warning = TRUE, fig.align = \"center\")\noptions(digits=2)\nlibrary(tidyverse)\nlibrary(mosaic)\nlibrary(ggformula)\nlibrary(ggmosaic) # plotting mosaic plots for Categorical Data\nlibrary(vcd) # Creating Tables and plotting mosaic charts\n\n## Datasets from Chihara and Hesterberg's book (Second Edition)\nlibrary(resampledata)\n\n## Datasets from Cetinkaya-Rundel and Hardin's book (First Edition)\nlibrary(openintro)\n```\n:::\n\n\n## Introduction\n\nWe saw from the diagram created by Allen Downey that *there is only one\ntest*! We will now use this philosophy to develop a technique that\nallows us to mechanize several *Statistical Models* in that way, with\nnearly identical code.\n\nWe will use two packages in R, `mosaic` to develop our intuition for\nwhat are called **permutation** based statistical tests. (There is also\na more recent package called `infer` in R which can do pretty much all\nof this, including visualization. In my opinion, the code is a little\ntoo high-level and does not offer quite the detailed insight that the\n`mosaic` package does).\n\n## Permutation Visually Demonstrated\n\nWe will look visually at a permutation exercise. We will create dummy\ndata that contains the following case study:\n\n> A set of identical resumes was sent to male and female evaluators. The\n> candidates in the resumes were of both genders. We wish to see if\n> there was difference in the way resumes were evaluated, by male and\n> female evaluators. (We use just *one* male and *one* female evaluator\n> here, to keep things simple!)\n\n\n::: {.cell layout-align=\"center\" hash='single-prop_cache/html/Artificial Data_462a17d9522e2e2da45c6d4a64269d27'}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"evaluator\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"candidate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"0\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"0\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"0\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"F\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"0\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"0\"},{\"1\":\"M\",\"2\":\"0\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"0\"},{\"1\":\"M\",\"2\":\"0\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"0\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"0\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"1\"},{\"1\":\"M\",\"2\":\"0\"},{\"1\":\"M\",\"2\":\"0\"},{\"1\":\"M\",\"2\":\"0\"},{\"1\":\"M\",\"2\":\"0\"},{\"1\":\"M\",\"2\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"evaluator\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"selection_ratio\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"count\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"F\",\"2\":\"0.12\",\"3\":\"3\",\"4\":\"24\"},{\"1\":\"M\",\"2\":\"0.46\",\"3\":\"11\",\"4\":\"24\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n    M \n-0.33 \n```\n:::\n:::\n\n\nSo, we have a solid disparity in percentage of selection between the two\nevaluators! Let us first plot this:\n\n\n::: {.cell layout-align=\"center\" hash='single-prop_cache/html/unnamed-chunk-3_399727d4a2d35ecddacb178c894a8f5a'}\n::: {.cell-output-display}\n![](single-prop_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nNow we pretend that *there is no difference between the selections made\nby either set of evaluators*. So we can just:\n\n-   Pool up all the evaluations\n\n-   Arbitrarily re-assign a given candidate(selected or rejected) to\n    either of the two sets of evaluators, by permutation.\n\n    How would that pooled shuffled set of evaluations look like?\n\n\n    ::: {.cell layout-align=\"center\" hash='single-prop_cache/html/Shuffle the data once_90c43fe25913accd1243847cbb9ce2d6'}\n    ::: {.cell-output-display}\n    `````{=html}\n    <div data-pagedtable=\"false\">\n      <script data-pagedtable-source type=\"application/json\">\n    {\"columns\":[{\"label\":[\"evaluator\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"selection_ratio\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"count\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"F\",\"2\":\"0.25\",\"3\":\"6\",\"4\":\"24\"},{\"1\":\"M\",\"2\":\"0.33\",\"3\":\"8\",\"4\":\"24\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n      </script>\n    </div>\n    `````\n    :::\n    :::\n\n    ::: {.cell layout-align=\"center\" hash='single-prop_cache/html/unnamed-chunk-5_0c7e041bf57086226e2e3ae0d7889e47'}\n    \n    :::\n\n::: {.cell layout-align=\"center\" hash='single-prop_cache/html/unnamed-chunk-6_fd82128edc598b1a26204a6c0f9ea088'}\n\n:::\n\n::: {.cell layout-align=\"center\" hash='single-prop_cache/html/unnamed-chunk-7_de13362bb6cde2b6c6b17a2276f8efce'}\n::: {.cell-output-display}\n![](single-prop_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nAs can be seen, the ratio is different! We can now do this many many\ntimes, to check out our Hypothesis that there is *no* bias. We can plot\nthe distribution of the differences in selection ratio and see how that\nartificially created distribution compares with mother-nature, the\noriginally observed figure.\n\n\n::: {.cell layout-align=\"center\" hash='single-prop_cache/html/unnamed-chunk-8_ba4548c581fe3d65637ae83fca67761e'}\n\n```{.r .cell-code}\nnull_dist <- do(10000) * diff(mean(candidate ~ shuffle(evaluator), data = data))\nnull_dist %>% names()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"M\"\n```\n:::\n\n```{.r .cell-code}\nnull_dist %>% gf_histogram( ~ M, \n                            fill = ~ (M <= obs_difference)) %>% \n  gf_vline(xintercept = ~ obs_difference, color = \"red\" )\n```\n\n::: {.cell-output-display}\n![](single-prop_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\nmean(~ M<= obs_difference, data = null_dist)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.013\n```\n:::\n:::\n\n\nWe see that the artificial data can hardly ever (\\$ p = 0.012\\$) mimic\nwhat the real world experiment is showing. Hence we had good reason to\nreject our Hypothesis that there is no bias.\n\n## An Example\n\n## Conclusion\n\n## References\n\n1.  [OpenIntro Modern Statistics: Chapter\n    17](https://openintro-ims.netlify.app/inference-one-prop.html)\n2.  Chihara and Hesterberg\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}