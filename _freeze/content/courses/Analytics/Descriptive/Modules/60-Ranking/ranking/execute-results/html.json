{
  "hash": "bd5968a1f4493f416d9e84c9dea11b57",
  "result": {
    "markdown": "---\ntitle: \"\\U0001F58F Ratings and Rankings\"\nsubtitle: \"Ranking\"\nauthor: \"Arvind Venkatadri\"\ndate: 10 Feb 2023\ndate-modified: \"2023-04-15\"\norder : 60\nabstract: \"Comparisons between observations and between variables\"\nimage: preview.jpg\nimage-alt: Photo by Jonathan Chng on Unsplash\ncategories:\n- Bar Charts\n- Lollipop Charts\n- Radar Charts\n- Word Clouds\n- Bump Charts\n---\n\n\n## {{< fa folder-open >}} Slides and Tutorials\n\nTBD.\n\n## {{< iconify noto-v1 package >}} Setting up R Packages\n\n\n::: {.cell hash='ranking_cache/html/setup_d63d99b1220d8598a93bee436519f852'}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(tidyverse) # includes ggplot for plotting\nlibrary(mosaic)\nlibrary(ggformula)\n\nlibrary(ggbump) # Bump Charts\n\nlibrary(ggiraphExtra) # Radar, Spine, Donut and Donut-Pie combo charts !!\n\n# install.packages(\"devtools\")\n# devtools::install_github(\"ricardo-bion/ggradar\")\nlibrary(ggradar) # Radar Plots\n```\n:::\n\n\n## What graphs are we going to see today?\n\nWhen we wish to compare the size of things and rank them, there are\nquite a few ways to do it.\n\nBar Charts and Lollipop Charts are immediately obvious when we wish to\nrank things on *one* aspect or parameter.\n\nWhen we wish to rank the same set of objects against **multiple**\naspects or parameters, then we can use Bump Charts and Radar Charts.\n\n## Lollipop Charts\n\n\n::: {.cell hash='ranking_cache/html/unnamed-chunk-1_707974bc50cdf0fcd2016fcd3d3f0e19'}\n\n```{.r .cell-code}\n# Sample data set\nset.seed(1)\ndf1 <- tibble(x = LETTERS[1:10],\n                 y = sample(20:35, 10, replace = TRUE))\ndf1\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"x\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"y\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"A\",\"2\":\"28\"},{\"1\":\"B\",\"2\":\"23\"},{\"1\":\"C\",\"2\":\"26\"},{\"1\":\"D\",\"2\":\"20\"},{\"1\":\"E\",\"2\":\"21\"},{\"1\":\"F\",\"2\":\"32\"},{\"1\":\"G\",\"2\":\"26\"},{\"1\":\"H\",\"2\":\"30\"},{\"1\":\"I\",\"2\":\"33\"},{\"1\":\"J\",\"2\":\"21\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ngf_segment(0 + y ~ x + x, data = df1) %>% \n# A formula with shape y + yend ~ x + xend.\n  \n  gf_point(y ~ x, colour = ~ x, size = 5)\n```\n\n::: {.cell-output-display}\n![](ranking_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Compare with ggplot code:\n# ggplot(df1) + \n#   geom_segment(aes(x = x, xend = x, y = 0, yend = y)) + \n#   geom_point(aes(x = x, y = y, colour = x), size = 5)\n```\n:::\n\n\nWe can flip this horizontally *and* reorder the $x$ categories in order\nof decreasing ( or increasing ) $y$, using `forcats::fct_reorder`:\n\n\n::: {.cell hash='ranking_cache/html/unnamed-chunk-2_c4d5cbf822d5b327d2b742387356d6ed'}\n\n```{.r .cell-code}\ngf_segment(0 + y ~ fct_reorder(x, -y) + fct_reorder(x, -y), \n           data = df1) %>%\n  # A formula with shape y + yend ~ x + xend.\n  \n  gf_point(y ~ x, colour = ~ x, size = 5) %>%\n  \n  gf_refine(coord_flip()) %>%\n  gf_labs(x = \"Group\", y = \"\") %>%\n  gf_theme(theme_minimal())\n```\n\n::: {.cell-output-display}\n![](ranking_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Compare with ggplot code\n# ggplot(df1) + \n#   geom_segment(aes(x = fct_reorder(x, -y), # in decreasing order of y\n#                    xend = fct_reorder(x, -y), \n#                    y = 0, \n#                    yend = y)) + \n#   geom_point(aes(x = x, y = y, colour = x), size = 5) +\n#   coord_flip() + \n#   xlab(\"Group\") +\n#   ylab(\"\") +\n#   theme_minimal()\n```\n:::\n\n\n## Bump Charts\n\nBump Charts track the ranking of several objects based on *other*\nparameters, such as time/month or even category. For instance, what is\nthe opinion score of a set of products across various categories of\nusers:\n\n\n::: {.cell hash='ranking_cache/html/unnamed-chunk-3_5cbab407d41bc90be5beaae257f53bf0'}\n\n```{.r .cell-code}\nyear <- rep(2019:2021, 4)\nposition <- c(4, 2, 2, 3, 1, 4, 2, 3, 1, 1, 4, 3)\nproduct <- c(\"A\", \"A\", \"A\",\n            \"B\", \"B\", \"B\", \n            \"C\", \"C\", \"C\",\n            \"D\", \"D\", \"D\")\n\ndf2 <- tibble(x = year,\n                 y = position,\n                 group = product)\n\ndf2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"x\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"y\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"group\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"2019\",\"2\":\"4\",\"3\":\"A\"},{\"1\":\"2020\",\"2\":\"2\",\"3\":\"A\"},{\"1\":\"2021\",\"2\":\"2\",\"3\":\"A\"},{\"1\":\"2019\",\"2\":\"3\",\"3\":\"B\"},{\"1\":\"2020\",\"2\":\"1\",\"3\":\"B\"},{\"1\":\"2021\",\"2\":\"4\",\"3\":\"B\"},{\"1\":\"2019\",\"2\":\"2\",\"3\":\"C\"},{\"1\":\"2020\",\"2\":\"3\",\"3\":\"C\"},{\"1\":\"2021\",\"2\":\"1\",\"3\":\"C\"},{\"1\":\"2019\",\"2\":\"1\",\"3\":\"D\"},{\"1\":\"2020\",\"2\":\"4\",\"3\":\"D\"},{\"1\":\"2021\",\"2\":\"3\",\"3\":\"D\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nWe need to use a new package called, what else, `ggbump` to create our\n`Bump Charts`: Here again we do not yet have a `ggformula` equivalent .\nNote the `+` syntax with ggplot code!!\n\n\n::: {.cell hash='ranking_cache/html/bump-1_9742574b7ca5b21faa9ec1c8ea2edfb5'}\n\n```{.r .cell-code}\nlibrary(ggbump)\n\nggplot(df2) +\n  geom_bump(aes(x = x, y = y, color = group)) +\n  geom_point(aes(x = x, y = y, color = group), size = 6) +\n  theme_minimal() +\n  xlab(\"Time\") +\n  ylab(\"Product Rank\") +\n  scale_color_brewer(palette = \"RdBu\") # Change Colour Scale\n```\n\n::: {.cell-output-display}\n![](ranking_files/figure-html/bump-1-1.png){width=672}\n:::\n:::\n\n\nWe can add labels along the \"bump lines\" and remove the legend\naltogether:\n\n\n::: {.cell hash='ranking_cache/html/bump-2_ce1844b6bfbb9993e2c61b856fe8efeb'}\n\n```{.r .cell-code}\nggplot(df2) +\n  geom_bump(aes(x = x, y = y, color = group)) +\n  geom_point(aes(x = x, y = y, color = group), size = 6) +\n  theme_minimal() +\n  scale_color_brewer(palette = \"RdBu\") + # Change Colour Scale\n# Same as before up to her\n# Add the labels at start and finish\n\n  geom_text(data = df2 %>% filter(x == min(x)),\n            aes(x = x - 0.1, label = group, y = y),\n            size = 5, hjust = 1) +\n  geom_text(data = df2 %>% filter(x == max(x)),\n            aes(x = x + 0.1, label = group, y = y),\n            size = 5, hjust = 0) +\n  xlab(\"Time\") +\n  ylab(\"Product Rank\") +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](ranking_files/figure-html/bump-2-1.png){width=672}\n:::\n:::\n\n\n## Radar Charts\n\nThe same data can be plotted on a roughly circular set of axes, with the\nradial distance defining the rank against each axes.\n\nOf course, we can use `ggradar`, which is at this time (Feb 2023) a\ndevelopment version and not yet part of CRAN. We will still try it, and\nanother package `ggiraphExtra` which IS a part of CRAN.\n\n\n::: {.cell hash='ranking_cache/html/using ggradar_f79a95d5f36842691d66d1209602cbbf'}\n\n```{.r .cell-code}\n#library(ggradar)\n\nset.seed(4)\ndf3 <- tibble(Product = c(\"G1\", \"G2\", \"G3\"),\n              Power = runif(3), \n              Cost = runif(3),\n              Harmony = runif(3),\n              Style = runif(3),\n              Size = runif(3),\n              Manufacturability = runif(3),\n              Durability = runif(3),\n              Universality = runif(3))\ndf3\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Product\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Power\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Cost\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Harmony\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Style\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Size\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Manufacturability\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Durability\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Universality\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"G1\",\"2\":\"0.585800305\",\"3\":\"0.2773750\",\"4\":\"0.7244059\",\"5\":\"0.07314447\",\"6\":\"0.1000535\",\"7\":\"0.4551024\",\"8\":\"0.9622046\",\"9\":\"0.9966129\"},{\"1\":\"G2\",\"2\":\"0.008945796\",\"3\":\"0.8135742\",\"4\":\"0.9060922\",\"5\":\"0.75467503\",\"6\":\"0.9540688\",\"7\":\"0.9710557\",\"8\":\"0.7617024\",\"9\":\"0.5062709\"},{\"1\":\"G3\",\"2\":\"0.293739612\",\"3\":\"0.2604278\",\"4\":\"0.9490402\",\"5\":\"0.28600062\",\"6\":\"0.4156071\",\"7\":\"0.5839880\",\"8\":\"0.7145085\",\"9\":\"0.4899432\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nggradar::ggradar(plot.data = df3,\n                 axis.label.size = 3, # Titles of Params\n                 grid.label.size = 4, # Score Values/Circles\n                 group.point.size = 3,# Product Points Sizes\n                 group.line.width = 1, # Product Line Widths\n                 fill = TRUE, # fill the radar polygons\n                 fill.alpha = 0.3, # Not too dark, Arvind\n                 legend.title = \"Product\") +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](ranking_files/figure-html/using ggradar-1.png){width=672}\n:::\n:::\n\n\nFrom the `ggiraphExtra` website:\n\n> Package `ggiraphExtra` contains many useful functions for exploratory\n> plots. These functions are made by both 'ggplot2' and 'ggiraph'\n> packages. You can make a static ggplot or an interactive ggplot by\n> setting the parameter interactive=TRUE.\n\n\n::: {.cell hash='ranking_cache/html/using ggiraphExtra_b4372b1aea47f6454ad41f550162ea70'}\n\n```{.r .cell-code}\n# library(ggiraphExtra)\n\nggiraphExtra::ggRadar(data = df3,\n        aes(colour = Product),\n        rescale = FALSE,\n          )  + # recale = TRUE makes it look different...try!!\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](ranking_files/figure-html/using ggiraphExtra-1.png){width=672}\n:::\n:::\n\n\nBoth render very similar-looking radar charts and the syntax is not too\nintimidating!!\n\n## Your Turn\n\n1.  Take the `HELPrct` dataset from our well used `mosaicData` package.\n    Plot ranking charts using each of the public health issues that you\n    can see in that dataset. What choice will you make for the the axes?\n2.  Try the `SaratogaHouses` dataset also from `mosaicData`.\n\n# References\n\n1.  Keon-Woong Moon, R Package `ggiraphExtra`,\n    <https://cran.r-project.org/web/packages/ggiraphExtra/vignettes/introduction.html>\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}