{
  "hash": "adb0c92fadb4369c1bb3c59b9614eb0e",
  "result": {
    "markdown": "---\ntitle: \"\\U0001F578 Evolution and Flow\"\nsubtitle: \"Evolution and Flow\"\nauthor: \"Arvind Venkatadri\"\ndate: 22/Nov/2022\ndate-modified: \"2023-04-02\"\norder: 40\nabstract: \"Changes in Information over space and time\"\nimage: preview.jpg\nimage-alt: image from rawpixel.com\ncategories:\n- Line and Area Plots\n- Stream Charts\n- Alluvial Plots\n- Sankey Diagrams\n- Chord Diagrams\n- Waterfall Plots\n- Bump Charts\n---\n\n\n## {{< fa folder-open >}} Slides and Tutorials\n\n|                                                                                        |                                                                                                                       |                                                                                                 |                                                                               |\n|-----------------|---------------------|-----------------|-----------------|\n| <a href=\"./files/evolutions.qmd\"><i class=\"fa-brands fa-r-project\"></i> R Tutorial</a> | <a href=\"./files/evolutions.ows\"> <iconify-icon icon=\"fluent-emoji:orange-circle\"></iconify-icon> Orange Tutorial</a> | <a href=\"./files/evolutions.rda\"> <i class=\"fa-solid fa-person-rays\"></i> Radiant Tutorial </a> | <a href=\"./data/data.zip\"> <i class=\"fa-solid fa-database\"> </i> Datasets</a> |\n\n## {{< iconify noto-v1 package >}} Setting up R Packages\n\n\n::: {.cell hash='evol-flow_cache/html/setup_54578990219faafbcf06dd9f5e40235b'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(ggstream)\n\n# remotes::install_github(\"corybrunson/ggalluvial@main\", build_vignettes = TRUE)\nlibrary(ggalluvial)\n```\n:::\n\n\n## What Time Evolution Charts can we plot?\n\nIn these cases, the x-axis is typically *time*...and we chart the\nvariable of another Quant variable with respect to time, using a *line*\ngeometry.\n\nLet is take a healthcare budget dataset from [Our World in\nData](https://ourworldindata.org/grapher/public-health-expenditure-share-GDP-OWID):\nWe will plot graphs for 5 countries (India, China, Brazil, Russia,\nCanada ). Download this data by clicking on the button below:\n\n{{< downloadthis data/public-health-expenditure-share-GDP-OWID.csv dname=\"public-health-expenditure-share-GDP-OWID\" label=\"Download the Health data\" icon=\"database-fill-down\" type=\"info\">}}\n\n\n::: {.cell hash='evol-flow_cache/html/unnamed-chunk-2_da08613014508ccdfa319c1c3c494a0a'}\n\n```{.r .cell-code}\nhealth <-\n  read_csv(\"data/public-health-expenditure-share-GDP-OWID.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 2177 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Entity, Code\ndbl (2): Year, public_health_expenditure_pc_gdp\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nhealth_filtered <- health %>%\n  filter(Entity %in% c(\n    \"India\",\n    \"China\",\n    \"United States\",\n    \"United Kingdom\",\n    \"Russia\",\n    \"Sweden\"\n  ))\np1 <- ggplot(health_filtered,\n         aes(x = Year, y = public_health_expenditure_pc_gdp, colour = Entity)) + geom_line() + labs(y = \"Healthcare Budget\\n as % of GDP\")\n\np2 <-  \n  ggplot(health_filtered,\n         aes(x = Year, y = public_health_expenditure_pc_gdp, fill = Entity)) + geom_area()+ labs(y = \"Healthcare Budget\\n as % of GDP\")\n\n\np1 / p2 + plot_layout(nrow = 2) + plot_annotation(title = \"Line and Area Charts to show Evolution (over Time )\",subtitle = \"\", tag_levels = 'A') & theme_minimal()\n```\n\n::: {.cell-output-display}\n![](evol-flow_files/figure-html/unnamed-chunk-2-1.png){width=4200}\n:::\n:::\n\n\n## What Space Evolution Charts can we plot?\n\nHere, the *space* can be any Qual variable, and we can chart another\nQuant or Qual variable move across levels of the first chosen Qual\nvariable.\n\nFor instance we can contemplate Enrollment at a University, and show how\nstudents move from course to course in a University. Or how customers\ndrift from one category of products or brands to another....or the\nmovement of cricket players from one IPL Team to another !!\n\n> A Sankey diagram is a visualization used to depict a flow from one set\n> of values to another. The things being connected are called\n> **stages/axes**, **nodes / strata** and the connections are called\n> **flows / links / alluvia**. Sankeys are best used when you want to\n> show a many-to-many mapping between two domains or multiple paths\n> through a set of stages E.g Students going through multiple courses\n> during a semester of study.\n\n![](images/sankey.png){fig-align=\"center\"}\n\n\n::: {.cell hash='evol-flow_cache/html/more-charts_2838fc82100c8641bb4a384ee568354b'}\n\n```{.r .cell-code}\nlibrary(ggalluvial)\ndata(\"Titanic\")\nTitanic %>% as_tibble() %>% \nggplot(data = .,\n       aes(axis1 = Class, axis2 = Sex, axis3 = Age,\n           y = n)) +\n  geom_alluvium(aes(fill = Survived),size = .25) +\n  geom_stratum() + \n  geom_text(stat = \"stratum\", aes(label = after_stat(stratum))) +\n  scale_x_discrete(limits = c(\"Class\", \"Sex\", \"Age\"), \n                   expand = c(.2, .05)) +\n  scale_fill_manual(values = c(\"darkgoldenrod\", \"purple\")) + \n  xlab(\"Demographic\") +\n  theme_minimal() +\n  ggtitle(\"passengers on the maiden voyage of the Titanic\",\n          \"stratified by demographics and survival\")\n```\n\n::: {.cell-output-display}\n![](evol-flow_files/figure-html/more-charts-1.png){width=4200}\n:::\n:::\n\n\nHere is another example of a Sankey Diagram: This diagram show how\nenergy is converted or transmitted before being consumed or lost:\nsupplies are on the left, and demands are on the right. Data: Department\nof Energy & Climate Change via Tom Counsell:\n\n<iframe width=\"100%\" height=\"684\" frameborder=\"0\" src=\"https://observablehq.com/embed/@d3/sankey?cells=chart\">\n\n</iframe>\n\n## Chord Diagram\n\nWe will explore this diagram when we explore network graphs with the\n`tidygraph` and `ggraph` packages.\n\n## Conclusion\n\nWe see that we can visualize 'evolutions\" over time and space. The\nevolutions can represent changes in the **quantities** of things, or\ntheir **categorical** affiliations or groups.\n\nWhat business data would you depict in this way? Revenue streams?\nEmployment? Expenditures over time and market? There are many\npossibilities!\n\n## Your Turn\n\n1.  Within the `ggalluvial` package are two datasets, `majors` and\n    `vaccinations`. Plot alluvial charts for both of these.\n2.  Go to the [American Life Panel\n    Website](https://alpdata.rand.org/index.php?page=data) where you\n    will find many public datasets. Try to take one and make charts from\n    it that we have learned in this Module.\n\n## References\n\n1.  Global Migration, <https://download.gsb.bund.de/BIB/global_flow/> A\n    good example of the use of a Chord Diagram.\n2.  Cory Brunson, `ggalluvial,`\n    <https://corybrunson.github.io/ggalluvial/>\n3.  Other packages: [Sankey plot \\| the R Graph Gallery\n    (r-graph-gallery.com)](https://r-graph-gallery.com/sankey-diagram.html)\n4.  Another package: [Sankey diagrams in ggplot2 with ggsankey \\| R\n    CHARTS\n    (r-charts.com)](https://r-charts.com/flow/sankey-diagram-ggplot2/)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}