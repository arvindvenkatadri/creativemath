{
  "hash": "b5d58aa1c30840d87458511ee3d99837",
  "result": {
    "markdown": "---\ntitle: \"\\U0001F409 Visualizing Categorical Data\"\nauthor: \"Arvind Venkatadri\"\ndate: 27/Dec/2022\ndate-modified: \"2023-05-29\"\nabstract: Types, Categories, and Counts\norder: 120\ncategories:\n- Proportions\n- Frequency Tables\n- Contingency Tables\n- Numerical Data in Groups\n- Margins\n- Likert Scale data\n- Bar Plots (for Contingency Tables)\n- Mosaic Plots\n- Balloon Plots\n- Pie Charts\n- Correspondence Analysis\n---\n\n::: {.cell hash='index_cache/html/setup_b6990b4151ce3114a221b739a7733847'}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(tidyverse)\nlibrary(skimr)\nlibrary(vcd) # Michael Friendly's package, Visualizing Categorical Data\nlibrary(vcdExtra) # Categorical Data Sets\nlibrary(sjPlot) # Likert Scale Plots\nlibrary(ggpubr) # Colours, Themes and geometries in ggplot\nlibrary(ca) # Correspondence Analysis, for use some day\n\nlibrary(mosaic) # Our trusted friend\n\n## Making Tables\nlibrary(kableExtra) # html styled tables\nlibrary(gt) # Making Cool Tables\nlibrary(patchwork) # To arrange plots on a grid and other things\n```\n:::\n\n\n# Introduction\n\nTo recall, a categorical **variable** is one for which the possible\nmeasured or assigned values consist of a discrete set of categories,\nwhich may be `ordered` or `unordered`. Some typical examples are:\n\n-   Gender, with categories \"Male,\" \"Female.\"\n-   Marital status, with categories \"Never married,\" \"Married,\"\n    \"Separated,\" \"Divorced,\" \"Widowed.\"\n-   Fielding position (in ~~baseball~~ cricket), with categories\n    \"Slips,\"Cover \",\"Mid-off \"Deep Fine Leg\", \"Close-in\", \"Deep\"...\n-   Side effects (in a pharmacological study), with categories \"None,\"\n    \"Skin rash,\" \"Sleep disorder,\" \"Anxiety,\" . . ..\n-   Political attitude, with categories \"Left,\" \"Center,\" \"Right.\"\n-   Party preference (in India), with categories \"BJP\" \"Congress,\"\n    \"AAP,\" \"TMC\"...\n-   Treatment outcome, with categories \"no improvement,\" \"some\n    improvement,\" or \"marked improvement.\"\n-   Age, with categories \"0--9,\" \"10--19,\" \"20--29,\" \"30--39,\" . . . .\n-   Number of children, with categories 0, 1, 2, . . . .\n\nAs these examples suggest, categorical variables differ in the number of\ncategories: we often distinguish binary variables (or dichotomous\nvariables) such as Gender from those with more than two categories\n(called polytomous variables).\n\n\n{{< video https://www.youtube.com/embed/7NhNeADL8fA >}}\n\n\n\n# Categorical Data\n\nFrom the `{vcd package}` vignette:\n\n> The first thing you need to know is that categorical data can be\n> represented in **three different forms in R**, and it is sometimes\n> necessary to convert from one form to another, for carrying out\n> statistical tests, fitting models or visualizing the results.\n\n-   Case Data\n-   Frequency Data\n-   Cross-Tabular Count Data\n\nLet us first see examples of each.\n\n::: panel-tabset\n## Case Form\n\nContaining *individual observations* with one or more **categorical**\nfactors, used as classifying variables. The total number of observations\nis `nrow(X)`, and the number of variables is `ncol(X)`.\n\n\n::: {.cell hash='index_cache/html/Arthritis-Dataset_1547def87165339719d01b7a37271169'}\n\n```{.r .cell-code}\nArthritis\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"ID\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Treatment\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"Sex\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"Age\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Improved\"],\"name\":[5],\"type\":[\"ord\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"57\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"27\",\"5\":\"Some\",\"_rn_\":\"1\"},{\"1\":\"46\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"29\",\"5\":\"None\",\"_rn_\":\"2\"},{\"1\":\"77\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"30\",\"5\":\"None\",\"_rn_\":\"3\"},{\"1\":\"17\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"32\",\"5\":\"Marked\",\"_rn_\":\"4\"},{\"1\":\"36\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"46\",\"5\":\"Marked\",\"_rn_\":\"5\"},{\"1\":\"23\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"58\",\"5\":\"Marked\",\"_rn_\":\"6\"},{\"1\":\"75\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"59\",\"5\":\"None\",\"_rn_\":\"7\"},{\"1\":\"39\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"59\",\"5\":\"Marked\",\"_rn_\":\"8\"},{\"1\":\"33\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"63\",\"5\":\"None\",\"_rn_\":\"9\"},{\"1\":\"55\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"63\",\"5\":\"None\",\"_rn_\":\"10\"},{\"1\":\"30\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"64\",\"5\":\"None\",\"_rn_\":\"11\"},{\"1\":\"5\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"64\",\"5\":\"Some\",\"_rn_\":\"12\"},{\"1\":\"63\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"69\",\"5\":\"None\",\"_rn_\":\"13\"},{\"1\":\"83\",\"2\":\"Treated\",\"3\":\"Male\",\"4\":\"70\",\"5\":\"Marked\",\"_rn_\":\"14\"},{\"1\":\"66\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"23\",\"5\":\"None\",\"_rn_\":\"15\"},{\"1\":\"40\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"32\",\"5\":\"None\",\"_rn_\":\"16\"},{\"1\":\"6\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"37\",\"5\":\"Some\",\"_rn_\":\"17\"},{\"1\":\"7\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"41\",\"5\":\"None\",\"_rn_\":\"18\"},{\"1\":\"72\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"41\",\"5\":\"Marked\",\"_rn_\":\"19\"},{\"1\":\"37\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"48\",\"5\":\"None\",\"_rn_\":\"20\"},{\"1\":\"82\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"48\",\"5\":\"Marked\",\"_rn_\":\"21\"},{\"1\":\"53\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"55\",\"5\":\"Marked\",\"_rn_\":\"22\"},{\"1\":\"79\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"55\",\"5\":\"Marked\",\"_rn_\":\"23\"},{\"1\":\"26\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"56\",\"5\":\"Marked\",\"_rn_\":\"24\"},{\"1\":\"28\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"57\",\"5\":\"Marked\",\"_rn_\":\"25\"},{\"1\":\"60\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"57\",\"5\":\"Marked\",\"_rn_\":\"26\"},{\"1\":\"22\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"57\",\"5\":\"Marked\",\"_rn_\":\"27\"},{\"1\":\"27\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"58\",\"5\":\"None\",\"_rn_\":\"28\"},{\"1\":\"2\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"59\",\"5\":\"Marked\",\"_rn_\":\"29\"},{\"1\":\"59\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"59\",\"5\":\"Marked\",\"_rn_\":\"30\"},{\"1\":\"62\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"60\",\"5\":\"Marked\",\"_rn_\":\"31\"},{\"1\":\"84\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"61\",\"5\":\"Marked\",\"_rn_\":\"32\"},{\"1\":\"64\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"62\",\"5\":\"Some\",\"_rn_\":\"33\"},{\"1\":\"34\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"62\",\"5\":\"Marked\",\"_rn_\":\"34\"},{\"1\":\"58\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"66\",\"5\":\"Marked\",\"_rn_\":\"35\"},{\"1\":\"13\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"67\",\"5\":\"Marked\",\"_rn_\":\"36\"},{\"1\":\"61\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"68\",\"5\":\"Some\",\"_rn_\":\"37\"},{\"1\":\"65\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"68\",\"5\":\"Marked\",\"_rn_\":\"38\"},{\"1\":\"11\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"69\",\"5\":\"None\",\"_rn_\":\"39\"},{\"1\":\"56\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"69\",\"5\":\"Some\",\"_rn_\":\"40\"},{\"1\":\"43\",\"2\":\"Treated\",\"3\":\"Female\",\"4\":\"70\",\"5\":\"Some\",\"_rn_\":\"41\"},{\"1\":\"9\",\"2\":\"Placebo\",\"3\":\"Male\",\"4\":\"37\",\"5\":\"None\",\"_rn_\":\"42\"},{\"1\":\"14\",\"2\":\"Placebo\",\"3\":\"Male\",\"4\":\"44\",\"5\":\"None\",\"_rn_\":\"43\"},{\"1\":\"73\",\"2\":\"Placebo\",\"3\":\"Male\",\"4\":\"50\",\"5\":\"None\",\"_rn_\":\"44\"},{\"1\":\"74\",\"2\":\"Placebo\",\"3\":\"Male\",\"4\":\"51\",\"5\":\"None\",\"_rn_\":\"45\"},{\"1\":\"25\",\"2\":\"Placebo\",\"3\":\"Male\",\"4\":\"52\",\"5\":\"None\",\"_rn_\":\"46\"},{\"1\":\"18\",\"2\":\"Placebo\",\"3\":\"Male\",\"4\":\"53\",\"5\":\"None\",\"_rn_\":\"47\"},{\"1\":\"21\",\"2\":\"Placebo\",\"3\":\"Male\",\"4\":\"59\",\"5\":\"None\",\"_rn_\":\"48\"},{\"1\":\"52\",\"2\":\"Placebo\",\"3\":\"Male\",\"4\":\"59\",\"5\":\"None\",\"_rn_\":\"49\"},{\"1\":\"45\",\"2\":\"Placebo\",\"3\":\"Male\",\"4\":\"62\",\"5\":\"None\",\"_rn_\":\"50\"},{\"1\":\"41\",\"2\":\"Placebo\",\"3\":\"Male\",\"4\":\"62\",\"5\":\"None\",\"_rn_\":\"51\"},{\"1\":\"8\",\"2\":\"Placebo\",\"3\":\"Male\",\"4\":\"63\",\"5\":\"Marked\",\"_rn_\":\"52\"},{\"1\":\"80\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"23\",\"5\":\"None\",\"_rn_\":\"53\"},{\"1\":\"12\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"30\",\"5\":\"None\",\"_rn_\":\"54\"},{\"1\":\"29\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"30\",\"5\":\"None\",\"_rn_\":\"55\"},{\"1\":\"50\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"31\",\"5\":\"Some\",\"_rn_\":\"56\"},{\"1\":\"38\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"32\",\"5\":\"None\",\"_rn_\":\"57\"},{\"1\":\"35\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"33\",\"5\":\"Marked\",\"_rn_\":\"58\"},{\"1\":\"51\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"37\",\"5\":\"None\",\"_rn_\":\"59\"},{\"1\":\"54\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"44\",\"5\":\"None\",\"_rn_\":\"60\"},{\"1\":\"76\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"45\",\"5\":\"None\",\"_rn_\":\"61\"},{\"1\":\"16\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"46\",\"5\":\"None\",\"_rn_\":\"62\"},{\"1\":\"69\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"48\",\"5\":\"None\",\"_rn_\":\"63\"},{\"1\":\"31\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"49\",\"5\":\"None\",\"_rn_\":\"64\"},{\"1\":\"20\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"51\",\"5\":\"None\",\"_rn_\":\"65\"},{\"1\":\"68\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"53\",\"5\":\"None\",\"_rn_\":\"66\"},{\"1\":\"81\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"54\",\"5\":\"None\",\"_rn_\":\"67\"},{\"1\":\"4\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"54\",\"5\":\"None\",\"_rn_\":\"68\"},{\"1\":\"78\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"54\",\"5\":\"Marked\",\"_rn_\":\"69\"},{\"1\":\"70\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"55\",\"5\":\"Marked\",\"_rn_\":\"70\"},{\"1\":\"49\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"57\",\"5\":\"None\",\"_rn_\":\"71\"},{\"1\":\"10\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"57\",\"5\":\"Some\",\"_rn_\":\"72\"},{\"1\":\"47\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"58\",\"5\":\"Some\",\"_rn_\":\"73\"},{\"1\":\"44\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"59\",\"5\":\"Some\",\"_rn_\":\"74\"},{\"1\":\"24\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"59\",\"5\":\"Marked\",\"_rn_\":\"75\"},{\"1\":\"48\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"61\",\"5\":\"None\",\"_rn_\":\"76\"},{\"1\":\"19\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"63\",\"5\":\"Some\",\"_rn_\":\"77\"},{\"1\":\"3\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"64\",\"5\":\"None\",\"_rn_\":\"78\"},{\"1\":\"67\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"65\",\"5\":\"Marked\",\"_rn_\":\"79\"},{\"1\":\"32\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"66\",\"5\":\"None\",\"_rn_\":\"80\"},{\"1\":\"42\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"66\",\"5\":\"None\",\"_rn_\":\"81\"},{\"1\":\"15\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"66\",\"5\":\"Some\",\"_rn_\":\"82\"},{\"1\":\"71\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"68\",\"5\":\"Some\",\"_rn_\":\"83\"},{\"1\":\"1\",\"2\":\"Placebo\",\"3\":\"Female\",\"4\":\"74\",\"5\":\"Marked\",\"_rn_\":\"84\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nclass(Arthritis)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"data.frame\"\n```\n:::\n:::\n\n\nFrom Michael Friendly [Discrete Data Analysis and\nVisualization](/pdf/DataAnalytics/Michael-Friendly-DDAS.pdf) :\n\n> In many circumstances, data is recorded on each individual or\n> experimental unit. Data in this form is called case data, or data in\n> case form.\n\n\n::: {.cell hash='index_cache/html/case-form-data_ce8eeb4e73c4b8f2a45c242bd1e25562'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style=\"font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Arthritis Treatments and Effects (first 6 entries)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> ID </th>\n   <th style=\"text-align:left;\"> Treatment </th>\n   <th style=\"text-align:left;\"> Sex </th>\n   <th style=\"text-align:right;\"> Age </th>\n   <th style=\"text-align:left;\"> Improved </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 57 </td>\n   <td style=\"text-align:left;\"> Treated </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 27 </td>\n   <td style=\"text-align:left;\"> Some </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:left;\"> Treated </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:left;\"> None </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 77 </td>\n   <td style=\"text-align:left;\"> Treated </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:left;\"> None </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:left;\"> Treated </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:left;\"> Marked </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:left;\"> Treated </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:left;\"> Marked </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:left;\"> Treated </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:left;\"> Marked </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nThe `Arthritis` data set has three factors and two *integer* variables.\nOne of the three factors `Improved` is an **ordered factor**.\n\n1)  ID\n2)  Treatment: a factor; Placebo or Treated\n3)  Sex: a factor, M / F\n4)  Age: integer\n5)  Improved: **Ordinal factor**; None \\< Some \\< Marked\n\nEach row in the `Arthritis` dataset is a separate case or observation.\n\n## Frequency Data\n\nData in frequency form has already been tabulated, by counting over the\n(combinations of ) categories of the table variables. When the data are\nin **case form**, we can always trace any observation back to its\nindividual identifier or data record, since each row is a unique\nobservation or *case*; the reverse is rarely possible.\n\nFrequency Data is usually a data frame, with columns of categorical\nvariables and at least one column containing `frequency` or `count`\ninformation.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-3_cbb96baa8bce207a8f7f77ce06c00b3d'}\n\n```{.r .cell-code}\nstr(GSS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t6 obs. of  3 variables:\n $ sex  : Factor w/ 2 levels \"female\",\"male\": 1 2 1 2 1 2\n $ party: Factor w/ 3 levels \"dem\",\"indep\",..: 1 1 2 2 3 3\n $ count: num  279 165 73 47 225 191\n```\n:::\n\n```{.r .cell-code}\nGSS %>% \n  kbl(caption = \"General Social Survey\",centering = TRUE) %>%\n  kable_classic_2(html_font = \"Cambria\", full_width = F,)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style=\"font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>General Social Survey</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> sex </th>\n   <th style=\"text-align:left;\"> party </th>\n   <th style=\"text-align:right;\"> count </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> dem </td>\n   <td style=\"text-align:right;\"> 279 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> dem </td>\n   <td style=\"text-align:right;\"> 165 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> indep </td>\n   <td style=\"text-align:right;\"> 73 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> indep </td>\n   <td style=\"text-align:right;\"> 47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:left;\"> rep </td>\n   <td style=\"text-align:right;\"> 225 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:left;\"> rep </td>\n   <td style=\"text-align:right;\"> 191 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nRespondents in the GSS survey were classified by `sex` and `party`\nidentification. As can be seen, there is a **count** for every\ncombination of the two *categorical* variables, `sex` and `party`.\n\n## Table form\n\n> Table Form Data can be a `matrix`, `array` or `table object`, whose\n> elements are the frequencies in an **n-way table**. The variable names\n> (factors) and their levels are given by `dimnames(X)`.\n\n\n::: {.cell hash='index_cache/html/Table-Form_91e5063b57d10f0658da7c63c29c657e'}\n\n```{.r .cell-code}\nHairEyeColor\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n, , Sex = Male\n\n       Eye\nHair    Brown Blue Hazel Green\n  Black    32   11    10     3\n  Brown    53   50    25    15\n  Red      10   10     7     7\n  Blond     3   30     5     8\n\n, , Sex = Female\n\n       Eye\nHair    Brown Blue Hazel Green\n  Black    36    9     5     2\n  Brown    66   34    29    14\n  Red      16    7     7     7\n  Blond     4   64     5     8\n```\n:::\n\n```{.r .cell-code}\nclass(HairEyeColor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"table\"\n```\n:::\n:::\n\n\n`HairEyeColor` is a \"two-way\" table, consisting of **two tables**, one\nfor `Sex = Female` and the other for `Sex = Male`. The total number of\nobservations is `sum(X)`. The number of dimensions of the table is\n`length(dimnames(X))`, and the table sizes are given by\n`sapply(dimnames(X), length)`. The data looks like a n-dimensional cube\nand needs n-way tables to represent.\n\n\n::: {.cell hash='index_cache/html/exploring-tables_ef6b9c5aa3f05eb6a42c2b7825503677'}\n\n```{.r .cell-code}\nsum(HairEyeColor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 592\n```\n:::\n\n```{.r .cell-code}\ndimnames(HairEyeColor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$Hair\n[1] \"Black\" \"Brown\" \"Red\"   \"Blond\"\n\n$Eye\n[1] \"Brown\" \"Blue\"  \"Hazel\" \"Green\"\n\n$Sex\n[1] \"Male\"   \"Female\"\n```\n:::\n\n```{.r .cell-code}\nsapply(dimnames(HairEyeColor), length)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nHair  Eye  Sex \n   4    4    2 \n```\n:::\n:::\n\n\nA good way to think of tabular data is to think of a Rubik's Cube.\n\n![Rubik's Cube model for Multi-Table\nData](cube.jpg){alt=\"Rubik's Cube model for Multi-Table Data\"\nfig-alt=\"Rubik's Cube model for Multi-Table Data\" fig-align=\"center\"\nwidth=\"352\"}\n\nEach of the edges is an *Ordinal Variable*, each segment represents a\n*level* in the variable. So each face of the Cube represents *two*\nordinal variables. Any segment is at the intersection of two\n(independent) levels of two variables, and the colour may be visualized\nas a *count*. This array of counts on a face is a 2D or **2-Way Table**.\n( More on this later )\n\nSince we can only print 2D tables, we hold one face in front and the\nimage we see is a 2-Way Table. Turning the Cube by 90 degrees gives us\nanother face with 2 variables, with one variable in common with the\nprevious face. If we consider two faces together, we get two 2-way\ntables, effectively allowing us to contemplate 3 categorical variables.\n\nMultiple 2-Way tables can be **flattened** into a single long table that\ncontains all counts for all combinations of categorical variables.\n\n\n::: {.cell hash='index_cache/html/flattened-table_03617fa7ea971738bd9490778c04beb5'}\n\n```{.r .cell-code}\nftable(HairEyeColor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Sex Male Female\nHair  Eye                  \nBlack Brown       32     36\n      Blue        11      9\n      Hazel       10      5\n      Green        3      2\nBrown Brown       53     66\n      Blue        50     34\n      Hazel       25     29\n      Green       15     14\nRed   Brown       10     16\n      Blue        10      7\n      Hazel        7      7\n      Green        7      7\nBlond Brown        3      4\n      Blue        30     64\n      Hazel        5      5\n      Green        8      8\n```\n:::\n:::\n\n\nWe may need to convert the (multiple) tables into a data frame:\n\n\n::: {.cell hash='index_cache/html/tables-to-data-frame_0c8e451a71e40859bbfbf75bc567b689'}\n\n```{.r .cell-code}\n## Convert the two tables into a data frame\nHairEyeColor %>% \n  as_tibble() %>% # Convert\n  head() %>% # Take first few rows to show\n  kbl(caption = \"Hair Eye and Color (First 6 Entries)\") %>% \n  kable_classic_2(html_font = \"Cambria\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic-2\" style=\"font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Hair Eye and Color (First 6 Entries)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Hair </th>\n   <th style=\"text-align:left;\"> Eye </th>\n   <th style=\"text-align:left;\"> Sex </th>\n   <th style=\"text-align:right;\"> n </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Black </td>\n   <td style=\"text-align:left;\"> Brown </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 32 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Brown </td>\n   <td style=\"text-align:left;\"> Brown </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 53 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Red </td>\n   <td style=\"text-align:left;\"> Brown </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Blond </td>\n   <td style=\"text-align:left;\"> Brown </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Black </td>\n   <td style=\"text-align:left;\"> Blue </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Brown </td>\n   <td style=\"text-align:left;\"> Blue </td>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 50 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n\n# Creating Contingency Tables\n\nMost plots for Categorical Data ( as we shall see ) require that the\ndata be converted into a ***Contingency Table*** ; even Statistical\ntests for Proportions ( the $\\chi^2$ test ) need Contingency Tables. The\n*Frequency Table* we encountered earlier is very close to being a\nfull-fledged Contingency Table.\n\nFrom [Wolfram\nAlpha](https://www.wolframalpha.com/input/?i=contingency+table):\n\n> A contingency table, sometimes called a two-way frequency table, is a\n> tabular mechanism with at least two rows and two columns used in\n> statistics to present categorical data in terms of frequency counts.\n> More precisely, an $r \\times c$ contingency table shows the observed\n> frequency of two variables the observed frequencies of which are\n> arranged into $r$ rows and $c$ columns. The intersection of a row and\n> a column of a contingency table is called a cell.\n\nIn this section we understand how to make Contingency Tables from each\nof the three forms. We will use `vcd`, `mosaic` and the `tidyverse`\npackages for our purposes.\n\n::: panel-tabset\n## Using base R\n\n\n::: {.cell hash='index_cache/html/base-R-one-way_cd86174a6d0249bb33cd9b6ae6d11178'}\n\n```{.r .cell-code}\n#One Way Table ( one variable )\ntable(Arthritis$Treatment) # Contingency Table\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nPlacebo Treated \n     43      41 \n```\n:::\n\n```{.r .cell-code}\n# We can add (row) margins to this table\ntable(Arthritis$Treatment) %>% addmargins() # Contingency Table with margins\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nPlacebo Treated     Sum \n     43      41      84 \n```\n:::\n:::\n\n::: {.cell hash='index_cache/html/base-R-two-way_28090a2ab5047d19085711773d1204de'}\n\n```{.r .cell-code}\n# Two-Way Table ( two variables )\n# table(Arthritis$Treatment, Arthritis$Improved) %>% prop.table() \ntable(Arthritis$Treatment, Arthritis$Improved) %>% addmargins() # Contingency Table with margins\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         \n          None Some Marked Sum\n  Placebo   29    7      7  43\n  Treated   13    7     21  41\n  Sum       42   14     28  84\n```\n:::\n:::\n\n\nWe can use **table()** ( and also **xtabs()** ) to generate\nmulti-dimensional tables too (More than 2D ) These will be printed out\nas a series of 2D tables, one for each value of the \"third\" parameter.\nWe can then *flatten* this set of tables using **ftable()** and add\nmargins to convert into a Contingency Table:\n\n\n::: {.cell hash='index_cache/html/r-base-three-way-table_8e90e7d89ebeb8cdfd4a7abbfa0657ee'}\n\n```{.r .cell-code}\nmytable <- table(Arthritis$Treatment, Arthritis$Sex, Arthritis$Improved)\nmytable\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n, ,  = None\n\n         \n          Female Male\n  Placebo     19   10\n  Treated      6    7\n\n, ,  = Some\n\n         \n          Female Male\n  Placebo      7    0\n  Treated      5    2\n\n, ,  = Marked\n\n         \n          Female Male\n  Placebo      6    1\n  Treated     16    5\n```\n:::\n\n```{.r .cell-code}\nftable(mytable) %>% addmargins()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Sum\n    19  7  6  32\n    10  0  1  11\n     6  5 16  27\n     7  2  5  14\nSum 42 14 28  84\n```\n:::\n:::\n\n\n## Using the `vcd` package\n\nThe `vcd` ( Visualize Categorical Data ) package by Michael Friendly has\na convenient function to create Contingency Tables: `structable()`; this\nfunction produces a 'flat' representation of a high-dimensional\ncontingency table constructed by recursive splits (similar to the\nconstruction of mosaic charts/graphs). `structable` tends to render flat\ntables, of the kind that can be thought of as a \"text representation\" of\nthe `vcd::mosaic` plot:\n\nThe arguments of `structable` are:\n\n-   a formula $y + p \\sim x + z$ which shows which variables are to be\n    included as *columns* and *rows* respectively on a table\n-   a `data` argument, which can indicate a `data frame`\n\n\n::: {.cell hash='index_cache/html/vcd-data-frame-to-contingency-table_be52bec7867df3ccbf91046750ee9a2d'}\n\n```{.r .cell-code}\narth_vcd <- vcd::structable(data = Arthritis, Treatment ~ Improved + Sex)\narth_vcd\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                Treatment Placebo Treated\nImproved Sex                             \nNone     Female                19       6\n         Male                  10       7\nSome     Female                 7       5\n         Male                   0       2\nMarked   Female                 6      16\n         Male                   1       5\n```\n:::\n\n```{.r .cell-code}\nclass(arth_vcd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"structable\" \"ftable\"    \n```\n:::\n\n```{.r .cell-code}\n# With Margins\narth_vcd %>% as.matrix() %>% addmargins()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               Treatment\nImproved_Sex    Placebo Treated Sum\n  None_Female        19       6  25\n  None_Male          10       7  17\n  Some_Female         7       5  12\n  Some_Male           0       2   2\n  Marked_Female       6      16  22\n  Marked_Male         1       5   6\n  Sum                43      41  84\n```\n:::\n:::\n\n::: {.cell hash='index_cache/html/vcd-mutlitable-to-contingency-table_f8b7feaa3b07a5a0f993075a6d08cd17'}\n\n```{.r .cell-code}\n# HairEyeColor is in multiple table form\n# structable flattens these into one, as for a mosaic chart\nHairEyeColor\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n, , Sex = Male\n\n       Eye\nHair    Brown Blue Hazel Green\n  Black    32   11    10     3\n  Brown    53   50    25    15\n  Red      10   10     7     7\n  Blond     3   30     5     8\n\n, , Sex = Female\n\n       Eye\nHair    Brown Blue Hazel Green\n  Black    36    9     5     2\n  Brown    66   34    29    14\n  Red      16    7     7     7\n  Blond     4   64     5     8\n```\n:::\n\n```{.r .cell-code}\nvcd::structable(HairEyeColor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Eye Brown Blue Hazel Green\nHair  Sex                              \nBlack Male          32   11    10     3\n      Female        36    9     5     2\nBrown Male          53   50    25    15\n      Female        66   34    29    14\nRed   Male          10   10     7     7\n      Female        16    7     7     7\nBlond Male           3   30     5     8\n      Female         4   64     5     8\n```\n:::\n:::\n\n\nUCBAdmissions is already in Frequency Form i.e. a Contingency Table.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-12_3c93329ad14200e635115548a347c8e6'}\n\n```{.r .cell-code}\nUCBAdmissions\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n, , Dept = A\n\n          Gender\nAdmit      Male Female\n  Admitted  512     89\n  Rejected  313     19\n\n, , Dept = B\n\n          Gender\nAdmit      Male Female\n  Admitted  353     17\n  Rejected  207      8\n\n, , Dept = C\n\n          Gender\nAdmit      Male Female\n  Admitted  120    202\n  Rejected  205    391\n\n, , Dept = D\n\n          Gender\nAdmit      Male Female\n  Admitted  138    131\n  Rejected  279    244\n\n, , Dept = E\n\n          Gender\nAdmit      Male Female\n  Admitted   53     94\n  Rejected  138    299\n\n, , Dept = F\n\n          Gender\nAdmit      Male Female\n  Admitted   22     24\n  Rejected  351    317\n```\n:::\n\n```{.r .cell-code}\nvcd::structable(UCBAdmissions)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              Gender Male Female\nAdmit    Dept                   \nAdmitted A            512     89\n         B            353     17\n         C            120    202\n         D            138    131\n         E             53     94\n         F             22     24\nRejected A            313     19\n         B            207      8\n         C            205    391\n         D            279    244\n         E            138    299\n         F            351    317\n```\n:::\n:::\n\n\nNote that `structable` does not permit the adding of margins directly;\nit needs to be converted to a matrix for `addmargins()` to do its work.\n\n## Using the `mosaic` package\n\nI think this is the simplest and most elegant way of obtaining\nContingency Tables:\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-13_cdf6720504bb38eeac190147146beeaf'}\n\n```{.r .cell-code}\n# One Way Table\nmosaicCore::tally( ~ substance, data = HELPrct, margins = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nsubstance\nalcohol cocaine  heroin   Total \n    177     152     124     453 \n```\n:::\n\n```{.r .cell-code}\n# Two ways of producing the same result\ntally( sex ~ substance, data = HELPrct, margins = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        substance\nsex      alcohol cocaine heroin\n  female      36      41     30\n  male       141     111     94\n  Total      177     152    124\n```\n:::\n\n```{.r .cell-code}\ntally(~ sex | substance, data = HELPrct, margins = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        substance\nsex      alcohol cocaine heroin\n  female      36      41     30\n  male       141     111     94\n  Total      177     152    124\n```\n:::\n:::\n\n\n## Using the `tidyverse`\n\nDoing this with the `tidyverse` set of packages may seem\ncounter-intuitively long-winded, but the workflow is easily\nunderstandable:\n\nFirst we develop the counts:\n\n\n::: {.cell hash='index_cache/html/tidyverse-for-Contingency-Tables_7d41c914216fe3f03b3211db82d0c5a2'}\n\n```{.r .cell-code}\ndiamonds %>% \n  group_by(cut, clarity) %>% \n  dplyr::summarise( count = n())\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"cut\"],\"name\":[1],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"clarity\"],\"name\":[2],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"count\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Fair\",\"2\":\"I1\",\"3\":\"210\"},{\"1\":\"Fair\",\"2\":\"SI2\",\"3\":\"466\"},{\"1\":\"Fair\",\"2\":\"SI1\",\"3\":\"408\"},{\"1\":\"Fair\",\"2\":\"VS2\",\"3\":\"261\"},{\"1\":\"Fair\",\"2\":\"VS1\",\"3\":\"170\"},{\"1\":\"Fair\",\"2\":\"VVS2\",\"3\":\"69\"},{\"1\":\"Fair\",\"2\":\"VVS1\",\"3\":\"17\"},{\"1\":\"Fair\",\"2\":\"IF\",\"3\":\"9\"},{\"1\":\"Good\",\"2\":\"I1\",\"3\":\"96\"},{\"1\":\"Good\",\"2\":\"SI2\",\"3\":\"1081\"},{\"1\":\"Good\",\"2\":\"SI1\",\"3\":\"1560\"},{\"1\":\"Good\",\"2\":\"VS2\",\"3\":\"978\"},{\"1\":\"Good\",\"2\":\"VS1\",\"3\":\"648\"},{\"1\":\"Good\",\"2\":\"VVS2\",\"3\":\"286\"},{\"1\":\"Good\",\"2\":\"VVS1\",\"3\":\"186\"},{\"1\":\"Good\",\"2\":\"IF\",\"3\":\"71\"},{\"1\":\"Very Good\",\"2\":\"I1\",\"3\":\"84\"},{\"1\":\"Very Good\",\"2\":\"SI2\",\"3\":\"2100\"},{\"1\":\"Very Good\",\"2\":\"SI1\",\"3\":\"3240\"},{\"1\":\"Very Good\",\"2\":\"VS2\",\"3\":\"2591\"},{\"1\":\"Very Good\",\"2\":\"VS1\",\"3\":\"1775\"},{\"1\":\"Very Good\",\"2\":\"VVS2\",\"3\":\"1235\"},{\"1\":\"Very Good\",\"2\":\"VVS1\",\"3\":\"789\"},{\"1\":\"Very Good\",\"2\":\"IF\",\"3\":\"268\"},{\"1\":\"Premium\",\"2\":\"I1\",\"3\":\"205\"},{\"1\":\"Premium\",\"2\":\"SI2\",\"3\":\"2949\"},{\"1\":\"Premium\",\"2\":\"SI1\",\"3\":\"3575\"},{\"1\":\"Premium\",\"2\":\"VS2\",\"3\":\"3357\"},{\"1\":\"Premium\",\"2\":\"VS1\",\"3\":\"1989\"},{\"1\":\"Premium\",\"2\":\"VVS2\",\"3\":\"870\"},{\"1\":\"Premium\",\"2\":\"VVS1\",\"3\":\"616\"},{\"1\":\"Premium\",\"2\":\"IF\",\"3\":\"230\"},{\"1\":\"Ideal\",\"2\":\"I1\",\"3\":\"146\"},{\"1\":\"Ideal\",\"2\":\"SI2\",\"3\":\"2598\"},{\"1\":\"Ideal\",\"2\":\"SI1\",\"3\":\"4282\"},{\"1\":\"Ideal\",\"2\":\"VS2\",\"3\":\"5071\"},{\"1\":\"Ideal\",\"2\":\"VS1\",\"3\":\"3589\"},{\"1\":\"Ideal\",\"2\":\"VVS2\",\"3\":\"2606\"},{\"1\":\"Ideal\",\"2\":\"VVS1\",\"3\":\"2047\"},{\"1\":\"Ideal\",\"2\":\"IF\",\"3\":\"1212\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nWe need to have the levels of `cut` as rows and the levels of `clarity`\nas columns. This means that we need to pivot this from \"long\" to wide\"\nto obtain a Contingency Table:\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-15_dbd7fcf0e9b03aff207d8112df678f2b'}\n\n```{.r .cell-code}\ndiamonds %>% \n  group_by(cut, clarity) %>% \n  dplyr::summarise( count = n()) %>% \n  \n  \n  pivot_wider(id_cols = cut, \n              names_from = clarity, \n              values_from = count) %>% \n  \n  # Now add the row and column totals using the `janitor` package\n  janitor::adorn_totals(where = c(\"row\", \"col\")) %>%\n  \n  # Recover to tibble since janitor gives a \"tabyl\" format ( which can be useful )\n  as_tibble()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"cut\"],\"name\":[1],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"I1\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"SI2\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"SI1\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"VS2\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"VS1\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"VVS2\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"VVS1\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"IF\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Total\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Fair\",\"2\":\"210\",\"3\":\"466\",\"4\":\"408\",\"5\":\"261\",\"6\":\"170\",\"7\":\"69\",\"8\":\"17\",\"9\":\"9\",\"10\":\"1610\"},{\"1\":\"Good\",\"2\":\"96\",\"3\":\"1081\",\"4\":\"1560\",\"5\":\"978\",\"6\":\"648\",\"7\":\"286\",\"8\":\"186\",\"9\":\"71\",\"10\":\"4906\"},{\"1\":\"Very Good\",\"2\":\"84\",\"3\":\"2100\",\"4\":\"3240\",\"5\":\"2591\",\"6\":\"1775\",\"7\":\"1235\",\"8\":\"789\",\"9\":\"268\",\"10\":\"12082\"},{\"1\":\"Premium\",\"2\":\"205\",\"3\":\"2949\",\"4\":\"3575\",\"5\":\"3357\",\"6\":\"1989\",\"7\":\"870\",\"8\":\"616\",\"9\":\"230\",\"10\":\"13791\"},{\"1\":\"Ideal\",\"2\":\"146\",\"3\":\"2598\",\"4\":\"4282\",\"5\":\"5071\",\"6\":\"3589\",\"7\":\"2606\",\"8\":\"2047\",\"9\":\"1212\",\"10\":\"21551\"},{\"1\":\"Total\",\"2\":\"741\",\"3\":\"9194\",\"4\":\"13065\",\"5\":\"12258\",\"6\":\"8171\",\"7\":\"5066\",\"8\":\"3655\",\"9\":\"1790\",\"10\":\"53940\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n:::\n\nNow that we have Contingency Tables, we can plot these:\n\n## What sort of Plots can we make for Categorical Data?\n\nWe have already seen bar plots, which allow us to plot counts of\ncategorical data. However, if there are a large number of categorical\nvariables or if the categorical variables have many levels, the bar plot\nis not adequate.\n\nFrom Michael Friendly:\n\n> The familiar techniques for displaying raw data are often\n> disappointing when applied to categorical data. The simple\n> scatterplot, for example, widely used to show the relation between\n> quantitative response and predictors, when applied to discrete\n> variables, gives a display of the category combinations, with all\n> identical values overplotted, and no representation of their\n> frequency.\n\n> Instead, frequencies of categorical variables are often best\n> represented graphically using **areas** rather than as **position\n> along a scale**. Using the visual attribute:\n\n$$\\pmb{area \\sim frequency}$$\n\n> allows creating novel graphical displays of frequency data for special\n> circumstances.\n\nLet us not look at some sample plots that embody this \"area-frequency\\*\nprinciple.\n\n### Mosaic Plots\n\nA mosaic plot is basically an area-proportional visualization of\n(typically observed) frequencies, consisting of tiles (corresponding to\nthe cells) created by vertically and horizontally splitting a rectangle\nrecursively. Thus, the area of each tile is proportional to the\ncorresponding cell entry given the dimensions of previous splits.\n\nThe `vcd::mosaic()` function needs the data in *contingency table* form.\nWe will use our `vcd::structable()` function to construct one:\n\n\n::: {.cell hash='index_cache/html/mosaic-plot-using-vcd_e5aa38aab39c7eee5aac41671a7aaebe'}\n\n```{.r .cell-code}\nart <- vcd::structable(~ Treatment + Improved, data = Arthritis)\nart\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Improved None Some Marked\nTreatment                          \nPlacebo              29    7      7\nTreated              13    7     21\n```\n:::\n\n```{.r .cell-code}\nvcd::mosaic(art, gp = shading_max)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/mosaic-plot-using-vcd-1.png){width=672}\n:::\n\n```{.r .cell-code}\n### Or\n### vcd::mosaic(structable(~ Treatment + Improved, data = Arthritis), gp = shading_max, split_vertical = TRUE)\n```\n:::\n\n\n### Balloon Plots\n\n\n::: {.cell hash='index_cache/html/balloon-plot-using-ggpubr_29dc658af434911f872b7b9faabff37d'}\n\n```{.r .cell-code}\nhousetasks <- read.delim(\n  system.file(\"demo-data/housetasks.txt\", \n              package = \"ggpubr\"),\n  row.names = 1\n  )\nhead(housetasks, 4)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Wife\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Alternating\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Husband\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Jointly\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"156\",\"2\":\"14\",\"3\":\"2\",\"4\":\"4\",\"_rn_\":\"Laundry\"},{\"1\":\"124\",\"2\":\"20\",\"3\":\"5\",\"4\":\"4\",\"_rn_\":\"Main_meal\"},{\"1\":\"77\",\"2\":\"11\",\"3\":\"7\",\"4\":\"13\",\"_rn_\":\"Dinner\"},{\"1\":\"82\",\"2\":\"36\",\"3\":\"15\",\"4\":\"7\",\"_rn_\":\"Breakfeast\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nggpubr::ggballoonplot(housetasks, fill = \"value\") +\n  scale_fill_viridis_c(option = \"C\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/balloon-plot-using-ggpubr-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='index_cache/html/unnamed-chunk-17_454f874007c7e5910dd478c713d6746f'}\n\n```{.r .cell-code}\ndf <- as.data.frame(HairEyeColor)\nggballoonplot(df, x = \"Hair\", y = \"Eye\", size = \"Freq\",\n              fill = \"Freq\", facet.by = \"Sex\",\n              ggtheme = theme_bw()) +\n  scale_fill_viridis_c(option = \"C\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n### Plots for Likert Data\n\nIn many business situations, we perform surveys to get [Likert\nScale](https://www.simplypsychology.org/likert-scale.html) data, where\nseveral respondents rate a product or a service on a scale of\n`Very much like`, `somewhat like`, `neutral`, `Dislike` and\n`Very much dislike,` for example. Such data may look for example as\nfollows:\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-18_f7f0185ad5b6711d6853551ed5b9c6a6'}\n\n```{.r .cell-code}\ndata(efc)\nhead(efc, 20)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"c12hour\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"e15relat\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"e16sex\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"e17age\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"e42dep\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c82cop1\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c83cop2\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c84cop3\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c85cop4\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c86cop5\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c87cop6\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c88cop7\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c89cop8\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c90cop9\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c160age\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c161sex\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c172code\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"c175empl\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"barthtot\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"neg_c_7\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"pos_v_4\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"quol_5\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"resttotn\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"tot_sc_e\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n4pstu\"],\"name\":[25],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"nur_pst\"],\"name\":[26],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"16\",\"2\":\"2\",\"3\":\"2\",\"4\":\"83\",\"5\":\"3\",\"6\":\"3\",\"7\":\"2\",\"8\":\"2\",\"9\":\"2\",\"10\":\"1\",\"11\":\"1\",\"12\":\"2\",\"13\":\"3\",\"14\":\"3\",\"15\":\"56\",\"16\":\"2\",\"17\":\"2\",\"18\":\"1\",\"19\":\"75\",\"20\":\"12\",\"21\":\"12\",\"22\":\"14\",\"23\":\"0\",\"24\":\"4\",\"25\":\"0\",\"26\":\"NA\",\"_rn_\":\"1\"},{\"1\":\"148\",\"2\":\"2\",\"3\":\"2\",\"4\":\"88\",\"5\":\"3\",\"6\":\"3\",\"7\":\"3\",\"8\":\"3\",\"9\":\"3\",\"10\":\"4\",\"11\":\"1\",\"12\":\"3\",\"13\":\"2\",\"14\":\"2\",\"15\":\"54\",\"16\":\"2\",\"17\":\"2\",\"18\":\"1\",\"19\":\"75\",\"20\":\"20\",\"21\":\"11\",\"22\":\"10\",\"23\":\"4\",\"24\":\"0\",\"25\":\"0\",\"26\":\"NA\",\"_rn_\":\"2\"},{\"1\":\"70\",\"2\":\"1\",\"3\":\"2\",\"4\":\"82\",\"5\":\"3\",\"6\":\"2\",\"7\":\"2\",\"8\":\"1\",\"9\":\"4\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"4\",\"14\":\"3\",\"15\":\"80\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"35\",\"20\":\"11\",\"21\":\"13\",\"22\":\"7\",\"23\":\"0\",\"24\":\"1\",\"25\":\"2\",\"26\":\"2\",\"_rn_\":\"3\"},{\"1\":\"168\",\"2\":\"1\",\"3\":\"2\",\"4\":\"67\",\"5\":\"4\",\"6\":\"4\",\"7\":\"1\",\"8\":\"3\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"2\",\"14\":\"4\",\"15\":\"69\",\"16\":\"1\",\"17\":\"2\",\"18\":\"0\",\"19\":\"0\",\"20\":\"10\",\"21\":\"15\",\"22\":\"12\",\"23\":\"2\",\"24\":\"0\",\"25\":\"3\",\"26\":\"3\",\"_rn_\":\"4\"},{\"1\":\"168\",\"2\":\"2\",\"3\":\"2\",\"4\":\"84\",\"5\":\"4\",\"6\":\"3\",\"7\":\"2\",\"8\":\"1\",\"9\":\"2\",\"10\":\"2\",\"11\":\"2\",\"12\":\"1\",\"13\":\"4\",\"14\":\"4\",\"15\":\"47\",\"16\":\"2\",\"17\":\"2\",\"18\":\"0\",\"19\":\"25\",\"20\":\"12\",\"21\":\"15\",\"22\":\"19\",\"23\":\"2\",\"24\":\"1\",\"25\":\"2\",\"26\":\"2\",\"_rn_\":\"5\"},{\"1\":\"16\",\"2\":\"2\",\"3\":\"2\",\"4\":\"85\",\"5\":\"4\",\"6\":\"2\",\"7\":\"2\",\"8\":\"3\",\"9\":\"3\",\"10\":\"3\",\"11\":\"2\",\"12\":\"2\",\"13\":\"1\",\"14\":\"1\",\"15\":\"56\",\"16\":\"1\",\"17\":\"2\",\"18\":\"1\",\"19\":\"60\",\"20\":\"19\",\"21\":\"9\",\"22\":\"8\",\"23\":\"1\",\"24\":\"3\",\"25\":\"2\",\"26\":\"2\",\"_rn_\":\"6\"},{\"1\":\"161\",\"2\":\"1\",\"3\":\"1\",\"4\":\"74\",\"5\":\"4\",\"6\":\"4\",\"7\":\"2\",\"8\":\"4\",\"9\":\"1\",\"10\":\"1\",\"11\":\"2\",\"12\":\"4\",\"13\":\"1\",\"14\":\"4\",\"15\":\"61\",\"16\":\"2\",\"17\":\"2\",\"18\":\"0\",\"19\":\"5\",\"20\":\"15\",\"21\":\"13\",\"22\":\"20\",\"23\":\"0\",\"24\":\"0\",\"25\":\"3\",\"26\":\"3\",\"_rn_\":\"7\"},{\"1\":\"110\",\"2\":\"4\",\"3\":\"2\",\"4\":\"87\",\"5\":\"4\",\"6\":\"3\",\"7\":\"2\",\"8\":\"2\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"2\",\"13\":\"3\",\"14\":\"3\",\"15\":\"67\",\"16\":\"2\",\"17\":\"2\",\"18\":\"0\",\"19\":\"35\",\"20\":\"11\",\"21\":\"14\",\"22\":\"20\",\"23\":\"0\",\"24\":\"1\",\"25\":\"1\",\"26\":\"1\",\"_rn_\":\"8\"},{\"1\":\"28\",\"2\":\"2\",\"3\":\"2\",\"4\":\"79\",\"5\":\"4\",\"6\":\"3\",\"7\":\"2\",\"8\":\"3\",\"9\":\"2\",\"10\":\"2\",\"11\":\"1\",\"12\":\"3\",\"13\":\"1\",\"14\":\"3\",\"15\":\"59\",\"16\":\"2\",\"17\":\"NA\",\"18\":\"0\",\"19\":\"15\",\"20\":\"15\",\"21\":\"13\",\"22\":\"8\",\"23\":\"0\",\"24\":\"2\",\"25\":\"3\",\"26\":\"3\",\"_rn_\":\"9\"},{\"1\":\"40\",\"2\":\"2\",\"3\":\"2\",\"4\":\"83\",\"5\":\"4\",\"6\":\"3\",\"7\":\"2\",\"8\":\"1\",\"9\":\"2\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"1\",\"14\":\"3\",\"15\":\"49\",\"16\":\"2\",\"17\":\"2\",\"18\":\"0\",\"19\":\"0\",\"20\":\"10\",\"21\":\"13\",\"22\":\"15\",\"23\":\"1\",\"24\":\"1\",\"25\":\"3\",\"26\":\"3\",\"_rn_\":\"10\"},{\"1\":\"100\",\"2\":\"1\",\"3\":\"1\",\"4\":\"68\",\"5\":\"4\",\"6\":\"3\",\"7\":\"4\",\"8\":\"4\",\"9\":\"4\",\"10\":\"4\",\"11\":\"4\",\"12\":\"4\",\"13\":\"1\",\"14\":\"1\",\"15\":\"66\",\"16\":\"2\",\"17\":\"2\",\"18\":\"0\",\"19\":\"25\",\"20\":\"28\",\"21\":\"9\",\"22\":\"1\",\"23\":\"1\",\"24\":\"1\",\"25\":\"3\",\"26\":\"3\",\"_rn_\":\"11\"},{\"1\":\"25\",\"2\":\"8\",\"3\":\"2\",\"4\":\"97\",\"5\":\"3\",\"6\":\"3\",\"7\":\"3\",\"8\":\"3\",\"9\":\"1\",\"10\":\"3\",\"11\":\"1\",\"12\":\"4\",\"13\":\"3\",\"14\":\"1\",\"15\":\"47\",\"16\":\"2\",\"17\":\"2\",\"18\":\"1\",\"19\":\"85\",\"20\":\"18\",\"21\":\"8\",\"22\":\"19\",\"23\":\"1\",\"24\":\"1\",\"25\":\"1\",\"26\":\"1\",\"_rn_\":\"12\"},{\"1\":\"25\",\"2\":\"2\",\"3\":\"2\",\"4\":\"80\",\"5\":\"4\",\"6\":\"3\",\"7\":\"2\",\"8\":\"2\",\"9\":\"2\",\"10\":\"2\",\"11\":\"1\",\"12\":\"2\",\"13\":\"4\",\"14\":\"4\",\"15\":\"58\",\"16\":\"2\",\"17\":\"3\",\"18\":\"0\",\"19\":\"15\",\"20\":\"13\",\"21\":\"14\",\"22\":\"12\",\"23\":\"0\",\"24\":\"3\",\"25\":\"3\",\"26\":\"3\",\"_rn_\":\"13\"},{\"1\":\"24\",\"2\":\"1\",\"3\":\"2\",\"4\":\"75\",\"5\":\"3\",\"6\":\"3\",\"7\":\"2\",\"8\":\"4\",\"9\":\"4\",\"10\":\"1\",\"11\":\"1\",\"12\":\"2\",\"13\":\"4\",\"14\":\"4\",\"15\":\"75\",\"16\":\"1\",\"17\":\"1\",\"18\":\"0\",\"19\":\"70\",\"20\":\"18\",\"21\":\"14\",\"22\":\"8\",\"23\":\"0\",\"24\":\"0\",\"25\":\"1\",\"26\":\"1\",\"_rn_\":\"14\"},{\"1\":\"56\",\"2\":\"2\",\"3\":\"2\",\"4\":\"82\",\"5\":\"3\",\"6\":\"2\",\"7\":\"3\",\"8\":\"3\",\"9\":\"3\",\"10\":\"2\",\"11\":\"2\",\"12\":\"1\",\"13\":\"1\",\"14\":\"1\",\"15\":\"49\",\"16\":\"2\",\"17\":\"3\",\"18\":\"1\",\"19\":\"NA\",\"20\":\"16\",\"21\":\"9\",\"22\":\"8\",\"23\":\"3\",\"24\":\"3\",\"25\":\"0\",\"26\":\"NA\",\"_rn_\":\"15\"},{\"1\":\"20\",\"2\":\"2\",\"3\":\"2\",\"4\":\"89\",\"5\":\"3\",\"6\":\"4\",\"7\":\"2\",\"8\":\"1\",\"9\":\"3\",\"10\":\"3\",\"11\":\"1\",\"12\":\"2\",\"13\":\"1\",\"14\":\"3\",\"15\":\"56\",\"16\":\"2\",\"17\":\"2\",\"18\":\"0\",\"19\":\"0\",\"20\":\"13\",\"21\":\"14\",\"22\":\"6\",\"23\":\"0\",\"24\":\"2\",\"25\":\"0\",\"26\":\"NA\",\"_rn_\":\"16\"},{\"1\":\"25\",\"2\":\"1\",\"3\":\"1\",\"4\":\"80\",\"5\":\"1\",\"6\":\"3\",\"7\":\"2\",\"8\":\"1\",\"9\":\"2\",\"10\":\"1\",\"11\":\"1\",\"12\":\"2\",\"13\":\"4\",\"14\":\"4\",\"15\":\"75\",\"16\":\"2\",\"17\":\"2\",\"18\":\"0\",\"19\":\"95\",\"20\":\"11\",\"21\":\"15\",\"22\":\"16\",\"23\":\"0\",\"24\":\"2\",\"25\":\"0\",\"26\":\"NA\",\"_rn_\":\"17\"},{\"1\":\"126\",\"2\":\"1\",\"3\":\"1\",\"4\":\"72\",\"5\":\"3\",\"6\":\"4\",\"7\":\"2\",\"8\":\"1\",\"9\":\"2\",\"10\":\"1\",\"11\":\"1\",\"12\":\"2\",\"13\":\"3\",\"14\":\"3\",\"15\":\"70\",\"16\":\"2\",\"17\":\"2\",\"18\":\"0\",\"19\":\"55\",\"20\":\"11\",\"21\":\"13\",\"22\":\"14\",\"23\":\"0\",\"24\":\"0\",\"25\":\"2\",\"26\":\"2\",\"_rn_\":\"18\"},{\"1\":\"168\",\"2\":\"2\",\"3\":\"1\",\"4\":\"94\",\"5\":\"3\",\"6\":\"3\",\"7\":\"2\",\"8\":\"1\",\"9\":\"2\",\"10\":\"2\",\"11\":\"1\",\"12\":\"3\",\"13\":\"1\",\"14\":\"4\",\"15\":\"52\",\"16\":\"1\",\"17\":\"3\",\"18\":\"1\",\"19\":\"55\",\"20\":\"13\",\"21\":\"13\",\"22\":\"15\",\"23\":\"3\",\"24\":\"1\",\"25\":\"1\",\"26\":\"1\",\"_rn_\":\"19\"},{\"1\":\"118\",\"2\":\"1\",\"3\":\"1\",\"4\":\"79\",\"5\":\"4\",\"6\":\"3\",\"7\":\"2\",\"8\":\"4\",\"9\":\"2\",\"10\":\"1\",\"11\":\"3\",\"12\":\"3\",\"13\":\"2\",\"14\":\"2\",\"15\":\"48\",\"16\":\"2\",\"17\":\"3\",\"18\":\"1\",\"19\":\"45\",\"20\":\"17\",\"21\":\"12\",\"22\":\"10\",\"23\":\"0\",\"24\":\"7\",\"25\":\"2\",\"26\":\"2\",\"_rn_\":\"20\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n`efc` is a German data set from a European study on family care of older\npeople. Following a common protocol, data were collected from national\nsamples of approximately 1,000 family carers (i.e. caregivers) per\ncountry and clustered into comparable subgroups to facilitate\ncross-national analysis. One of the *research questions* in [**this\nEUROFAM study**](https://doi.org/10.1093/geront/48.6.752) was:\n\n> What are the main difficulties carers experience accessing the\n> services used? What prevents carers from accessing unused supports\n> that they need? What causes them to stop using still-needed services?\n\nWe will select the variables from the `efc` data set that related to\n*coping* (on part of care-givers) and plot their responses after\ninspecting them:\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-19_17b12196a87c0876b1c5c6d1fc681793'}\n\n```{.r .cell-code}\nefc %>% select(dplyr::contains(\"cop\")) %>% str()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t908 obs. of  9 variables:\n $ c82cop1: num  3 3 2 4 3 2 4 3 3 3 ...\n  ..- attr(*, \"label\")= chr \"do you feel you cope well as caregiver?\"\n  ..- attr(*, \"labels\")= Named num [1:4] 1 2 3 4\n  .. ..- attr(*, \"names\")= chr [1:4] \"never\" \"sometimes\" \"often\" \"always\"\n $ c83cop2: num  2 3 2 1 2 2 2 2 2 2 ...\n  ..- attr(*, \"label\")= chr \"do you find caregiving too demanding?\"\n  ..- attr(*, \"labels\")= Named num [1:4] 1 2 3 4\n  .. ..- attr(*, \"names\")= chr [1:4] \"Never\" \"Sometimes\" \"Often\" \"Always\"\n $ c84cop3: num  2 3 1 3 1 3 4 2 3 1 ...\n  ..- attr(*, \"label\")= chr \"does caregiving cause difficulties in your relationship with your friends?\"\n  ..- attr(*, \"labels\")= Named num [1:4] 1 2 3 4\n  .. ..- attr(*, \"names\")= chr [1:4] \"Never\" \"Sometimes\" \"Often\" \"Always\"\n $ c85cop4: num  2 3 4 1 2 3 1 1 2 2 ...\n  ..- attr(*, \"label\")= chr \"does caregiving have negative effect on your physical health?\"\n  ..- attr(*, \"labels\")= Named num [1:4] 1 2 3 4\n  .. ..- attr(*, \"names\")= chr [1:4] \"Never\" \"Sometimes\" \"Often\" \"Always\"\n $ c86cop5: num  1 4 1 1 2 3 1 1 2 1 ...\n  ..- attr(*, \"label\")= chr \"does caregiving cause difficulties in your relationship with your family?\"\n  ..- attr(*, \"labels\")= Named num [1:4] 1 2 3 4\n  .. ..- attr(*, \"names\")= chr [1:4] \"Never\" \"Sometimes\" \"Often\" \"Always\"\n $ c87cop6: num  1 1 1 1 2 2 2 1 1 1 ...\n  ..- attr(*, \"label\")= chr \"does caregiving cause financial difficulties?\"\n  ..- attr(*, \"labels\")= Named num [1:4] 1 2 3 4\n  .. ..- attr(*, \"names\")= chr [1:4] \"Never\" \"Sometimes\" \"Often\" \"Always\"\n $ c88cop7: num  2 3 1 1 1 2 4 2 3 1 ...\n  ..- attr(*, \"label\")= chr \"do you feel trapped in your role as caregiver?\"\n  ..- attr(*, \"labels\")= Named num [1:4] 1 2 3 4\n  .. ..- attr(*, \"names\")= chr [1:4] \"Never\" \"Sometimes\" \"Often\" \"Always\"\n $ c89cop8: num  3 2 4 2 4 1 1 3 1 1 ...\n  ..- attr(*, \"label\")= chr \"do you feel supported by friends/neighbours?\"\n  ..- attr(*, \"labels\")= Named num [1:4] 1 2 3 4\n  .. ..- attr(*, \"names\")= chr [1:4] \"never\" \"sometimes\" \"often\" \"always\"\n $ c90cop9: num  3 2 3 4 4 1 4 3 3 3 ...\n  ..- attr(*, \"label\")= chr \"do you feel caregiving worthwhile?\"\n  ..- attr(*, \"labels\")= Named num [1:4] 1 2 3 4\n  .. ..- attr(*, \"names\")= chr [1:4] \"never\" \"sometimes\" \"often\" \"always\"\n```\n:::\n:::\n\n\nThe `cop`ing related variables have responses on the Likert Scale\n`(1,2,3,4)` which correspond to `(never, sometimes, often, always)`,\n**and** each variable also has a `label` defining each variable. We can\nplot this data using the `plot_likert` function from package `sjPlot`:\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-20_a9aa8d950df412b7f041f5c62c763bfb'}\n\n```{.r .cell-code}\nefc %>% select(dplyr::contains(\"cop\")) %>% \n  sjPlot::plot_likert(title = \"Caregiver Survey from EUROFAM\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nSo there we are with Categorical data ! There are a few other plots with\nthis type of data, which are useful in very specialized circumstances.\nOne example of this is the `agreement plot` which captures the agreement\nbetween two (sets) of evaluators, on ratings given on a shared ordinal\nscale to a set of items. An example from the field of medical diagnosis\nis the opinions of two specialists on a common set of patients.\n\n## Conclusion\n\nHow are these bar plots different from histograms? Why don't \"regular\"\nplots simply work for Categorical data? Discuss!\n\n## Your Turn\n\n1.  Take some of the categorical datasets from the `vcd` and `vcdExtra`\n    packages and recreate the plots from this module.\n\n## References\n\n1.  Chapter 4,\n    <https://openintro-ims.netlify.app/explore-categorical.html> from\n    *An Introduction to Modern Statistics by Mine Cetinkaya-Rundel and\n    Johanna Hardin*.\n\n2.  Using the `strcplot` command from `vcd`,\n    <https://cran.r-project.org/web/packages/vcd/vignettes/strucplot.pdf>\n\n3.  Creating Frequency Tables with `vcd`,\n    <https://cran.r-project.org/web/packages/vcdExtra/vignettes/A_creating.html>\n\n4.  Creating mosaic plots with `vcd`,\n    <https://cran.r-project.org/web/packages/vcdExtra/vignettes/D_mosaics.html>\n\n5.  Michael Friendly, *Corrgrams: Exploratory displays for correlation\n    matrices*. The American Statistician August 19, 2002 (v1.5).\n    <https://www.datavis.ca/papers/corrgram.pdf>\n\n6.  [Visualizing Categorical Data in\n    R](https://homepage.divms.uiowa.edu/~luke/classes/STAT4580/catone.html)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../../../../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n<link href=\"../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}