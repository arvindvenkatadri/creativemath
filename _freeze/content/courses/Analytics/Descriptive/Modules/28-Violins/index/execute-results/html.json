{
  "hash": "914270260045b1895551c12d513b923d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"\\U0001F4CA Violins: Plotting Groups and Density\"\nsubtitle: \"\"\nauthor: \"Arvind V.\"\ndate: 15/Nov/2022\ndate-modified: \"2024-06-26\"\nabstract: \"Quant and Qual Variable Graphs and their Siblings\"\norder: 28\nimage: preview.jpg\nimage-alt: Image by rawpixel.com\ndf-print: paged\ncategories:\n- Qual Variables\n- Quant Variables\n- Bar Charts\n- Column Charts\n- Histograms\n- Density Plots\n- Box Plots\n- Violin Plots\nbibliography: \n  - references.bib\n  - grateful-refs.bib\ncitation: true\n#suppress-bibliography: true\n# editor: \n#   markdown: \n#     wrap: 72\nwebr:\n  packages: ['readr', 'tidyr', 'dplyr','mosaic', 'skimr', 'ggformula','ggridges', 'palmerpenguins']\n\n---\n\n\n## {{< fa folder-open >}} Slides and Tutorials\n\n|                                                                                                 |                                                                                                    |                                                                                        |\n|------------------------|------------------------|------------------------|\n| <a href=\"./files/distributions.qmd\"><i class=\"fa-brands fa-r-project\"></i> R (Static Viz)</a>   | <a href=\"./files/distributions.rda\"> <i class=\"fa-solid fa-person-rays\"></i> Radiant Tutorial</a>  | <a href=\"./files/data/qdd-data.zip\"> <i class=\"fa-solid fa-database\"></i> Datasets</a> |\n\n## {{< iconify noto-v1 package >}} Setting up R Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(paged.print = TRUE)\nlibrary(tidyverse)\nlibrary(mosaic)\nlibrary(ggformula)\n\n#install.packages(\"remotes\")\n#library(remotes)\n#remotes::install_github(\"wilkelab/ggridges\")\nlibrary(ggridges)\nlibrary(skimr)\n\nlibrary(palmerpenguins) # Our new favourite dataset\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n## {{< iconify fxemoji japanesesymbolforbeginner >}} What graphs will we see today?\n\n| Variable #1 | Variable #2 | Chart Names |                    Chart Shape    | \n|:-------------:|:--------------:|:------------------:|:--------------------:|:------:|\n|    Quant    |    (Qual)    |  Violin Plot  | {{< iconify carbon chart-violin-plot size=4x >}} |\n\n\n## {{< iconify tabler variable >}} What kind of Data Variables will we choose?\n\n::: column-page-inset-right\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> No </th>\n   <th style=\"text-align:left;\"> Pronoun </th>\n   <th style=\"text-align:left;\"> Answer </th>\n   <th style=\"text-align:left;\"> Variable/Scale </th>\n   <th style=\"text-align:left;\"> Example </th>\n   <th style=\"text-align:left;\"> What Operations? </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> How Many / Much / Heavy? Few? Seldom? Often? When? </td>\n   <td style=\"text-align:left;\"> Quantities, with Scale and a Zero Value.Differences and Ratios /Products are meaningful. </td>\n   <td style=\"text-align:left;\"> Quantitative/Ratio </td>\n   <td style=\"text-align:left;\"> Length,Height,Temperature in Kelvin,Activity,Dose Amount,Reaction Rate,Flow Rate,Concentration,Pulse,Survival Rate </td>\n   <td style=\"text-align:left;\"> Correlation </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n\n\n## {{< iconify icons8 idea >}} Inspiration\n\n::: {#fig-golf-drive-evolution layout-ncol=2}\n\n![](../../../../../materials/images/Golf-Drive-Distance-1983.png)\n\n![](../../../../../materials/images/Golf-Drive-distance-2017.png)\nGolf Drive Distance over the years\n\n:::\n\n### {{< iconify carbon chart-violin-plot >}} Violin Plots\n\nOften one needs to view **multiple densities** at the same time. Ridge\nplots of course give us one option, where we get densities of a *Quant*\nvariable split by a *Qual* variable. Another option is to generate a\ndensity plot facetted into *small multiples* using a *Qual* variable.\n\nYet another plot that allows comparison of multiple densities side by\nside is a **violin plot**. The violin plot combines the aspects of a\n*boxplot*(ranking of values, median, quantiles...) with a superimposed\n*density* plot. This allows us to look at medians, means, densities, and\nquantiles of a *Quant* variable with respect to another *Qual* variable.\nLet us see what this looks like!\n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke;\"}\n\n### Using ggformula\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\n## Set graph theme\ntheme_set(new = theme_custom())\n##\n\n\ngf_violin(price ~ \"All Diamonds\", data = diamonds, \n          draw_quantiles = c(0,.25,.50,.75)) %>%\n  gf_labs(title = \"Plot A: Violin plot for Diamond Prices\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Violin plots with ggformula-1.png){width=2100}\n:::\n\n```{.r .cell-code}\n###\ndiamonds %>% \n  gf_violin(price ~ cut,\n            draw_quantiles = c(0,.25,.50,.75)) %>% \n  gf_labs(title = \"Plot B: Price by Cut\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Violin plots with ggformula-2.png){width=2100}\n:::\n\n```{.r .cell-code}\n###\ndiamonds %>% \n  gf_violin(price ~ cut, \n             fill = ~ cut, \n             color = ~ cut,\n             alpha = 0.3,\n            draw_quantiles = c(0,.25,.50,.75)) %>% \n  gf_labs(title = \"Plot C: Price by Cut\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Violin plots with ggformula-3.png){width=2100}\n:::\n\n```{.r .cell-code}\n###\ndiamonds %>% \n  gf_violin(price ~ cut, \n             fill = ~ cut, \n             colour = ~ cut,             \n             alpha = 0.3,draw_quantiles = c(0,.25,.50,.75)) %>% \n  gf_facet_wrap(vars(clarity)) %>%\n  gf_labs(title = \"Plot D: Price by Cut facetted by Clarity\") %>%\n  gf_theme(theme(axis.text.x = element_text(angle = 45,hjust = 1)))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Violin plots with ggformula-4.png){width=2100}\n:::\n:::\n\n\n### Using ggplot\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\n## Set graph theme\ntheme_set(new = theme_custom())\n##\n\ndiamonds %>% ggplot() + \n  geom_violin(aes(y = price, x = \"\"),\n              draw_quantiles = c(0,.25,.50,.75)) + # note: y, not x\n  labs(title = \"Plot A: violin for Diamond Prices\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Violin plots with ggplot-1.png){width=2100}\n:::\n\n```{.r .cell-code}\n###\ndiamonds %>% ggplot() + \n  geom_violin(aes(cut, price),\n              draw_quantiles = c(0,.25,.50,.75)) + \n  labs(title = \"Plot B: Price by Cut\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Violin plots with ggplot-2.png){width=2100}\n:::\n\n```{.r .cell-code}\n###\ndiamonds %>% ggplot() + \n  geom_violin(aes(cut, price, \n                  color = cut, fill = cut),\n              draw_quantiles = c(0,.25,.50,.75),\n              alpha = 0.4) +\n  labs(title = \"Plot C: Price by Cut\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Violin plots with ggplot-3.png){width=2100}\n:::\n\n```{.r .cell-code}\n###\ndiamonds %>% ggplot() + \n  geom_violin(aes(cut, \n                   price, \n                   color = cut, fill = cut), \n              draw_quantiles = c(0,.25,.50,.75),\n              alpha = 0.4)  +  \n  facet_wrap(vars(clarity)) +\n  labs(title = \"Plot D: Price by Cut facetted by Clarity\") +\n  theme(axis.text.x = element_text(angle = 45,hjust = 1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Violin plots with ggplot-4.png){width=2100}\n:::\n:::\n\n\n\n### {{< iconify noto-v1 spider-web >}} web-r\n\n```{webr-r}\n#| label: Violin plots with ggformula webr\n#| collapse: true\n\ngf_violin(price ~ \"\", data = diamonds, \n          draw_quantiles = c(0,.25,.50,.75)) %>%\n  gf_labs(title = \"Plot A: Violin plot for Diamond Prices\")\n\n```\n\n```{webr-r}\ndiamonds %>% \n  gf_violin(price ~ cut,\n            draw_quantiles = c(0,.25,.50,.75)) %>% \n  gf_labs(title = \"Plot B: Price by Cut\")\n\n```\n\n```{webr-r}\ndiamonds %>% \n  gf_violin(price ~ cut, \n             fill = ~ cut, \n             color = ~ cut,\n             alpha = 0.3,\n            draw_quantiles = c(0,.25,.50,.75)) %>% \n  gf_labs(title = \"Plot C: Price by Cut\")\n\n```\n\n```{webr-r}\ndiamonds %>% \n  gf_violin(price ~ cut, \n             fill = ~ cut, \n             colour = ~ cut,             \n             alpha = 0.3,draw_quantiles = c(0,.25,.50,.75)) %>% \n  gf_facet_wrap(vars(clarity)) %>%\n  gf_labs(title = \"Plot D: Price by Cut facetted by Clarity\") %>%\n  gf_theme(theme(axis.text.x = element_text(angle = 45,hjust = 1)))\n\n```\n\n```{webr-r}\n#| label: Violin plots with ggplot webr\n#| layout-ncol: 2\n#| collapse: true\ndiamonds %>% ggplot() + \n  geom_violin(aes(y = price, x = \"\"),\n              draw_quantiles = c(0,.25,.50,.75)) + # note: y, not x\n  labs(title = \"Plot A: violin for Diamond Prices\")\n\n```\n\n```{webr-r}\ndiamonds %>% ggplot() + \n  geom_violin(aes(cut, price),\n              draw_quantiles = c(0,.25,.50,.75)) + \n  labs(title = \"Plot B: Price by Cut\")\n\n```\n\n```{webr-r}\ndiamonds %>% ggplot() + \n  geom_violin(aes(cut, price, \n                  color = cut, fill = cut),\n              draw_quantiles = c(0,.25,.50,.75),\n              alpha = 0.4) +\n  labs(title = \"Plot C: Price by Cut\")\n\n```\n\n```{webr-r}\ndiamonds %>% ggplot() + \n  geom_violin(aes(cut, \n                   price, \n                   color = cut, fill = cut), \n              draw_quantiles = c(0,.25,.50,.75),\n              alpha = 0.4)  +  \n  facet_wrap(vars(clarity)) +\n  labs(title = \"Plot D: Price by Cut facetted by Clarity\") +\n  theme(axis.text.x = element_text(angle = 45,hjust = 1))\n\n```\n\n:::\n\n::: callout-note\n### Business Insights from `diamond` Violin Plots\n\nThe distribution for price is clearly *long-tailed* (skewed). The\ndistributions also vary considerably based on both `cut` and `clarity`.\nThese *Qual* variables clearly have a large effect on the prices of\nindividual diamonds.\n:::\n\n\n\n## {{< iconify ph bell-simple-z-duotone >}} Z-scores\n\nOften when we compute wish to compare distributions with different\nvalues for means and standard deviations, we resort to a *scaling* of\nthe variables that are plotted in the respective distributions.\n\n\n::: {.cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n![](index_files/figure-html/z-scores-1.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/z-scores-2.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/z-scores-3.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/z-scores-4.png){width=2100}\n:::\n:::\n\n\nAlthough the densities all look the same, they are are quite different!\nThe x-axis in each case has *two scales*: one is the actual value of the\nx-variable, and the other is the *z-score* which is calculated as:\n\n$$\nz_x = \\frac{x - \\mu_{x}}{\\sigma_x}\n$$\n\nWith similar distributions (i.e. normal distributions), we see that the\nvariation in density is the **same** at the same values of `z-score` for\neach variable. However since the $\\mu_i$ and $\\sigma_i$ are different,\nthe *absolute* value of the `z-score` is different for each variable. In\nthe first plot (from the top left), $z = 1$ corresponds to an absolute\nchange of $5$ units; it is $15$ units in the plot directly below it.\n\nOur comparisons are done easily when we compare differences in\nprobabilities at identical `z-scores`, or differences in `z-scores` at\nidentical probabilities.\n\n## {{< iconify fluent-mdl2 decision-solid >}} Conclusion\n\n-   Histograms, Frequency Distributions, and Box Plots are used for\n    Quantitative data variables\n-   Histograms \"dwell upon\" **counts**, **ranges**, **means** and\n    **standard deviations**\n-   Frequency Density plots \"dwell upon\" **probabilities** and\n    **densities**\n-   Box Plots \"dwell upon\" **medians** and **Quartiles**\n-   Qualitative data variables can be plotted as **counts**, using Bar\n    Charts, or using Heat Maps\n-   Violin Plots help us to visualize multiple distributions at the same\n    time, as when we split a *Quant* variable wrt to the *levels* of a\n    *Qual* variable.\n-   Ridge Plots are **density plots** used for describing one Quant and\n    one Qual variable (by inherent splitting)\n-   We can split all these plots on the basis of another Qualitative\n    variable.(Ridge Plots are already split)\n-   Long tailed distributions need care in visualization and in\n    inference making!\n\n## {{< iconify openmoji person >}} Your Turn\n\n<a href=\"./files/data/qdd-data.zip\">\n<i class=\"fa-solid fa-database\"></i> Datasets</a>\n\n1.  Click on the Dataset Icon above, and unzip that archive. Try to make\n    distribution plots with each of the three tools.\n2.  A dataset from calmcode.io <https://calmcode.io/datasets.html>\n3.  Old Faithful Data in R (Find it!)\n\n`inspect` the dataset in each case and develop a set of Questions, that\ncan be answered by appropriate stat measures, or by using a chart to\nshow the distribution.\n\n## {{< iconify ri slash-commands-2>}} R Commands Used Here{.hidden}\n\n\n\n\n\n## {{< iconify ooui references-rtl >}} References\n\n1. See the scrolly animation for a histogram at this website: *Exploring Histograms, an essay by Aran Lunzer and Amelia McNamara*\n<https://tinlizzie.org/histograms/?s=09>\\\n1. Minimal R using\n`mosaic`.<https://cran.r-project.org/web/packages/mosaic/vignettes/MinimalRgg.pdf>\\\n1. Sebastian Sauer, *Plotting multiple plots using purrr::map and ggplot* [](https://data-se.netlify.app/2021/02/06/plotting-multiple-plots-using-purrr-map-and-ggplot/)\\\n\n::: {#refs style=\"font-size: 60%;\"}\n###### {{< iconify lucide package-check >}} R Package Citations\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nPackage         Version   Citation       \n--------------  --------  ---------------\nggridges        0.5.6     @ggridges      \nNHANES          2.1.0     @NHANES        \nTeachHist       0.2.1     @TeachHist     \nTeachingDemos   2.13      @TeachingDemos \nvisualize       4.5.0     @visualize     \n\n\n:::\n:::\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../../../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<link href=\"../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}