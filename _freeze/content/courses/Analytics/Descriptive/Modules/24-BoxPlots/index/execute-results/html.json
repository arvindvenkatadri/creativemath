{
  "hash": "1a3bbd6627a9cf3528240203495c5167",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"\\U0001F4CA Boxplots: Plotting Groups\"\nsubtitle: \"Plotting Distributions over Categories\"\nauthor: \"Arvind V.\"\ndate: 24/June/2024\ndate-modified: \"2024-07-19\"\nabstract: \"Quant and Qual Variable Graphs and their Siblings\"\norder: 24\nimage: preview.jpg\nimage-alt: Image by rawpixel.com\ndf-print: paged\ncategories:\n- Qual Variables\n- Quant Variables\n- Box Plots\n- Violin Plots\nbibliography: \n  - references.bib\n  - grateful-refs.bib\ncitation: true\n#suppress-bibliography: true\n# editor: \n#   markdown: \n#     wrap: 72\nwebr:\n  packages: ['readr', 'tidyr', 'dplyr','mosaic', 'skimr', 'ggformula','ggridges', 'palmerpenguins']\n\n---\n\n\n\n\n## {{< fa folder-open >}} Slides and Tutorials\n\n|                                                                                                 |                                                                                                    |                                                                                        |\n|------------------------|------------------------|------------------------|\n| <a href=\"./files/distributions.qmd\"><i class=\"fa-brands fa-r-project\"></i> R (Static Viz)</a>   | <a href=\"./files/distributions.rda\"> <i class=\"fa-solid fa-person-rays\"></i> Radiant Tutorial</a>  | <a href=\"./files/data/qdd-data.zip\"> <i class=\"fa-solid fa-database\"></i> Datasets</a> |\n\n## {{< iconify noto-v1 package >}} Setting up R Packages\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(paged.print = TRUE)\nlibrary(tidyverse)\nlibrary(mosaic)\nlibrary(ggformula)\nlibrary(palmerpenguins) # Our new favourite dataset\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\n\n## {{< iconify fxemoji japanesesymbolforbeginner >}} What graphs will we see today?\n\n| Variable #1 | Variable #2 | Chart Names |                    Chart Shape    | \n|:-------------:|:--------------:|:------------------:|:--------------------:|:------:|\n|    Quant    |    Qual   | Box Plot | {{< iconify carbon box-plot size=4x >}} |\n\n## {{< iconify tabler variable >}} What kind of Data Variables will we choose?\n\n::: column-page-inset-right\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper lightable-hover\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> No </th>\n   <th style=\"text-align:left;\"> Pronoun </th>\n   <th style=\"text-align:left;\"> Answer </th>\n   <th style=\"text-align:left;\"> Variable/Scale </th>\n   <th style=\"text-align:left;\"> Example </th>\n   <th style=\"text-align:left;\"> What Operations? </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> How Many / Much / Heavy? Few? Seldom? Often? When? </td>\n   <td style=\"text-align:left;\"> Quantities, with Scale and a Zero Value.Differences and Ratios /Products are meaningful. </td>\n   <td style=\"text-align:left;\"> Quantitative/Ratio </td>\n   <td style=\"text-align:left;\"> Length,Height,Temperature in Kelvin,Activity,Dose Amount,Reaction Rate,Flow Rate,Concentration,Pulse,Survival Rate </td>\n   <td style=\"text-align:left;\"> Correlation </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> What, Who, Where, Whom, Which </td>\n   <td style=\"text-align:left;\"> Name, Place, Animal, Thing </td>\n   <td style=\"text-align:left;\"> Qualitative/Nominal </td>\n   <td style=\"text-align:left;\"> Name </td>\n   <td style=\"text-align:left;\"> Count no. of cases,Mode </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n\n## {{< iconify icons8 idea >}} Inspiration\n\n![Box Plot Inspiration](what-we-mean-when-we-say.jpeg){#fig-boxplot-inspiration}\n\n[Alice said, \"I say what I mean and I mean what I say!\"](https://www.reddit.com/r/EnglishLearning/comments/1abf1dg/comment/kjn85an/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button) Are the rest of us so sure? What do we mean when we use any of the phrases above? How definite are we? There is a range of \"sureness\" and \"unsureness\"...and this is where we can use box plots like @fig-boxplot-inspiration to show that range of opinion.\n\n\n## {{< iconify mdi food-processor-outline >}} How do these Chart(s) Work?\n\nBox Plots are an extremely useful data visualization that gives us an idea of the distribution of a Quant variable, for each *level* of another Qual variable. The internal process of this plot is as follows:\n\n  - make groups of the Quant variable for each level of the Qual\n  - in each group, rank the Quant variable values in increasing order\n  - Calculate: `median`, `IQR`, `outliers`\n  - plot these as a vertical or horizontal box structure\n\nThe box  can also be asymmetric \"half plots\" if needed...\n\n::: callout-note\n### Histograms and Box Plots\nNote how the histogram that dwells upon the `mean` and `standard deviation`, whereas the boxplot focuses on the `median` and `quartiles`.\nThe former uses the *values* of the Quant variable, whereas the latter uses their *sequence number* or *ranks*. \n:::\n\nBox plots are often used for example in HR operations to understand Salary distributions across grades of employees. Marks of students in competitive exams are also declared using Quartiles. \n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Box Plot Definitions](index_files/figure-html/fig-boxplot-diagram-1.png){#fig-boxplot-diagram width=2100}\n:::\n:::\n\n\n\n\nBox plots can show skew in distributions. In such cases the \"bottom\" and the \"lid\" of the box may not be the same size!\n\n::: {#fig-boxplots-with-skewness layout-ncol=2}\n\n![Box Plot and Skewness](../../../../../materials/images/Boxplots_with_skewness.png){#fig-three-boxplots}\n\n\n![Density and Skewness](../../../../../materials/images/Relationship_between_mean_and_median_under_different_skewness.png){#fig-distribution-skewness}\n\nBox Plot Discussions\n\n:::\n\nIn the @fig-three-boxplots, we see the difference between boxplots that show *symmetric* and *skewed* distributions. The \"lid\" and the \"bottom\" of the box are not of similar width in distributions with significant skewness. \n\nCompare these with the corresponding @fig-distribution-skewness.\n\n:::\n\n## {{< iconify grommet-icons test >}} Case Study-1: `gss_wages` dataset\n\nWe will first look at Wage data from the General Social Survey (1974-2018) conducted in the USA, which is used to illustrate wage discrepancies by gender (while also considering respondent occupation, age, and education). This is available on [Vincent Arel-Bundock's superb repository of datasets](https://vincentarelbundock.github.io/Rdatasets/articles/data.html). Let us read into R *directly from the website*. \n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke;\"}\n\n### {{< iconify la r-project >}} R\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwages <- read_csv(\"https://vincentarelbundock.github.io/Rdatasets/csv/stevedata/gss_wages.csv\")\n```\n:::\n\n\n\n\nThe data has automatically been read into the `webr` session, so you can continue on to the next code chunk!\n\n\n```{webr-r}\n#| context: setup\n# Read the data\nwages <- read.csv(\"https://vincentarelbundock.github.io/Rdatasets/csv/stevedata/gss_wages.csv\")\n\n```\n:::\n\n\n### {{< iconify file-icons influxdata >}} Examine the Data\n\nAs per our Workflow, we will look at the data using all the three\nmethods we have seen.\n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke;\"}\n\n### {{< iconify la r-project >}} R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(wages)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 61,697\nColumns: 12\n$ rownames   <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ year       <dbl> 1974, 1974, 1974, 1974, 1974, 1974, 1974, 1974, 1974, 1974,…\n$ realrinc   <dbl> 4935, 43178, NA, NA, 18505, 22206, 55515, NA, NA, 4935, NA,…\n$ age        <dbl> 21, 41, 83, 69, 58, 30, 48, 67, 51, 54, 89, 71, 27, 30, 22,…\n$ occ10      <dbl> 5620, 2040, NA, NA, 5820, 910, 230, 6355, 4720, 3940, 4810,…\n$ occrecode  <chr> \"Office and Administrative Support\", \"Professional\", NA, NA…\n$ prestg10   <dbl> 25, 66, NA, NA, 37, 45, 59, 49, 28, 38, 47, 45, 50, 29, 33,…\n$ childs     <dbl> 0, 3, 2, 2, 0, 0, 2, 1, 2, 2, 3, 1, 4, 3, 0, 1, 2, 3, 4, 8,…\n$ wrkstat    <chr> \"School\", \"Full-Time\", \"Housekeeper\", \"Housekeeper\", \"Full-…\n$ gender     <chr> \"Male\", \"Male\", \"Female\", \"Female\", \"Female\", \"Male\", \"Male…\n$ educcat    <chr> \"High School\", \"Bachelor\", \"Less Than High School\", \"Less T…\n$ maritalcat <chr> \"Married\", \"Married\", \"Widowed\", \"Widowed\", \"Never Married\"…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nskim(wages)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |      |\n|:------------------------|:-----|\n|Name                     |wages |\n|Number of rows           |61697 |\n|Number of columns        |12    |\n|_______________________  |      |\n|Column type frequency:   |      |\n|character                |5     |\n|numeric                  |7     |\n|________________________ |      |\n|Group variables          |None  |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|occrecode     |      3561|          0.94|   5|  37|     0|       11|          0|\n|wrkstat       |        21|          1.00|   5|  23|     0|        8|          0|\n|gender        |         0|          1.00|   4|   6|     0|        2|          0|\n|educcat       |       135|          1.00|   8|  21|     0|        5|          0|\n|maritalcat    |        27|          1.00|   7|  13|     0|        5|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|     mean|       sd|   p0|   p25|   p50|   p75|     p100|hist  |\n|:-------------|---------:|-------------:|--------:|--------:|----:|-----:|-----:|-----:|--------:|:-----|\n|rownames      |         0|          1.00| 30849.00| 17810.53|    1| 15425| 30849| 46273|  61697.0|▇▇▇▇▇ |\n|year          |         0|          1.00|  1996.07|    12.79| 1974|  1985|  1996|  2006|   2018.0|▆▇▇▇▇ |\n|realrinc      |     23810|          0.61| 22326.36| 28581.79|  227|  8156| 16563| 27171| 480144.5|▇▁▁▁▁ |\n|age           |       219|          1.00|    46.18|    17.56|   18|    32|    44|    59|     89.0|▇▇▆▅▂ |\n|occ10         |      3561|          0.94|  4695.77|  2627.72|   10|  2710|  4720|  6230|   9997.0|▃▅▇▂▃ |\n|prestg10      |      4186|          0.93|    43.06|    12.99|   16|    33|    42|    50|     80.0|▃▇▇▃▁ |\n|childs        |       189|          1.00|     1.92|     1.76|    0|     0|     2|     3|      8.0|▇▇▂▁▁ |\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninspect(wages)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n        name     class levels     n missing\n1  occrecode character     11 58136    3561\n2    wrkstat character      8 61676      21\n3     gender character      2 61697       0\n4    educcat character      5 61562     135\n5 maritalcat character      5 61670      27\n                                   distribution\n1 Professional (19%), Service (16.9%) ...      \n2 Full-Time (49.4%), Housekeeper (15.1%) ...   \n3 Female (56.1%), Male (43.9%)                 \n4 High School (51.5%) ...                      \n5 Married (51.7%), Never Married (21.8%) ...   \n\nquantitative variables:  \n      name   class  min    Q1 median    Q3      max         mean           sd\n1 rownames numeric    1 15425  30849 46273  61697.0 30849.000000 17810.534116\n2     year numeric 1974  1985   1996  2006   2018.0  1996.073715    12.794470\n3 realrinc numeric  227  8156  16563 27171 480144.5 22326.359234 28581.794499\n4      age numeric   18    32     44    59     89.0    46.176177    17.561065\n5    occ10 numeric   10  2710   4720  6230   9997.0  4695.774081  2627.724076\n6 prestg10 numeric   16    33     42    50     80.0    43.060701    12.987526\n7   childs numeric    0     0      2     3      8.0     1.923457     1.763569\n      n missing\n1 61697       0\n2 61697       0\n3 37887   23810\n4 61478     219\n5 58136    3561\n6 57511    4186\n7 61508     189\n```\n\n\n:::\n:::\n\n\n\n\n### {{< iconify noto-v1 spider-web >}} web-r\n\n```{webr-r}\n#| label: glimpse-wages-webr\nglimpse(wages)\n\n```\n\n```{webr-r}\n#| label: skim-wages-webr\nskim(wages)\n\n```\n\n```{webr-r}\n#| label: inspect-wages-webr\nskim(wages)\n\n```\n\n:::\n\n\n::: callout-note\n### Data Dictionary for the `wages` dataset\nFrom the [dataset documentation page](https://vincentarelbundock.github.io/Rdatasets/doc/stevedata/gss_wages.html), we note that:\n\n-   This is a large dataset (61K rows), with 11 variables:\\\n  - `year`(dbl): the survey year\\\n  - `realrinc`(dbl): the respondent's base income (in constant 1986 USD\\\n  - `age`(dbl): the respondent's age in years\\\n  - `occ10`(dbl): respondent's occupation code (2010)\\\n  - `occrecode`(chr): recode of the occupation code into one of 11 main categories\\\n  - `prestg10`(dbl): respondent's occupational prestige score (2010)\\\n  - `childs`(dbl): number of children (0-8)\\\n  - `wrkstat`(chr): the work status of the respondent (full-time, part-time, temporarily not working, unemployed (laid off), retired, school, housekeeper, other). 8 levels.\\ \n  - `gender`(chr): respondent's gender (male or female). 2 levels.\\\n  - `educcat`(chr): respondent's degree level (Less Than High School, High School, Junior College, Bachelor, or Graduate). 5 levels.\\\n  - `maritalcat`(chr): respondent's marital status (Married, Widowed, Divorced, Separated, Never Married). 5 levels.\\\n:::\n\n::: callout-note\n### Business Insights based on `wages` dataset\n- Fair amount of missing data; however with 61K rows, we can for the present simply neglect the missing data. \n- Good mix of Qual and Quant variables\n:::\n\n::: callout-note\n### Hypothesis and Research Questions\n- The target variable for an experiment that resulted in this data might be the `realinc` variable, the resultant income of the individual. Which is numerical variable. \n- Research Questions:\n  - What is the basic distribution of `realrinc`?\n  - Is `realrinc` affected by `gender`? \n  - By `educcat`? By `maritalcat`?\n  - Is `realrinc` affected by `child`? \n  - Do combinations of these factors have an effect on the target variable?\n  \nThese should do for now! But we should make more questions when have seen some plots!\n\n:::\n\n### {{< iconify carbon clean >}} Data Munging\n Since there are so many missing data in the target variable `realinc` *and* there is still enough data leftover, let us remove the rows containing missing data in that variable. \n \n::: callout-important\nNOTE: This is not advised at all as a general procedure!! Data is valuable and there are better ways to manage this problem!\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwages_clean <- \n  wages %>% \n  tidyr::drop_na(realrinc) # choose column or leave blank to choose all\n```\n:::\n\n\n\n\n```{webr-r}\nwages_clean <-  wages %>% tidyr::drop_na(realinc)\n```\n\n\n## {{< iconify carbon box-plot >}} Plotting Box Plots\n\n### {{< iconify el question-sign >}} Question-1: What is the basic distribution of `realrinc`?\n\n::: callout-note\n### Question-1: What is the basic distribution of `realrinc`?\n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke; \"}\n\n### Using ggformula\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\nwages_clean %>% \n  gf_boxplot(realrinc ~ \"Income\") %>% # Dummy X-axis \"variable\"\n  gf_labs(title = \"Plot 1A: Income has a skewed distribution\",\n          subtitle = \"Many outliers on the high side\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/realincome-ggformula-1.png){width=2100}\n:::\n:::\n\n\n\n\n### Using ggplot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\nwages_clean %>% \n  ggplot() + \n  geom_boxplot(aes(y = realrinc, x = \"Income\")) +  # Dummy X-axis \"variable\"\n  labs(title = \"Plot 1A: Income has a skewed distribution\",\n          subtitle = \"Many outliers on the high side\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/realincome-ggplot-1.png){width=2100}\n:::\n:::\n\n\n\n\n### {{< iconify noto-v1 spider-web >}} web-r\n```{webr-r}\nwages %>% \n  tidyr::drop_na(realrinc) %>% \n  gf_boxplot(realrinc ~ \"Income\") %>% # Dummy X-axis \"variable\"\n  gf_labs(title = \"Plot 1A: Income has a skewed distribution\",\n          subtitle = \"Many outliers on the high side\")\n##\nwages %>% \n  tidyr::drop_na(realrinc) %>%  \n  ggplot() + \n  geom_boxplot(aes(y = realrinc, x = \"Income\")) +  # Dummy X-axis \"variable\"\n  labs(title = \"Plot 1A: Income has a skewed distribution\",\n          subtitle = \"Many outliers on the high side\")\n\n```\n\n\n\n:::\n### Business Insights-1\n- Income is a very skewed distribution, as might be expected. \n- Presence of many higher-side outliers is noted. \n\n:::\n\n\n\n### {{< iconify el question-sign >}} Question-2: Is `realrinc` affected by `gender`? \n::: callout-note\n### Question-2: Is `realrinc` affected by `gender`? \n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke;\"}\n### Using ggformula\n\n\n\n::: {#fig-income-by-gender-ggformula .cell layout-ncol=\"3\"}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\nwages_clean %>% \n  gf_boxplot(gender ~ realrinc) %>% \n  gf_labs(title = \"Plot 2A: Income by Gender\")\n##\nwages_clean %>% \n  gf_boxplot(gender ~ log10(realrinc)) %>% \n  gf_labs(title = \"Plot 2B: Log(Income) by Gender\")\n##\nwages_clean %>% \n  gf_boxplot(gender ~ realrinc, fill = ~ gender) %>% \n  gf_refine(scale_x_log10()) %>% \n  gf_labs(title = \"Plot 2C: Income filled by Gender, log scale\")\n```\n\n::: {.cell-output-display}\n![Split by Gender](index_files/figure-html/fig-income-by-gender-ggformula-1.png){#fig-income-by-gender-ggformula-1 width=2100}\n:::\n\n::: {.cell-output-display}\n![With log income](index_files/figure-html/fig-income-by-gender-ggformula-2.png){#fig-income-by-gender-ggformula-2 width=2100}\n:::\n\n::: {.cell-output-display}\n![With log scale](index_files/figure-html/fig-income-by-gender-ggformula-3.png){#fig-income-by-gender-ggformula-3 width=2100}\n:::\n\nIncome by Gender\n:::\n\n\n\n\n### Using ggplot\n\n\n\n::: {#fig-income-by-gender-ggplot .cell layout-ncol=\"3\"}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\nwages_clean %>% \n  ggplot() + \n  geom_boxplot(aes(y = gender, x = realrinc)) +\n  labs(title = \"Plot 2A: Income by Gender\")\n##\nwages_clean %>% \n  ggplot() + \n  geom_boxplot(aes(y = gender, x = log10(realrinc))) + \n  labs(title = \"Plot 2B: Log(Income) by Gender\")\n##\nwages_clean %>% \n  ggplot() + \n  geom_boxplot(aes(y = gender, x = realrinc, fill = gender)) +\n  gf_refine(scale_x_log10()) +\n  labs(title = \"Plot 2C: Income filled by Gender, log scale\")\n```\n\n::: {.cell-output-display}\n![Split by Gender](index_files/figure-html/fig-income-by-gender-ggplot-1.png){#fig-income-by-gender-ggplot-1 width=2100}\n:::\n\n::: {.cell-output-display}\n![With log income](index_files/figure-html/fig-income-by-gender-ggplot-2.png){#fig-income-by-gender-ggplot-2 width=2100}\n:::\n\n::: {.cell-output-display}\n![With log scale](index_files/figure-html/fig-income-by-gender-ggplot-3.png){#fig-income-by-gender-ggplot-3 width=2100}\n:::\n\nIncome by Gender\n:::\n\n\n\n\n\n### web-r\n\n```{webr-r}\n\nwages %>% \n  tidyr::drop_na(realrinc) %>% \n  gf_boxplot(gender ~ realrinc) %>% \n  gf_labs(title = \"Plot 2A: Income by Gender\")\n##\nwages %>% \n  tidyr::drop_na(realrinc) %>% \n  gf_boxplot(gender ~ log10(realrinc)) %>% \n  gf_labs(title = \"Plot 2B: Log(Income) by Gender\")\n##\nwages %>% \n  tidyr::drop_na(realrinc) %>% \n  gf_boxplot(gender ~ realrinc, fill = ~ gender) %>% \n  gf_refine(scale_x_log10()) %>% \n  gf_labs(title = \"Plot 2C: Income filled by Gender, log scale\")\n\n```\n\n:::\n\n### Business Insights-2\n- Even when split by `gender`, `realincome` presents a skewed set of distributions.\n- The IQR for `male`s is smaller than the IQR for `female`s. There is less variation in the middle ranges of `realrinc` for men. \n- log10 transformation helps to view and understand the regions of low `realrinc`. \n- There are outliers on both sides, indicating that there may be many people who make very small amounts of money and large amounts of money in both `gender`s. \n\n:::\n\n### {{< iconify el question-sign >}} Question-3: Is `realrinc` affected by `educcat`? \n::: callout-note\n### Question-3: Is `realrinc` affected by `educcat`? \n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke; \"}\n\n### Using ggformula\n\n\n\n::: {#fig-income-by-educcat-ggformula .cell layout-nrow=\"2\" layout-ncol=\"2\"}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\nwages_clean %>% \n  gf_boxplot(educcat ~ realrinc) %>% \n  gf_labs(title = \"Plot 3A: Income by Education Category\")\n##\nwages_clean %>% \n  gf_boxplot(educcat ~ log10(realrinc)) %>% \n  gf_labs(title = \"Plot 3B: Log(Income) by Education Category\")\n##\nwages_clean %>% \n  gf_boxplot(reorder(educcat, realrinc, FUN = median) ~ log(realrinc), \n             fill = ~ educcat,\n             alpha = 0.3) %>% \n  gf_labs(title = \"Plot 3C: Log(Income) by Education Category, sorted\") %>% gf_labs(x = \"Log Income\", y = \"Education Category\")\n##\nwages_clean %>% \n  gf_boxplot(reorder(educcat, realrinc, FUN = median) ~ realrinc, \n             fill = ~ educcat,\n             alpha = 0.5) %>% \n  gf_refine(scale_x_log10()) %>% \n  gf_labs(title = \"Plot 3D: Income by Education Category, sorted\",\n          subtitle = \"Log Income Scale\") %>% \n  gf_labs(x = \"Income\", y = \"Education Category\")\n```\n\n::: {.cell-output-display}\n![Split by Education Category](index_files/figure-html/fig-income-by-educcat-ggformula-1.png){#fig-income-by-educcat-ggformula-1 width=2100}\n:::\n\n::: {.cell-output-display}\n![With log income](index_files/figure-html/fig-income-by-educcat-ggformula-2.png){#fig-income-by-educcat-ggformula-2 width=2100}\n:::\n\n::: {.cell-output-display}\n![With log scale](index_files/figure-html/fig-income-by-educcat-ggformula-3.png){#fig-income-by-educcat-ggformula-3 width=2100}\n:::\n\n::: {.cell-output-display}\n![Split by Education Category](index_files/figure-html/fig-income-by-educcat-ggformula-4.png){#fig-income-by-educcat-ggformula-4 width=2100}\n:::\n\nIncome by Education Category\n:::\n\n\n\n### Using ggplot\n\n\n\n\n::: {#fig-income-by-educcat-ggplot .cell layout-nrow=\"2\" layout-ncol=\"2\"}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\nwages_clean %>% \n  ggplot() +\n  geom_boxplot(aes(realrinc, educcat)) + # (x,y) format\n  labs(title = \"Plot 3A: Income by Education Category\")\n##\nwages_clean %>% \n  ggplot() + \n  geom_boxplot(aes(log10(realrinc), educcat)) + \n  labs(title = \"Plot 3B: Log(Income) by Education Category\")\n##\nwages_clean %>% \n  ggplot() + \n  geom_boxplot(aes(log(realrinc), \n                   reorder(educcat, realrinc, FUN = median), \n                   fill = educcat),\n               alpha = 0.3) + \n  labs(title = \"Plot 3C: Log(Income) by Education Category, sorted\",\n       x = \"Log Income\", y = \"Education Category\")\n##\nwages_clean %>% \n  ggplot() + \n  geom_boxplot(aes(realrinc, \n                   reorder(educcat, realrinc, FUN = median), \n                   fill = educcat),\n               alpha = 0.3)+ \n  scale_x_log10() + \n  labs(title = \"Plot 3D: Income by Education Category, sorted\",\n       subtitle = \"Log Income Scale\",\n       x = \"Income\", y = \"Education Category\")\n```\n\n::: {.cell-output-display}\n![Split by Education Category](index_files/figure-html/fig-income-by-educcat-ggplot-1.png){#fig-income-by-educcat-ggplot-1 width=2100}\n:::\n\n::: {.cell-output-display}\n![With log income](index_files/figure-html/fig-income-by-educcat-ggplot-2.png){#fig-income-by-educcat-ggplot-2 width=2100}\n:::\n\n::: {.cell-output-display}\n![With log scale](index_files/figure-html/fig-income-by-educcat-ggplot-3.png){#fig-income-by-educcat-ggplot-3 width=2100}\n:::\n\n::: {.cell-output-display}\n![Split by Education Category](index_files/figure-html/fig-income-by-educcat-ggplot-4.png){#fig-income-by-educcat-ggplot-4 width=2100}\n:::\n\nIncome by Education Category\n:::\n\n\n\n\n### web-r\n\n```{webr-r}\nwages %>% \n  tidyr::drop_na(realrinc) %>% \n  gf_boxplot(educcat ~ realrinc) %>% \n  gf_labs(title = \"Plot 3A: Income by Education Category\")\n##\nwages %>% \n  tidyr::drop_na(realrinc) %>% \n  gf_boxplot(educcat ~ log10(realrinc)) %>% \n  gf_labs(title = \"Plot 3B: Log(Income) by Education Category\")\n##\nwages %>% \n  tidyr::drop_na(realrinc) %>% \n  gf_boxplot(reorder(educcat, realrinc, FUN = median) ~ log(realrinc), \n             fill = ~ educcat,\n             alpha = 0.3) %>% \n  gf_labs(title = \"Plot 3C: Log(Income) by Education Category, sorted\") %>% gf_labs(x = \"Log Income\", y = \"Education Category\")\n##\nwages %>% \n  tidyr::drop_na(realrinc) %>% \n  gf_boxplot(reorder(educcat, realrinc, FUN = median) ~ realrinc, \n             fill = ~ educcat,\n             alpha = 0.5) %>% \n  gf_refine(scale_x_log10()) %>% \n  gf_labs(title = \"Plot 3D: Income by Education Category, sorted\",\n          subtitle = \"Log Income Scale\") %>% \n  gf_labs(x = \"Income\", y = \"Education Category\")\n\n```\n\n:::\n### Business Insights-3\n\n- `realrinc` rises with `educcat`, which is to be expected.\n- However, there are people with *very low* and *very high* income in all categories of `educcat`\n- Hence `educcat` *alone* may not be a good predictor for `realrinc`. \n:::\n\nWe can do similar work with the other Qual variables. Let us now see how we can use more than one Qual variable and answer the last hypothesis, Question 4.\n\n### {{< iconify el question-sign >}} Question-4: Is the target variable `realrinc` affected by combinations of Qual factors `gender`, `educcat`, `maritalcat` and `childs`?\n::: callout-important \nThis is a rather complex question and could take us deep into [Modelling](https://r4ds.had.co.nz/model-building.html). Ideally we ought to:\\\n- take each Qual variable, explain its effect on the target variable\\\n- **remove that effect** and model the remainder ( i.e. *residual*) with the next Qual variable\\\n- Proceed in this way until we have a good model.\\\nif we are going to do this manually. There are more modern [Modelling Workflows](workflows), that can do things much faster and without such manual tweaking. \n:::\n\nSo will simply plot box plots showing effects on the target variable of *combinations* of Qual variables taken two at a time. (We will of course use facetted box plots!)\n\nWe will also drop NA values all around this time, to avoid seeing boxplots for undocumented categories.\n\n::: callout-note\n### Question-4: Is `realrinc` affected by combinations of factors?\n\n\n::: {.panel-tabset .nav-pills style=\"background: whitesmoke; \"}\n\n### Using ggformula\n\n\n\n::: {#fig-income-by-educcat-childs-ggformula .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\nwages %>% \n  drop_na() %>% \n  gf_boxplot(reorder(educcat, realrinc) ~ log10(realrinc),\n             fill = ~ educcat, \n             alpha = 0.5) %>% \n  gf_facet_wrap(vars(childs)) %>% \n  gf_refine(scale_fill_brewer(type = \"qual\", palette = \"Dark2\")) %>% \n  gf_labs(title = \"Plot 4A: Log Income by Education Category and Family Size\", x = \"Log income\", y = \"No. of Children\")\n##\nwages %>% \n  drop_na() %>% \n  mutate(childs = as_factor(childs)) %>% \n  gf_boxplot(childs ~ log10(realrinc),\n             group = ~ childs,\n             fill = ~ childs, \n             alpha = 0.5) %>% \n  gf_facet_wrap(~ gender) %>% \n  gf_refine(scale_fill_brewer(type = \"qual\", palette = \"Set3\")) %>% \n  gf_labs(title = \"Plot 4B: Log Income by Gender and Family Size\",\n          x = \"Log income\",\n          y = \"No. of Children\")\n```\n\n::: {.cell-output-display}\n![Split by Education Category and Family Size](index_files/figure-html/fig-income-by-educcat-childs-ggformula-1.png){#fig-income-by-educcat-childs-ggformula-1 width=2100}\n:::\n\n::: {.cell-output-display}\n![Split by Gender and Family Size](index_files/figure-html/fig-income-by-educcat-childs-ggformula-2.png){#fig-income-by-educcat-childs-ggformula-2 width=2100}\n:::\n\nIncome and Other Qual Variables\n:::\n\n\n\n\n\n### Using ggplot\n\n\n\n::: {#fig-income-by-educcat-childs-ggplot .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\n# Set graph theme\ntheme_set(new = theme_custom())\n#\nwages %>% \n  drop_na() %>%\n  ggplot() + \n  geom_boxplot(aes(log10(realrinc), reorder(educcat, realrinc),\n                   fill = educcat), # aes() closes here\n               alpha = 0.5) + \n  facet_wrap(vars(childs)) +\n  scale_fill_brewer(type = \"qual\", palette = \"Dark2\") + \n  labs(title = \"Plot 4A: Log Income by Education Category and Family Size\", x = \"Log income\", y = \"No. of Children\")\n##\nwages %>% \n  drop_na() %>% \n  mutate(childs = as_factor(childs)) %>% \n  ggplot() + \n  geom_boxplot(aes(log10(realrinc),childs,\n                 group = childs,\n                 fill = childs), # aes() closes here\n             alpha = 0.5) +\n  facet_wrap(vars(gender)) +\n  scale_fill_brewer(type = \"qual\", palette = \"Set3\") + \n  labs(title = \"Plot 4B: Log Income by Gender and Family Size\",\n          x = \"Log income\",\n          y = \"No. of Children\")\n```\n\n::: {.cell-output-display}\n![Split by Education Category and Family Size](index_files/figure-html/fig-income-by-educcat-childs-ggplot-1.png){#fig-income-by-educcat-childs-ggplot-1 width=2100}\n:::\n\n::: {.cell-output-display}\n![Split by Gender and Family Size](index_files/figure-html/fig-income-by-educcat-childs-ggplot-2.png){#fig-income-by-educcat-childs-ggplot-2 width=2100}\n:::\n\nIncome and Other Qual Variables\n:::\n\n\n\n\n### web-r\n\n```{webr-r}\n#| label: fig-income-by-educcat-childs-webr\n# Set graph theme\ntheme_set(new = theme_custom())\n#\nwages %>% \n  drop_na() %>% \n  gf_boxplot(reorder(educcat, realrinc) ~ log10(realrinc),\n             fill = ~ educcat, \n             alpha = 0.5) %>% \n  gf_facet_wrap(vars(childs)) %>% \n  gf_refine(scale_fill_brewer(type = \"qual\", palette = \"Dark2\")) %>% \n  gf_labs(title = \"Plot 4A: Log Income by Education Category and Family Size\", x = \"Log income\", y = \"No. of Children\")\n##\nwages %>% \n  drop_na() %>% \n  mutate(childs = as_factor(childs)) %>% \n  gf_boxplot(childs ~ log10(realrinc),\n             group = ~ childs,\n             fill = ~ childs, \n             alpha = 0.5) %>% \n  gf_facet_wrap(~ gender) %>% \n  gf_refine(scale_fill_brewer(type = \"qual\", palette = \"Set3\")) %>% \n  gf_labs(title = \"Plot 4B: Log Income by Gender and Family Size\",\n          x = \"Log income\",\n          y = \"No. of Children\")\n\n```\n\n:::\n\n### Business Insights-4\n- From @fig-income-by-educcat-childs-ggformula-1, we see that `realrinc` increases with `educcat`, across (almost) all family sizes `childs`. \n- However, this trend breaks a little when family sizes `childs` is large, say >= 7. Be aware that the data observations for such large families may be sparse and this inference may not be necessarily valid.\n- From @fig-income-by-educcat-childs-ggformula-2, we see that the effect of `childs` on `realrinc` is different for each `gender`! For *females*, the income steadily drops with the number of children, whereas for *males* it actually increases up to a certain family size before decreasing again. \n:::\n\n\n## {{< iconify fluent-mdl2 decision-solid >}} Conclusion\n\n-   Box Plots \"dwell upon\" **medians** and **Quartiles**\n-   Box Plots can show distributions of a Quant variable over levels of a Qual variable\n- This allows a comparison of box plots side by side to visibly detect differences in median and IQR across such levels\n\n\n## {{< iconify openmoji person >}} Your Turn\n\n<a href=\"./files/data/qdd-data.zip\">\n<i class=\"fa-solid fa-database\"></i> Datasets</a>\n\n1.  Click on the Dataset Icon above, and unzip that archive. Try to make\n    distribution plots with each of the three tools.\n2.  A dataset from calmcode.io <https://calmcode.io/datasets.html>\n3.  Old Faithful Data in R (Find it!)\n\n`inspect` the dataset in each case and develop a set of Questions, that\ncan be answered by appropriate stat measures, or by using a chart to\nshow the distribution.\n\n## {{< iconify ri slash-commands-2>}} R Commands Used Here{.hidden}\n\n\n\n\n\n\n\n\n\n## {{< iconify ooui references-rtl >}} References\n\n1. See the scrolly animation for a histogram at this website: *Exploring Histograms, an essay by Aran Lunzer and Amelia McNamara*\n<https://tinlizzie.org/histograms/?s=09>\\\n1. Minimal R using\n`mosaic`.<https://cran.r-project.org/web/packages/mosaic/vignettes/MinimalRgg.pdf>\\\n1. Sebastian Sauer, *Plotting multiple plots using purrr::map and ggplot* [](https://data-se.netlify.app/2021/02/06/plotting-multiple-plots-using-purrr-map-and-ggplot/)\\\n\n::: {#refs style=\"font-size: 60%;\"}\n###### {{< iconify lucide package-check >}} R Package Citations\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\nPackage         Version   Citation       \n--------------  --------  ---------------\nggridges        0.5.6     @ggridges      \nNHANES          2.1.0     @NHANES        \nTeachHist       0.2.1     @TeachHist     \nTeachingDemos   2.13      @TeachingDemos \nvisualize       4.5.0     @visualize     \n\n\n:::\n:::\n\n\n\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../../../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<link href=\"../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}