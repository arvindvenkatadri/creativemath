{
  "hash": "ee02a060127e1f59595b627ae3a72e43",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Maps\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(tmap)\nlibrary(osmdata)\nlibrary(ggformula)\n```\n:::\n\n\n\n\n\n## Defining a bounding box\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbbox_2 <- osmdata::getbb(\"Jayanagar, Bangalore, India\")\nbbox_2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       min      max\nx 77.58034 77.58507\ny 12.93683 12.94356\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlocations <-\n  osmdata::opq(bbox = bbox_2) %>%\n  osmdata::add_osm_feature(\n    key = \"amenity\",\n    value = c(\"restaurant\", \"atm\", \"college\")\n  ) %>%\n  osmdata_sf() %>% # Convert to Simple Features format\n  purrr::pluck(\"osm_points\") # Pull out the data frame of interest\n###\ndat_buildings <-\n  osmdata::opq(bbox = bbox_2) %>%\n  osmdata::add_osm_feature(key = \"building\") %>%\n  osmdata_sf() %>%\n  purrr::pluck(\"osm_polygons\")\n```\n:::\n\n\n\n\n\n\n## Inspecting OSM data\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(locations)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nClasses 'sf' and 'data.frame':\t37 obs. of  22 variables:\n $ osm_id            : chr  \"493493804\" \"493493806\" \"493493810\" \"1217571540\" ...\n $ name              : chr  NA NA NA NA ...\n $ amenity           : chr  NA NA NA NA ...\n $ brand             : chr  NA NA NA NA ...\n $ brand:en          : chr  NA NA NA NA ...\n $ brand:hi          : chr  NA NA NA NA ...\n $ brand:kn          : chr  NA NA NA NA ...\n $ brand:pa          : chr  NA NA NA NA ...\n $ brand:pnb         : chr  NA NA NA NA ...\n $ brand:ur          : chr  NA NA NA NA ...\n $ brand:wikidata    : chr  NA NA NA NA ...\n $ brand:wikipedia   : chr  NA NA NA NA ...\n $ brand:wikipedia:pa: chr  NA NA NA NA ...\n $ name:en           : chr  NA NA NA NA ...\n $ name:hi           : chr  NA NA NA NA ...\n $ name:kn           : chr  NA NA NA NA ...\n $ name:pa           : chr  NA NA NA NA ...\n $ name:pnb          : chr  NA NA NA NA ...\n $ name:ur           : chr  NA NA NA NA ...\n $ operator          : chr  NA NA NA NA ...\n $ operator:wikidata : chr  NA NA NA NA ...\n $ geometry          :sfc_POINT of length 37; first list element:  'XY' num  77.6 12.9\n - attr(*, \"sf_column\")= chr \"geometry\"\n - attr(*, \"agr\")= Factor w/ 3 levels \"constant\",\"aggregate\",..: NA NA NA NA NA NA NA NA NA NA ...\n  ..- attr(*, \"names\")= chr [1:21] \"osm_id\" \"name\" \"amenity\" \"brand\" ...\n```\n\n\n:::\n\n```{.r .cell-code}\nstr(dat_buildings)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nClasses 'sf' and 'data.frame':\t733 obs. of  26 variables:\n $ osm_id          : chr  \"105734855\" \"105734857\" \"105734859\" \"130863019\" ...\n $ name            : chr  NA NA NA \"BBMP Complex (Jayanagar 2nd Block)\" ...\n $ addr:city       : chr  NA NA NA NA ...\n $ addr:housenumber: chr  NA NA NA NA ...\n $ addr:postcode   : chr  NA NA NA NA ...\n $ addr:street     : chr  NA NA NA NA ...\n $ alt_name        : chr  NA NA NA NA ...\n $ amenity         : chr  NA NA NA \"public_building\" ...\n $ atm             : chr  NA NA NA NA ...\n $ brand           : chr  NA NA NA NA ...\n $ brand:wikidata  : chr  NA NA NA NA ...\n $ brand:wikipedia : chr  NA NA NA NA ...\n $ building        : chr  NA \"yes\" \"yes\" \"yes\" ...\n $ building:levels : chr  NA NA NA NA ...\n $ level           : chr  NA NA NA NA ...\n $ lit             : chr  NA NA NA NA ...\n $ name:en         : chr  NA NA NA NA ...\n $ name:kn         : chr  NA NA NA \"ಬಿಬಿಎಂಪಿ ಸಂಕೀರ್ಣ\" ...\n $ office          : chr  NA NA NA NA ...\n $ opening_hours   : chr  NA NA NA NA ...\n $ operator        : chr  NA NA NA NA ...\n $ phone           : chr  NA NA NA NA ...\n $ shop            : chr  NA NA NA NA ...\n $ smoking         : chr  NA NA NA NA ...\n $ website         : chr  NA NA NA NA ...\n $ geometry        :sfc_POLYGON of length 733; first list element: List of 1\n  ..$ : num [1:14, 1:2] 77.6 77.6 77.6 77.6 77.6 ...\n  .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. ..$ : chr [1:14] \"1217571544\" \"1217571540\" \"493493806\" \"1217571541\" ...\n  .. .. ..$ : chr [1:2] \"lon\" \"lat\"\n  ..- attr(*, \"class\")= chr [1:3] \"XY\" \"POLYGON\" \"sfg\"\n - attr(*, \"sf_column\")= chr \"geometry\"\n - attr(*, \"agr\")= Factor w/ 3 levels \"constant\",\"aggregate\",..: NA NA NA NA NA NA NA NA NA NA ...\n  ..- attr(*, \"names\")= chr [1:25] \"osm_id\" \"name\" \"addr:city\" \"addr:housenumber\" ...\n```\n\n\n:::\n:::\n\n\n\n\n\n## Plotting Base Maps with ggplot/ggformula\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = locations, fill = \"gold\", color = \"grey\", linewidth = 0.025) +\n  geom_sf(data = dat_buildings, fill = \"purple\") +\n  coord_sf()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=2100}\n:::\n\n```{.r .cell-code}\ngf_sf(geometry = ~geometry, data = locations) %>%\n  gf_sf(geometry = ~geometry, dat = dat_buildings)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-2.png){width=2100}\n:::\n:::\n\n\n\n\n\n## Plotting with tmap\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(locations) +\n  tm_dots(size = 0.5) +\n  tm_shape(dat_buildings) +\n  tm_polygons() +\n  tm_compass(position = c(\"right\", \"top\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=2100}\n:::\n:::\n\n\n\n\n\n\n\n## Adding User Data to a Base Map\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}